<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processing Query - VoiceQuery AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563EB',
                        secondary: '#3B82F6',
                        accent: '#0EA5E9',
                        dark: '#0F172A',
                        darker: '#020617',
                        surface: '#1E293B',
                        border: '#334155',
                        textPrimary: '#F8FAFC',
                        textSecondary: '#94A3B8',
                    },
                    fontFamily: {
                        heading: ['Space Grotesk', 'sans-serif'],
                        body: ['DM Sans', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'DM Sans', sans-serif;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Space Grotesk', sans-serif;
        }
        
        /* Animated gradient background */
        .reasoning-bg {
            background: radial-gradient(ellipse at center, #1E293B 0%, #0F172A 50%, #020617 100%);
        }

        /* Table card styling */
        .table-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8) 0%, rgba(15, 23, 42, 0.9) 100%);
            border: 1px solid rgba(71, 85, 105, 0.5);
            backdrop-filter: blur(10px);
        }

        .table-row-item {
            background: rgba(51, 65, 85, 0.5);
            border: 1px solid rgba(71, 85, 105, 0.3);
        }

        /* Connection lines animation */
        @keyframes flowLine {
            0% { stroke-dashoffset: 1000; }
            100% { stroke-dashoffset: 0; }
        }

        @keyframes flowDash {
            to { stroke-dashoffset: -20; }
        }

        .connection-line {
            stroke-dasharray: 8, 4;
            animation: flowDash 0.8s linear infinite;
        }

        .connection-line-delayed-1 { animation-delay: 0.1s; }
        .connection-line-delayed-2 { animation-delay: 0.2s; }
        .connection-line-delayed-3 { animation-delay: 0.3s; }
        .connection-line-delayed-4 { animation-delay: 0.4s; }

        /* Neural network node animation */
        @keyframes nodeGlow {
            0%, 100% { 
                box-shadow: 0 0 5px rgba(14, 165, 233, 0.5);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 20px rgba(14, 165, 233, 1), 0 0 40px rgba(37, 99, 235, 0.5);
                transform: scale(1.1);
            }
        }

        .neural-node {
            animation: nodeGlow 2s ease-in-out infinite;
        }

        .neural-node-delayed-1 { animation-delay: 0.2s; }
        .neural-node-delayed-2 { animation-delay: 0.4s; }
        .neural-node-delayed-3 { animation-delay: 0.6s; }
        .neural-node-delayed-4 { animation-delay: 0.8s; }

        /* Step card animation */
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .step-card {
            animation: slideInRight 0.5s ease-out forwards;
            opacity: 0;
        }

        .step-card.active {
            border-color: rgba(14, 165, 233, 0.8);
            box-shadow: 0 0 20px rgba(14, 165, 233, 0.3);
        }

        /* Confidence gauge */
        @keyframes gaugeProgress {
            from { stroke-dashoffset: 283; }
            to { stroke-dashoffset: 42; }
        }

        .gauge-progress {
            animation: gaugeProgress 2s ease-out forwards;
            animation-delay: 1s;
        }

        /* Table highlight animation */
        @keyframes tableHighlight {
            0%, 100% { border-color: rgba(71, 85, 105, 0.5); }
            50% { border-color: rgba(14, 165, 233, 0.8); box-shadow: 0 0 15px rgba(14, 165, 233, 0.3); }
        }

        .table-active {
            animation: tableHighlight 2s ease-in-out infinite;
        }

        /* Floating particles */
        @keyframes float {
            0%, 100% { transform: translateY(0px) translateX(0px); opacity: 0.3; }
            25% { transform: translateY(-20px) translateX(10px); opacity: 0.8; }
            50% { transform: translateY(-10px) translateX(-10px); opacity: 0.5; }
            75% { transform: translateY(-30px) translateX(5px); opacity: 0.7; }
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #0EA5E9;
            border-radius: 50%;
            animation: float 4s ease-in-out infinite;
        }

        /* Reasoning step check animation */
        @keyframes checkPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        .check-animated {
            animation: checkPop 0.4s ease-out forwards;
        }

        /* Network mesh lines */
        @keyframes meshPulse {
            0%, 100% { stroke-opacity: 0.2; }
            50% { stroke-opacity: 0.6; }
        }

        .mesh-line {
            stroke: rgba(14, 165, 233, 0.3);
            stroke-width: 1;
        }

        .mesh-animated {
            animation: meshPulse 3s ease-in-out infinite;
        }

        /* Data flow particle on path */
        @keyframes moveAlongPath {
            0% { offset-distance: 0%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { offset-distance: 100%; opacity: 0; }
        }

        .data-particle {
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, #0EA5E9 0%, transparent 70%);
            border-radius: 50%;
            position: absolute;
            offset-rotate: 0deg;
            animation: moveAlongPath 2s linear infinite;
        }

        /* Glowing center effect */
        @keyframes centerGlow {
            0%, 100% { 
                box-shadow: 0 0 30px rgba(14, 165, 233, 0.5), 0 0 60px rgba(37, 99, 235, 0.3);
            }
            50% { 
                box-shadow: 0 0 50px rgba(14, 165, 233, 0.8), 0 0 100px rgba(37, 99, 235, 0.5);
            }
        }

        .center-node {
            animation: centerGlow 2s ease-in-out infinite;
        }

        /* Row highlight effect */
        @keyframes rowHighlight {
            0%, 100% { background: rgba(51, 65, 85, 0.5); }
            50% { background: rgba(14, 165, 233, 0.2); }
        }

        .row-active {
            animation: rowHighlight 1s ease-in-out;
        }
    </style>
</head>
<body class="bg-darker text-textPrimary min-h-screen">
    <div class="flex min-h-screen">
        <!-- Sidebar (Collapsed for more space) -->
        <aside class="w-16 bg-dark border-r border-border flex flex-col items-center py-6">
            <a href="index.html" class="w-10 h-10 bg-gradient-to-br from-primary to-accent rounded-xl flex items-center justify-center mb-8">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                </svg>
            </a>
            <nav class="flex-1 flex flex-col items-center gap-4">
                <a href="sales-dashboard.html" class="p-3 bg-primary/10 text-primary rounded-xl cursor-pointer" title="Voice Query">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                    </svg>
                </a>
                <a href="#" class="p-3 text-textSecondary hover:text-textPrimary hover:bg-surface/50 rounded-xl transition-colors cursor-pointer" title="History">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col reasoning-bg">
            <!-- Top Bar -->
            <header class="h-14 bg-dark/50 backdrop-blur-xl border-b border-border/50 flex items-center justify-between px-6">
                <div class="flex items-center gap-4">
                    <a href="query-confirmation.html" class="p-2 hover:bg-surface rounded-xl transition-colors cursor-pointer" aria-label="Go back">
                        <svg class="w-5 h-5 text-textSecondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                        </svg>
                    </a>
                    <div>
                        <h1 class="text-lg font-heading font-bold">AI Reasoning Engine</h1>
                        <p class="text-xs text-textSecondary">Analyzing query and generating SQL</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <!-- Confidence Gauge -->
                    <div class="flex items-center gap-3">
                        <span class="text-sm text-textSecondary">Confidence:</span>
                        <div class="relative w-16 h-16">
                            <svg class="w-16 h-16 -rotate-90" viewBox="0 0 100 100">
                                <circle cx="50" cy="50" r="45" fill="none" stroke="#334155" stroke-width="8"/>
                                <circle cx="50" cy="50" r="45" fill="none" stroke="url(#gaugeGradient)" stroke-width="8" 
                                    stroke-linecap="round" stroke-dasharray="283" stroke-dashoffset="283" class="gauge-progress"/>
                                <defs>
                                    <linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#2563EB"/>
                                        <stop offset="100%" style="stop-color:#0EA5E9"/>
                                    </linearGradient>
                                </defs>
                            </svg>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <span id="confidenceValue" class="text-sm font-bold text-accent">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Visualization Area -->
            <div class="flex-1 flex relative overflow-hidden">
                <!-- Floating Particles Background -->
                <div class="absolute inset-0 pointer-events-none">
                    <div class="particle" style="left: 10%; top: 20%; animation-delay: 0s;"></div>
                    <div class="particle" style="left: 25%; top: 60%; animation-delay: 1s;"></div>
                    <div class="particle" style="left: 45%; top: 30%; animation-delay: 0.5s;"></div>
                    <div class="particle" style="left: 70%; top: 70%; animation-delay: 1.5s;"></div>
                    <div class="particle" style="left: 85%; top: 40%; animation-delay: 2s;"></div>
                    <div class="particle" style="left: 60%; top: 15%; animation-delay: 0.8s;"></div>
                    <div class="particle" style="left: 30%; top: 80%; animation-delay: 1.2s;"></div>
                </div>

                <!-- Left Panel - Source Tables -->
                <div class="w-56 p-4 flex flex-col gap-4 z-10">
                    <!-- Users/Customers Table -->
                    <div id="usersTable" class="table-card rounded-xl p-3" style="opacity: 0; transition: opacity 0.5s, box-shadow 0.5s;">
                        <div class="flex items-center gap-2 mb-3">
                            <div class="w-6 h-6 bg-cyan-500/20 rounded flex items-center justify-center">
                                <svg class="w-4 h-4 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                                </svg>
                            </div>
                            <span class="font-medium text-sm text-textPrimary">Customers</span>
                        </div>
                        <div class="space-y-1.5">
                            <div id="users-row1" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-yellow-400 rounded-full"></span> id
                            </div>
                            <div id="users-row2" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> name
                            </div>
                            <div id="users-row3" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> email
                            </div>
                            <div id="users-row4" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> created_at
                            </div>
                        </div>
                    </div>

                    <!-- Orders Table -->
                    <div id="ordersTable" class="table-card rounded-xl p-3" style="opacity: 0; transition: opacity 0.5s, box-shadow 0.5s;">
                        <div class="flex items-center gap-2 mb-3">
                            <div class="w-6 h-6 bg-purple-500/20 rounded flex items-center justify-center">
                                <svg class="w-4 h-4 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                </svg>
                            </div>
                            <span class="font-medium text-sm text-textPrimary">Orders</span>
                        </div>
                        <div class="space-y-1.5">
                            <div id="orders-row1" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-yellow-400 rounded-full"></span> id
                            </div>
                            <div id="orders-row2" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-green-400 rounded-full"></span> customer_id
                            </div>
                            <div id="orders-row3" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> order_date
                            </div>
                            <div id="orders-row4" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> total_amount
                            </div>
                        </div>
                    </div>

                    <!-- Products Table -->
                    <div id="productsTable" class="table-card rounded-xl p-3" style="opacity: 0; transition: opacity 0.5s, box-shadow 0.5s;">
                        <div class="flex items-center gap-2 mb-3">
                            <div class="w-6 h-6 bg-orange-500/20 rounded flex items-center justify-center">
                                <svg class="w-4 h-4 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                                </svg>
                            </div>
                            <span class="font-medium text-sm text-textPrimary">Products</span>
                        </div>
                        <div class="space-y-1.5">
                            <div id="products-row1" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-yellow-400 rounded-full"></span> id
                            </div>
                            <div id="products-row2" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> name
                            </div>
                            <div id="products-row3" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> price
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Table -->
                    <div id="analyticsTable" class="table-card rounded-xl p-3" style="opacity: 0; transition: opacity 0.5s, box-shadow 0.5s;">
                        <div class="flex items-center gap-2 mb-3">
                            <div class="w-6 h-6 bg-pink-500/20 rounded flex items-center justify-center">
                                <svg class="w-4 h-4 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                                </svg>
                            </div>
                            <span class="font-medium text-sm text-textPrimary">Analytics</span>
                        </div>
                        <div class="space-y-1.5">
                            <div id="analytics-row1" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-yellow-400 rounded-full"></span> id
                            </div>
                            <div id="analytics-row2" class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> metrics
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Center - Neural Network Visualization -->
                <div class="flex-1 relative flex items-center justify-center">
                    <!-- SVG Connection Lines & Neural Network -->
                    <svg class="absolute inset-0 w-full h-full" style="z-index: 1;" id="connectionSvg">
                        <!-- Connection lines will be drawn by JavaScript -->
                        
                        <!-- Neural network mesh lines in center -->
                        <g class="mesh-animated" id="meshGroup" style="opacity: 0; transition: opacity 0.5s;">
                            <!-- Mesh will be drawn relative to center -->
                        </g>

                        <!-- Gradients -->
                        <defs>
                            <linearGradient id="lineGradient1" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#0EA5E9; stop-opacity:0.8"/>
                                <stop offset="100%" style="stop-color:#8B5CF6; stop-opacity:0.8"/>
                            </linearGradient>
                            <linearGradient id="lineGradient2" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#2563EB; stop-opacity:0.8"/>
                                <stop offset="100%" style="stop-color:#0EA5E9; stop-opacity:0.8"/>
                            </linearGradient>
                            <linearGradient id="lineGradient3" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#8B5CF6; stop-opacity:0.8"/>
                                <stop offset="100%" style="stop-color:#EC4899; stop-opacity:0.8"/>
                            </linearGradient>
                            <radialGradient id="glowGradient">
                                <stop offset="0%" style="stop-color:#0EA5E9; stop-opacity:1"/>
                                <stop offset="100%" style="stop-color:#0EA5E9; stop-opacity:0"/>
                            </radialGradient>
                        </defs>
                    </svg>

                    <!-- Neural Network Nodes -->
                    <div id="neuralNetwork" class="relative z-10" style="width: 200px; height: 200px; opacity: 0; transition: opacity 0.5s;">
                        <!-- Central large node -->
                        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full center-node flex items-center justify-center">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                            </svg>
                        </div>
                        
                        <!-- Surrounding nodes -->
                        <div class="absolute left-0 top-1/4 w-6 h-6 bg-cyan-500 rounded-full neural-node neural-node-delayed-1"></div>
                        <div class="absolute right-0 top-1/4 w-6 h-6 bg-purple-500 rounded-full neural-node neural-node-delayed-2"></div>
                        <div class="absolute left-1/4 top-0 w-5 h-5 bg-blue-500 rounded-full neural-node neural-node-delayed-3"></div>
                        <div class="absolute right-1/4 top-0 w-5 h-5 bg-pink-500 rounded-full neural-node neural-node-delayed-4"></div>
                        <div class="absolute left-1/4 bottom-0 w-5 h-5 bg-green-500 rounded-full neural-node neural-node-delayed-1"></div>
                        <div class="absolute right-1/4 bottom-0 w-5 h-5 bg-orange-500 rounded-full neural-node neural-node-delayed-2"></div>
                        <div class="absolute left-0 bottom-1/4 w-4 h-4 bg-cyan-400 rounded-full neural-node neural-node-delayed-3"></div>
                        <div class="absolute right-0 bottom-1/4 w-4 h-4 bg-violet-400 rounded-full neural-node neural-node-delayed-4"></div>
                        
                        <!-- Inner nodes -->
                        <div class="absolute left-1/3 top-1/3 w-3 h-3 bg-cyan-300 rounded-full neural-node neural-node-delayed-2"></div>
                        <div class="absolute right-1/3 top-1/3 w-3 h-3 bg-blue-300 rounded-full neural-node neural-node-delayed-1"></div>
                        <div class="absolute left-1/3 bottom-1/3 w-3 h-3 bg-purple-300 rounded-full neural-node neural-node-delayed-4"></div>
                        <div class="absolute right-1/3 bottom-1/3 w-3 h-3 bg-pink-300 rounded-full neural-node neural-node-delayed-3"></div>
                    </div>

                    <!-- Processing Steps Cards (Floating) -->
                    <div class="absolute top-8 left-1/2 -translate-x-1/2 z-20">
                        <div id="step1" class="step-card bg-surface/80 backdrop-blur-xl border border-cyan-500/50 rounded-xl px-4 py-2 flex items-center gap-3">
                            <div class="w-6 h-6 bg-cyan-500/20 rounded-full flex items-center justify-center">
                                <svg id="step1Icon" class="w-4 h-4 text-cyan-400 animate-spin" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                                </svg>
                            </div>
                            <span class="text-sm font-medium text-cyan-300">Analyzing Request...</span>
                        </div>
                    </div>

                    <div class="absolute top-28 left-[30%] z-20">
                        <div id="step2" class="step-card bg-surface/80 backdrop-blur-xl border border-purple-500/50 rounded-xl px-4 py-2 flex items-center gap-3" style="animation-delay: 1.5s;">
                            <div class="w-6 h-6 bg-purple-500/20 rounded-full flex items-center justify-center">
                                <svg id="step2Icon" class="w-4 h-4 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                                </svg>
                            </div>
                            <span class="text-sm font-medium text-purple-300">Linking Tables: Customers â†” Orders</span>
                        </div>
                    </div>

                    <div class="absolute bottom-36 left-1/2 -translate-x-1/2 z-20">
                        <div id="step3" class="step-card bg-surface/80 backdrop-blur-xl border border-green-500/50 rounded-xl px-4 py-2 flex items-center gap-3" style="animation-delay: 2.5s;">
                            <div class="w-6 h-6 bg-green-500/20 rounded-full flex items-center justify-center">
                                <svg id="step3Icon" class="w-4 h-4 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/>
                                </svg>
                            </div>
                            <span class="text-sm font-medium text-green-300">Reasoning: Filtering by Date > 30 days</span>
                        </div>
                    </div>

                    <div class="absolute bottom-12 left-1/2 -translate-x-1/2 z-20">
                        <div id="step4" class="step-card bg-surface/80 backdrop-blur-xl border border-pink-500/50 rounded-xl px-4 py-2 flex items-center gap-3" style="animation-delay: 3.5s;">
                            <div class="w-6 h-6 bg-pink-500/20 rounded-full flex items-center justify-center">
                                <svg id="step4Icon" class="w-4 h-4 text-pink-400 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/>
                                </svg>
                            </div>
                            <span class="text-sm font-medium text-pink-300">Generating Output...</span>
                        </div>
                    </div>
                </div>

                <!-- Right Panel - Output Tables & Reasoning Steps -->
                <div class="w-64 p-4 flex flex-col gap-4 z-10">
                    <!-- Reasoning Steps Panel -->
                    <div class="bg-surface/50 backdrop-blur-xl border border-border rounded-xl p-4">
                        <h3 class="font-heading font-semibold text-sm mb-4 flex items-center gap-2">
                            <svg class="w-4 h-4 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                            </svg>
                            Reasoning Steps
                        </h3>
                        <div class="space-y-3">
                            <div id="rStep1" class="flex items-start gap-2 opacity-30" style="transition: opacity 0.3s;">
                                <div class="w-5 h-5 rounded-full bg-dark border border-border flex items-center justify-center flex-shrink-0 mt-0.5" style="transition: all 0.3s;">
                                    <svg class="w-3 h-3 text-green-400 opacity-0" style="transition: opacity 0.3s;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                                    </svg>
                                </div>
                                <span class="text-xs text-textSecondary">Analyzing Request</span>
                            </div>
                            <div id="rStep2" class="flex items-start gap-2 opacity-30" style="transition: opacity 0.3s;">
                                <div class="w-5 h-5 rounded-full bg-dark border border-border flex items-center justify-center flex-shrink-0 mt-0.5" style="transition: all 0.3s;">
                                    <svg class="w-3 h-3 text-green-400 opacity-0" style="transition: opacity 0.3s;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                                    </svg>
                                </div>
                                <span class="text-xs text-textSecondary">Linking Tables: customers, orders</span>
                            </div>
                            <div id="rStep3" class="flex items-start gap-2 opacity-30" style="transition: opacity 0.3s;">
                                <div class="w-5 h-5 rounded-full bg-dark border border-border flex items-center justify-center flex-shrink-0 mt-0.5" style="transition: all 0.3s;">
                                    <svg class="w-3 h-3 text-green-400 opacity-0" style="transition: opacity 0.3s;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                                    </svg>
                                </div>
                                <span class="text-xs text-textSecondary">Reasoning: Products, Analytics</span>
                            </div>
                            <div id="rStep4" class="flex items-start gap-2 opacity-30" style="transition: opacity 0.3s;">
                                <div class="w-5 h-5 rounded-full bg-dark border border-border flex items-center justify-center flex-shrink-0 mt-0.5" style="transition: all 0.3s;">
                                    <svg class="w-3 h-3 text-green-400 opacity-0" style="transition: opacity 0.3s;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                                    </svg>
                                </div>
                                <span class="text-xs text-textSecondary">Filtering: Date > 2025</span>
                            </div>
                            <div id="rStep5" class="flex items-start gap-2 opacity-30" style="transition: opacity 0.3s;">
                                <div class="w-5 h-5 rounded-full bg-dark border border-border flex items-center justify-center flex-shrink-0 mt-0.5" style="transition: all 0.3s;">
                                    <svg class="w-3 h-3 text-green-400 opacity-0" style="transition: opacity 0.3s;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                                    </svg>
                                </div>
                                <span class="text-xs text-textSecondary">Generating SQL & analytics</span>
                            </div>
                        </div>
                    </div>

                    <!-- Output Result Tables -->
                    <div id="outputTable1" class="table-card rounded-xl p-3" style="opacity: 0; transition: opacity 0.5s;">
                        <div class="flex items-center gap-2 mb-3">
                            <div class="w-6 h-6 bg-green-500/20 rounded flex items-center justify-center">
                                <svg class="w-4 h-4 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/>
                                </svg>
                            </div>
                            <span class="font-medium text-sm text-textPrimary">Result Set</span>
                        </div>
                        <div class="space-y-1.5">
                            <div class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-green-400 rounded-full"></span> customer_id
                            </div>
                            <div class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-green-400 rounded-full"></span> name
                            </div>
                            <div class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-green-400 rounded-full"></span> order_count
                            </div>
                        </div>
                    </div>

                    <div id="outputTable2" class="table-card rounded-xl p-3" style="opacity: 0; transition: opacity 0.5s;">
                        <div class="flex items-center gap-2 mb-3">
                            <div class="w-6 h-6 bg-blue-500/20 rounded flex items-center justify-center">
                                <svg class="w-4 h-4 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                            </div>
                            <span class="font-medium text-sm text-textPrimary">Metrics</span>
                        </div>
                        <div class="space-y-1.5">
                            <div class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> total_rows
                            </div>
                            <div class="table-row-item rounded px-2 py-1 text-xs text-textSecondary flex items-center gap-2">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span> exec_time
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Get SVG element and center position
        const svg = document.getElementById('connectionSvg');
        
        // Helper function to create SVG path
        function createPath(d, gradient, delay = 0) {
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path.setAttribute('d', d);
            path.setAttribute('fill', 'none');
            path.setAttribute('stroke', `url(#${gradient})`);
            path.setAttribute('stroke-width', '2');
            path.classList.add('connection-line');
            if (delay > 0) {
                path.style.animationDelay = `${delay}s`;
            }
            path.style.opacity = '0';
            path.style.transition = 'opacity 0.5s';
            return path;
        }

        // Create neural network mesh in center
        function createMesh(cx, cy) {
            const meshGroup = document.getElementById('meshGroup');
            const offsets = [
                [-40, -20], [0, -40], [40, -20],
                [-50, 20], [-20, 0], [20, 0], [50, 20],
                [-40, 40], [0, 30], [40, 40]
            ];
            
            // Create mesh connections
            for (let i = 0; i < offsets.length; i++) {
                for (let j = i + 1; j < offsets.length; j++) {
                    if (Math.random() > 0.4) {
                        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                        line.setAttribute('x1', cx + offsets[i][0]);
                        line.setAttribute('y1', cy + offsets[i][1]);
                        line.setAttribute('x2', cx + offsets[j][0]);
                        line.setAttribute('y2', cy + offsets[j][1]);
                        line.classList.add('mesh-line');
                        line.style.animationDelay = `${Math.random() * 2}s`;
                        meshGroup.appendChild(line);
                    }
                }
            }
        }

        // Initialize connections after layout
        function initConnections() {
            const svgRect = svg.getBoundingClientRect();
            const centerX = svgRect.width / 2;
            const centerY = svgRect.height / 2;
            
            // Create mesh
            createMesh(centerX, centerY);
            
            // Store paths for animation
            window.connectionPaths = [];
            
            // Left side tables connections (will be animated)
            const tables = ['usersTable', 'ordersTable', 'productsTable', 'analyticsTable'];
            tables.forEach((tableId, index) => {
                const table = document.getElementById(tableId);
                const tableRect = table.getBoundingClientRect();
                const startX = tableRect.right - svgRect.left;
                const startY = tableRect.top + tableRect.height / 2 - svgRect.top;
                
                // Bezier curve to center
                const path = createPath(
                    `M ${startX} ${startY} Q ${startX + 100} ${startY} ${centerX - 50} ${centerY + (index - 1.5) * 30}`,
                    index % 2 === 0 ? 'lineGradient1' : 'lineGradient2',
                    index * 0.2
                );
                svg.insertBefore(path, document.getElementById('meshGroup'));
                window.connectionPaths.push({ path, tableId, delay: index * 800 });
            });
            
            // Right side output connections
            const outputs = ['outputTable1', 'outputTable2'];
            outputs.forEach((outputId, index) => {
                const output = document.getElementById(outputId);
                const outputRect = output.getBoundingClientRect();
                const endX = outputRect.left - svgRect.left;
                const endY = outputRect.top + outputRect.height / 2 - svgRect.top;
                
                const path = createPath(
                    `M ${centerX + 50} ${centerY + (index - 0.5) * 40} Q ${endX - 100} ${endY} ${endX} ${endY}`,
                    'lineGradient3',
                    (4 + index) * 0.2
                );
                svg.insertBefore(path, document.getElementById('meshGroup'));
                window.outputPaths = window.outputPaths || [];
                window.outputPaths.push({ path, outputId, delay: (4 + index) * 800 });
            });
        }

        // Activate reasoning step with check animation
        function activateReasoningStep(stepId) {
            const step = document.getElementById(stepId);
            step.style.opacity = '1';
            const icon = step.querySelector('svg');
            icon.style.opacity = '1';
            icon.classList.add('check-animated');
            const circle = step.querySelector('div');
            circle.style.borderColor = '#22C55E';
            circle.style.backgroundColor = 'rgba(34, 197, 94, 0.2)';
        }

        // Complete a floating step card
        function completeStep(stepId) {
            const step = document.getElementById(stepId);
            const iconId = stepId + 'Icon';
            const icon = document.getElementById(iconId);
            if (icon) {
                icon.classList.remove('animate-spin', 'animate-pulse');
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
            }
            step.classList.add('active');
        }

        // Highlight table row
        function highlightRow(rowId) {
            const row = document.getElementById(rowId);
            if (row) {
                row.classList.add('row-active');
                setTimeout(() => row.classList.remove('row-active'), 1000);
            }
        }

        // Animation timeline
        const timeline = [
            // Phase 1: Show first step and users table
            { time: 300, action: () => {
                document.getElementById('step1').style.opacity = '1';
                document.getElementById('usersTable').style.opacity = '1';
                document.getElementById('usersTable').classList.add('table-active');
                if (window.connectionPaths && window.connectionPaths[0]) {
                    window.connectionPaths[0].path.style.opacity = '1';
                }
                highlightRow('users-row1');
            }},
            { time: 600, action: () => {
                highlightRow('users-row2');
                activateReasoningStep('rStep1');
            }},
            
            // Phase 2: Link tables
            { time: 1200, action: () => {
                completeStep('step1');
                document.getElementById('step2').style.opacity = '1';
                document.getElementById('ordersTable').style.opacity = '1';
                document.getElementById('ordersTable').classList.add('table-active');
                if (window.connectionPaths && window.connectionPaths[1]) {
                    window.connectionPaths[1].path.style.opacity = '1';
                }
                highlightRow('orders-row1');
                highlightRow('orders-row2');
            }},
            { time: 1500, action: () => {
                document.getElementById('neuralNetwork').style.opacity = '1';
                document.getElementById('meshGroup').style.opacity = '1';
            }},
            { time: 1800, action: () => {
                activateReasoningStep('rStep2');
            }},
            
            // Phase 3: Reasoning with more tables
            { time: 2400, action: () => {
                completeStep('step2');
                document.getElementById('step3').style.opacity = '1';
                document.getElementById('productsTable').style.opacity = '1';
                document.getElementById('productsTable').classList.add('table-active');
                if (window.connectionPaths && window.connectionPaths[2]) {
                    window.connectionPaths[2].path.style.opacity = '1';
                }
                highlightRow('products-row1');
            }},
            { time: 2700, action: () => {
                document.getElementById('analyticsTable').style.opacity = '1';
                document.getElementById('analyticsTable').classList.add('table-active');
                if (window.connectionPaths && window.connectionPaths[3]) {
                    window.connectionPaths[3].path.style.opacity = '1';
                }
            }},
            { time: 3000, action: () => {
                activateReasoningStep('rStep3');
            }},
            
            // Phase 4: Filtering
            { time: 3600, action: () => {
                completeStep('step3');
                activateReasoningStep('rStep4');
            }},
            
            // Phase 5: Generate output
            { time: 4200, action: () => {
                document.getElementById('step4').style.opacity = '1';
                document.getElementById('outputTable1').style.opacity = '1';
                if (window.outputPaths && window.outputPaths[0]) {
                    window.outputPaths[0].path.style.opacity = '1';
                }
            }},
            { time: 4800, action: () => {
                document.getElementById('outputTable2').style.opacity = '1';
                if (window.outputPaths && window.outputPaths[1]) {
                    window.outputPaths[1].path.style.opacity = '1';
                }
            }},
            { time: 5400, action: () => {
                completeStep('step4');
                activateReasoningStep('rStep5');
            }},
            
            // Navigate to results
            { time: 7000, action: () => {
                window.location.href = 'query-results.html';
            }}
        ];

        // Confidence animation
        let confidence = 0;
        const targetConfidence = 85;
        const confidenceInterval = setInterval(() => {
            confidence += 1;
            if (confidence > targetConfidence) {
                clearInterval(confidenceInterval);
                confidence = targetConfidence;
            }
            document.getElementById('confidenceValue').textContent = confidence + '%';
        }, 60);

        // Initialize and run
        window.addEventListener('load', () => {
            initConnections();
            
            // Run timeline
            timeline.forEach(item => {
                setTimeout(item.action, item.time);
            });
        });

        // Handle resize
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                // Clear existing paths
                const paths = svg.querySelectorAll('path');
                paths.forEach(p => p.remove());
                const lines = document.getElementById('meshGroup').querySelectorAll('line');
                lines.forEach(l => l.remove());
                
                // Reinitialize
                initConnections();
                
                // Show all paths that should be visible
                if (window.connectionPaths) {
                    window.connectionPaths.forEach(cp => {
                        cp.path.style.opacity = '1';
                    });
                }
                if (window.outputPaths) {
                    window.outputPaths.forEach(op => {
                        op.path.style.opacity = '1';
                    });
                }
            }, 100);
        });
    </script>
</body>
</html>
