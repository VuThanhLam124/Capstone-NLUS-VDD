ID,Transcription,SQL Ground Truth
1,Bạn hãy tìm tên những khách hàng có trình độ 'Advanced Degree' đã mua đồ 'Jewelry' qua kênh Web và cũng đã từng mua đồ 'Home' qua kênh Catalog,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_education_status = 'Advanced Degree'
INTERSECT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
JOIN item i1 ON ws.ws_item_sk = i1.i_item_sk WHERE i1.i_category = 'Jewelry'
INTERSECT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk
JOIN item i2 ON cs.cs_item_sk = i2.i_item_sk WHERE i2.i_category = 'Home';"
2,Tìm URL của những trang web page đã bán đồ 'Women' cho khách hàng có xếp hạng tín dụng 'Good' thông qua hệ thống Website có ngày hoạt động sớm nhất.,"SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Women' AND cd.cd_credit_rating = 'Good'
  AND web.web_rec_start_date = (SELECT MIN(web_rec_start_date) FROM web_site);"
3,Lấy thông tin định danh và họ tên khách hàng,"SELECT c_customer_id, c_first_name, c_last_name 
FROM customer;"
4,Tìm tất cả khách hàng đến từ Việt Nam,"SELECT * FROM customer 
WHERE c_birth_country = 'VN';"
5,Đếm tổng số lượng khách hàng trong bảng,"SELECT COUNT(*) AS total_customers 
FROM customer;"
6,Lọc danh sách khách hàng thân thiết,"SELECT c_first_name, c_last_name, c_email_address 
FROM customer 
WHERE c_preferred_cust_flag = 'Y';"
7,Lấy ra danh sách các khách hàng hiện tại không nằm trong nhóm đối tượng khách hàng ưu tiên của cửa hàng,"SELECT c_first_name, c_last_name, c_email_address 
FROM customer 
WHERE c_preferred_cust_flag = 'N';"
8,Đếm tổng tất cả khách hàng đến từ Mỹ,"SELECT COUNT(*) AS ""TOTAL CUSTOMER"" 
FROM customer 
WHERE c_birth_country = 'UNITED STATES';"
9,Sắp xếp khách hàng theo năm sinh giảm dần,"SELECT c_first_name, c_last_name, c_birth_year 
FROM customer 
ORDER BY c_birth_year DESC;"
10,Tìm các quốc gia khác nhau có trong dữ liệu,"SELECT DISTINCT c_birth_country 
FROM customer;"
11,Tìm các khách hàng đến từ Nhật Bản (JP),SELECT * FROM customer WHERE c_birth_country = 'JAPAN';
12,Có bao nhiêu khách hàng chưa cập nhật địa chỉ email?,SELECT COUNT(*) FROM customer WHERE c_email_address IS NULL;
13,Tìm những người sinh vào năm 2002,SELECT * FROM customer WHERE c_birth_year = 2002;
14,Cho tôi xem 10 khách hàng trẻ tuổi nhất ,SELECT TOP 10 * FROM customer ORDER BY c_birth_year DESC;
15,Những khách hàng nào có danh xưng là Tiến sĩ?,SELECT * FROM customer WHERE c_salutation = 'Dr.';
16,Liệt kê những khách hàng sinh ra ở Vương quốc Anh (UK),SELECT * FROM customer WHERE c_birth_country = 'UNITED KINGDOM';
17,Tìm các khách hàng sinh vào tháng 12,"SELECT c_first_name, c_last_name, c_birth_day 
FROM customer 
WHERE c_birth_month = 12;"
18,Thống kê số lượng khách hàng theo từng năm sinh,"SELECT c_birth_year, COUNT(*) 
FROM customer 
GROUP BY c_birth_year;"
19,Tìm khách hàng có tên bắt đầu bằng chữ 'M',"SELECT c_first_name, c_last_name 
FROM customer 
WHERE c_first_name LIKE 'M%';"
20,Liệt kê các khách hàng có danh xưng là 'Ms.',"SELECT * FROM customer 
WHERE c_salutation = 'Ms.';"
21,"Tôi cần tìm các khách hàng nam có danh xưng là Mr và hiện đang sinh sống hoặc có quốc tịch tại Canada, hãy liệt kê cho tôi đầy đủ thông tin của họ ",SELECT * FROM customer WHERE c_salutation = 'Mr.' AND c_birth_country = 'CA';
22,Bạn có thể giúp tôi lọc ra và hiển thị toàn bộ danh sách những khách hàng hiện tại đang có họ là Nguyen trong cơ sở dữ liệu được không?,SELECT * FROM customer WHERE c_first_name = 'Nguyen';
23,Tìm tất cả các khách hàng mà hiện nay thông tin tên đăng nhập đang bị để trống trong toàn bộ cơ sở dữ liệu,SELECT * FROM customer WHERE c_login IS NULL;
24,Liệt kê các khách hàng có danh xưng là tiến sĩ và đến từ Việt Nam ,SELECT * FROM customer WHERE c_salutation = 'Dr.' AND c_birth_country = 'VN';
25,Lấy địa chỉ email của những khách hàng nào đang có tên là Lan,SELECT c_email_address FROM customer WHERE c_last_name = 'Lan';
26,Truy vấn thông tin của những khách hàng có ngày sinh là ngày hai mươi hai ,SELECT * FROM customer WHERE c_birth_day = 22;
27,"Tìm tất cả những khách hàng mà tên của họ bắt đầu bằng chữ ""B""",SELECT * FROM customer WHERE c_first_name LIKE 'B%';
28,Thống kê xem có bao nhiêu khách hàng trong hệ thống của chúng ta sinh ra tại quốc gia Mỹ,SELECT COUNT(*) FROM customer WHERE c_birth_country = 'UNITED STATES';
29,Sắp xếp lại toàn bộ danh sách khách hàng trong hệ thống theo thứ tự của mã định danh khách hàng theo thứ tự tăng dần,SELECT * FROM customer ORDER BY c_customer_id;
30,Hiển thị chi tiết thông tin của người dùng hiện đang sử dụng tên đăng nhập là user15,SELECT * FROM customer WHERE c_login = 'user15';
31,Tìm tên các sản phẩm thuộc danh mục Fashion có giá bán hiện tại lớn hơn một trăm đô la trong bảng hàng hóa,"SELECT i_product_name, i_current_price 
FROM item 
WHERE i_category = 'Fashion' AND i_current_price > 100;"
32,Đếm xem có bao nhiêu sản phẩm thuộc danh mục Beauty mà tên thương hiệu của nó có chứa chữ Premium bên trong,SELECT COUNT(*) FROM item WHERE i_category = 'Beauty' AND i_brand LIKE '%Premium%';
33,Hiển thị tên khách hàng ở New York đã từng mua loại sản phẩm có tên bắt đầu bằng chữ Smart,"SELECT DISTINCT c_first_name, c_last_name 
FROM customer 
JOIN customer_address ON c_current_addr_sk = ca_address_sk 
JOIN store_sales ON c_customer_sk = ss_customer_sk 
JOIN item ON ss_item_sk = i_item_sk 
WHERE ca_city = 'New York' AND i_product_name LIKE 'Smart%';"
34,Liệt kê các khách hàng ưu tiên từ nước Anh đã mua hàng với số lượng sản phẩm trong một đơn lớn hơn năm,"SELECT DISTINCT c_first_name, c_last_name 
FROM customer 
JOIN store_sales ON c_customer_sk = ss_customer_sk 
WHERE c_birth_country = 'UK' AND c_preferred_cust_flag = 'Y' AND ss_quantity > 5;"
35,Liệt kê tất cả những khách hàng nào đã có trình độ học vấn là tiến sĩ PhD,"SELECT * FROM customer_demographics 
WHERE cd_education_status = 'PhD';"
36,Tìm thông tin những người hiện tại đang có tình trạng hôn nhân là độc thân,SELECT * FROM customer_demographics WHERE cd_marital_status = 'S';
37,Có bao nhiêu khách hàng đang phải nuôi từ ba người phụ thuộc trở lên trong gia đình,SELECT COUNT(*) FROM customer_demographics WHERE cd_dep_count >= 3;
38,Liệt kê danh sách những khách hàng đang ở trạng thái góa vợ hoặc góa chồng và đang phải nuôi dưỡng một người phụ thuộc duy nhất trong gia đình,"SELECT * FROM customer_demographics 
WHERE cd_marital_status = 'W' AND cd_dep_count = 1"
39,Lọc ra danh sách những khách hàng hiện tại vẫn còn đang độc thân và có trình độ cao đẳng,SELECT * FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College';
40,Liệt kê thông tin các khách hàng nữ có mức ước tính mua sắm đạt mức tám điểm và có xếp hạng tín dụng ở mức ưu tú,"SELECT * FROM customer_demographics 
WHERE cd_gender = 'F' AND cd_purchase_estimate = 8 AND cd_credit_rating = 'Elite'"
41,Lọc ra tất cả những khách hàng là nam giới và hiện tại đang có xếp hạng tín dụng ở mức thấp để bộ phận chăm sóc kiểm tra lại,"SELECT * FROM customer_demographics 
WHERE cd_gender = 'M' AND cd_credit_rating = 'Low';"
42,Liệt kê họ và tên của tất cả những khách hàng nào có trình độ học vấn là tiến sĩ PhD và sinh ra tại Việt Nam,"SELECT c_first_name, c_last_name FROM customer 
JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_education_status = 'PhD' AND c_birth_country = 'VN';"
43,Lọc ra những địa chỉ email của những khách hàng nữ hiện đang sinh sống tại Hoa Kỳ và có xếp hạng tín dụng ở mức ưu tú,"SELECT c_email_address FROM customer 
JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk 
WHERE cd_gender = 'F' AND c_birth_country = 'USA' 
AND cd_credit_rating = 'Elite';"
44,Đếm xem có bao nhiêu khách hàng nam hiện đang độc thân và đã từng mua hàng lần đầu vào năm 2002,SELECT COUNT(*) FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND c_birth_year = 2002;
45,Hiển thị thông tin tên đăng nhập của những khách hàng đã ly hôn và đang có từ ba người phụ thuộc trở lên trong gia đình.,SELECT c_login FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'D' AND cd_dep_count >= 3;
46,Lấy danh sách các khách hàng có trình độ thạc sĩ quản trị kinh doanh (MBA) và hiện đang là khách hàng ưu tiên của hệ thống,"SELECT c_first_name, c_last_name FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_education_status = 'MBA' AND c_preferred_cust_flag = 'Y';"
47,Tìm email của các khách hàng nam sinh ra tại nước Anh và có xếp hạng tín dụng đang ở mức thấp để gửi thông báo hỗ trợ,SELECT c_email_address FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_gender = 'M' AND c_birth_country = 'UK' AND cd_credit_rating = 'Low';
48,Liệt kê mã định danh của những khách hàng đã lập gia đình và có ít nhất hai người con hiện đang theo học  cao đẳng,SELECT c_customer_id FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'M' AND cd_dep_college_count >= 2;
49,Cho biết tên của những khách hàng góa vợ hoặc góa chồng sinh năm 1990 và có mức ước tính mua sắm là 6 điểm.,"SELECT c_first_name, c_last_name FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'W' AND c_birth_year = 1990 AND cd_purchase_estimate = 6"
50,Truy vấn danh sách những khách hàng có trình độ học vấn phổ thông đang sống tại Canada và có xếp hạng tín dụng ở mức tốt,SELECT * FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_education_status = 'School' AND c_birth_country = 'CA' AND cd_credit_rating = 'Good';
51,Hiển thị tên và email của các khách hàng nữ đã ly hôn và sinh vào tháng 8 năm 1999 tại nước Anh.,"SELECT c_first_name, c_last_name, c_email_address FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_gender = 'F' AND cd_marital_status = 'D' AND c_birth_month = 8 AND c_birth_year = 1999 AND c_birth_country = 'UK';"
52,Đếm xem có bao nhiêu khách hàng là nam (M),"SELECT COUNT(*) 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE cd.cd_gender = 'M';"
53,Hiển thị tên khách hàng và trình độ học vấn của họ.,"SELECT c.c_first_name, cd.cd_education_status 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk;"
54,Đếm tổng số khách hàng nữ có trình độ 'Advanced Degree'.,"SELECT COUNT(*) 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE cd.cd_gender = 'F' AND cd.cd_education_status = 'Advanced Degree';"
55,Tìm khách hàng nữ có tên bắt đầu bằng chữ 'M' kèm theo trình độ học vấn của họ.,"SELECT c.c_first_name, cd.cd_education_status 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE c.c_first_name LIKE 'M%' AND cd.cd_gender = 'F';"
56,Liệt kê khách hàng sống tại bang 'California' (CA),"SELECT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk 
WHERE ca.ca_state = 'CA';"
57,Tìm các khách hàng nữ sống tại bang 'NY' đã từng mua hàng.,"SELECT DISTINCT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE cd.cd_gender = 'F' AND ca.ca_state = 'NY';"
58,Liệt kê tên khách hàng và thu nhập bình quân của họ (Income Band).,"SELECT c.c_first_name, ib.ib_lower_bound, ib.ib_upper_bound 
FROM customer c 
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk 
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk;"
59,Tìm những khách hàng đã mua hàng và được giảm giá trên 100 đô la.,"SELECT DISTINCT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE ss.ss_ext_discount_amt > 100;"
60,Tính tổng số tiền mà khách hàng 'Billy Chen' đã chi tiêu.,"SELECT SUM(ss.ss_sales_price) 
FROM customer c 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE c.c_first_name = 'Billy' AND c.c_last_name = 'Chen';"
61,Liệt kê khách hàng có từ 2 xe ô tô trở lên (Vehicle count).,"SELECT c.c_first_name, hd.hd_vehicle_count 
FROM customer c 
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk 
WHERE hd.hd_vehicle_count > 2;"
62,Liệt kê những khách hàng đã chi tiêu tổng cộng hơn 5000 đô la tại các cửa hàng.,"SELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) as total_spent
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
HAVING total_spent > 5000;"
63,Tìm các khách hàng ở bang 'CA' đã mua hàng trong cả hai năm 2000 và 2001,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'CA'
AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2000)
AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2001);"
64,Tìm tên khách hàng đã trả lại hàng với tổng giá trị hoàn lại lớn nhất.,"SELECT c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_returned_value
FROM customer c
JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_returned_value DESC
LIMIT 1;"
65,Tìm khách hàng có thu nhập cao (trên 150.000) nhưng chỉ sở hữu tối đa 1 xe ô tô.,"SELECT c.c_first_name, c.c_last_name, ib.ib_upper_bound, hd.hd_vehicle_count
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_upper_bound > 150000 AND hd.hd_vehicle_count <= 1;"
66,Liệt kê những khách hàng chi tiêu trên Web nhiều hơn chi tiêu tại Cửa hàng,"SELECT c.c_first_name, 
       SUM(ws.ws_sales_price) as web_spend, 
       (SELECT SUM(ss_sales_price) FROM store_sales ss WHERE ss.ss_customer_sk = c.c_customer_sk) as store_spend
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name
HAVING web_spend > store_spend;"
67,"Tìm những khách hàng ""trung thành"" đã mua hàng ở cả 3 kênh: Cửa hàng, Web và Catalog","SELECT c.c_first_name, c.c_last_name
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss WHERE ss.ss_customer_sk = c.c_customer_sk)
  AND EXISTS (SELECT 1 FROM web_sales ws WHERE ws.ws_bill_customer_sk = c.c_customer_sk)
  AND EXISTS (SELECT 1 FROM catalog_sales cs WHERE cs.cs_bill_customer_sk = c.c_customer_sk);"
68,Tính tổng doanh thu từ kênh Catalog cho những khách hàng sống ở bang 'Texas' (TX),"SELECT SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX';"
69,Liệt kê những khách hàng đã mua cùng một mặt hàng hơn 3 lần trong năm 2002,"SELECT c.c_first_name, i.i_item_desc, COUNT(*) as purchase_count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, i.i_item_desc
HAVING purchase_count > 3;"
70,Ai là người trả hàng nhiều nhất vì lý do đồ bị hỏng (damaged)?,"SELECT c.c_first_name, COUNT(*) AS damaged_returns
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%damaged%'
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY damaged_returns DESC
LIMIT 1;"
71,"Tìm cho tôi mấy khách hàng nữ, độc thân, mà tiêu tiền trên web nhiều hơn ở cửa hàng.","SELECT c.c_first_name, 
       SUM(ws.ws_sales_price) AS total_web,
       (SELECT SUM(ss_sales_price) FROM store_sales ss WHERE ss.ss_customer_sk = c.c_customer_sk) AS total_store
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
WHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'S'
GROUP BY c.c_customer_sk, c.c_first_name
HAVING total_web > total_store;"
72,Những khách hàng nào sống ở cùng thành phố với kho hàng (Warehouse) mà họ mua đồ?,"SELECT DISTINCT c.c_first_name, ca.ca_city
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN warehouse w ON ss.ss_warehouse_sk = w.w_warehouse_sk
WHERE ca.ca_city = w.w_city;"
73,"Trong năm 2001, mấy bà khách nữ đã kết hôn thường hay mua loại hàng (category) gì nhất?","SELECT i.i_category, COUNT(*) AS total_bought
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'M' AND d.d_year = 2001
GROUP BY i.i_category
ORDER BY total_bought DESC LIMIT 1;"
74,Tính xem tỷ lệ khách hàng có dùng mã khuyến mãi (promotion) khi mua đồ điện tử là bao nhiêu?,"SELECT 
  (SELECT COUNT(*) FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics' AND ss.ss_promo_sk IS NOT NULL) * 100.0 / 
  (SELECT COUNT(*) FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics') AS promo_ratio;"
75,Lấy danh sách 5 khách hàng chi tiêu mạnh nhất nhưng lại chưa bao giờ mua hàng qua Catalog.,"SELECT c.c_first_name, SUM(ss.ss_sales_price) AS total_spent
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
WHERE c.c_customer_sk NOT IN (SELECT cs_bill_customer_sk FROM catalog_sales)
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY total_spent DESC LIMIT 5;"
76,Tính doanh thu từ mấy món đồ thuộc loại 'Jewelry' (Trang sức) bán cho khách hàng ở bang 'Texas'.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX';"
77,Mấy món đồ nào bị trả lại nhiều nhất vì lý do 'không giống mô tả' (not as described)?,"SELECT i.i_item_desc, COUNT(*) AS return_times
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%not as described%'
GROUP BY i.i_item_desc
ORDER BY return_times DESC;"
78,Thành phố nào có tổng lợi nhuận từ kênh Web cao hơn 1000 đô trong năm 2000?,"SELECT ca.ca_city, SUM(ws.ws_net_profit) AS web_profit
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY ca.ca_city
HAVING web_profit > 1000;"
79,"Trong quý 1 năm 2000, loại hàng (category) nào bán chạy nhất trên trang web?","SELECT i.i_category, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1
GROUP BY i.i_category
ORDER BY total_qty DESC
LIMIT 1;"
80,Lấy cho tôi 5 mặt hàng đắt nhất nhưng lại được khách hàng sinh trước năm 1960 hay mua.,"SELECT i.i_item_desc, i.i_current_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE c.c_birth_year < 1960
GROUP BY i.i_item_desc, i.i_current_price
ORDER BY i.i_current_price DESC
LIMIT 5;"
81,Cho tôi biết tên 5 khách hàng nữ chi tiêu 'mạnh tay' nhất cho đồ điện tử trong năm 2002,"SELECT c.c_first_name, SUM(ss.ss_sales_price) AS electronics_spend
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'F' 
  AND i.i_category = 'Electronics' 
  AND d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY electronics_spend DESC
LIMIT 5;"
82,Thử tìm giúp tôi mấy khách hàng nào hay mua sắm vào đúng cái tháng sinh nhật của họ,"SELECT DISTINCT c.c_first_name, c.c_last_name, c.c_birth_month
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE c.c_birth_month = d.d_moy;"
83,"""Mấy ông khách nào có trên 3 cái xe hơi thì thường hay chi tiền vào loại hàng (category) nào nhiều nhất?","SELECT i.i_category, COUNT(*) AS purchase_count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count > 3
GROUP BY i.i_category
ORDER BY purchase_count DESC;"
84,Liệt kê cho tôi mấy khách hàng nào mua hàng nhiều nhất vào các ngày Thứ Bảy.,"SELECT c.c_first_name, COUNT(*) AS saturday_purchases
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Saturday'
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY saturday_purchases DESC
LIMIT 10;"
85,Lọc ra mấy người mua đồ 'Jewelry' (Trang sức) mà có dùng mã giảm giá (promotion),"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry' AND ss.ss_promo_sk IS NOT NULL;"
86,Tìm xem có khách hàng nào đã mua cùng một món đồ ở cả hai kênh Store và Web không.,"SELECT DISTINCT c.c_first_name, i.i_item_desc
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE EXISTS (
    SELECT 1 FROM web_sales ws 
    WHERE ws.ws_bill_customer_sk = c.c_customer_sk 
    AND ws.ws_item_sk = i.i_item_sk
);"
87,Tính tổng tiền thuế (sales tax) thu được từ nhóm khách hàng có thu nhập dưới 50.000.,"SELECT SUM(ss.ss_ext_tax)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_upper_bound < 50000;"
88,Lấy danh sách 5 mặt hàng được khách hàng nam mua nhiều nhất trên Web vào quý 1.,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'M' AND d.d_qoy = 1
GROUP BY i.i_item_desc
ORDER BY total_qty DESC LIMIT 5;"
89,Có khách hàng nào mua đồ ở cả Cửa hàng và Catalog nhưng lại chưa từng chạm vào Web không?,"SELECT c.c_first_name, c.c_last_name
FROM customer c
WHERE c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales)
  AND c.c_customer_sk IN (SELECT cs_bill_customer_sk FROM catalog_sales)
  AND c.c_customer_sk NOT IN (SELECT ws_bill_customer_sk FROM web_sales);"
90,Mấy món đồ nào bị trả lại nhiều nhất vì khách hàng 'không ưng ý' (did not like) trong tháng 12?,"SELECT i.i_item_desc, COUNT(*) AS count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc ILIKE '%did not like%' AND d.d_moy = 12
GROUP BY i.i_item_desc
ORDER BY count DESC;"
91,"Tìm 5 khách hàng có giá trị đơn hàng trung bình (Average Order Value) cao nhất, tính trên cả hai kênh Store và Web","SELECT c.c_first_name, c.c_last_name, AVG(all_sales.sales_price) AS avg_order_value
FROM customer c
JOIN (
    SELECT ss_customer_sk AS customer_sk, ss_sales_price AS sales_price FROM store_sales
    UNION ALL
    SELECT ws_bill_customer_sk AS customer_sk, ws_sales_price AS sales_price FROM web_sales
) all_sales ON c.c_customer_sk = all_sales.customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY avg_order_value DESC
LIMIT 5;"
92,"Liệt kê các khách hàng đã mua hàng liên tiếp trong cả 3 năm 2000, 2001 và 2002 tại kênh Store.","SELECT c.c_first_name, c.c_last_name
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
  AND EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
  AND EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
93,Tìm danh mục sản phẩm (Category) có tỷ lệ trả hàng (Return Rate) cao nhất so với số lượng bán ra trong quý 1 năm 2002,"SELECT i.i_category, 
       SUM(sr.sr_return_quantity) * 100.0 / SUM(ss.ss_quantity) AS return_rate
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1
GROUP BY i.i_category
ORDER BY return_rate DESC;"
94,So sánh sự thay đổi về doanh thu của loại hàng 'Electronics' giữa tháng 11 và tháng 12 năm 2001,"SELECT d.d_moy, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2001 AND d.d_moy IN (11, 12)
GROUP BY d.d_moy
ORDER BY d.d_moy;"
95,Tính tổng lợi nhuận từ những khách hàng mua hàng tại các cửa hàng (Store) nằm ngoài bang nơi họ đang cư trú,"SELECT SUM(ss.ss_net_profit) AS out_of_state_profit
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE ca.ca_state <> s.s_state;"
96,Liệt kê 5 mặt hàng có doanh số bán ra cao nhất trong các ngày lễ (Holiday = 'Y') của năm 2001.,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS holiday_sales
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY holiday_sales DESC
LIMIT 5;"
97,Tìm các khách hàng đã mua đồng thời các mặt hàng từ hai danh mục 'Men' và 'Women' trong cùng một đơn hàng (Ticket number).,"SELECT ss.ss_ticket_number, c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category IN ('Men', 'Women')
GROUP BY ss.ss_ticket_number, c.c_first_name, c.c_last_name
HAVING COUNT(DISTINCT i.i_category) = 2;"
98,"Thống kê xem khách hàng nam và nữ, nhóm nào hay đi mua sắm ở cửa hàng hơn vào ngày Thứ Hai?","SELECT cd.cd_gender, COUNT(*) AS visit_count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Monday'
GROUP BY cd.cd_gender;"
99,Có bao nhiêu khách hàng độc thân đã từng mua hàng qua kênh Catalog trong năm 2002?,"SELECT COUNT(DISTINCT c.c_customer_sk)
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE cd.cd_marital_status = 'S' AND d.d_year = 2002;"
100,Cho tôi biết 3 loại hàng hóa (category) được khách hàng có trình độ học vấn 'Secondary' mua nhiều nhất.,"SELECT i.i_category, COUNT(*) AS total_count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_education_status = 'Secondary'
GROUP BY i.i_category
ORDER BY total_count DESC LIMIT 3;"
101,Tìm những khách hàng sinh trước năm 1970 sống tại bang New York đã từng mua hàng ở cửa hàng,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
WHERE c.c_birth_year < 1970 AND ca.ca_state = 'NY';"
102,Tìm 5 mặt hàng thuộc loại 'Sports' (Thể thao) có doanh thu cao nhất trên trang web,"SELECT i.i_item_desc, SUM(ws.ws_sales_price) AS revenue
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY revenue DESC LIMIT 5;"
103,Thống kê doanh thu bán hàng qua Web theo từng tháng của năm 2000,"SELECT d.d_moy, SUM(ws.ws_sales_price) AS monthly_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d_moy;"
104,Cho tôi biết tên cửa hàng có doanh thu cao nhất trong tháng 12 năm 2000,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12
GROUP BY s.s_store_name
ORDER BY revenue DESC LIMIT 1;"
105,Có bao nhiêu giao dịch tại cửa hàng đã sử dụng mã khuyến mãi 'Summer Special'?,"SELECT COUNT(*) 
FROM store_sales ss
JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk
WHERE p.p_promo_name = 'Summer Special';"
106,Liệt kê 5 mặt hàng có giá niêm yết (current price) cao nhất thuộc danh mục 'Books' (Sách).,"SELECT i_item_desc, i_current_price
FROM item
WHERE i_category = 'Books'
ORDER BY i_current_price DESC LIMIT 5;"
107,Tìm các mặt hàng loại 'Home' (Gia đình) mà chưa từng bị khách hàng trả lại bao giờ.,"SELECT i_item_desc
FROM item i
WHERE i_category = 'Home'
  AND i_item_sk NOT IN (SELECT sr_item_sk FROM store_returns);"
108,Tính tổng doanh thu từ các mặt hàng được bán vào các ngày lễ (Holiday) trong năm 2001.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y' AND d.d_year = 2001;"
109,Liệt kê tên những khách hàng có từ 2 xe hơi trở lên và đã từng trả hàng tại cửa hàng.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk
WHERE hd.hd_vehicle_count >= 2;"
110,Tìm khách hàng sống ở bang Texas (TX) mà có gia đình đông người (trên 4 người phụ thuộc).,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE ca.ca_state = 'TX' AND hd.hd_dep_count > 4;"
111,Lấy tên khách hàng đã thực hiện giao dịch có giá trị lớn nhất trên hệ thống Catalog,"SELECT c.c_first_name, c.c_last_name, cs.cs_sales_price
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
ORDER BY cs.cs_sales_price DESC LIMIT 1;"
112,Tìm những khách hàng mua đồ qua Web mà có địa chỉ nhận hàng khác hoàn toàn với địa chỉ thanh toán.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
WHERE ws.ws_bill_addr_sk <> ws.ws_ship_addr_sk;"
113,Liệt kê 5 thành phố có số lượng khách hàng nữ sinh sống đông nhất.,"SELECT ca.ca_city, COUNT(*) AS female_count
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F'
GROUP BY ca.ca_city
ORDER BY female_count DESC LIMIT 5;"
114,Cho tôi biết tên những khách hàng đã chọn phương thức vận chuyển bằng đường hàng không (AIR) cho đơn hàng Web,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE sm.sm_type = 'AIR';"
115,Thống kê xem kho hàng (Warehouse) nào đang xử lý nhiều đơn hàng nhất cho kênh Catalog.,"SELECT w.w_warehouse_name, COUNT(*) AS order_count
FROM catalog_sales cs
JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk
GROUP BY w.w_warehouse_name
ORDER BY order_count DESC;"
116,"Trong loại hàng 'Electronics' (Điện tử), món đồ nào có giá niêm yết cao nhất hiện nay?","SELECT i_item_desc, i_current_price
FROM item
WHERE i_category = 'Electronics'
ORDER BY i_current_price DESC
LIMIT 1;"
117,Tính tổng doanh thu từ nhóm hàng 'dresses' (váy) bán cho khách hàng ở bang New York (NY).,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
WHERE i.i_class = 'dresses' AND ca.ca_state = 'NY';"
118,Tìm 5 mặt hàng thuộc nhóm 'Books' (Sách) mà khách hàng nam thường hay mua nhất.,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Books' AND cd.cd_gender = 'M'
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;"
119,So sánh doanh thu bán hàng tại cửa hàng giữa ca sáng (8h-12h) và ca chiều (13h-18h).,"SELECT 
  CASE WHEN t.t_hour BETWEEN 8 AND 12 THEN 'Morning'
       WHEN t.t_hour BETWEEN 13 AND 18 THEN 'Afternoon'
       ELSE 'Other' END AS shift,
  SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
GROUP BY shift;"
120,Những khách hàng nào đã mua sắm liên tục vào các ngày cuối tuần trong tháng 12 năm 2000?,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12 AND d.d_day_name IN ('Saturday', 'Sunday');"
121,Lấy tên 3 khách hàng trả lại hàng nhiều nhất vì lý do 'đồ quá to' (too big).,"SELECT c.c_first_name, COUNT(*) AS return_count
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%too big%'
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY return_count DESC
LIMIT 3;"
122,Tìm khách hàng sinh năm 1990 trở đi mà chưa từng thực hiện bất kỳ giao dịch trả hàng nào,"SELECT c_first_name, c_last_name
FROM customer
WHERE c_birth_year >= 1990
   AND c_customer_sk NOT IN (SELECT sr_customer_sk FROM store_returns)
   AND c_customer_sk NOT IN (SELECT wr_refunded_customer_sk FROM web_returns);"
123,Thống kê cho tôi xem danh sách khách hàng nam hay nữ hay đi mua sắm  vào ngày Thứ Bảy trong tuần?,"SELECT cd.cd_gender, COUNT(*) AS visit_count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Saturday'
GROUP BY cd.cd_gender;"
124,Tìm mấy ông khách hàng sinh năm 1980 sống ở bang California (CA) mà có trên 2 xe ô tô.,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE c.c_birth_year = 1980 AND ca.ca_state = 'CA' AND hd.hd_vehicle_count > 2;"
125,Cho tôi biết 3 loại hàng (category) nào mang lại doanh thu cao nhất trên kênh Catalog.,"SELECT i.i_category, SUM(cs.cs_sales_price) AS total_revenue
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
GROUP BY i.i_category
ORDER BY total_revenue DESC LIMIT 3;"
126,Mấy món đồ điện tử (Electronics) có giá trên 150 đô thường được mua nhiều nhất vào tháng mấy?,"SELECT d.d_moy, COUNT(*) AS sales_count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND i.i_current_price > 150
GROUP BY d.d_moy
ORDER BY sales_count DESC LIMIT 1;"
127,Tìm 5 mặt hàng thuộc nhóm 'Sports' bị khách hàng trả lại nhiều nhất ở cửa hàng.,"SELECT i.i_item_desc, COUNT(*) AS return_count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC LIMIT 5;"
128,"Trong quý 1 năm 2000, có bao nhiêu khách hàng đã dùng mã giảm giá để mua đồ trên Web?","SELECT COUNT(DISTINCT ws_bill_customer_sk)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1 AND ws_promo_sk IS NOT NULL;"
129,Hãy thống kê xem các trang Catalog có mô tả chi tiết thường mang lại doanh số cao hơn bao nhiêu so với các trang thông thường,"SELECT cp.cp_description, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
GROUP BY cp.cp_description;"
130,Tôi muốn xem doanh thu theo từng khung giờ trong ngày tại cửa hàng 'Northwest',"SELECT t.t_hour, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE s.s_store_name = 'Northwest'
GROUP BY t.t_hour
ORDER BY t_hour;"
131,Tìm thành phố có nhiều khách hàng 'VIP' nhất (thu nhập mức cao nhất),"SELECT ca.ca_city, COUNT(*) AS vip_count
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE hd.hd_income_band_sk = (SELECT MAX(ib_income_band_sk) FROM income_band)
GROUP BY ca.ca_city
ORDER BY vip_count DESC LIMIT 1;"
132,Tìm cho tôi 5 kho hàng có diện tích (floor space) lớn nhất và liệt kê tổng lượng hàng họ đang giữ.,"SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, SUM(inv.inv_quantity_on_hand) AS total_inv
FROM warehouse w
JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk
GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft
ORDER BY w.w_warehouse_sq_ft DESC
LIMIT 5;"
133,Thống kê doanh thu bán hàng qua Catalog theo từng trung tâm hỗ trợ (Call Center) trong năm 2002.,"SELECT cc.cc_name, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name;"
134,Lý do phổ biến nhất mà khách hàng đưa ra khi trả lại hàng mua từ Web là gì?,"
SELECT r.r_reason_desc, COUNT(*) AS count
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
GROUP BY r.r_reason_desc
ORDER BY count DESC
LIMIT 1;"
135,Liệt kê 5 cửa hàng có số lượng nhân viên đông nhất và tổng doanh thu của họ trong quý 1.,"SELECT s.s_store_name, s.s_number_employees, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_qoy = 1
GROUP BY s.s_store_name, s.s_number_employees
ORDER BY s.s_number_employees DESC
LIMIT 5;"
136,Có cửa hàng nào diện tích dưới 2 triệu feet vuông mà doanh thu lại cao hơn 1 triệu đô không?,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE s.s_floor_space < 2000000
GROUP BY s.s_store_name
HAVING revenue > 1000000;"
137,Tìm những khách hàng sinh năm 1995 đã trả hàng ở cửa hàng với lý do 'hàng bị hỏng' (damaged).,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE c.c_birth_year = 1995 AND r.r_reason_desc ILIKE '%damaged%';"
138,"Trong năm 2001, thương hiệu (brand) nào của mặt hàng 'Men' bán chạy nhất tại cửa hàng?","SELECT i.i_brand, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2001
GROUP BY i.i_brand
ORDER BY total_sold DESC
LIMIT 1;"
139,Tìm tên các nhà sản xuất (manufacturer) có sản phẩm bị khách hàng trả lại nhiều hơn 100 lần trên Web.,"SELECT i.i_manufact, COUNT(*) AS return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
GROUP BY i.i_manufact
HAVING return_count > 100;"
140,Những khách hàng có tiềm năng mua sắm 'Thấp' (Buy potential = 'Low') thường hay mua loại mặt hàng gì?,"SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE hd.hd_buy_potential = '0-500' -- Giả định giá trị Buy potential thấp
GROUP BY i.i_category
ORDER BY count DESC;"
141,Có khách hàng nào mua hàng qua Web với phương thức 'AIR' nhưng lại trả hàng bằng đường 'GROUND' không?,"SELECT DISTINCT c.c_first_name
FROM web_sales ws
JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number
JOIN ship_mode sm1 ON ws.ws_ship_mode_sk = sm1.sm_ship_mode_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
WHERE sm1.sm_type = 'AIR';"
142,Những mặt hàng nào thuộc danh mục 'Music' có lượng tồn kho dưới mức trung bình của cả kho?,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music' 
  AND inv.inv_quantity_on_hand < (SELECT AVG(inv_quantity_on_hand) FROM inventory);"
143,Tính tổng chi phí vận chuyển (ws_ext_ship_cost) cho các sản phẩm thuộc danh mục 'Jewelry' (Trang sức) gửi đến bang 'TX',"SELECT SUM(ws.ws_ext_ship_cost)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX';"
144,"Trong quý 2 năm 2001, loại hàng nào mang lại lợi nhuận thực tế (ss_net_profit) dương cao nhất?","SELECT i.i_category, SUM(ss.ss_net_profit) AS total_profit
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2
GROUP BY i.i_category
ORDER BY total_profit DESC LIMIT 1;"
145,Cho tôi biết doanh thu của thương hiệu 'Men' bán tại cửa hàng vào những ngày không phải ngày lễ (Holiday = 'N'),"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_holiday = 'N';"
146,Màu sắc nào của sản phẩm loại 'Sports' được khách hàng ở độ tuổi sinh từ 1990 trở đi ưa chuộng nhất?,"SELECT i.i_color, COUNT(*) AS count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports' AND c.c_birth_year >= 1990
GROUP BY i.i_color
ORDER BY count DESC LIMIT 1;"
147,Tính tổng doanh thu bán đồ điện tử cho nhóm khách hàng có xếp hạng tín dụng 'Good'.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Electronics' AND cd.cd_credit_rating = 'Good';"
148,Tôi muốn biết đơn vị đo lường (units) nào của sản phẩm là phổ biến nhất,"SELECT i_units, COUNT(*) AS count
FROM item
GROUP BY i_units
ORDER BY count DESC;"
149,Cho tôi biết mấy ông khách đã lập gia đình (Married) thì hay trả lại hàng ở cửa hàng với lý do gì nhất?,"SELECT r.r_reason_desc, COUNT(*) AS count
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE cd.cd_marital_status = 'M'
GROUP BY r.r_reason_desc
ORDER BY count DESC LIMIT 1;"
150,Mấy người ở bang Texas (TX) mà có từ 3 xe hơi trở lên thường mua loại hàng điện tử (Electronics) nào?,"SELECT i.i_item_desc, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX' AND hd.hd_vehicle_count >= 3 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc;"
151,Thống kê xem có bao nhiêu bà nội trợ (nữ) đi mua đồ nam (category = 'Men') tại hệ thống cửa hàng.,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_gender = 'F' AND i.i_category = 'Men';"
152,Tìm xem 3 phương thức vận chuyển (ship mode) nào được dùng nhiều nhất cho mấy món đồ đắt tiền trên Web (giá trên 200).,"SELECT sm.sm_type, COUNT(*) AS usage_count
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_current_price > 200
GROUP BY sm.sm_type
ORDER BY usage_count DESC LIMIT 3;"
153,Cho tôi biết lượng hàng tồn kho của các mặt hàng 'Electronics' tại kho hàng ở thành phố 'San Jose' vào ngày 2001-01-01,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND w.w_city = 'San Jose' AND d.d_date = '2001-01-01';"
154,Thống kê tổng lợi nhuận và tiền thuế (cs_ext_tax) thu được từ kênh Catalog theo từng năm,"SELECT d.d_year, SUM(cs.cs_net_profit) AS profit, SUM(cs.cs_ext_tax) AS tax
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
GROUP BY d.d_year;"
155,Liệt kê 5 cửa hàng có ít nhân viên (dưới 100 người) nhưng doanh thu năm 2001 lại đứng top đầu.,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_number_employees < 100 AND d.d_year = 2001
GROUP BY s.s_store_name
ORDER BY revenue DESC LIMIT 5;"
156,Tính xem tổng doanh thu bán hàng trên Web vào khung giờ khuya (từ 11h đêm đến 2h sáng) là bao nhiêu,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour IN (23, 0, 1, 2);"
157,Tính tổng doanh thu từ các cửa hàng siêu lớn (diện tích trên 5 triệu feet vuông) trong quý 4.,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_floor_space > 5000000 AND d.d_qoy = 4
GROUP BY s.s_store_name;"
158,Những người lớn tuổi (sinh trước năm 1950) thường hay mua loại sách (category = 'Books') nào nhất?,"SELECT i.i_class, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE c.c_birth_year < 1950 AND i.i_category = 'Books'
GROUP BY i.i_class
ORDER BY count DESC LIMIT 1;"
159,Tìm 5 món đồ đắt nhất được bán qua kênh Catalog trong năm 2002.,"SELECT DISTINCT i.i_item_desc, i.i_current_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
ORDER BY i.i_current_price DESC LIMIT 5;"
160,Lọc ra mấy khách hàng chỉ đi mua trang sức (Jewelry) vào đúng hai ngày Thứ Bảy và Chủ Nhật.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_day_name IN ('Saturday', 'Sunday');"
161,Thành phố nào có lượng hàng trả lại qua Web nhiều hơn là trả trực tiếp tại cửa hàng?,"SELECT ca.ca_city
FROM customer_address ca
WHERE (SELECT COUNT(*) FROM web_returns wr WHERE wr.wr_refunded_addr_sk = ca.ca_address_sk) > 
      (SELECT COUNT(*) FROM store_returns sr WHERE sr.sr_addr_sk = ca.ca_address_sk)
LIMIT 10;"
162,Trung tâm hỗ trợ (Call Center) nào ở thành phố 'New York' mang về nhiều doanh thu Catalog nhất?,"SELECT cc.cc_name, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
WHERE cc.cc_city = 'New York'
GROUP BY cc.cc_name
ORDER BY revenue DESC LIMIT 1;"
163,Tìm những người hay mua hàng trên mạng vào ngày lễ nhưng chưa bao giờ bước chân vào cửa hàng.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y'
  AND c.c_customer_sk NOT IN (SELECT ss_customer_sk FROM store_sales);"
164,Trang web (Web page) nào đang mang lại doanh thu cao nhất cho hệ thống trong năm 2002?,"SELECT wp.wp_url, SUM(ws.ws_sales_price) AS revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_url
ORDER BY revenue DESC LIMIT 1;"
165,Tìm các sản phẩm có lượng tồn kho dưới 10 đơn vị trong quý 1 năm 2002.,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1 AND inv.inv_quantity_on_hand < 10;"
166,Trung tâm hỗ trợ (Call Center) nào ở bang 'NY' đã xử lý doanh thu cao nhất cho kênh Catalog?,"SELECT cc.cc_name, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
WHERE cc.cc_state = 'NY'
GROUP BY cc.cc_name
ORDER BY revenue DESC LIMIT 1;"
167,Liệt kê 5 Website đang hoạt động (không có ngày kết thúc web_rec_end_date) và ngày bắt đầu của chúng.,"SELECT web_name, web_rec_start_date
FROM web_site
WHERE web_rec_end_date IS NULL
LIMIT 5;"
168,Có bao nhiêu mặt hàng 'Electronics' được bán qua các trang web tự động tạo (wp_autogen_flag = 'Y'),"SELECT COUNT(*)
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics' AND wp.wp_autogen_flag = 'Y';"
169,Tính trung bình số lượng sản phẩm mỗi đơn hàng trên các trang web có URL chứa từ 'sales',"SELECT AVG(ws_quantity)
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
WHERE wp.wp_url LIKE '%sales%';"
170,Tính tổng doanh thu Web thu được từ khách hàng nhận hàng tại bang 'California' (CA).,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'CA';"
171,Phương thức vận chuyển nào mang lại lợi nhuận Web cao nhất cho các đơn hàng gửi đến 'Texas'?,"SELECT sm.sm_type, SUM(ws.ws_net_profit) AS total_profit
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
GROUP BY sm.sm_type
ORDER BY total_profit DESC LIMIT 1;"
172,Liệt kê 5 thành phố có chi phí vận chuyển qua Web (ws_ext_ship_cost) cao nhất trong năm 2002.,"SELECT ca.ca_city, SUM(ws.ws_ext_ship_cost) AS total_ship_cost
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY ca.ca_city
ORDER BY total_ship_cost DESC LIMIT 5;"
173,Website nào có tỷ lệ thuế (web_tax_percentage) cao nhất trong hệ thống?,"SELECT web_name, web_tax_percentage
FROM web_site
ORDER BY web_tax_percentage DESC LIMIT 1;"
174,Khách hàng nào đã mua hàng trên Web vào khung giờ từ 2 giờ đến 4 giờ sáng?,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour BETWEEN 2 AND 4;"
175,Tìm 3 trang Web page có lượng sản phẩm khác nhau (distinct items) được bán ra nhiều nhất.,"SELECT wp.wp_url, COUNT(DISTINCT ws.ws_item_sk) AS item_variety
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
GROUP BY wp.wp_url
ORDER BY item_variety DESC LIMIT 3;"
176,Thống kê cho tôi xem những hộ gia đình có từ 4 xe hơi trở lên thì thường mua loại hàng (category) nào nhiều nhất?,"SELECT i.i_category, COUNT(*) AS purchase_count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE hd.hd_vehicle_count >= 4
GROUP BY i.i_category
ORDER BY purchase_count DESC;"
177,Tính doanh thu trung bình từ những khách hàng chỉ sở hữu duy nhất 1 chiếc xe ô tô.,"SELECT AVG(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 1;"
178,Những gia đình có trên 5 người phụ thuộc (Dependents) thường hay trả lại hàng với lý do gì?,"SELECT r.r_reason_desc, COUNT(*) AS count
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE hd.hd_dep_count > 5
GROUP BY r.r_reason_desc
ORDER BY count DESC;"
179,Tính tổng tiền thuế (ss_ext_tax) thu được từ các hộ gia đình không có người phụ thuộc nào.,"SELECT SUM(ss.ss_ext_tax)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_dep_count = 0;"
180,Thống kê doanh thu Catalog theo từng nhóm khả năng chi tiêu trong năm 2002.,"SELECT hd.hd_buy_potential, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY hd.hd_buy_potential;"
181,Tìm những hộ gia đình có thu nhập mức thấp nhất nhưng lại sở hữu từ 2 xe hơi trở lên,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_income_band_sk = (SELECT MIN(ib_income_band_sk) FROM income_band)
  AND hd.hd_vehicle_count >= 2;"
182,"Trong các ngày lễ, nhóm gia đình có thu nhập trung bình thường mua loại hàng gì nhất?","SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE d.d_holiday = 'Y' AND hd.hd_income_band_sk BETWEEN 8 AND 12
GROUP BY i.i_category
ORDER BY count DESC LIMIT 1;"
183,Có bao nhiêu khách hàng sinh năm 1990 mà gia đình có đúng 2 xe hơi và 2 người phụ thuộc?,"SELECT COUNT(*)
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE c.c_birth_year = 1990 AND hd.hd_vehicle_count = 2 AND hd.hd_dep_count = 2;"
184,Bạn hãy thống kê giúp tôi lượng hàng tồn kho của danh mục đồ điện tử tại kho hàng ở thành phố San Jose vào ngày đầu năm 2001,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' 
  AND w.w_city = 'San Jose' 
  AND d.d_date = '2001-01-01';"
185,Hãy liệt kê 5 kho hàng có diện tích mặt sàn lớn nhất và tính tổng số lượng sản phẩm hiện có trong các kho này.,"SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, SUM(inv.inv_quantity_on_hand) AS total_inventory
FROM warehouse w
JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk
GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft
ORDER BY w.w_warehouse_sq_ft DESC
LIMIT 5;"
186,Bạn hãy xác định xem trung tâm hỗ trợ nào có chi phí vận hành bao gồm thuế và phí vận chuyển cao nhất cho các đơn hàng Catalog.,"SELECT cc.cc_name, SUM(cs.cs_ext_tax + cs.cs_ext_ship_cost) AS total_operating_cost
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
GROUP BY cc.cc_name
ORDER BY total_operating_cost DESC
LIMIT 1;"
187,Liệt kê danh sách các trang Catalog có chứa nhiều hơn 50 sản phẩm khác nhau và sắp xếp theo số lượng giảm dần.,"SELECT cp.cp_catalog_page_number, COUNT(DISTINCT cs_item_sk) AS item_count
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
GROUP BY cp.cp_catalog_page_number
ORDER BY item_count DESC;"
188,Xác định phương thức vận chuyển nào thường được sử dụng nhiều nhất cho các đơn hàng từ Web gửi đến khách hàng ở bang Texas,"SELECT sm.sm_type, COUNT(*) AS usage_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
GROUP BY sm.sm_type
ORDER BY usage_count DESC LIMIT 1;"
189,Hãy cho tôi biết lý do hàng đầu khiến khách hàng trả lại sản phẩm mua từ Web là gì và số lượng tương ứng là bao nhiêu,"SELECT r.r_reason_desc, COUNT(*) AS return_count
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
GROUP BY r.r_reason_desc
ORDER BY return_count DESC LIMIT 1;"
190,Thống kê doanh thu từ các chương trình khuyến mãi được quảng bá qua kênh sự kiện trực tiếp trong năm 2000,"SELECT p.p_promo_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE p.p_channel_event = 'Y' AND d.d_year = 2000
GROUP BY p.p_promo_name;"
191,Bạn hãy tính tổng doanh thu bán đồ điện tử trong khoảng thời gian từ 18 giờ đến 21 giờ tối hàng ngày.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE i.i_category = 'Electronics' AND t.t_hour BETWEEN 18 AND 21;"
192,Tìm các cửa hàng ở bang California có giờ mở cửa vào lúc 8 giờ sáng và liệt kê tên quản lý của họ.,"SELECT s_store_name, s_manager
FROM store
WHERE s_state = 'CA' AND s_hours ILIKE '%8AM%';"
193,Tính giúp tôi tổng số lượng hàng tồn kho của các sản phẩm có màu sắc là xanh dương và thuộc sản phẩm váy,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_color = 'blue' AND i.i_class = 'dresses';"
194,Bạn hãy thống kê giúp tôi tổng doanh thu từ các khách hàng nữ có trình độ học vấn là Cao Đẳng và hiện đang có xếp hạng  tín dụng ở mức Tốt,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F' 
  AND cd.cd_education_status = 'College' 
  AND cd.cd_credit_rating = 'Good';"
195,Hãy cho tôi biết những khách hàng đã lập gia đình và có ước tính mức mua sắm trên năm ngàn đô la thường ưa chuộng danh mục hàng hóa nào nhất,"SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND cd.cd_purchase_estimate > 5000
GROUP BY i.i_category
ORDER BY count DESC LIMIT 1;"
196,Xác định giúp tôi xem có bao nhiêu khách hàng có số lượng người phụ thuộc đang đi làm lớn hơn hai và đã từng mua hàng tại hệ thống cửa hàng.,"SELECT COUNT(DISTINCT ss_customer_sk)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_dep_employed_count > 2;"
197,Liệt kê danh sách năm khách hàng có xếp hạng tín dụng thấp nhất nhưng lại thực hiện nhiều giao dịch trả hàng nhất tại các trung tâm hỗ trợ trực tuyến.,"SELECT c.c_first_name, c.c_last_name, COUNT(wr.wr_item_sk) AS return_count
FROM web_returns wr
JOIN customer c ON wr.wr_refunded_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_credit_rating = 'Low Risk'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY return_count DESC LIMIT 5;"
198,Bạn hãy kiểm tra giúp tôi xem trang Catalog số một có chứa bao nhiêu mặt hàng thuộc danh mục sách và tổng giá trị của những mặt hàng đó là bao nhiêu,"SELECT COUNT(cs.cs_item_sk), SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cp.cp_catalog_page_number = 1 AND i.i_category = 'Books';"
199,Bạn hãy xác định xem nhà sản xuất nào có nhiều sản phẩm được liệt kê trên các trang Catalog nhất và tổng số lượng đơn hàng tương ứng của họ là bao nhiêu.,"SELECT i.i_manufact, COUNT(cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
GROUP BY i.i_manufact
ORDER BY COUNT(DISTINCT i.i_item_sk) DESC LIMIT 1;"
200,Hãy thống kê giúp tôi số lượng đơn hàng Web bị trả lại với lý do là sản phẩm không giống như hình ảnh hiển thị trên trang web trực tuyến của công ty,"SELECT COUNT(*)
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%wrong image%';"
201,Bạn hãy tính tổng số tiền mặt đã hoàn trả cho khách hàng khi họ thực hiện trả hàng tại các cửa hàng vật lý trong suốt tháng mười hai năm 2002,"SELECT SUM(sr.sr_refunded_cash)
FROM store_returns sr
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 12;"
202,Bạn hãy liệt kê năm mặt hàng có tần suất bị trả lại cao nhất tại các kho hàng nằm ở khu vực miền Tây do gặp sự cố hư hỏng trong lúc vận chuyển,"SELECT i.i_item_desc, COUNT(*) AS return_count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN warehouse w ON sr.sr_store_sk = w.w_warehouse_sk -- Giả định liên kết qua store_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%damaged%'
GROUP BY i.i_item_desc
ORDER BY return_count DESC LIMIT 5;"
203,"Bạn hãy tìm tên của những khách hàng vừa có giao dịch mua hàng tại cửa hàng, vừa thực hiện trả hàng thông qua kênh trực tuyến Web trong cùng một quý.","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk
JOIN date_dim d1 ON ss.ss_sold_date_sk = d1.d_date_sk
JOIN date_dim d2 ON wr.wr_returned_date_sk = d2.d_date_sk
WHERE d1.d_year = d2.d_year AND d1.d_qoy = d2.d_qoy;"
204,Bạn hãy liệt kê danh sách mười khách hàng chi tiêu mạnh tay nhất cho các mặt hàng thời trang nữ thông qua kênh Web trong suốt giai đoạn năm 2001,"SELECT c.c_first_name, SUM(ws.ws_sales_price) AS total_spend
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY total_spend DESC LIMIT 10;"
205,Bạn hãy tính giúp tôi mức lợi nhuận ròng trung bình cho mỗi mặt hàng được bán tại cửa hàng cho các khách hàng đã lập gia đình và hiện đang cư trú tại bang California,"SELECT AVG(ss.ss_net_profit)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE cd.cd_marital_status = 'M' AND ca.ca_state = 'CA';"
206,Tính  giúp tôi tổng số tiền thuế mà các khách hàng có trình độ học vấn cao đã chi trả cho việc mua sắm trên mạng vào những ngày cuối tuần.,"SELECT SUM(ws.ws_ext_tax)
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_weekend = 'Y';"
207,"Hãy liệt kê cho tôi năm thương hiệu sản phẩm có tổng doanh thu cao nhất vào khung giờ buổi sáng, cụ thể là từ tám giờ sáng đến mười hai giờ trưa tại hệ thống cửa hàng","SELECT i.i_brand, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE t.t_hour BETWEEN 8 AND 12
GROUP BY i.i_brand
ORDER BY revenue DESC LIMIT 5;"
208,Thống kê tổng doanh thu bán lẻ từ những hộ gia đình không sở hữu xe ô tô nào nhưng lại có từ hai người phụ thuộc trở lên trong hồ sơ nhân khẩu học,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 0 AND hd.hd_dep_count >= 2;"
209,Hãy cho tôi biết tổng doanh thu thu được từ các sản phẩm thuộc danh mục đồ điện tử đã được bán thông qua trang số năm trong cuốn danh mục Catalog,"SELECT SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cp.cp_catalog_page_number = 5 AND i.i_category = 'Electronics';"
210,Bạn hãy tìm giúp tôi danh sách các mặt hàng đã được mua trực tuyến và sau đó bị khách hàng trả lại ngay trong cùng một tháng bán hàng đó,"SELECT DISTINCT i.i_item_desc
FROM web_sales ws
JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d1 ON ws.ws_sold_date_sk = d1.d_date_sk
JOIN date_dim d2 ON wr.wr_returned_date_sk = d2.d_date_sk
WHERE d1.d_moy = d2.d_moy AND d1.d_year = d2.d_year;"
211,Xác định xem lý do hàng đầu khiến các khách hàng nữ trả lại hàng hóa đã mua qua kênh Catalog là do lỗi sản phẩm hay không hài lòng,"SELECT r.r_reason_desc, COUNT(*) AS count
FROM catalog_returns cr
JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F'
GROUP BY r.r_reason_desc
ORDER BY count DESC LIMIT 1;"
212,Tìm giúp tôi ba nhà sản xuất có mức giá vốn nhập hàng trung bình thấp nhất cho các mặt hàng đang được kinh doanh trong hệ thống,"SELECT i_manufact, AVG(i_wholesale_cost) AS avg_cost
FROM item
GROUP BY i_manufact
ORDER BY avg_cost ASC LIMIT 3;"
213,Bạn hãy cho tôi biết ngày nào trong tuần thường có số lượng đơn hàng bán ra cao nhất đối với danh mục sách trên trang web trực tuyến,"SELECT d.d_day_name, COUNT(*) AS sales_count
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY d.d_day_name
ORDER BY sales_count DESC LIMIT 1;"
214,Hãy tính tổng lợi nhuận từ các cửa hàng do quản lý có tên bắt đầu bằng chữ 'W' điều hành trong suốt cả năm 2001,"SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_manager LIKE 'W%' AND d.d_year = 2001;"
215,Thống kê số lượng trang web có chứa trên năm hình ảnh minh họa và đã từng phát sinh giao dịch bán các mặt hàng gia dụng.,"SELECT COUNT(DISTINCT wp.wp_web_page_sk)
FROM web_page wp
JOIN web_sales ws ON wp.wp_web_page_sk = ws.ws_web_page_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE wp.wp_image_count > 5 AND i.i_category = 'Home';"
216,So sánh tổng số lượng sản phẩm bán ra trong các ngày lễ so với các ngày bình thường để đánh giá sức mua của khách hàng,"SELECT d.d_holiday, SUM(ss.ss_quantity)
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
GROUP BY d.d_holiday;"
217,Hãy tìm lợi nhuận thu được từ những người đàn ông đã ly hôn khi họ mua đồ điện tử thông qua kênh bán hàng Catalog của công ty,"SELECT SUM(cs.cs_net_profit)
FROM catalog_sales cs
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cd.cd_gender = 'M' AND cd.cd_marital_status = 'D' AND i.i_category = 'Electronics';"
218,Hãy giúp tôi tìm ra ba khách hàng có mức chi tiêu cao nhất tại mỗi tiểu bang và hiển thị thứ hạng của họ dựa trên tổng doanh thu bán hàng qua hệ thống Web,"SELECT * FROM (
    SELECT ca.ca_state, c.c_first_name, SUM(ws.ws_sales_price) AS total_spent,
           DENSE_RANK() OVER (PARTITION BY ca.ca_state ORDER BY SUM(ws.ws_sales_price) DESC) AS rank
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    GROUP BY ca.ca_state, c.c_customer_sk, c.c_first_name
) tmp WHERE rank <= 3;"
219,Bạn hãy thực hiện phân chia danh sách khách hàng thành bốn nhóm bằng nhau dựa trên giá trị ước tính mức độ mua sắm trong hồ sơ nhân khẩu học của họ,"SELECT c_first_name, c_last_name, cd_purchase_estimate,
       NTILE(4) OVER (ORDER BY cd_purchase_estimate DESC) AS customer_segment
FROM customer
JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk;"
220,Hãy xác định xem mặt hàng nào là sản phẩm được mua nhiều thứ hai bởi khách hàng có mã số 188 dựa trên số lượng sản phẩm.,"SELECT * FROM (
    SELECT ss_item_sk, ss_quantity,
           ROW_NUMBER() OVER (ORDER BY ss_quantity DESC) AS item_seq
    FROM store_sales
    WHERE ss_customer_sk = 188
) tmp WHERE item_seq = 2;"
221,Bạn hãy tính mức chi tiêu trung bình di động của khách hàng Javier Lewis dựa trên ba giao dịch mua hàng gần nhất của ông ấy tại hệ thống cửa hàng.,"SELECT ss_ticket_number, ss_sales_price,
       AVG(ss_sales_price) OVER (ORDER BY ss_sold_date_sk ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_avg
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE c.c_first_name = 'Javier' AND c.c_last_name = 'Lewis';"
222,Bạn hãy tìm những khách hàng sống trong các căn hộ chung cư có tổng chi tiêu cao hơn mức chi tiêu trung bình của tất cả khách hàng trong cùng khu vực đó,"SELECT c_first_name, total_spent, avg_area_spent
FROM (
    SELECT c.c_first_name, SUM(ss.ss_sales_price) AS total_spent,
           AVG(SUM(ss.ss_sales_price)) OVER (PARTITION BY ca.ca_location_type) AS avg_area_spent
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    WHERE ca.ca_location_type = 'condo'
    GROUP BY c.c_customer_sk, c.c_first_name, ca.ca_location_type
) tmp WHERE total_spent > avg_area_spent;"
223,Bạn hãy tính toán giá trị đơn hàng trung bình của kênh Web trong mỗi giờ và hiển thị thứ hạng của các khung giờ dựa trên mức độ sinh lời,"SELECT t_hour, avg_profit,
       RANK() OVER (ORDER BY avg_profit DESC) AS hour_rank
FROM (
    SELECT t.t_hour, AVG(ws.ws_net_profit) AS avg_profit
    FROM web_sales ws
    JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
    GROUP BY t.t_hour
) tmp;"
224,Hãy giúp tôi xác định ngày đầu tiên và ngày cuối cùng mà khách hàng Latisha Hamilton đã thực hiện mua sắm tại cửa hàng,"SELECT DISTINCT 
       FIRST_VALUE(d_date) OVER (ORDER BY d_date ASC) AS first_purchase,
       LAST_VALUE(d_date) OVER (ORDER BY d_date ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_purchase
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE c.c_first_name = 'Latisha' AND c.c_last_name = 'Hamilton';"
225,Bạn hãy xếp hạng các kho hàng dựa trên tổng lượng hàng tồn kho của sản phẩm có màu xanh dương hiện đang có mặt trong hệ thống kho bãi,"SELECT w_warehouse_name, total_qty,
       RANK() OVER (ORDER BY total_qty DESC) AS stock_rank
FROM (
    SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_qty
    FROM inventory inv
    JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
    JOIN item i ON inv.inv_item_sk = i.i_item_sk
    WHERE i.i_color = 'blue'
    GROUP BY w.w_warehouse_name
) tmp;"
226,Bạn hãy thống kê giúp tôi tổng doanh thu của các mặt hàng thương hiệu 'Home' được bán cho những khách hàng đang sống trong các căn hộ chung cư,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_location_type = 'condo' AND i.i_brand = 'Home';"
227,Hãy liệt kê danh sách email của các khách hàng nam hiện đang cư trú tại các ngôi nhà dành cho một gia đình có múi giờ là -7,"SELECT c.c_email_address
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'M' 
  AND ca.ca_location_type = 'single family' 
  AND ca.ca_gmt_offset = -7.00;"
228,Hãy cho tôi biết mặt hàng có mã số sản phẩm là một trăm bốn mươi sáu đã mang lại bao nhiêu doanh thu trên kênh bán hàng trực tuyến Web,"SELECT SUM(ws_sales_price)
FROM web_sales
WHERE ws_item_sk = 146;"
229,"Bạn hãy liệt kê các giao dịch tại cửa hàng đang gây ra mức thua lỗ lớn nhất, cụ thể là có lợi nhuận ròng âm hơn bảy trăm đô la","SELECT ss_ticket_number, ss_net_profit
FROM store_sales
WHERE ss_net_profit < -700.00
ORDER BY ss_net_profit ASC;"
230,Bạn hãy thống kê tổng số tiền thuế thu được từ các đơn hàng Catalog của những hộ gia đình có mức khả năng chi tiêu từ năm trăm đến một ngàn đô la.,"SELECT SUM(cs.cs_ext_tax)
FROM catalog_sales cs
JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_buy_potential = '501-1000';"
231,Bạn hãy tính tổng số tiền chiết khấu đã được áp dụng cho những khách hàng nam hiện đang sinh sống tại khu vực có múi giờ âm bảy,"SELECT SUM(ss.ss_ext_discount_amt)
FROM store_sales ss
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'M' AND ca.ca_gmt_offset = -7.00;"
232,Hãy tìm giúp tôi tổng mức tổn thất ròng từ việc trả hàng qua Catalog đối với mặt hàng có mã số sản phẩm là một trăm năm mươi tư,"SELECT SUM(cr_net_loss)
FROM catalog_returns
WHERE cr_item_sk = 154;"
233,Hãy cho tôi biết tổng lợi nhuận thu được từ các sản phẩm màu xanh dương được bán tại hệ thống cửa hàng cho các khách hàng độc thân,"SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_color = 'blue' AND cd.cd_marital_status = 'S';"
234,Hãy liệt kê tên và mã địa chỉ của năm khách hàng có số lượng người phụ thuộc đang đi làm lớn hơn hai và hiện đang sống ở bang California,"SELECT c.c_first_name, ca.ca_address_id
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_dep_employed_count > 2 AND ca.ca_state = 'CA'
LIMIT 5;"
235,Bạn hãy giúp tôi xác định xem nhà sản xuất nào có nhiều sản phẩm được bán nhất cho những hộ gia đình không sở hữu xe ô tô nào.,"SELECT i.i_manufact, COUNT(*) AS sold_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 0
GROUP BY i.i_manufact
ORDER BY sold_qty DESC LIMIT 1;"
236,Hãy cho tôi biết tổng doanh thu thực tế thu được từ các đơn hàng Web phát sinh vào khung giờ khuya từ mười giờ đêm đến hai giờ sáng hôm sau,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour IN (22, 23, 0, 1);"
237,Bạn hãy liệt kê mười món đồ có giá vốn nhập hàng thấp nhất nhưng lại mang về lợi nhuận dương cao nhất trên hệ thống bán lẻ Web,"SELECT i.i_item_desc, ws.ws_net_profit
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ws.ws_net_profit > 0
ORDER BY i.i_wholesale_cost ASC, ws.ws_net_profit DESC
LIMIT 10;"
238,Hãy giúp tôi tìm xem có bao nhiêu đơn hàng bị trả lại tại cửa hàng có giá trị hoàn tiền mặt lớn hơn năm trăm đô la vào quý bốn năm hai ngàn lẻ hai,"SELECT COUNT(*)
FROM store_returns sr
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE sr.sr_refunded_cash > 500.00 AND d.d_year = 2002 AND d.d_qoy = 4;"
239,Bạn hãy tính tổng lợi nhuận ròng thu được từ kênh Web của nhóm khách hàng có thu nhập từ mức năm mươi ngàn đô la trở lên và có trên bốn người phụ thuộc,"SELECT SUM(ws.ws_net_profit)
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_lower_bound >= 50000 AND hd.hd_dep_count > 4;"
240,Bạn hãy thống kê giúp tôi tổng doanh thu của các sản phẩm thuộc danh mục 'Books' được bán tại các cửa hàng ở bang Texas cho những khách hàng đang sống trong căn hộ 'condo',"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Books' 
  AND s.s_state = 'TX' 
  AND ca.ca_location_type = 'condo';"
241,Hãy thống kê số lượng đơn hàng Catalog được đặt trong khung giờ từ tám giờ tối đến mười giờ đêm bởi những khách hàng cư trú tại bang California,"SELECT COUNT(*)
FROM catalog_sales cs
JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk
JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk
WHERE t.t_hour BETWEEN 20 AND 22 
  AND ca.ca_state = 'CA';"
242,Bạn hãy thống kê giúp tôi tổng doanh thu của các sản phẩm thuộc danh mục Music được bán tại hệ thống cửa hàng cho các khách hàng đang cư trú tại bang Texas trong suốt năm 2001,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND ca.ca_state = 'TX' AND d.d_year = 2001;"
243,Hãy cho tôi biết mức chi tiêu trung bình cho các mặt hàng thời trang Women của những khách hàng nữ có trình độ học vấn là Tiến sĩ khi họ mua sắm trực tuyến trên hệ thống Web,"SELECT AVG(ws.ws_sales_price)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Women' AND cd.cd_gender = 'F' AND cd.cd_education_status = 'Advanced Degree';"
244,Bạn hãy tính toán tổng lợi nhuận ròng thu được từ các sản phẩm danh mục Home khi bán cho những hộ gia đình sống trong các căn hộ chung cư và sở hữu từ hai xe ô tô trở lên,"SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk
WHERE i.i_category = 'Home' AND ca.ca_location_type = 'condo' AND hd.hd_vehicle_count >= 2;"
245,Bạn hãy thống kê giúp tôi tổng doanh thu của các sản phẩm thuộc danh mục Music được bán qua trang web và được vận chuyển bằng phương thức giao hàng hỏa tốc OVERNIGHT cho những khách hàng đang sống trong căn hộ chung cư,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Music' 
  AND sm.sm_type = 'OVERNIGHT' 
  AND ca.ca_location_type = 'condo';"
246,Hãy tính toán chi phí vận chuyển trung bình cho các mặt hàng thời trang Women được gửi đến bang Texas bằng phương thức giao hàng NEXT DAY thông qua hệ thống bán hàng trực tuyến Web,"SELECT AVG(ws.ws_ext_ship_cost)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Women' 
  AND sm.sm_type = 'NEXT DAY' 
  AND ca.ca_state = 'TX';"
247,Bạn hãy so sánh lợi nhuận ròng giữa hai phương thức vận chuyển REGULAR và EXPRESS đối với các mặt hàng danh mục Home được bán trên kênh Web trong suốt năm 2001,"SELECT sm.sm_type, SUM(ws.ws_net_profit) AS total_profit
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' 
  AND sm.sm_type IN ('REGULAR', 'EXPRESS') 
  AND d.d_year = 2001
GROUP BY sm.sm_type;"
248,Thống kê giúp tôi tổng số lượng sản phẩm Children được bán qua kênh Catalog và vận chuyển bằng đường bộ LIBRARY cho những khách hàng nữ đã lập gia đình.,"SELECT SUM(cs.cs_quantity)
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Children' 
  AND sm.sm_type = 'LIBRARY' 
  AND cd.cd_gender = 'F' 
  AND cd.cd_marital_status = 'M';"
249,Bạn hãy tìm giúp tôi tổng tiền thuế thu được từ các đơn hàng Catalog của danh mục Jewelry được vận chuyển bằng phương thức TWO DAY đến khu vực có múi giờ là âm bảy,"SELECT SUM(cs.cs_ext_tax)
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' 
  AND sm.sm_type = 'TWO DAY' 
  AND ca.ca_gmt_offset = -7.00;"
250,Hãy liệt kê danh sách năm khách hàng có trình độ học vấn là Tiến sĩ đã chi tiêu nhiều nhất cho các mặt hàng Shoes vận chuyển qua phương thức OVERNIGHT trên hệ thống Catalog.,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_sales_price) AS total_spend
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Shoes' 
  AND sm.sm_type = 'OVERNIGHT' 
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spend DESC LIMIT 5;"
251,Thống kê giúp tôi số lượng đơn hàng trực tuyến của danh mục Men được đặt bởi những khách hàng sinh sau năm một chín tám mươi và chọn phương thức giao hàng TWO DAY.,"SELECT COUNT(ws.ws_order_number)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Men' 
  AND c.c_birth_year > 1980 
  AND sm.sm_type = 'TWO DAY';"
252,Hãy thống kê tổng số tiền hoàn lại cho những khách hàng sống tại các ngôi nhà dành cho một gia đình khi họ trả lại các mặt hàng Sports được giao bằng phương thức REGULAR,"SELECT SUM(wr.wr_refunded_cash)
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
JOIN web_sales ws ON wr.wr_item_sk = ws.ws_item_sk AND wr.wr_order_number = ws.ws_order_number
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Sports' 
  AND sm.sm_type = 'REGULAR' 
  AND ca.ca_location_type = 'single family';"
253,Hãy liệt kê tên các trung tâm hỗ trợ có trên một trăm nhân viên và tổng giá trị thuế thu được từ các đơn hàng Catalog mà họ đã xử lý trong quý bốn,"SELECT cc.cc_name, SUM(cs.cs_ext_tax) AS total_tax
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE cc.cc_employees > 100 AND d.d_qoy = 4
GROUP BY cc.cc_name;"
254,Bạn hãy tìm giúp tôi mức lợi nhuận trung bình của các đơn hàng Catalog được xử lý bởi trung tâm hỗ trợ có diện tích mặt sàn lớn nhất trong hệ thống,"SELECT cc.cc_name, AVG(cs.cs_net_profit) AS avg_profit
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
WHERE cc.cc_sq_ft = (SELECT MAX(cc_sq_ft) FROM call_center)
GROUP BY cc.cc_name;"
255,Bạn hãy tính toán lợi nhuận ròng từ các sản phẩm danh mục Home được bán qua Website có ngày bắt đầu hoạt động sớm nhất trong hệ thống.,"SELECT web.web_name, SUM(ws.ws_net_profit)
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE web.web_rec_start_date = (SELECT MIN(web_rec_start_date) FROM web_site)
  AND i.i_category = 'Home'
GROUP BY web.web_name;"
256,Thống kê tổng số đơn hàng Jewelry được giao bằng dịch vụ EXPRESS thông qua các trang web có lượng khách truy cập (mã số thuế) 0.11,"SELECT COUNT(*)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE sm.sm_type = 'EXPRESS' AND web.web_tax_percentage = 0.11 AND i.i_category = 'Jewelry';"
257,Hãy liệt kê danh sách các mã sản phẩm và số lượng tồn kho tương ứng của chúng tại kho hàng có mã số là một,"SELECT inv_item_sk, inv_quantity_on_hand 
FROM inventory 
WHERE inv_warehouse_sk = 1;"
258,Bạn hãy thống kê tổng số lượng hàng tồn kho cho tất cả các sản phẩm thuộc danh mục hàng Music,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
259,Bạn hãy liệt kê tên các sản phẩm thuộc danh mục Children và số lượng tồn kho hiện tại,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
LIMIT 10;"
260,Bạn hãy thống kê tổng số lượng hàng tồn kho của các sản phẩm thuộc danh mục 'Music' tại tất cả các kho hàng trong suốt quý một của năm 2002,"SELECT i.i_category, SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002 AND d.d_qoy = 1
GROUP BY i.i_category;"
261,Hãy cho tôi biết lượng tồn kho trung bình của các mặt hàng thời trang 'Women' vào những ngày cuối tuần trong tháng mười hai năm 2001,"SELECT AVG(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_weekend = 'Y' 
  AND d.d_year = 2001 AND d.d_moy = 12;"
262,Bạn hãy thống kê xem kho hàng nào ở khu vực múi giờ âm bảy đang lưu giữ nhiều mặt hàng 'Jewelry' nhất hiện nay,"SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_qty
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND w.w_gmt_offset = -7.00
GROUP BY w.w_warehouse_name
ORDER BY total_qty DESC LIMIT 1;"
263,Bạn hãy liệt kê năm sản phẩm 'Children' có lượng tồn kho ít nhất tại các kho hàng thuộc bang 'California' vào những ngày lễ của năm 2002,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND w.w_state = 'CA' 
  AND d.d_holiday = 'Y' AND d.d_year = 2002
ORDER BY inv.inv_quantity_on_hand ASC LIMIT 5;"
264,"Bạn hãy thống kê tổng lợi nhuận dự kiến nếu chúng ta bán hết toàn bộ lượng hàng tồn kho của danh mục 'Music' hiện có, dựa trên mức giá bán lẻ hiện tại của từng sản phẩm.","SELECT SUM((i.i_current_price - i.i_wholesale_cost) * inv.inv_quantity_on_hand) AS potential_profit
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
265,Hãy cho tôi biết những kho hàng ở bang 'California' đang chứa các mặt hàng 'Shoes' có giá bán trên một trăm đô la và liệt kê tổng số lượng tồn của từng loại phương thức vận chuyển 'EXPRESS' liên quan,"SELECT w.w_warehouse_name, i.i_item_desc, SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE w.w_state = 'CA' AND i.i_category = 'Shoes' 
  AND i.i_current_price > 100 AND sm.sm_type = 'EXPRESS'
GROUP BY w.w_warehouse_name, i.i_item_desc;"
266,Bạn hãy liệt kê năm nhà sản xuất có lượng tồn kho danh mục 'Children' bị sụt giảm nhiều nhất khi so sánh giữa quý một và quý hai năm 2002,"SELECT i.i_manufact, 
       SUM(CASE WHEN d.d_qoy = 1 THEN inv.inv_quantity_on_hand ELSE 0 END) - 
       SUM(CASE WHEN d.d_qoy = 2 THEN inv.inv_quantity_on_hand ELSE 0 END) AS stock_drop
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_manufact
ORDER BY stock_drop DESC LIMIT 5;"
267,Bạn hãy tính toán sự chênh lệch về lượng hàng tồn kho của danh mục 'Children' giữa các kho hàng có múi giờ âm bảy và các kho hàng ở múi giờ âm năm.,"SELECT w.w_gmt_offset, SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children' AND w.w_gmt_offset IN (-7.00, -5.00)
GROUP BY w.w_gmt_offset;"
268,Hãy so sánh tổng lượng hàng tồn của danh mục 'Home' tại các kho phục vụ phương thức vận chuyển 'EXPRESS' so với phương thức 'REGULAR,"SELECT sm.sm_type, SUM(inv.inv_quantity_on_hand) AS total_inventory
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Home' AND sm.sm_type IN ('EXPRESS', 'REGULAR')
GROUP BY sm.sm_type;"
269,Hãy so sánh sự chênh lệch về tổng lượng tồn kho của danh mục 'Home' giữa các kho hàng có diện tích trên một triệu feet vuông và dưới một triệu feet vuông,"SELECT CASE WHEN w.w_warehouse_sq_ft > 1000000 THEN 'Large' ELSE 'Small' END AS warehouse_size,
       SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY warehouse_size;"
270,Bạn hãy liệt kê năm nhà sản xuất có lượng hàng tồn kho danh mục 'Children' bị sụt giảm nhiều nhất khi so sánh giữa quý 3 và quý 4 năm 2002,"SELECT i.i_manufact, 
       SUM(CASE WHEN d.d_qoy = 3 THEN inv.inv_quantity_on_hand ELSE 0 END) - 
       SUM(CASE WHEN d.d_qoy = 4 THEN inv.inv_quantity_on_hand ELSE 0 END) AS stock_reduction
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_manufact
ORDER BY stock_reduction DESC LIMIT 5;"
271,Bạn hãy liệt kê danh sách tên các nhà sản xuất có mặt hàng thuộc danh mục Music hiện đang còn hàng trong kho tại bang Texas.,"SELECT DISTINCT i.i_manufact
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'TX' AND inv.inv_quantity_on_hand > 0;"
272,Hãy tìm địa chỉ cụ thể bao gồm tên đường và thành phố của các kho hàng hiện đang lưu trữ sản phẩm Electronics có màu đỏ,"SELECT DISTINCT w.w_street_name, w.w_city, w.w_state
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics' AND i.i_color = 'red';"
273,Bạn hãy hiển thị tên của những khách hàng ở bang California đã từng mua mặt hàng Women mà hiện nay mặt hàng đó vẫn còn tồn kho tại kho hàng địa phương.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk
WHERE ca.ca_state = 'CA' AND inv.inv_quantity_on_hand > 0;"
274,Hãy hiển thị danh sách các trang web page có chứa hình ảnh minh họa và đã từng bán các mặt hàng Jewelry cho khách hàng có trình độ học vấn là Tiến sĩ.,"SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND cd.cd_education_status = 'Advanced Degree' AND wp.wp_image_count > 0;"
275,Hãy tìm các đơn hàng Catalog sử dụng dịch vụ EXPRESS mà mặt hàng trong đơn đó hiện nay đã hết sạch hàng trong hệ thống kho bãi,"SELECT DISTINCT cs.cs_order_number
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk
WHERE sm.sm_type = 'EXPRESS' AND inv.inv_quantity_on_hand = 0;"
276,Bạn hãy liệt kê danh sách tên các nhà sản xuất có mặt hàng thuộc danh mục Music hiện đang có sẵn trong kho tại bang Kansas để chuẩn bị cho đợt kiểm hàng tới,"SELECT DISTINCT i.i_manufact
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'KS' AND inv.inv_quantity_on_hand > 0;"
277,Hãy hiển thị tên và email của khách hàng ở bang 'California' có trình độ 'Advanced Degree' đã từng mua đồ 'Jewelry' qua kênh Web.,"SELECT DISTINCT c.c_first_name, c.c_last_name, c.c_email_address
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'CA' AND cd.cd_education_status = 'Advanced Degree' AND i.i_category = 'Jewelry';"
278,Bạn hãy liệt kê các loại hình cư trú của những khách hàng ở 'Virginia' đã mua sản phẩm 'Shoes' được giao bằng phương thức 'OVERNIGHT',"SELECT DISTINCT ca.ca_location_type
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA' AND sm.sm_type = 'OVERNIGHT' AND i.i_category = 'Shoes';"
279,Bạn hãy tìm URL của các trang web page đã thực hiện bán mặt hàng 'Music' cho khách hàng sống tại cùng bang với kho hàng cung cấp.,"SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Music' AND w.w_state = ca.ca_state;"
280,Hãy liệt kê tên các Website đã từng bán mặt hàng 'Sports' cho khách hàng có trình độ học vấn là 'College' tại bang 'Iowa',"SELECT DISTINCT web.web_name
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND cd.cd_education_status = 'College' AND ca.ca_state = 'IA';"
281,Bạn hãy hiển thị tên các nhà sản xuất của sản phẩm 'Books' bị trả lại qua kênh Catalog bởi khách hàng sống tại bang 'Kentucky',"SELECT DISTINCT i.i_manufact
FROM catalog_returns cr
JOIN item i ON cr.cr_item_sk = i.i_item_sk
JOIN customer_address ca ON cr.cr_refunded_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Books' AND ca.ca_state = 'KY';"
282,Bạn hãy hiển thị địa chỉ tên đường của các kho hàng đang chứa sản phẩm 'Electronics' màu xanh dương phục vụ cho phương thức vận chuyển 'EXPRESS,"SELECT DISTINCT w.w_street_name
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Electronics' AND i.i_color = 'blue' AND sm.sm_type = 'EXPRESS';"
283,Bạn hãy hiển thị tên Website và mã số thuế của nó nếu Website đó đã từng bán đồ 'Women' cho khách hàng ở 'Virginia' có trên hai người phụ thuộc,"SELECT DISTINCT web.web_name, web.web_tax_percentage
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Women' AND ca.ca_state = 'VA' AND cd.cd_dep_count > 2;"
284,Hãy hiển thị tên người quản lý trung tâm hỗ trợ đã xử lý việc hoàn lại cho mặt hàng 'Home' của những khách hàng có xếp hạng tín dụng 'Good',"SELECT DISTINCT cc.cc_manager
FROM catalog_returns cr
JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
JOIN item i ON cr.cr_item_sk = i.i_item_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Home' AND cd.cd_credit_rating = 'Good';"
285,Hãy hiển thị tên người quản lý trung tâm hỗ trợ call center đã xử lý việc trả hàng 'Men' cho những khách hàng có bằng '4 yr Degree' sống tại bang 'North Carolina'.,"SELECT DISTINCT cc.cc_manager
FROM catalog_returns cr
JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON cr.cr_refunded_addr_sk = ca.ca_address_sk
JOIN item i ON cr.cr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men' AND cd.cd_education_status = '4 yr Degree' AND ca.ca_state = 'NC';"
286,Bạn hãy liệt kê tên các nhà sản xuất có sản phẩm thuộc danh mục Home hiện đang được bày bán tại các cửa hàng có trên hai trăm nhân viên phục vụ,"SELECT DISTINCT i.i_manufact
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home' AND s.s_number_employees > 200;"
287,Liệt kê các loại hình cư trú của những khách hàng ở bang Virginia đã mua sản phẩm Children thông qua phương thức vận chuyển hỏa tốc ,"SELECT DISTINCT ca.ca_location_type
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA' AND sm.sm_type = 'OVERNIGHT' AND i.i_category = 'Children';"
288,Hiển thị danh sách các thương hiệu sản phẩm thuộc danh mục hàng Shoes,SELECT DISTINCT i_brand FROM item WHERE i_category = 'Shoes';
289,Hiển thị tên Website và mã số thuế của nó nếu Website đó đã bán hàng Sports cho những hộ gia đình sở hữu trên ba xe ô tô,"SELECT DISTINCT web.web_name, web.web_tax_percentage
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND hd.hd_vehicle_count > 3;"
290,Tìm danh sách tên các khách hàng đã từng mua mặt hàng 'Music' thông qua kênh Web nhưng lại thực hiện việc trả lại hàng đó thông qua kênh Catalog,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
WHERE c.c_customer_sk IN (
    SELECT ws_bill_customer_sk FROM web_sales ws 
    JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_category = 'Music'
)
AND c.c_customer_sk IN (
    SELECT cr_refunded_customer_sk FROM catalog_returns cr 
    JOIN item i ON cr.cr_item_sk = i.i_item_sk WHERE i.i_category = 'Music'
);"
291,Tìm tên người quản lý cửa hàng đã bán mặt hàng 'Shoes' được giao bằng dịch vụ 'OVERNIGHT' cho những khách hàng sống cùng bang với địa điểm cửa hàng đó,"SELECT DISTINCT s.s_manager
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk -- Giả định liên kết giao hàng
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Shoes' AND sm.sm_type = 'OVERNIGHT' AND s.s_state = ca.ca_state;"
292,Liệt kê danh sách tên những khách hàng có trình độ 'College' đã mua đồ 'Men' tại cửa hàng vào năm 2001 nhưng chưa bao giờ mua hàng qua trang Web,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001
EXCEPT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk;"
293,Hãy tìm tên các quản lý trung tâm hỗ trợ đã xử lý đơn hàng 'Sports' cho khách hàng độc thân vào khung giờ từ mười giờ đêm đến hai giờ sáng,"SELECT DISTINCT cc.cc_manager
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND cd.cd_marital_status = 'S' AND t.t_hour IN (22, 23, 0, 1);"
294,Bạn hãy liệt kê tên các khách hàng đã từng mua đồ 'Electronics' qua kênh Web nhưng cũng đồng thời thực hiện mua hàng trực tiếp tại các cửa hàng ở bang 'Texas'.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
  AND c.c_customer_sk IN (SELECT ws_bill_customer_sk FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics')
  AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics');"
295,Liệt kê danh sách tên các khách hàng 'độc thân' đã mua đồ 'Jewelry' qua kênh Web nhưng chưa bao giờ thực hiện bất kỳ giao dịch nào qua kênh Catalog,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Jewelry'
EXCEPT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk;"
296,Tìm tên các Website đã bán đồ 'Women' cho khách hàng có xếp hạng tín dụng 'Good' thông qua phương thức vận chuyển 'OVERNIGHT' mà đơn hàng đó sau này bị trả lại.,"SELECT DISTINCT web.web_name
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Women' AND sm.sm_type = 'OVERNIGHT' AND cd.cd_credit_rating = 'Good';"
297,Hiển thị địa chỉ tên đường của các kho hàng đang lưu giữ sản phẩm 'Books' của cùng một nhà sản xuất với các mặt hàng 'Children' đã được bán tại bang 'Georgia',"SELECT DISTINCT w.w_street_name
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Books' AND i.i_manufact IN (
    SELECT DISTINCT i2.i_manufact 
    FROM store_sales ss 
    JOIN item i2 ON ss.ss_item_sk = i2.i_item_sk 
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    WHERE i2.i_category = 'Children' AND s.s_state = 'GA'
);"
298,Liệt kê tên các trung tâm hỗ trợ đã xử lý đơn hàng 'Jewelry' cho các hộ gia đình sở hữu trên ba xe ô tô thông qua phương thức vận chuyển 'NEXT DAY,"SELECT DISTINCT cc.cc_name
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND sm.sm_type = 'NEXT DAY' AND hd.hd_vehicle_count > 3;"
299,Bạn hãy liệt kê tên các khách hàng đã từng mua mặt hàng 'Music' trực tiếp tại cửa hàng nhưng lại thực hiện trả lại món hàng đó thông qua hệ thống Web,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND EXISTS (
      SELECT 1 FROM web_returns wr 
      WHERE wr.wr_refunded_customer_sk = c.c_customer_sk AND wr.wr_item_sk = i.i_item_sk
  );"
300,Hãy liệt kê tên các kho hàng đang lưu trữ sản phẩm 'Shoes' mà có số lượng tồn kho cao hơn mức tồn kho trung bình của tất cả các kho trong cùng bang đó.,"WITH AvgStock AS (
    SELECT w_state, AVG(inv_quantity_on_hand) as state_avg
    FROM inventory JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk
    GROUP BY w_state
)
SELECT DISTINCT w.w_warehouse_name
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN AvgStock ast ON w.w_state = ast.w_state
WHERE i.i_category = 'Shoes' AND inv.inv_quantity_on_hand > ast.state_avg;"
301,Ai mua đồ Shoes nhiều nhất ở TX vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
302,Check giùm tôi tồn kho của Shoes ở chi nhánh IL.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND w.w_state = 'IL'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
303,Tổng doanh thu của Women tại bang KY năm 2002 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002;"
304,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category;"
305,Cửa hàng nào ở NC đứng đầu về doanh số Books vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
306,Check giùm tôi tồn kho của Sports ở chi nhánh KS.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND w.w_state = 'KS'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
307,"Trong năm 2002, khách hàng ở GA mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY ca.ca_state, i.i_category;"
308,Cửa hàng nào ở NC đứng đầu về doanh số Home vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NC'
  AND i.i_category = 'Home'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
309,Khách hàng có bằng Secondary tại NC thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
310,Liệt kê 10 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở GA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10;"
311,Ai mua đồ Men nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
312,Năm ngoái dân ở IL mua Jewelry nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
313,Có bao nhiêu đơn hàng Electronics bị trả lại tại VA vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2002;"
314,Tìm email của các khách hàng VIP ở IA đã mua đồ Sports trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
315,Tìm 10 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
316,Tìm email của các khách hàng VIP ở IA đã mua đồ Electronics trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Electronics'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
317,Giá bán trung bình của mặt hàng Books trong năm 1999 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 1999
GROUP BY i.i_category;"
318,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Home tại TX.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10;"
319,Check giùm tôi tồn kho của Electronics ở chi nhánh VA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'VA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
320,So sánh lợi nhuận của Women giữa kênh Web và Catalog tại KY.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel;"
321,Doanh số của Home tại GA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'GA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'GA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
322,Ai mua đồ Music nhiều nhất ở KY vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
323,Năm 2000 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_year;"
324,Có bao nhiêu đơn hàng Shoes bị trả lại tại IL vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;"
325,Check giùm tôi tồn kho của Men ở chi nhánh VA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND w.w_state = 'VA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
326,Check giùm tôi tồn kho của Shoes ở chi nhánh TX.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND w.w_state = 'TX'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
327,So sánh lợi nhuận của Jewelry giữa kênh Web và Web tại TX.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel;"
328,Thống kê tổng số lượng Women được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;"
329,Check giùm tôi tồn kho của Music ở chi nhánh KS.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND w.w_state = 'KS'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
330,Tìm email của các khách hàng VIP ở VA đã mua đồ Shoes trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Shoes'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
331,Năm ngoái dân ở TX mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
332,Tìm 5 sản phẩm Home có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
333,Khách hàng có bằng 2 yr Degree tại GA thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
334,"Trong năm 2001, khách hàng ở KS mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
335,Ai mua đồ Women nhiều nhất ở TX vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
336,Check giùm tôi tồn kho của Electronics ở chi nhánh NC.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'NC'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
337,Ai mua đồ Sports nhiều nhất ở IA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
338,Cho tôi xem danh sách sản phẩm Music bán chạy nhất ở KS.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
339,Thống kê tổng số lượng Women được mua bởi những khách hàng có trình độ 2 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND cd.cd_education_status = '2 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;"
340,Check giùm tôi tồn kho của Electronics ở chi nhánh IL.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'IL'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
341,Năm 2001 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year;"
342,"Năm 1999, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
343,Tỷ lệ trả hàng của Electronics ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Electronics' as category,
    'GA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
344,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Home tại KY.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 5;"
345,Tỷ lệ trả hàng của Books ở IA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Books' as category,
    'IA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
346,Năm ngoái dân ở TX mua Sports nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Sports'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
347,"Hàng Women trả lại ở GA có nhiều không, xem số liệu năm 2002 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year;"
348,Tổng doanh thu của Women tại bang IA năm 2000 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000;"
349,Tìm 5 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
350,Check giùm tôi tồn kho của Electronics ở chi nhánh KY.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'KY'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
351,Năm ngoái dân ở IL mua Sports nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Sports'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
352,Ai mua đồ Books nhiều nhất ở MO vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'MO'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
353,Năm 2001 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year;"
354,Giá bán trung bình của mặt hàng Music trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 2000
GROUP BY i.i_category;"
355,So sánh lợi nhuận của Jewelry giữa kênh Store và Web tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
ORDER BY channel;"
356,Thống kê tổng số lượng Home được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category;"
357,Năm 2001 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year;"
358,"Trong quý 4 năm 2000, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Men?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Men'
  AND d.d_year = 2000
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
359,Tỷ lệ trả hàng của Men ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'GA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
360,Giá bán trung bình của mặt hàng Electronics trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
GROUP BY i.i_category;"
361,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;"
362,Tổng doanh thu của Children tại bang IL năm 2002 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002;"
363,Check giùm tôi tồn kho của Children ở chi nhánh KY.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND w.w_state = 'KY'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
364,Tìm 10 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
365,Tổng doanh thu của Shoes tại bang IL năm 2000 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2000;"
366,So sánh lợi nhuận của Men giữa kênh Web và Catalog tại KS.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel;"
367,Tổng doanh thu của Women tại bang TX năm 2001 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001;"
368,So sánh lợi nhuận của Music giữa kênh Store và Catalog tại VA.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'VA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'VA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'VA'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel;"
369,Khách hàng có bằng 4 yr Degree tại KS thường mua Sports qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
370,Tổng doanh thu của Sports tại bang IL năm 2002 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002;"
371,Doanh số của Shoes tại NC năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
372,Cửa hàng nào ở IA đứng đầu về doanh số Shoes vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Shoes'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
373,Thống kê tổng số lượng Children được mua bởi những khách hàng có trình độ College.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND cd.cd_education_status = 'College'
GROUP BY cd.cd_education_status, i.i_category;"
374,Năm ngoái dân ở IL mua Children nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
375,Cửa hàng nào ở KS đứng đầu về doanh số Sports vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS'
  AND i.i_category = 'Sports'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
376,"Trong năm 2002, khách hàng ở IL mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY ca.ca_state, i.i_category;"
377,"Trong quý 4 năm 1999, nhóm khách hàng Primary chi bao nhiêu tiền cho Men?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
378,Năm 2002 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year;"
379,Cửa hàng nào ở NC đứng đầu về doanh số Men vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NC'
  AND i.i_category = 'Men'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
380,Có bao nhiêu đơn hàng Women bị trả lại tại VA vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2000;"
381,"Hàng Sports trả lại ở GA có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;"
382,Có bao nhiêu đơn hàng Music bị trả lại tại NC vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002;"
383,"Trong quý 4 năm 2002, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Shoes?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
384,Giá bán trung bình của mặt hàng Electronics trong năm 1999 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
GROUP BY i.i_category;"
385,"Hàng Home trả lại ở IA có nhiều không, xem số liệu năm 2002 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year;"
386,Năm ngoái dân ở TX mua Children nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
387,Doanh số của Electronics tại IA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
388,"Trong quý 4 năm 2000, nhóm khách hàng Advanced Degree chi bao nhiêu tiền cho Sports?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Sports'
  AND d.d_year = 2000
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
389,Doanh số của Sports tại KY năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
390,"Trong năm 2001, khách hàng ở VA mua nhiều Music không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Music'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
391,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Jewelry tại NC.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'NC'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 3;"
392,Tìm 10 sản phẩm Children có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
393,Năm 2000 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_year;"
394,Ai mua đồ Men nhiều nhất ở GA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'GA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
395,"Năm 2002, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
396,Tìm 10 sản phẩm Sports có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
397,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở IA.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
398,Tỷ lệ trả hàng của Women ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'VA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Women' as category,
    'VA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
399,Doanh số của Electronics tại NC năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
400,Có bao nhiêu đơn hàng Electronics bị trả lại tại MO vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;"
401,Khách hàng có bằng Secondary tại VA thường mua Women qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
402,Tìm email của các khách hàng VIP ở TX đã mua đồ Sports trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;"
403,Giá bán trung bình của mặt hàng Men trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 2002
GROUP BY i.i_category;"
404,Liệt kê 10 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở VA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'VA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10;"
405,Khách hàng có bằng Primary tại IA thường mua Shoes qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Primary'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Shoes'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Primary'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Shoes'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Primary'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Shoes'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
406,"Trong quý 4 năm 2002, nhóm khách hàng College chi bao nhiêu tiền cho Sports?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Sports'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
407,Tìm 10 sản phẩm Men có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
408,Doanh số của Shoes tại IL năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
409,Tổng doanh thu của Music tại bang KS năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999;"
410,Tìm email của các khách hàng VIP ở VA đã mua đồ Jewelry trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
411,Doanh số của Men tại VA năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
412,Khách hàng có bằng College tại IA thường mua Sports qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
413,Thống kê tổng số lượng Sports được mua bởi những khách hàng có trình độ Primary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND cd.cd_education_status = 'Primary'
GROUP BY cd.cd_education_status, i.i_category;"
414,Năm ngoái dân ở NC mua Books nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
415,Cho tôi xem danh sách sản phẩm Children bán chạy nhất ở MO.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'MO'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
416,Giá bán trung bình của mặt hàng Shoes trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
GROUP BY i.i_category;"
417,Cửa hàng nào ở IA đứng đầu về doanh số Women vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
418,Có bao nhiêu đơn hàng Men bị trả lại tại GA vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000;"
419,Tổng doanh thu của Sports tại bang IA năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999;"
420,Năm ngoái dân ở KS mua Jewelry nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
421,Tìm 5 sản phẩm Children có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
422,Có bao nhiêu đơn hàng Electronics bị trả lại tại TX vào năm 1999?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999;"
423,Giá bán trung bình của mặt hàng Jewelry trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
GROUP BY i.i_category;"
424,Thống kê tổng số lượng Shoes được mua bởi những khách hàng có trình độ Advanced Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY cd.cd_education_status, i.i_category;"
425,Khách hàng có bằng 2 yr Degree tại KS thường mua Home qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
426,Liệt kê 3 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3;"
427,"Hàng Music trả lại ở TX có nhiều không, xem số liệu năm 2001 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001
GROUP BY i.i_category, ca.ca_state, d.d_year;"
428,So sánh lợi nhuận của Children giữa kênh Web và Web tại KY.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel;"
429,Giá bán trung bình của mặt hàng Women trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND d.d_year = 2000
GROUP BY i.i_category;"
430,Năm ngoái dân ở TX mua Books nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
431,Có bao nhiêu đơn hàng Shoes bị trả lại tại MO vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2002;"
432,Cho tôi xem danh sách sản phẩm Women bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
433,Năm 2002 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year;"
434,Giá bán trung bình của mặt hàng Sports trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 2001
GROUP BY i.i_category;"
435,Có bao nhiêu đơn hàng Shoes bị trả lại tại IA vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000;"
436,Liệt kê 5 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở GA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'GA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
437,Năm 1999 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY d.d_year;"
438,Cửa hàng nào ở IA đứng đầu về doanh số Electronics vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Electronics'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
439,So sánh lợi nhuận của Electronics giữa kênh Store và Catalog tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel;"
440,Năm ngoái dân ở IL mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
441,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại KS.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10;"
442,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại GA.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 3;"
443,Tỷ lệ trả hàng của Men ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
444,Có bao nhiêu đơn hàng Books bị trả lại tại IL vào năm 1999?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999;"
445,Doanh số của Jewelry tại TX năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
446,Tìm 3 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;"
447,Doanh số của Women tại IA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
448,Khách hàng có bằng Advanced Degree tại KS thường mua Shoes qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Shoes'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Shoes'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Shoes'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
449,Có bao nhiêu đơn hàng Jewelry bị trả lại tại TX vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001;"
450,Có bao nhiêu đơn hàng Home bị trả lại tại IL vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002;"
451,Doanh số của Books tại VA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'VA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'VA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
452,Cửa hàng nào ở KY đứng đầu về doanh số Electronics vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY'
  AND i.i_category = 'Electronics'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
453,Ai mua đồ Shoes nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
454,"Hàng Books trả lại ở KS có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;"
455,Tỷ lệ trả hàng của Children ở TX có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'TX'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Children' as category,
    'TX' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
456,Cho tôi xem danh sách sản phẩm Books bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
457,Khách hàng có bằng College tại IA thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
458,Giá bán trung bình của mặt hàng Music trong năm 1999 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 1999
GROUP BY i.i_category;"
459,Doanh số của Men tại MO năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'MO' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'MO' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
460,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Sports tại VA.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 5;"
461,Năm 1999 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY d.d_year;"
462,So sánh lợi nhuận của Books giữa kênh Store và Web tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
ORDER BY channel;"
463,Tìm email của các khách hàng VIP ở IA đã mua đồ Women trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Women'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;"
464,Giá bán trung bình của mặt hàng Electronics trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 2000
GROUP BY i.i_category;"
465,Doanh số của Men tại NC năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'NC' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'NC' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
466,Năm 2002 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year;"
467,So sánh lợi nhuận của Children giữa kênh Store và Catalog tại VA.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel;"
468,Tìm email của các khách hàng VIP ở NC đã mua đồ Shoes trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;"
469,"Trong năm 2001, khách hàng ở MO mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
470,Doanh số của Jewelry tại GA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
471,Tìm 3 sản phẩm Electronics có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;"
472,Khách hàng có bằng 4 yr Degree tại TX thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
473,"Hàng Women trả lại ở IL có nhiều không, xem số liệu năm 1999 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year;"
474,Thống kê tổng số lượng Children được mua bởi những khách hàng có trình độ 2 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND cd.cd_education_status = '2 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;"
475,Tìm email của các khách hàng VIP ở KY đã mua đồ Children trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Children'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
476,Năm ngoái dân ở VA mua Jewelry nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
477,Tìm email của các khách hàng VIP ở TX đã mua đồ Women trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Women'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;"
478,Tổng doanh thu của Books tại bang GA năm 2001 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2001;"
479,Cho tôi xem danh sách sản phẩm Books bán chạy nhất ở IA.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
480,Ai mua đồ Electronics nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
481,So sánh lợi nhuận của Music giữa kênh Catalog và Catalog tại KS.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
ORDER BY channel;"
482,Ai mua đồ Home nhiều nhất ở NC vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
483,Liệt kê 5 thương hiệu Men được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
484,Tỷ lệ trả hàng của Shoes ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Shoes' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
485,"Trong năm 2001, khách hàng ở NC mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
486,Khách hàng có bằng Secondary tại KS thường mua Music qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Music'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Music'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Music'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
487,Cửa hàng nào ở VA đứng đầu về doanh số Women vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'VA'
  AND i.i_category = 'Women'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
488,Ai mua đồ Books nhiều nhất ở KS vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
489,Cửa hàng nào ở MO đứng đầu về doanh số Books vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'MO'
  AND i.i_category = 'Books'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
490,Ai mua đồ Sports nhiều nhất ở KY vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
491,Có bao nhiêu đơn hàng Sports bị trả lại tại NC vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002;"
492,Giá bán trung bình của mặt hàng Shoes trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY i.i_category;"
493,Cửa hàng nào ở IA đứng đầu về doanh số Shoes vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Shoes'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
494,"Năm 2000, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
495,Cửa hàng nào ở KS đứng đầu về doanh số Women vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS'
  AND i.i_category = 'Women'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
496,Liệt kê 5 thương hiệu Men được ưa chuộng nhất bởi khách hàng ở IA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
497,Khách hàng có bằng 4 yr Degree tại IA thường mua Men qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
498,Có bao nhiêu đơn hàng Women bị trả lại tại VA vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2001;"
499,Tìm email của các khách hàng VIP ở GA đã mua đồ Sports trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
500,Check giùm tôi tồn kho của Shoes ở chi nhánh IA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND w.w_state = 'IA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
501,"Hàng Books trả lại ở TX có nhiều không, xem số liệu năm 1999 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year;"
502,So sánh lợi nhuận của Children giữa kênh Web và Catalog tại IL.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel;"
503,Khách hàng có bằng Advanced Degree tại KS thường mua Home qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
504,Cửa hàng nào ở IA đứng đầu về doanh số Women vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
505,Doanh số của Electronics tại GA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
506,Tìm 5 sản phẩm Children có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
507,"Trong quý 4 năm 2002, nhóm khách hàng 4 yr Degree chi bao nhiêu tiền cho Music?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree'
  AND i.i_category = 'Music'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
508,Cho tôi xem danh sách sản phẩm Music bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
509,Thống kê tổng số lượng Electronics được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category;"
510,Check giùm tôi tồn kho của Home ở chi nhánh KS.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND w.w_state = 'KS'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
511,"Hàng Children trả lại ở GA có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;"
512,Giá bán trung bình của mặt hàng Home trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY i.i_category;"
513,Tìm 10 sản phẩm Men có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
514,Liệt kê 10 thương hiệu Children được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10;"
515,Tổng doanh thu của Books tại bang KS năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999;"
516,"Hàng Men trả lại ở NC có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;"
517,Ai mua đồ Children nhiều nhất ở IL vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
518,So sánh lợi nhuận của Music giữa kênh Web và Web tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel;"
519,Tìm email của các khách hàng VIP ở MO đã mua đồ Children trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Children'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;"
520,Cửa hàng nào ở MO đứng đầu về doanh số Sports vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'MO'
  AND i.i_category = 'Sports'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
521,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Home tại MO.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10;"
522,Có bao nhiêu đơn hàng Children bị trả lại tại IA vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002;"
523,"Trong năm 2001, khách hàng ở MO mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
524,Check giùm tôi tồn kho của Sports ở chi nhánh VA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND w.w_state = 'VA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
525,Doanh số của Home tại TX năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'TX' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'TX' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
526,"Năm 1999, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
527,Tổng doanh thu của Sports tại bang GA năm 2001 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2001;"
528,Giá bán trung bình của mặt hàng Women trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND d.d_year = 2001
GROUP BY i.i_category;"
529,Ai mua đồ Sports nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
530,"Năm 2002, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
531,"Năm 2001, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
532,Tỷ lệ trả hàng của Books ở NC có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'NC'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Books' as category,
    'NC' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
533,Có bao nhiêu đơn hàng Men bị trả lại tại NC vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000;"
534,Cửa hàng nào ở KY đứng đầu về doanh số Children vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY'
  AND i.i_category = 'Children'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
535,Cửa hàng nào ở IA đứng đầu về doanh số Jewelry vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Jewelry'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
536,Tìm email của các khách hàng VIP ở IA đã mua đồ Men trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Men'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
537,Năm ngoái dân ở VA mua Women nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
538,Năm ngoái dân ở GA mua Men nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
539,Năm ngoái dân ở IA mua Music nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Music'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
540,Tổng doanh thu của Home tại bang GA năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'GA'
  AND d.d_year = 1999;"
541,"Trong năm 2001, khách hàng ở TX mua nhiều Men không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
542,Giá bán trung bình của mặt hàng Books trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 2000
GROUP BY i.i_category;"
543,Tổng doanh thu của Music tại bang NC năm 2002 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002;"
544,Khách hàng có bằng Secondary tại VA thường mua Books qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Books'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Books'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Books'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
545,Tổng doanh thu của Home tại bang KY năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'KY'
  AND d.d_year = 1999;"
546,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở TX.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
547,Tìm email của các khách hàng VIP ở KY đã mua đồ Sports trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
548,Tìm email của các khách hàng VIP ở IL đã mua đồ Home trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
549,Ai mua đồ Jewelry nhiều nhất ở IA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
550,Tìm 10 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
551,Doanh số của Sports tại VA năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'VA' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'VA' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
552,Liệt kê 5 thương hiệu Home được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
553,So sánh lợi nhuận của Music giữa kênh Catalog và Web tại NC.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
ORDER BY channel;"
554,Có bao nhiêu đơn hàng Men bị trả lại tại KY vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2000;"
555,Khách hàng có bằng 2 yr Degree tại KS thường mua Women qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
556,"Trong quý 4 năm 2001, nhóm khách hàng Secondary chi bao nhiêu tiền cho Books?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
557,Giá bán trung bình của mặt hàng Music trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 2002
GROUP BY i.i_category;"
558,Năm ngoái dân ở MO mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
559,Khách hàng có bằng 4 yr Degree tại KS thường mua Electronics qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
560,Tìm email của các khách hàng VIP ở GA đã mua đồ Music trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Music'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
561,"Trong quý 4 năm 1999, nhóm khách hàng Secondary chi bao nhiêu tiền cho Men?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
562,Tỷ lệ trả hàng của Women ở NC có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'NC'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Women' as category,
    'NC' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
563,Giá bán trung bình của mặt hàng Home trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY i.i_category;"
564,Khách hàng có bằng Advanced Degree tại KY thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
565,Liệt kê 3 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IL'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3;"
566,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ Advanced Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY cd.cd_education_status, i.i_category;"
567,Cho tôi xem danh sách sản phẩm Shoes bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
568,Liệt kê 5 thương hiệu Shoes được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
569,Tìm 3 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;"
570,"Trong năm 2001, khách hàng ở IL mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
571,Check giùm tôi tồn kho của Jewelry ở chi nhánh IL.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND w.w_state = 'IL'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
572,"Trong năm 2000, khách hàng ở NC mua nhiều Shoes không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY ca.ca_state, i.i_category;"
573,Có bao nhiêu đơn hàng Shoes bị trả lại tại TX vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001;"
574,"Năm 2002, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
575,"Hàng Children trả lại ở KS có nhiều không, xem số liệu năm 2002 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year;"
576,Check giùm tôi tồn kho của Home ở chi nhánh IA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND w.w_state = 'IA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
577,Tỷ lệ trả hàng của Men ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'VA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
578,"Trong năm 2000, khách hàng ở NC mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
GROUP BY ca.ca_state, i.i_category;"
579,Có bao nhiêu đơn hàng Electronics bị trả lại tại NC vào năm 1999?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;"
580,Tìm 5 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
581,Tìm 5 sản phẩm Sports có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
582,Năm ngoái dân ở IA mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
583,Khách hàng có bằng 4 yr Degree tại GA thường mua Sports qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
584,Tỷ lệ trả hàng của Electronics ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Electronics' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
585,Check giùm tôi tồn kho của Women ở chi nhánh IL.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND w.w_state = 'IL'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
586,Cửa hàng nào ở TX đứng đầu về doanh số Electronics vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX'
  AND i.i_category = 'Electronics'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
587,Doanh số của Women tại IA năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
588,Tìm email của các khách hàng VIP ở KS đã mua đồ Electronics trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Electronics'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
589,Giá bán trung bình của mặt hàng Books trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY i.i_category;"
590,Có bao nhiêu đơn hàng Men bị trả lại tại MO vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;"
591,Tìm 3 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;"
592,Thống kê tổng số lượng Men được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;"
593,Liệt kê 3 thương hiệu Music được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3;"
594,So sánh lợi nhuận của Sports giữa kênh Catalog và Web tại GA.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
ORDER BY channel;"
595,Có bao nhiêu đơn hàng Sports bị trả lại tại MO vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;"
596,Cửa hàng nào ở MO đứng đầu về doanh số Books vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'MO'
  AND i.i_category = 'Books'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
597,Tìm email của các khách hàng VIP ở IL đã mua đồ Jewelry trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
598,Check giùm tôi tồn kho của Electronics ở chi nhánh IA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'IA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
599,"Hàng Music trả lại ở KS có nhiều không, xem số liệu năm 1999 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year;"
600,Ai mua đồ Men nhiều nhất ở IL vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
601,Tổng doanh thu của Home tại bang NC năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;"
602,Năm ngoái dân ở IA mua Men nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
603,Cho tôi xem danh sách sản phẩm Men bán chạy nhất ở IA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
604,Cho tôi xem danh sách sản phẩm Men bán chạy nhất ở NC.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
605,Năm ngoái dân ở IL mua Books nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
606,Cửa hàng nào ở NC đứng đầu về doanh số Women vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'NC'
  AND i.i_category = 'Women'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
607,Năm 2002 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year;"
608,Doanh số của Electronics tại KS năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
609,Tỷ lệ trả hàng của Jewelry ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'IL'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'IL' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
610,Cửa hàng nào ở MO đứng đầu về doanh số Men vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'MO'
  AND i.i_category = 'Men'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
611,Ai mua đồ Books nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
612,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;"
613,Có bao nhiêu đơn hàng Men bị trả lại tại TX vào năm 1999?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999;"
614,Giá bán trung bình của mặt hàng Sports trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2001
 GROUP BY i.i_category;"
615,Ai mua đồ Electronics nhiều nhất ở TX vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
616,Ai mua đồ Shoes nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
617,Tìm email của các khách hàng VIP ở TX đã mua đồ Men trên 1000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Men'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC;"
618,"Trong quý 4 năm 2002, nhóm khách hàng Secondary chi bao nhiêu tiền cho Shoes?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2002
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
619,Giá bán trung bình của mặt hàng Jewelry trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
620,Cửa hàng nào ở VA đứng đầu về doanh số Home vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'VA'
  AND i.i_category = 'Home'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
621,Có bao nhiêu đơn hàng Children bị trả lại tại IL vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;"
622,"Trong năm 2001, khách hàng ở IA mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
623,"Hàng Women trả lại ở KY có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
624,Doanh số của Men tại GA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
625,Cửa hàng nào ở VA đứng đầu về doanh số Women vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'VA'
  AND i.i_category = 'Women'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
626,So sánh lợi nhuận của Music giữa kênh Catalog và Catalog tại TX.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel;"
627,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ College.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category;"
628,Giá bán trung bình của mặt hàng Women trong năm 2002 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND d.d_year = 2002
 GROUP BY i.i_category;"
629,Doanh số của Music tại KY năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
630,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Electronics tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
631,Cửa hàng nào ở IA đứng đầu về doanh số Women vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
632,Có bao nhiêu đơn hàng Music bị trả lại tại KS vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002;"
633,"Trong năm 2001, khách hàng ở MO mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
634,Tỷ lệ trả hàng của Shoes ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Shoes' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
635,"Trong quý 4 năm 2000, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Books?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
636,Thống kê tổng số lượng Home được mua bởi những khách hàng có trình độ College.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category;"
637,Có bao nhiêu đơn hàng Women bị trả lại tại TX vào năm 2000?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2000;"
638,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;"
639,"Hàng Home trả lại ở MO có nhiều không, xem số liệu năm 2001 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
640,Giá bán trung bình của mặt hàng Music trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 1999
 GROUP BY i.i_category;"
641,Tổng doanh thu của Jewelry tại bang NC năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;"
642,Tỷ lệ trả hàng của Shoes ở TX có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'TX'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Shoes' as category,
  'TX' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
643,"Trong năm 2000, khách hàng ở GA mua nhiều Children không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Children'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;"
644,Thống kê tổng số lượng Electronics được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
645,Tìm 10 sản phẩm Men có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
646,Có bao nhiêu đơn hàng Electronics bị trả lại tại MO vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2002;"
647,Khách hàng có bằng 4 yr Degree tại MO thường mua Sports qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
648,"Hàng Music trả lại ở KY có nhiều không, xem số liệu năm 2001 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
649,Tìm email của các khách hàng VIP ở NC đã mua đồ Music trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Music'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;"
650,Check giùm tôi tồn kho của Home ở chi nhánh GA.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND w.w_state = 'GA'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
651,Giá bán trung bình của mặt hàng Home trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY i.i_category;"
652,Tổng doanh thu của Shoes tại bang KY năm 2002 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002;"
653,Cho tôi xem danh sách sản phẩm Electronics bán chạy nhất ở IL.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
654,Cửa hàng nào ở VA đứng đầu về doanh số Home vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'VA'
  AND i.i_category = 'Home'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
655,"Hàng Home trả lại ở NC có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
656,Check giùm tôi tồn kho của Men ở chi nhánh KS.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND w.w_state = 'KS'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
657,Doanh số của Music tại NC năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'NC' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'NC' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
658,Doanh số của Home tại NC năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'NC' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'NC' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
659,Năm ngoái dân ở KS mua Books nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
660,So sánh lợi nhuận của Men giữa kênh Store và Catalog tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
 ORDER BY channel;"
661,"Hàng Home trả lại ở TX có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
662,"Năm 1999, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
663,Cửa hàng nào ở GA đứng đầu về doanh số Jewelry vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'GA'
  AND i.i_category = 'Jewelry'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
664,Ai mua đồ Men nhiều nhất ở KS vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
665,Liệt kê 10 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;"
666,Cho tôi xem danh sách sản phẩm Electronics bán chạy nhất ở KS.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
667,"Trong năm 2001, khách hàng ở KS mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
668,Tìm 3 sản phẩm Men có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 3;"
669,Có bao nhiêu đơn hàng Music bị trả lại tại TX vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002;"
670,Cửa hàng nào ở IL đứng đầu về doanh số Women vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'IL'
  AND i.i_category = 'Women'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
671,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Music tại KS.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
672,"Trong năm 2001, khách hàng ở GA mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Women'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
673,"Năm 2000, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
674,Check giùm tôi tồn kho của Women ở chi nhánh NC.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND w.w_state = 'NC'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
675,Check giùm tôi tồn kho của Men ở chi nhánh VA.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND w.w_state = 'VA'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
676,Ai mua đồ Children nhiều nhất ở MO vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'MO'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
677,"Trong năm 2001, khách hàng ở GA mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
678,Ai mua đồ Women nhiều nhất ở IL vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
679,Tỷ lệ trả hàng của Men ở MO có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'MO'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'MO' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
680,Năm 2001 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Catalog' as channel,
  SUM(cs.cs_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM catalog_sales cs
 JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year;"
681,Liệt kê 5 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5;"
682,Cho tôi xem danh sách sản phẩm Women bán chạy nhất ở IA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
683,Tỷ lệ trả hàng của Books ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Books' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
684,Khách hàng có bằng 4 yr Degree tại IA thường mua Music qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
685,Năm ngoái dân ở GA mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
686,"Trong quý 4 năm 1999, nhóm khách hàng Primary chi bao nhiêu tiền cho Children?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Primary'
  AND i.i_category = 'Children'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
687,Năm 2002 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year;"
688,Cửa hàng nào ở KS đứng đầu về doanh số Music vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'KS'
  AND i.i_category = 'Music'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
689,Doanh số của Electronics tại NC năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 2002
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 2001
 )
 SELECT 
  2002 as current_year,
  cy.revenue as current_revenue,
  2001 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
690,"Trong năm 2000, khách hàng ở MO mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;"
691,"Năm 2002, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
692,Doanh số của Music tại MO năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'MO' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'MO' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
693,Liệt kê 5 thương hiệu Shoes được ưa chuộng nhất bởi khách hàng ở TX.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5;"
694,Năm ngoái dân ở KS mua Women nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
695,Tổng doanh thu của Jewelry tại bang TX năm 2000 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2000;"
696,So sánh lợi nhuận của Sports giữa kênh Catalog và Web tại IL.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel;"
697,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
698,"Hàng Jewelry trả lại ở GA có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'GA'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
699,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Sports tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;"
700,Tỷ lệ trả hàng của Sports ở KY có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Sports' as category,
  'KY' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
701,Tìm 5 sản phẩm Electronics có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;"
702,Cho tôi xem danh sách sản phẩm Children bán chạy nhất ở KY.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
703,Năm 2001 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year;"
704,Tỷ lệ trả hàng của Women ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'VA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Women' as category,
  'VA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
705,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Jewelry tại KS.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
706,Ai mua đồ Children nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
707,Thống kê tổng số lượng Music được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
708,Tìm 10 sản phẩm Electronics có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
709,Khách hàng có bằng Primary tại KY thường mua Sports qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
710,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Secondary'
 GROUP BY cd.cd_education_status, i.i_category;"
711,Cửa hàng nào ở KS đứng đầu về doanh số Music vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'KS'
  AND i.i_category = 'Music'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
712,Cửa hàng nào ở VA đứng đầu về doanh số Sports vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'VA'
  AND i.i_category = 'Sports'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
713,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Men tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;"
714,Tìm email của các khách hàng VIP ở GA đã mua đồ Electronics trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;"
715,"Hàng Music trả lại ở TX có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
716,Khách hàng có bằng 4 yr Degree tại GA thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
717,Tổng doanh thu của Sports tại bang IL năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999;"
718,Thống kê tổng số lượng Shoes được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Secondary'
 GROUP BY cd.cd_education_status, i.i_category;"
719,So sánh lợi nhuận của Sports giữa kênh Web và Catalog tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
 ORDER BY channel;"
720,"Trong quý 4 năm 2001, nhóm khách hàng Secondary chi bao nhiêu tiền cho Home?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
721,Năm ngoái dân ở VA mua Men nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
722,Ai mua đồ Home nhiều nhất ở MO vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
723,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại KS.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
724,Năm 2001 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year;"
725,"Năm 2002, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
726,Ai mua đồ Electronics nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
727,"Trong quý 4 năm 2000, nhóm khách hàng College chi bao nhiêu tiền cho Children?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Children'
  AND d.d_year = 2000
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
728,Giá bán trung bình của mặt hàng Men trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 1999
 GROUP BY i.i_category;"
729,Tìm 10 sản phẩm Music có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
730,"Hàng Shoes trả lại ở IL có nhiều không, xem số liệu năm 2000 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
731,Giá bán trung bình của mặt hàng Women trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND d.d_year = 1999
 GROUP BY i.i_category;"
732,"Trong năm 2000, khách hàng ở KS mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;"
733,Ai mua đồ Jewelry nhiều nhất ở IL vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
734,"Trong quý 4 năm 1999, nhóm khách hàng Secondary chi bao nhiêu tiền cho Men?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
735,Check giùm tôi tồn kho của Women ở chi nhánh TX.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND w.w_state = 'TX'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
736,"Hàng Men trả lại ở KS có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
737,Cửa hàng nào ở IA đứng đầu về doanh số Sports vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'IA'
  AND i.i_category = 'Sports'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
738,Thống kê tổng số lượng Shoes được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
739,Tìm 5 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND d.d_year = 1999
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;"
740,Tìm email của các khách hàng VIP ở MO đã mua đồ Electronics trên 5000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC;"
741,Tìm email của các khách hàng VIP ở VA đã mua đồ Electronics trên 5000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC;"
742,Tìm email của các khách hàng VIP ở IL đã mua đồ Jewelry trên 1000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC;"
743,Giá bán trung bình của mặt hàng Jewelry trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
 GROUP BY i.i_category;"
744,So sánh lợi nhuận của Home giữa kênh Catalog và Catalog tại KY.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KY'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KY'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KY'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel;"
745,"Năm 2001, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
746,Năm ngoái dân ở IA mua Jewelry nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
747,Giá bán trung bình của mặt hàng Music trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
748,Cho tôi xem danh sách sản phẩm Sports bán chạy nhất ở KY.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
749,Check giùm tôi tồn kho của Home ở chi nhánh IA.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND w.w_state = 'IA'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
750,Liệt kê 10 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở KS.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;"
751,Ai mua đồ Books nhiều nhất ở IA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
752,"Trong năm 1999, khách hàng ở VA mua nhiều Electronics không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Electronics'
  AND d.d_year = 1999
 GROUP BY ca.ca_state, i.i_category;"
753,Giá bán trung bình của mặt hàng Electronics trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
 GROUP BY i.i_category;"
754,Tìm 10 sản phẩm Children có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
755,Doanh số của Electronics tại IA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
756,"Trong năm 2000, khách hàng ở KY mua nhiều Books không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;"
757,"Hàng Women trả lại ở MO có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'MO'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
758,"Hàng Home trả lại ở TX có nhiều không, xem số liệu năm 2001 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
759,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Music tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
760,So sánh lợi nhuận của Books giữa kênh Store và Web tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
761,"Trong năm 2002, khách hàng ở KY mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;"
762,Ai mua đồ Shoes nhiều nhất ở VA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'VA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
763,"Năm 1999, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
764,"Năm 2000, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
765,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại TX.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;"
766,Check giùm tôi tồn kho của Women ở chi nhánh GA.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND w.w_state = 'GA'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
767,Giá bán trung bình của mặt hàng Electronics trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
768,Năm ngoái dân ở IA mua Music nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Music'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
769,Có bao nhiêu đơn hàng Home bị trả lại tại MO vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;"
770,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;"
771,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại VA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'VA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
772,Doanh số của Jewelry tại NC năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'NC' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'NC' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
773,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Men tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
774,So sánh lợi nhuận của Music giữa kênh Catalog và Catalog tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel;"
775,Doanh số của Children tại NC năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'NC' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'NC' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
776,Năm 2000 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2000
 GROUP BY d.d_year;"
777,Doanh số của Music tại KY năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
778,Tìm 10 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
779,Liệt kê 3 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở KS.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;"
780,Cửa hàng nào ở MO đứng đầu về doanh số Books vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'MO'
  AND i.i_category = 'Books'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
781,Doanh số của Shoes tại IA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IA' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IA' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
782,Có bao nhiêu đơn hàng Home bị trả lại tại IL vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;"
783,So sánh lợi nhuận của Children giữa kênh Store và Web tại VA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
784,Tìm email của các khách hàng VIP ở TX đã mua đồ Jewelry trên 5000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Jewelry'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC;"
785,"Năm 2000, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
786,"Năm 1999, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
787,So sánh lợi nhuận của Women giữa kênh Store và Web tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
788,Tổng doanh thu của Jewelry tại bang IA năm 2002 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002;"
789,"Trong quý 4 năm 1999, nhóm khách hàng College chi bao nhiêu tiền cho Jewelry?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Jewelry'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
790,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;"
791,Năm ngoái dân ở GA mua Women nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
792,Có bao nhiêu đơn hàng Electronics bị trả lại tại IL vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;"
793,Năm 2002 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Catalog' as channel,
  SUM(cs.cs_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM catalog_sales cs
 JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year;"
794,"Trong quý 4 năm 2001, nhóm khách hàng Advanced Degree chi bao nhiêu tiền cho Sports?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Sports'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
795,Doanh số của Men tại VA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
796,Liệt kê 10 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở IA.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;"
797,Tổng doanh thu của Home tại bang IA năm 2001 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2001;"
798,Doanh số của Children tại VA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
799,Tỷ lệ trả hàng của Jewelry ở KS có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'KS'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'KS' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
800,"Trong năm 2001, khách hàng ở IA mua nhiều Shoes không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
801,So sánh lợi nhuận của Men giữa kênh Web và Web tại IL.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
 )
 SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
 ORDER BY channel;"
802,"Trong năm 2001, khách hàng ở NC mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Women'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
803,Khách hàng có bằng Advanced Degree tại MO thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
804,"Trong quý 4 năm 1999, nhóm khách hàng Advanced Degree chi bao nhiêu tiền cho Shoes?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Shoes'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
805,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND cd.cd_education_status = '4 yr Degree'
 GROUP BY cd.cd_education_status, i.i_category;"
806,Doanh số của Children tại KS năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
807,"Hàng Music trả lại ở IA có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
808,Tỷ lệ trả hàng của Men ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'VA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'VA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
809,Thống kê tổng số lượng Men được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
810,Có bao nhiêu đơn hàng Women bị trả lại tại MO vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;"
811,Năm ngoái dân ở KS mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
812,Tỷ lệ trả hàng của Men ở KS có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'KS' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
813,Cửa hàng nào ở IL đứng đầu về doanh số Books vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
814,Doanh số của Shoes tại NC năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
815,Giá bán trung bình của mặt hàng Men trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
816,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở NC.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
817,Cửa hàng nào ở IA đứng đầu về doanh số Books vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'IA'
  AND i.i_category = 'Books'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
818,"Hàng Home trả lại ở IA có nhiều không, xem số liệu năm 2000 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
819,Khách hàng có bằng 4 yr Degree tại IL thường mua Shoes qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
820,Ai mua đồ Children nhiều nhất ở IL vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
821,Ai mua đồ Sports nhiều nhất ở NC vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
822,Khách hàng có bằng Advanced Degree tại VA thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
823,"Trong năm 2002, khách hàng ở VA mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;"
824,Tổng doanh thu của Jewelry tại bang IA năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999;"
825,Liệt kê 10 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;"
826,Tìm email của các khách hàng VIP ở TX đã mua đồ Electronics trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;"
827,Tỷ lệ trả hàng của Women ở MO có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'MO'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Women' as category,
  'MO' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
828,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại IL.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
829,Cửa hàng nào ở MO đứng đầu về doanh số Sports vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'MO'
  AND i.i_category = 'Sports'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
830,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại KY.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;"
831,Liệt kê 3 thương hiệu Home được ưa chuộng nhất bởi khách hàng ở VA.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;"
832,Doanh số của Women tại NC năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'NC' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'NC' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
833,Giá bán trung bình của mặt hàng Sports trong năm 2002 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2002
 GROUP BY i.i_category;"
834,So sánh lợi nhuận của Books giữa kênh Store và Web tại TX.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
835,Thống kê tổng số lượng Sports được mua bởi những khách hàng có trình độ College.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category;"
836,Tỷ lệ trả hàng của Jewelry ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
837,Doanh số của Jewelry tại MO năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
838,Tìm email của các khách hàng VIP ở MO đã mua đồ Home trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;"
839,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở GA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'GA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
840,Năm ngoái dân ở IL mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
841,"Hàng Electronics trả lại ở KS có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
842,Tìm 10 sản phẩm Music có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
843,"Trong quý 4 năm 2001, nhóm khách hàng College chi bao nhiêu tiền cho Home?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
844,"Trong năm 2002, khách hàng ở VA mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Women'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;"
845,"Trong năm 2000, khách hàng ở IL mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Women'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;"
846,Tìm 3 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 1999
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 3;"
847,So sánh lợi nhuận của Shoes giữa kênh Store và Web tại MO.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
848,"Trong quý 4 năm 1999, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Women?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Women'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
849,So sánh lợi nhuận của Men giữa kênh Catalog và Web tại GA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel;"
850,Cửa hàng nào ở NC đứng đầu về doanh số Music vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'NC'
  AND i.i_category = 'Music'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
851,Có bao nhiêu đơn hàng Shoes bị trả lại tại KY vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002;"
852,Ai mua đồ Electronics nhiều nhất ở IA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
853,Khách hàng có bằng 2 yr Degree tại GA thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
854,Check giùm tôi tồn kho của Children ở chi nhánh MO.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND w.w_state = 'MO'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
855,Tìm 5 sản phẩm Children có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;"
856,Tổng doanh thu của Music tại bang NC năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;"
857,So sánh lợi nhuận của Books giữa kênh Catalog và Web tại TX.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel;"
858,Giá bán trung bình của mặt hàng Electronics trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2001
 GROUP BY i.i_category;"
859,Năm ngoái dân ở KY mua Jewelry nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
860,Năm ngoái dân ở NC mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
861,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ Advanced Degree.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Advanced Degree'
 GROUP BY cd.cd_education_status, i.i_category;"
862,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Women tại TX.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;"
863,Giá bán trung bình của mặt hàng Music trong năm 2002 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2002
 GROUP BY i.i_category;"
864,Liệt kê 3 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;"
865,Ai mua đồ Children nhiều nhất ở KY vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
866,"Hàng Music trả lại ở NC có nhiều không, xem số liệu năm 2000 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
867,Doanh số của Home tại KS năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
868,"Hàng Electronics trả lại ở NC có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
869,Tìm 5 sản phẩm Home có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;"
870,"Hàng Sports trả lại ở TX có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
871,Năm 1999 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 1999
 GROUP BY d.d_year;"
872,Có bao nhiêu đơn hàng Books bị trả lại tại MO vào năm 1999?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'MO'
  AND d.d_year = 1999;"
873,Tổng doanh thu của Music tại bang KY năm 2001 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2001;"
874,Cửa hàng nào ở KS đứng đầu về doanh số Books vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'KS'
  AND i.i_category = 'Books'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
875,Tổng doanh thu của Women tại bang NC năm 2000 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000;"
876,Liệt kê 5 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5;"
877,Khách hàng có bằng 2 yr Degree tại VA thường mua Women qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
878,Giá bán trung bình của mặt hàng Sports trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
879,"Trong năm 1999, khách hàng ở IA mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_year = 1999
 GROUP BY ca.ca_state, i.i_category;"
880,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = '4 yr Degree'
 GROUP BY cd.cd_education_status, i.i_category;"
881,"Trong năm 2002, khách hàng ở VA mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Men'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;"
882,Năm 1999 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 1999
 GROUP BY d.d_year;"
883,Khách hàng có bằng Advanced Degree tại IL thường mua Home qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
884,Năm ngoái dân ở IA mua Children nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
885,Tìm email của các khách hàng VIP ở IL đã mua đồ Women trên 1000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Women'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC;"
886,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Men tại IL.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;"
887,Cho tôi xem danh sách sản phẩm Women bán chạy nhất ở VA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
888,"Năm 2000, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
889,Khách hàng có bằng College tại KY thường mua Children qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
890,"Năm 1999, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
891,Liệt kê 3 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở VA.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;"
892,Năm 2000 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2000
 GROUP BY d.d_year;"
893,Khách hàng có bằng Secondary tại VA thường mua Sports qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
894,Khách hàng có bằng 4 yr Degree tại MO thường mua Men qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
895,"Trong quý 4 năm 2002, nhóm khách hàng 4 yr Degree chi bao nhiêu tiền cho Men?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '4 yr Degree'
  AND i.i_category = 'Men'
  AND d.d_year = 2002
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
896,Ai mua đồ Women nhiều nhất ở KY vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
897,Giá bán trung bình của mặt hàng Music trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2001
 GROUP BY i.i_category;"
898,Cửa hàng nào ở GA đứng đầu về doanh số Jewelry vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'GA'
  AND i.i_category = 'Jewelry'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
899,Tỷ lệ trả hàng của Books ở IA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Books' as category,
  'IA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
900,Có bao nhiêu đơn hàng Children bị trả lại tại IA vào năm 1999?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999;"
