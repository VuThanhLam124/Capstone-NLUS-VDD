id,question,sql_raw,sql_clean,exec_ok,has_rows,row_count_sample,col_count,error_type,error_message,exec_time_sec
1,Lấy thông tin định danh và họ tên khách hàng,"SELECT c_customer_id, c_first_name, c_last_name 
FROM customer;","SELECT c_customer_id, c_first_name, c_last_name 
FROM customer",True,True,50,3,,,0.0036890506744384766
3,Đếm tổng số lượng khách hàng trong bảng,"SELECT COUNT(*) AS total_customers 
FROM customer;","SELECT COUNT(*) AS total_customers 
FROM customer",True,True,1,1,,,0.0005769729614257812
4,Lọc danh sách khách hàng thân thiết,"SELECT c_first_name, c_last_name, c_email_address 
FROM customer 
WHERE c_preferred_cust_flag = 'Y';","SELECT c_first_name, c_last_name, c_email_address 
FROM customer 
WHERE c_preferred_cust_flag = 'Y'",True,True,50,3,,,0.0039136409759521484
5,Lấy ra danh sách các khách hàng hiện tại không nằm trong nhóm đối tượng khách hàng ưu tiên của cửa hàng,"SELECT c_first_name, c_last_name, c_email_address 
FROM customer 
WHERE c_preferred_cust_flag = 'N';","SELECT c_first_name, c_last_name, c_email_address 
FROM customer 
WHERE c_preferred_cust_flag = 'N'",True,True,50,3,,,0.002629518508911133
6,Đếm tổng tất cả khách hàng đến từ Mỹ,"SELECT COUNT(*) AS ""TOTAL CUSTOMER"" 
FROM customer 
WHERE c_birth_country = 'UNITED STATES';","SELECT COUNT(*) AS ""TOTAL CUSTOMER"" 
FROM customer 
WHERE c_birth_country = 'UNITED STATES'",True,True,1,1,,,0.0025026798248291016
7,Sắp xếp khách hàng theo năm sinh giảm dần,"SELECT c_first_name, c_last_name, c_birth_year 
FROM customer 
ORDER BY c_birth_year DESC;","SELECT c_first_name, c_last_name, c_birth_year 
FROM customer 
ORDER BY c_birth_year DESC",True,True,50,3,,,0.010833978652954102
8,Tìm các quốc gia khác nhau có trong dữ liệu,"SELECT DISTINCT c_birth_country 
FROM customer;","SELECT DISTINCT c_birth_country 
FROM customer",True,True,50,1,,,0.005101442337036133
9,Tìm các khách hàng đến từ Nhật Bản (JP),SELECT * FROM customer WHERE c_birth_country = 'JAPAN';,SELECT * FROM customer WHERE c_birth_country = 'JAPAN',True,True,50,18,,,0.013762950897216797
10,Có bao nhiêu khách hàng chưa cập nhật địa chỉ email?,SELECT COUNT(*) FROM customer WHERE c_email_address IS NULL;,SELECT COUNT(*) FROM customer WHERE c_email_address IS NULL,True,True,1,1,,,0.004310131072998047
12,Cho tôi xem 10 khách hàng trẻ tuổi nhất ,SELECT * FROM customer ORDER BY c_birth_year DESC LIMIT 10;,SELECT * FROM customer ORDER BY c_birth_year DESC LIMIT 10,True,True,10,18,,,0.003377676010131836
13,Những khách hàng nào có danh xưng là Tiến sĩ?,SELECT * FROM customer WHERE c_salutation = 'Dr.';,SELECT * FROM customer WHERE c_salutation = 'Dr.',True,True,50,18,,,0.0029137134552001953
14,Liệt kê những khách hàng sinh ra ở Vương quốc Anh (UK),SELECT * FROM customer WHERE c_birth_country = 'UNITED KINGDOM';,SELECT * FROM customer WHERE c_birth_country = 'UNITED KINGDOM',True,True,50,18,,,0.012508153915405273
15,Tìm các khách hàng sinh vào tháng 12,"SELECT c_first_name, c_last_name, c_birth_day 
FROM customer 
WHERE c_birth_month = 12;","SELECT c_first_name, c_last_name, c_birth_day 
FROM customer 
WHERE c_birth_month = 12",True,True,50,3,,,0.0025506019592285156
16,Thống kê số lượng khách hàng theo từng năm sinh,"SELECT c_birth_year, COUNT(*) 
FROM customer 
GROUP BY c_birth_year;","SELECT c_birth_year, COUNT(*) 
FROM customer 
GROUP BY c_birth_year",True,True,50,2,,,0.0009341239929199219
17,Tìm khách hàng có tên bắt đầu bằng chữ 'M',"SELECT c_first_name, c_last_name 
FROM customer 
WHERE c_first_name LIKE 'M%';","SELECT c_first_name, c_last_name 
FROM customer 
WHERE c_first_name LIKE 'M%'",True,True,50,2,,,0.0019164085388183594
18,Liệt kê các khách hàng có danh xưng là 'Ms.',"SELECT * FROM customer 
WHERE c_salutation = 'Ms.';","SELECT * FROM customer 
WHERE c_salutation = 'Ms.'",True,True,50,18,,,0.0065271854400634766
21,Tìm tất cả các khách hàng mà hiện nay thông tin tên đăng nhập đang bị để trống trong toàn bộ cơ sở dữ liệu,SELECT * FROM customer WHERE c_login IS NULL;,SELECT * FROM customer WHERE c_login IS NULL,True,True,50,18,,,0.012148141860961914
24,Truy vấn thông tin của những khách hàng có ngày sinh là ngày hai mươi hai ,SELECT * FROM customer WHERE c_birth_day = 22;,SELECT * FROM customer WHERE c_birth_day = 22,True,True,50,18,,,0.011283636093139648
25,"Tìm tất cả những khách hàng mà tên của họ bắt đầu bằng chữ ""B""",SELECT * FROM customer WHERE c_first_name LIKE 'B%';,SELECT * FROM customer WHERE c_first_name LIKE 'B%',True,True,50,18,,,0.007501363754272461
26,Thống kê xem có bao nhiêu khách hàng trong hệ thống của chúng ta sinh ra tại quốc gia Mỹ,SELECT COUNT(*) FROM customer WHERE c_birth_country = 'UNITED STATES';,SELECT COUNT(*) FROM customer WHERE c_birth_country = 'UNITED STATES',True,True,1,1,,,0.001596212387084961
27,Sắp xếp lại toàn bộ danh sách khách hàng trong hệ thống theo thứ tự của mã định danh khách hàng theo thứ tự tăng dần,SELECT * FROM customer ORDER BY c_customer_id;,SELECT * FROM customer ORDER BY c_customer_id,True,True,50,18,,,0.03200483322143555
30,Đếm xem có bao nhiêu sản phẩm thuộc danh mục Beauty mà tên thương hiệu của nó có chứa chữ Premium bên trong,SELECT COUNT(*) FROM item WHERE i_category = 'Beauty' AND i_brand LIKE '%Premium%';,SELECT COUNT(*) FROM item WHERE i_category = 'Beauty' AND i_brand LIKE '%Premium%',True,True,1,1,,,0.0009381771087646484
34,Tìm thông tin những người hiện tại đang có tình trạng hôn nhân là độc thân,SELECT * FROM customer_demographics WHERE cd_marital_status = 'S';,SELECT * FROM customer_demographics WHERE cd_marital_status = 'S',True,True,50,9,,,0.0012011528015136719
35,Có bao nhiêu khách hàng đang phải nuôi từ ba người phụ thuộc trở lên trong gia đình,SELECT COUNT(*) FROM customer_demographics WHERE cd_dep_count >= 3;,SELECT COUNT(*) FROM customer_demographics WHERE cd_dep_count >= 3,True,True,1,1,,,0.0011534690856933594
36,Liệt kê danh sách những khách hàng đang ở trạng thái góa vợ hoặc góa chồng và đang phải nuôi dưỡng một người phụ thuộc duy nhất trong gia đình,"SELECT * FROM customer_demographics 
WHERE cd_marital_status = 'W' AND cd_dep_count = 1","SELECT * FROM customer_demographics 
WHERE cd_marital_status = 'W' AND cd_dep_count = 1",True,True,50,9,,,0.0009222030639648438
37,Lọc ra danh sách những khách hàng hiện tại vẫn còn đang độc thân và có trình độ cao đẳng,SELECT * FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College';,SELECT * FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College',True,True,50,9,,,0.002485990524291992
42,Đếm xem có bao nhiêu khách hàng nam hiện đang độc thân và đã từng mua hàng lần đầu vào năm 2002,SELECT COUNT(*) FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND c_birth_year = 2002;,SELECT COUNT(*) FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND c_birth_year = 2002,True,True,1,1,,,0.0021064281463623047
43,Hiển thị thông tin tên đăng nhập của những khách hàng đã ly hôn và đang có từ ba người phụ thuộc trở lên trong gia đình.,SELECT c_login FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'D' AND cd_dep_count >= 3;,SELECT c_login FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'D' AND cd_dep_count >= 3,True,True,50,1,,,0.008136510848999023
46,Liệt kê mã định danh của những khách hàng đã lập gia đình và có ít nhất hai người con hiện đang theo học  cao đẳng,SELECT c_customer_id FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'M' AND cd_dep_college_count >= 2;,SELECT c_customer_id FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'M' AND cd_dep_college_count >= 2,True,True,50,1,,,0.009443998336791992
50,Đếm xem có bao nhiêu khách hàng là nam (M),"SELECT COUNT(*) 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE cd.cd_gender = 'M';","SELECT COUNT(*) 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE cd.cd_gender = 'M'",True,True,1,1,,,0.007729530334472656
51,Hiển thị tên khách hàng và trình độ học vấn của họ.,"SELECT c.c_first_name, cd.cd_education_status 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk;","SELECT c.c_first_name, cd.cd_education_status 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk",True,True,50,2,,,0.013822793960571289
52,Đếm tổng số khách hàng nữ có trình độ 'Advanced Degree'.,"SELECT COUNT(*) 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE cd.cd_gender = 'F' AND cd.cd_education_status = 'Advanced Degree';","SELECT COUNT(*) 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE cd.cd_gender = 'F' AND cd.cd_education_status = 'Advanced Degree'",True,True,1,1,,,0.007668256759643555
53,Tìm khách hàng nữ có tên bắt đầu bằng chữ 'M' kèm theo trình độ học vấn của họ.,"SELECT c.c_first_name, cd.cd_education_status 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE c.c_first_name LIKE 'M%' AND cd.cd_gender = 'F';","SELECT c.c_first_name, cd.cd_education_status 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE c.c_first_name LIKE 'M%' AND cd.cd_gender = 'F'",True,True,50,2,,,0.006291866302490234
54,Liệt kê khách hàng sống tại bang 'California' (CA),"SELECT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk 
WHERE ca.ca_state = 'CA';","SELECT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk 
WHERE ca.ca_state = 'CA'",True,True,50,2,,,0.004473209381103516
55,Tìm các khách hàng nữ sống tại bang 'NY' đã từng mua hàng.,"SELECT DISTINCT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE cd.cd_gender = 'F' AND ca.ca_state = 'NY';","SELECT DISTINCT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE cd.cd_gender = 'F' AND ca.ca_state = 'NY'",True,True,50,2,,,0.014257192611694336
56,Liệt kê tên khách hàng và thu nhập bình quân của họ (Income Band).,"SELECT c.c_first_name, ib.ib_lower_bound, ib.ib_upper_bound 
FROM customer c 
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk 
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk;","SELECT c.c_first_name, ib.ib_lower_bound, ib.ib_upper_bound 
FROM customer c 
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk 
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk",True,True,50,3,,,0.0025539398193359375
57,Tìm những khách hàng đã mua hàng và được giảm giá trên 100 đô la.,"SELECT DISTINCT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE ss.ss_ext_discount_amt > 100;","SELECT DISTINCT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE ss.ss_ext_discount_amt > 100",True,True,50,2,,,0.02346014976501465
58,Tính tổng số tiền mà khách hàng 'Billy Chen' đã chi tiêu.,"SELECT SUM(ss.ss_sales_price) 
FROM customer c 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE c.c_first_name = 'Billy' AND c.c_last_name = 'Chen';","SELECT SUM(ss.ss_sales_price) 
FROM customer c 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE c.c_first_name = 'Billy' AND c.c_last_name = 'Chen'",True,True,1,1,,,0.006198883056640625
59,Liệt kê khách hàng có từ 2 xe ô tô trở lên (Vehicle count).,"SELECT c.c_first_name, hd.hd_vehicle_count 
FROM customer c 
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk 
WHERE hd.hd_vehicle_count > 2;","SELECT c.c_first_name, hd.hd_vehicle_count 
FROM customer c 
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk 
WHERE hd.hd_vehicle_count > 2",True,True,50,2,,,0.0038177967071533203
60,Liệt kê những khách hàng đã chi tiêu tổng cộng hơn 5000 đô la tại các cửa hàng.,"SELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) as total_spent
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
HAVING total_spent > 5000;","SELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) as total_spent
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
HAVING total_spent > 5000",True,True,3,3,,,0.03912353515625
61,Tìm các khách hàng ở bang 'CA' đã mua hàng trong cả hai năm 2000 và 2001,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'CA'
AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2000)
AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2001);","SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'CA'
AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2000)
AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2001)",True,True,50,2,,,0.01326131820678711
62,Tìm tên khách hàng đã trả lại hàng với tổng giá trị hoàn lại lớn nhất.,"SELECT c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_returned_value
FROM customer c
JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_returned_value DESC
LIMIT 1;","SELECT c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_returned_value
FROM customer c
JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_returned_value DESC
LIMIT 1",True,True,1,3,,,0.02861189842224121
63,Tìm khách hàng có thu nhập cao (trên 150.000) nhưng chỉ sở hữu tối đa 1 xe ô tô.,"SELECT c.c_first_name, c.c_last_name, ib.ib_upper_bound, hd.hd_vehicle_count
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_upper_bound > 150000 AND hd.hd_vehicle_count <= 1;","SELECT c.c_first_name, c.c_last_name, ib.ib_upper_bound, hd.hd_vehicle_count
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_upper_bound > 150000 AND hd.hd_vehicle_count <= 1",True,True,50,4,,,0.0068132877349853516
64,Liệt kê những khách hàng chi tiêu trên Web nhiều hơn chi tiêu tại Cửa hàng,"SELECT c.c_first_name, 
       SUM(ws.ws_sales_price) as web_spend, 
       (SELECT SUM(ss_sales_price) FROM store_sales ss WHERE ss.ss_customer_sk = c.c_customer_sk) as store_spend
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name
HAVING web_spend > store_spend;","SELECT c.c_first_name, 
       SUM(ws.ws_sales_price) as web_spend, 
       (SELECT SUM(ss_sales_price) FROM store_sales ss WHERE ss.ss_customer_sk = c.c_customer_sk) as store_spend
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name
HAVING web_spend > store_spend",True,True,50,3,,,0.04494190216064453
65,"Tìm những khách hàng ""trung thành"" đã mua hàng ở cả 3 kênh: Cửa hàng, Web và Catalog","SELECT c.c_first_name, c.c_last_name
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss WHERE ss.ss_customer_sk = c.c_customer_sk)
  AND EXISTS (SELECT 1 FROM web_sales ws WHERE ws.ws_bill_customer_sk = c.c_customer_sk)
  AND EXISTS (SELECT 1 FROM catalog_sales cs WHERE cs.cs_bill_customer_sk = c.c_customer_sk);","SELECT c.c_first_name, c.c_last_name
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss WHERE ss.ss_customer_sk = c.c_customer_sk)
  AND EXISTS (SELECT 1 FROM web_sales ws WHERE ws.ws_bill_customer_sk = c.c_customer_sk)
  AND EXISTS (SELECT 1 FROM catalog_sales cs WHERE cs.cs_bill_customer_sk = c.c_customer_sk)",True,True,50,2,,,0.05063962936401367
66,Tính tổng doanh thu từ kênh Catalog cho những khách hàng sống ở bang 'Texas' (TX),"SELECT SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX';","SELECT SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'",True,True,1,1,,,0.0062408447265625
68,Ai là người trả hàng nhiều nhất vì lý do đồ bị hỏng (damaged)?,"SELECT c.c_first_name, COUNT(*) AS damaged_returns
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%damaged%'
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY damaged_returns DESC
LIMIT 1;","SELECT c.c_first_name, COUNT(*) AS damaged_returns
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%damaged%'
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY damaged_returns DESC
LIMIT 1",True,True,1,2,,,0.006612300872802734
69,"Tìm cho tôi mấy khách hàng nữ, độc thân, mà tiêu tiền trên web nhiều hơn ở cửa hàng.","SELECT c.c_first_name, 
       SUM(ws.ws_sales_price) AS total_web,
       (SELECT SUM(ss_sales_price) FROM store_sales ss WHERE ss.ss_customer_sk = c.c_customer_sk) AS total_store
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
WHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'S'
GROUP BY c.c_customer_sk, c.c_first_name
HAVING total_web > total_store;","SELECT c.c_first_name, 
       SUM(ws.ws_sales_price) AS total_web,
       (SELECT SUM(ss_sales_price) FROM store_sales ss WHERE ss.ss_customer_sk = c.c_customer_sk) AS total_store
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
WHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'S'
GROUP BY c.c_customer_sk, c.c_first_name
HAVING total_web > total_store",True,True,50,3,,,0.0304257869720459
70,Những khách hàng nào sống ở cùng thành phố với kho hàng (Warehouse) mà họ mua đồ?,"SELECT DISTINCT c.c_first_name, ca.ca_city
FROM web_sales ws
JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk
WHERE ca.ca_city = w.w_city;","SELECT DISTINCT c.c_first_name, ca.ca_city
FROM web_sales ws
JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk
WHERE ca.ca_city = w.w_city",True,True,50,2,,,0.013208866119384766
71,"Trong năm 2001, mấy bà khách nữ đã kết hôn thường hay mua loại hàng (category) gì nhất?","SELECT i.i_category, COUNT(*) AS total_bought
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'M' AND d.d_year = 2001
GROUP BY i.i_category
ORDER BY total_bought DESC LIMIT 1;","SELECT i.i_category, COUNT(*) AS total_bought
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'F' AND cd.cd_marital_status = 'M' AND d.d_year = 2001
GROUP BY i.i_category
ORDER BY total_bought DESC LIMIT 1",True,True,1,2,,,0.030786752700805664
72,Tính xem tỷ lệ khách hàng có dùng mã khuyến mãi (promotion) khi mua đồ điện tử là bao nhiêu?,"SELECT 
  (SELECT COUNT(*) FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics' AND ss.ss_promo_sk IS NOT NULL) * 100.0 / 
  (SELECT COUNT(*) FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics') AS promo_ratio;","SELECT 
  (SELECT COUNT(*) FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics' AND ss.ss_promo_sk IS NOT NULL) * 100.0 / 
  (SELECT COUNT(*) FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics') AS promo_ratio",True,True,1,1,,,0.008260250091552734
74,Tính doanh thu từ mấy món đồ thuộc loại 'Jewelry' (Trang sức) bán cho khách hàng ở bang 'Texas'.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX';","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'",True,True,1,1,,,0.01731133460998535
76,Thành phố nào có tổng lợi nhuận từ kênh Web cao hơn 1000 đô trong năm 2000?,"SELECT ca.ca_city, SUM(ws.ws_net_profit) AS web_profit
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY ca.ca_city
HAVING web_profit > 1000;","SELECT ca.ca_city, SUM(ws.ws_net_profit) AS web_profit
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY ca.ca_city
HAVING web_profit > 1000",True,True,50,2,,,0.05325460433959961
77,"Trong quý 1 năm 2000, loại hàng (category) nào bán chạy nhất trên trang web?","SELECT i.i_category, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1
GROUP BY i.i_category
ORDER BY total_qty DESC
LIMIT 1;","SELECT i.i_category, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1
GROUP BY i.i_category
ORDER BY total_qty DESC
LIMIT 1",True,True,1,2,,,0.011601686477661133
78,Lấy cho tôi 5 mặt hàng đắt nhất nhưng lại được khách hàng sinh trước năm 1960 hay mua.,"SELECT i.i_item_desc, i.i_current_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE c.c_birth_year < 1960
GROUP BY i.i_item_desc, i.i_current_price
ORDER BY i.i_current_price DESC
LIMIT 5;","SELECT i.i_item_desc, i.i_current_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE c.c_birth_year < 1960
GROUP BY i.i_item_desc, i.i_current_price
ORDER BY i.i_current_price DESC
LIMIT 5",True,True,5,2,,,0.0627894401550293
79,Cho tôi biết tên 5 khách hàng nữ chi tiêu 'mạnh tay' nhất cho đồ điện tử trong năm 2002,"SELECT c.c_first_name, SUM(ss.ss_sales_price) AS electronics_spend
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'F' 
  AND i.i_category = 'Electronics' 
  AND d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY electronics_spend DESC
LIMIT 5;","SELECT c.c_first_name, SUM(ss.ss_sales_price) AS electronics_spend
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'F' 
  AND i.i_category = 'Electronics' 
  AND d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY electronics_spend DESC
LIMIT 5",True,True,5,2,,,0.024208545684814453
80,Thử tìm giúp tôi mấy khách hàng nào hay mua sắm vào đúng cái tháng sinh nhật của họ,"SELECT DISTINCT c.c_first_name, c.c_last_name, c.c_birth_month
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE c.c_birth_month = d.d_moy;","SELECT DISTINCT c.c_first_name, c.c_last_name, c.c_birth_month
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE c.c_birth_month = d.d_moy",True,True,50,3,,,0.0241243839263916
81,"""Mấy ông khách nào có trên 3 cái xe hơi thì thường hay chi tiền vào loại hàng (category) nào nhiều nhất?","SELECT i.i_category, COUNT(*) AS purchase_count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count > 3
GROUP BY i.i_category
ORDER BY purchase_count DESC;","SELECT i.i_category, COUNT(*) AS purchase_count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count > 3
GROUP BY i.i_category
ORDER BY purchase_count DESC",True,True,11,2,,,0.012318849563598633
82,Liệt kê cho tôi mấy khách hàng nào mua hàng nhiều nhất vào các ngày Thứ Bảy.,"SELECT c.c_first_name, COUNT(*) AS saturday_purchases
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Saturday'
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY saturday_purchases DESC
LIMIT 10;","SELECT c.c_first_name, COUNT(*) AS saturday_purchases
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Saturday'
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY saturday_purchases DESC
LIMIT 10",True,True,10,2,,,0.018488168716430664
83,Lọc ra mấy người mua đồ 'Jewelry' (Trang sức) mà có dùng mã giảm giá (promotion),"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry' AND ss.ss_promo_sk IS NOT NULL;","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry' AND ss.ss_promo_sk IS NOT NULL",True,True,50,2,,,0.048737525939941406
84,Tìm xem có khách hàng nào đã mua cùng một món đồ ở cả hai kênh Store và Web không.,"SELECT DISTINCT c.c_first_name, i.i_item_desc
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE EXISTS (
    SELECT 1 FROM web_sales ws 
    WHERE ws.ws_bill_customer_sk = c.c_customer_sk 
    AND ws.ws_item_sk = i.i_item_sk
);","SELECT DISTINCT c.c_first_name, i.i_item_desc
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE EXISTS (
    SELECT 1 FROM web_sales ws 
    WHERE ws.ws_bill_customer_sk = c.c_customer_sk 
    AND ws.ws_item_sk = i.i_item_sk
)",True,True,50,2,,,0.04992318153381348
85,Tính tổng tiền thuế (sales tax) thu được từ nhóm khách hàng có thu nhập dưới 50.000.,"SELECT SUM(ss.ss_ext_tax)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_upper_bound < 50000;","SELECT SUM(ss.ss_ext_tax)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_upper_bound < 50000",True,True,1,1,,,0.008525371551513672
86,Lấy danh sách 5 mặt hàng được khách hàng nam mua nhiều nhất trên Web vào quý 1.,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'M' AND d.d_qoy = 1
GROUP BY i.i_item_desc
ORDER BY total_qty DESC LIMIT 5;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'M' AND d.d_qoy = 1
GROUP BY i.i_item_desc
ORDER BY total_qty DESC LIMIT 5",True,True,5,2,,,0.020241975784301758
88,Mấy món đồ nào bị trả lại nhiều nhất vì khách hàng 'không ưng ý' (did not like) trong tháng 12?,"SELECT i.i_item_desc, COUNT(*) AS count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc ILIKE '%did not like%' AND d.d_moy = 12
GROUP BY i.i_item_desc
ORDER BY count DESC;","SELECT i.i_item_desc, COUNT(*) AS count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc ILIKE '%did not like%' AND d.d_moy = 12
GROUP BY i.i_item_desc
ORDER BY count DESC",True,True,50,2,,,0.007504701614379883
89,"Tìm 5 khách hàng có giá trị đơn hàng trung bình (Average Order Value) cao nhất, tính trên cả hai kênh Store và Web","SELECT c.c_first_name, c.c_last_name, AVG(all_sales.sales_price) AS avg_order_value
FROM customer c
JOIN (
    SELECT ss_customer_sk AS customer_sk, ss_sales_price AS sales_price FROM store_sales
    UNION ALL
    SELECT ws_bill_customer_sk AS customer_sk, ws_sales_price AS sales_price FROM web_sales
) all_sales ON c.c_customer_sk = all_sales.customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY avg_order_value DESC
LIMIT 5;","SELECT c.c_first_name, c.c_last_name, AVG(all_sales.sales_price) AS avg_order_value
FROM customer c
JOIN (
    SELECT ss_customer_sk AS customer_sk, ss_sales_price AS sales_price FROM store_sales
    UNION ALL
    SELECT ws_bill_customer_sk AS customer_sk, ws_sales_price AS sales_price FROM web_sales
) all_sales ON c.c_customer_sk = all_sales.customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY avg_order_value DESC
LIMIT 5",True,True,5,3,,,0.0455164909362793
90,"Liệt kê các khách hàng đã mua hàng liên tiếp trong cả 3 năm 2000, 2001 và 2002 tại kênh Store.","SELECT c.c_first_name, c.c_last_name
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
  AND EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
  AND EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002);","SELECT c.c_first_name, c.c_last_name
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
  AND EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
  AND EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)",True,True,50,2,,,0.06047701835632324
91,Tìm danh mục sản phẩm (Category) có tỷ lệ trả hàng (Return Rate) cao nhất so với số lượng bán ra trong quý 1 năm 2002,"SELECT i.i_category, 
       SUM(sr.sr_return_quantity) * 100.0 / SUM(ss.ss_quantity) AS return_rate
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1
GROUP BY i.i_category
ORDER BY return_rate DESC;","SELECT i.i_category, 
       SUM(sr.sr_return_quantity) * 100.0 / SUM(ss.ss_quantity) AS return_rate
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1
GROUP BY i.i_category
ORDER BY return_rate DESC",True,True,11,2,,,0.021733522415161133
92,So sánh sự thay đổi về doanh thu của loại hàng 'Electronics' giữa tháng 11 và tháng 12 năm 2001,"SELECT d.d_moy, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2001 AND d.d_moy IN (11, 12)
GROUP BY d.d_moy
ORDER BY d.d_moy;","SELECT d.d_moy, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2001 AND d.d_moy IN (11, 12)
GROUP BY d.d_moy
ORDER BY d.d_moy",True,True,2,2,,,0.006348609924316406
93,Tính tổng lợi nhuận từ những khách hàng mua hàng tại các cửa hàng (Store) nằm ngoài bang nơi họ đang cư trú,"SELECT SUM(ss.ss_net_profit) AS out_of_state_profit
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE ca.ca_state <> s.s_state;","SELECT SUM(ss.ss_net_profit) AS out_of_state_profit
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE ca.ca_state <> s.s_state",True,True,1,1,,,0.09939408302307129
94,Liệt kê 5 mặt hàng có doanh số bán ra cao nhất trong các ngày lễ (Holiday = 'Y') của năm 2001.,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS holiday_sales
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY holiday_sales DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(ss.ss_quantity) AS holiday_sales
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY holiday_sales DESC
LIMIT 5",True,True,5,2,,,0.00910329818725586
95,Tìm các khách hàng đã mua đồng thời các mặt hàng từ hai danh mục 'Men' và 'Women' trong cùng một đơn hàng (Ticket number).,"SELECT ss.ss_ticket_number, c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category IN ('Men', 'Women')
GROUP BY ss.ss_ticket_number, c.c_first_name, c.c_last_name
HAVING COUNT(DISTINCT i.i_category) = 2;","SELECT ss.ss_ticket_number, c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category IN ('Men', 'Women')
GROUP BY ss.ss_ticket_number, c.c_first_name, c.c_last_name
HAVING COUNT(DISTINCT i.i_category) = 2",True,True,50,3,,,0.04141545295715332
96,"Thống kê xem khách hàng nam và nữ, nhóm nào hay đi mua sắm ở cửa hàng hơn vào ngày Thứ Hai?","SELECT cd.cd_gender, COUNT(*) AS visit_count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Monday'
GROUP BY cd.cd_gender;","SELECT cd.cd_gender, COUNT(*) AS visit_count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Monday'
GROUP BY cd.cd_gender",True,True,2,2,,,0.03062891960144043
97,Có bao nhiêu khách hàng độc thân đã từng mua hàng qua kênh Catalog trong năm 2002?,"SELECT COUNT(DISTINCT c.c_customer_sk)
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE cd.cd_marital_status = 'S' AND d.d_year = 2002;","SELECT COUNT(DISTINCT c.c_customer_sk)
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE cd.cd_marital_status = 'S' AND d.d_year = 2002",True,True,1,1,,,0.03794145584106445
98,Cho tôi biết 3 loại hàng hóa (category) được khách hàng có trình độ học vấn 'Secondary' mua nhiều nhất.,"SELECT i.i_category, COUNT(*) AS total_count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_education_status = 'Secondary'
GROUP BY i.i_category
ORDER BY total_count DESC LIMIT 3;","SELECT i.i_category, COUNT(*) AS total_count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_education_status = 'Secondary'
GROUP BY i.i_category
ORDER BY total_count DESC LIMIT 3",True,True,3,2,,,0.025472402572631836
99,Tìm những khách hàng sinh trước năm 1970 sống tại bang New York đã từng mua hàng ở cửa hàng,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
WHERE c.c_birth_year < 1970 AND ca.ca_state = 'NY';","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
WHERE c.c_birth_year < 1970 AND ca.ca_state = 'NY'",True,True,50,2,,,0.008178472518920898
100,Tìm 5 mặt hàng thuộc loại 'Sports' (Thể thao) có doanh thu cao nhất trên trang web,"SELECT i.i_item_desc, SUM(ws.ws_sales_price) AS revenue
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY revenue DESC LIMIT 5;","SELECT i.i_item_desc, SUM(ws.ws_sales_price) AS revenue
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY revenue DESC LIMIT 5",True,True,5,2,,,0.00755000114440918
101,Thống kê doanh thu bán hàng qua Web theo từng tháng của năm 2000,"SELECT d.d_moy, SUM(ws.ws_sales_price) AS monthly_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d_moy;","SELECT d.d_moy, SUM(ws.ws_sales_price) AS monthly_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d_moy",True,True,12,2,,,0.003888845443725586
102,Cho tôi biết tên cửa hàng có doanh thu cao nhất trong tháng 12 năm 2000,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12
GROUP BY s.s_store_name
ORDER BY revenue DESC LIMIT 1;","SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12
GROUP BY s.s_store_name
ORDER BY revenue DESC LIMIT 1",True,True,1,2,,,0.006865262985229492
103,Có bao nhiêu giao dịch tại cửa hàng đã sử dụng mã khuyến mãi 'Summer Special'?,"SELECT COUNT(*) 
FROM store_sales ss
JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk
WHERE p.p_promo_name = 'Summer Special';","SELECT COUNT(*) 
FROM store_sales ss
JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk
WHERE p.p_promo_name = 'Summer Special'",True,True,1,1,,,0.0011174678802490234
104,Liệt kê 5 mặt hàng có giá niêm yết (current price) cao nhất thuộc danh mục 'Books' (Sách).,"SELECT i_item_desc, i_current_price
FROM item
WHERE i_category = 'Books'
ORDER BY i_current_price DESC LIMIT 5;","SELECT i_item_desc, i_current_price
FROM item
WHERE i_category = 'Books'
ORDER BY i_current_price DESC LIMIT 5",True,True,5,2,,,0.002410411834716797
106,Tính tổng doanh thu từ các mặt hàng được bán vào các ngày lễ (Holiday) trong năm 2001.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y' AND d.d_year = 2001;","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y' AND d.d_year = 2001",True,True,1,1,,,0.003373861312866211
107,Liệt kê tên những khách hàng có từ 2 xe hơi trở lên và đã từng trả hàng tại cửa hàng.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk
WHERE hd.hd_vehicle_count >= 2;","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk
WHERE hd.hd_vehicle_count >= 2",True,True,50,2,,,0.01325082778930664
108,Tìm khách hàng sống ở bang Texas (TX) mà có gia đình đông người (trên 4 người phụ thuộc).,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE ca.ca_state = 'TX' AND hd.hd_dep_count > 4;","SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE ca.ca_state = 'TX' AND hd.hd_dep_count > 4",True,True,50,2,,,0.0048999786376953125
109,Lấy tên khách hàng đã thực hiện giao dịch có giá trị lớn nhất trên hệ thống Catalog,"SELECT c.c_first_name, c.c_last_name, cs.cs_sales_price
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
ORDER BY cs.cs_sales_price DESC LIMIT 1;","SELECT c.c_first_name, c.c_last_name, cs.cs_sales_price
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
ORDER BY cs.cs_sales_price DESC LIMIT 1",True,True,1,3,,,0.010511636734008789
110,Tìm những khách hàng mua đồ qua Web mà có địa chỉ nhận hàng khác hoàn toàn với địa chỉ thanh toán.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
WHERE ws.ws_bill_addr_sk <> ws.ws_ship_addr_sk;","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
WHERE ws.ws_bill_addr_sk <> ws.ws_ship_addr_sk",True,True,50,2,,,0.06979560852050781
111,Liệt kê 5 thành phố có số lượng khách hàng nữ sinh sống đông nhất.,"SELECT ca.ca_city, COUNT(*) AS female_count
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F'
GROUP BY ca.ca_city
ORDER BY female_count DESC LIMIT 5;","SELECT ca.ca_city, COUNT(*) AS female_count
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F'
GROUP BY ca.ca_city
ORDER BY female_count DESC LIMIT 5",True,True,5,2,,,0.01698923110961914
113,Thống kê xem kho hàng (Warehouse) nào đang xử lý nhiều đơn hàng nhất cho kênh Catalog.,"SELECT w.w_warehouse_name, COUNT(*) AS order_count
FROM catalog_sales cs
JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk
GROUP BY w.w_warehouse_name
ORDER BY order_count DESC;","SELECT w.w_warehouse_name, COUNT(*) AS order_count
FROM catalog_sales cs
JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk
GROUP BY w.w_warehouse_name
ORDER BY order_count DESC",True,True,5,2,,,0.012465953826904297
114,"Trong loại hàng 'Electronics' (Điện tử), món đồ nào có giá niêm yết cao nhất hiện nay?","SELECT i_item_desc, i_current_price
FROM item
WHERE i_category = 'Electronics'
ORDER BY i_current_price DESC
LIMIT 1;","SELECT i_item_desc, i_current_price
FROM item
WHERE i_category = 'Electronics'
ORDER BY i_current_price DESC
LIMIT 1",True,True,1,2,,,0.0016407966613769531
115,Tính tổng doanh thu từ nhóm hàng 'dresses' (váy) bán cho khách hàng ở bang New York (NY).,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
WHERE i.i_class = 'dresses' AND ca.ca_state = 'NY';","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
WHERE i.i_class = 'dresses' AND ca.ca_state = 'NY'",True,True,1,1,,,0.005379676818847656
116,Tìm 5 mặt hàng thuộc nhóm 'Books' (Sách) mà khách hàng nam thường hay mua nhất.,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Books' AND cd.cd_gender = 'M'
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Books' AND cd.cd_gender = 'M'
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.04264950752258301
117,So sánh doanh thu bán hàng tại cửa hàng giữa ca sáng (8h-12h) và ca chiều (13h-18h).,"SELECT 
  CASE WHEN t.t_hour BETWEEN 8 AND 12 THEN 'Morning'
       WHEN t.t_hour BETWEEN 13 AND 18 THEN 'Afternoon'
       ELSE 'Other' END AS shift,
  SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
GROUP BY shift;","SELECT 
  CASE WHEN t.t_hour BETWEEN 8 AND 12 THEN 'Morning'
       WHEN t.t_hour BETWEEN 13 AND 18 THEN 'Afternoon'
       ELSE 'Other' END AS shift,
  SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
GROUP BY shift",True,True,3,2,,,0.0212554931640625
118,Những khách hàng nào đã mua sắm liên tục vào các ngày cuối tuần trong tháng 12 năm 2000?,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12 AND d.d_day_name IN ('Saturday', 'Sunday');","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12 AND d.d_day_name IN ('Saturday', 'Sunday')",True,True,50,2,,,0.010164022445678711
121,Thống kê cho tôi xem danh sách khách hàng nam hay nữ hay đi mua sắm  vào ngày Thứ Bảy trong tuần?,"SELECT cd.cd_gender, COUNT(*) AS visit_count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Saturday'
GROUP BY cd.cd_gender;","SELECT cd.cd_gender, COUNT(*) AS visit_count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Saturday'
GROUP BY cd.cd_gender",True,True,2,2,,,0.027294397354125977
122,Tìm mấy ông khách hàng sinh năm 1980 sống ở bang California (CA) mà có trên 2 xe ô tô.,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE c.c_birth_year = 1980 AND ca.ca_state = 'CA' AND hd.hd_vehicle_count > 2;","SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE c.c_birth_year = 1980 AND ca.ca_state = 'CA' AND hd.hd_vehicle_count > 2",True,True,6,2,,,0.004302978515625
123,Cho tôi biết 3 loại hàng (category) nào mang lại doanh thu cao nhất trên kênh Catalog.,"SELECT i.i_category, SUM(cs.cs_sales_price) AS total_revenue
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
GROUP BY i.i_category
ORDER BY total_revenue DESC LIMIT 3;","SELECT i.i_category, SUM(cs.cs_sales_price) AS total_revenue
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
GROUP BY i.i_category
ORDER BY total_revenue DESC LIMIT 3",True,True,3,2,,,0.011167764663696289
125,Tìm 5 mặt hàng thuộc nhóm 'Sports' bị khách hàng trả lại nhiều nhất ở cửa hàng.,"SELECT i.i_item_desc, COUNT(*) AS return_count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC LIMIT 5;","SELECT i.i_item_desc, COUNT(*) AS return_count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC LIMIT 5",True,True,5,2,,,0.004789829254150391
126,"Trong quý 1 năm 2000, có bao nhiêu khách hàng đã dùng mã giảm giá để mua đồ trên Web?","SELECT COUNT(DISTINCT ws_bill_customer_sk)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1 AND ws_promo_sk IS NOT NULL;","SELECT COUNT(DISTINCT ws_bill_customer_sk)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1 AND ws_promo_sk IS NOT NULL",True,True,1,1,,,0.004413127899169922
127,Hãy thống kê xem các trang Catalog có mô tả chi tiết thường mang lại doanh số cao hơn bao nhiêu so với các trang thông thường,"SELECT cp.cp_description, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
GROUP BY cp.cp_description;","SELECT cp.cp_description, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
GROUP BY cp.cp_description",True,True,50,2,,,0.016479969024658203
129,Tìm thành phố có nhiều khách hàng 'VIP' nhất (thu nhập mức cao nhất),"SELECT ca.ca_city, COUNT(*) AS vip_count
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE hd.hd_income_band_sk = (SELECT MAX(ib_income_band_sk) FROM income_band)
GROUP BY ca.ca_city
ORDER BY vip_count DESC LIMIT 1;","SELECT ca.ca_city, COUNT(*) AS vip_count
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE hd.hd_income_band_sk = (SELECT MAX(ib_income_band_sk) FROM income_band)
GROUP BY ca.ca_city
ORDER BY vip_count DESC LIMIT 1",True,True,1,2,,,0.005828857421875
130,Tìm cho tôi 5 kho hàng có diện tích (floor space) lớn nhất và liệt kê tổng lượng hàng họ đang giữ.,"SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, SUM(inv.inv_quantity_on_hand) AS total_inv
FROM warehouse w
JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk
GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft
ORDER BY w.w_warehouse_sq_ft DESC
LIMIT 5;","SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, SUM(inv.inv_quantity_on_hand) AS total_inv
FROM warehouse w
JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk
GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft
ORDER BY w.w_warehouse_sq_ft DESC
LIMIT 5",True,True,5,3,,,0.04515409469604492
131,Thống kê doanh thu bán hàng qua Catalog theo từng trung tâm hỗ trợ (Call Center) trong năm 2002.,"SELECT cc.cc_name, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name;","SELECT cc.cc_name, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name",True,True,3,2,,,0.006989955902099609
132,Lý do phổ biến nhất mà khách hàng đưa ra khi trả lại hàng mua từ Web là gì?,"
SELECT r.r_reason_desc, COUNT(*) AS count
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
GROUP BY r.r_reason_desc
ORDER BY count DESC
LIMIT 1;","SELECT r.r_reason_desc, COUNT(*) AS count
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
GROUP BY r.r_reason_desc
ORDER BY count DESC
LIMIT 1",True,True,1,2,,,0.0046176910400390625
133,Liệt kê 5 cửa hàng có số lượng nhân viên đông nhất và tổng doanh thu của họ trong quý 1.,"SELECT s.s_store_name, s.s_number_employees, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_qoy = 1
GROUP BY s.s_store_name, s.s_number_employees
ORDER BY s.s_number_employees DESC
LIMIT 5;","SELECT s.s_store_name, s.s_number_employees, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_qoy = 1
GROUP BY s.s_store_name, s.s_number_employees
ORDER BY s.s_number_employees DESC
LIMIT 5",True,True,5,3,,,0.009369373321533203
136,"Trong năm 2001, thương hiệu (brand) nào của mặt hàng 'Men' bán chạy nhất tại cửa hàng?","SELECT i.i_brand, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2001
GROUP BY i.i_brand
ORDER BY total_sold DESC
LIMIT 1;","SELECT i.i_brand, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2001
GROUP BY i.i_brand
ORDER BY total_sold DESC
LIMIT 1",True,True,1,2,,,0.007983922958374023
137,Tìm tên các nhà sản xuất (manufacturer) có sản phẩm bị khách hàng trả lại nhiều hơn 100 lần trên Web.,"SELECT i.i_manufact, COUNT(*) AS return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
GROUP BY i.i_manufact
HAVING return_count > 100;","SELECT i.i_manufact, COUNT(*) AS return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
GROUP BY i.i_manufact
HAVING return_count > 100",True,True,50,2,,,0.007059335708618164
138,Những khách hàng có tiềm năng mua sắm 'Thấp' (Buy potential = 'Low') thường hay mua loại mặt hàng gì?,"SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE hd.hd_buy_potential = '0-500' -- Giả định giá trị Buy potential thấp
GROUP BY i.i_category
ORDER BY count DESC;","SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE hd.hd_buy_potential = '0-500' -- Giả định giá trị Buy potential thấp
GROUP BY i.i_category
ORDER BY count DESC",True,True,11,2,,,0.01381373405456543
140,Những mặt hàng nào thuộc danh mục 'Music' có lượng tồn kho dưới mức trung bình của cả kho?,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music' 
  AND inv.inv_quantity_on_hand < (SELECT AVG(inv_quantity_on_hand) FROM inventory);","SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music' 
  AND inv.inv_quantity_on_hand < (SELECT AVG(inv_quantity_on_hand) FROM inventory)",True,True,50,2,,,0.01491236686706543
141,Tính tổng chi phí vận chuyển (ws_ext_ship_cost) cho các sản phẩm thuộc danh mục 'Jewelry' (Trang sức) gửi đến bang 'TX',"SELECT SUM(ws.ws_ext_ship_cost)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX';","SELECT SUM(ws.ws_ext_ship_cost)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'",True,True,1,1,,,0.007252216339111328
142,"Trong quý 2 năm 2001, loại hàng nào mang lại lợi nhuận thực tế (ss_net_profit) dương cao nhất?","SELECT i.i_category, SUM(ss.ss_net_profit) AS total_profit
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2
GROUP BY i.i_category
ORDER BY total_profit DESC LIMIT 1;","SELECT i.i_category, SUM(ss.ss_net_profit) AS total_profit
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2
GROUP BY i.i_category
ORDER BY total_profit DESC LIMIT 1",True,True,1,2,,,0.014517068862915039
143,Cho tôi biết doanh thu của thương hiệu 'Men' bán tại cửa hàng vào những ngày không phải ngày lễ (Holiday = 'N'),"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_holiday = 'N';","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_holiday = 'N'",True,True,1,1,,,0.009531497955322266
144,Màu sắc nào của sản phẩm loại 'Sports' được khách hàng ở độ tuổi sinh từ 1990 trở đi ưa chuộng nhất?,"SELECT i.i_color, COUNT(*) AS count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports' AND c.c_birth_year >= 1990
GROUP BY i.i_color
ORDER BY count DESC LIMIT 1;","SELECT i.i_color, COUNT(*) AS count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports' AND c.c_birth_year >= 1990
GROUP BY i.i_color
ORDER BY count DESC LIMIT 1",True,True,1,2,,,0.008213996887207031
145,Tính tổng doanh thu bán đồ điện tử cho nhóm khách hàng có xếp hạng tín dụng 'Good'.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Electronics' AND cd.cd_credit_rating = 'Good';","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Electronics' AND cd.cd_credit_rating = 'Good'",True,True,1,1,,,0.0253908634185791
146,Tôi muốn biết đơn vị đo lường (units) nào của sản phẩm là phổ biến nhất,"SELECT i_units, COUNT(*) AS count
FROM item
GROUP BY i_units
ORDER BY count DESC;","SELECT i_units, COUNT(*) AS count
FROM item
GROUP BY i_units
ORDER BY count DESC",True,True,22,2,,,0.002214670181274414
147,Cho tôi biết mấy ông khách đã lập gia đình (Married) thì hay trả lại hàng ở cửa hàng với lý do gì nhất?,"SELECT r.r_reason_desc, COUNT(*) AS count
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE cd.cd_marital_status = 'M'
GROUP BY r.r_reason_desc
ORDER BY count DESC LIMIT 1;","SELECT r.r_reason_desc, COUNT(*) AS count
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE cd.cd_marital_status = 'M'
GROUP BY r.r_reason_desc
ORDER BY count DESC LIMIT 1",True,True,1,2,,,0.013744354248046875
148,Mấy người ở bang Texas (TX) mà có từ 3 xe hơi trở lên thường mua loại hàng điện tử (Electronics) nào?,"SELECT i.i_item_desc, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX' AND hd.hd_vehicle_count >= 3 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc;","SELECT i.i_item_desc, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX' AND hd.hd_vehicle_count >= 3 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc",True,True,50,2,,,0.009450912475585938
149,Thống kê xem có bao nhiêu bà nội trợ (nữ) đi mua đồ nam (category = 'Men') tại hệ thống cửa hàng.,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_gender = 'F' AND i.i_category = 'Men';","SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_gender = 'F' AND i.i_category = 'Men'",True,True,1,1,,,0.023221254348754883
152,Thống kê tổng lợi nhuận và tiền thuế (cs_ext_tax) thu được từ kênh Catalog theo từng năm,"SELECT d.d_year, SUM(cs.cs_net_profit) AS profit, SUM(cs.cs_ext_tax) AS tax
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
GROUP BY d.d_year;","SELECT d.d_year, SUM(cs.cs_net_profit) AS profit, SUM(cs.cs_ext_tax) AS tax
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
GROUP BY d.d_year",True,True,6,3,,,0.0066835880279541016
154,Tính xem tổng doanh thu bán hàng trên Web vào khung giờ khuya (từ 11h đêm đến 2h sáng) là bao nhiêu,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour IN (23, 0, 1, 2);","SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour IN (23, 0, 1, 2)",True,True,1,1,,,0.0032982826232910156
155,Tính tổng doanh thu từ các cửa hàng siêu lớn (diện tích trên 5 triệu feet vuông) trong quý 4.,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_floor_space > 5000000 AND d.d_qoy = 4
GROUP BY s.s_store_name;","SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_floor_space > 5000000 AND d.d_qoy = 4
GROUP BY s.s_store_name",True,True,6,2,,,0.013139009475708008
156,Những người lớn tuổi (sinh trước năm 1950) thường hay mua loại sách (category = 'Books') nào nhất?,"SELECT i.i_class, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE c.c_birth_year < 1950 AND i.i_category = 'Books'
GROUP BY i.i_class
ORDER BY count DESC LIMIT 1;","SELECT i.i_class, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE c.c_birth_year < 1950 AND i.i_category = 'Books'
GROUP BY i.i_class
ORDER BY count DESC LIMIT 1",True,True,1,2,,,0.013780832290649414
157,Tìm 5 món đồ đắt nhất được bán qua kênh Catalog trong năm 2002.,"SELECT DISTINCT i.i_item_desc, i.i_current_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
ORDER BY i.i_current_price DESC LIMIT 5;","SELECT DISTINCT i.i_item_desc, i.i_current_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
ORDER BY i.i_current_price DESC LIMIT 5",True,True,5,2,,,0.030824899673461914
158,Lọc ra mấy khách hàng chỉ đi mua trang sức (Jewelry) vào đúng hai ngày Thứ Bảy và Chủ Nhật.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_day_name IN ('Saturday', 'Sunday');","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_day_name IN ('Saturday', 'Sunday')",True,True,50,2,,,0.02231311798095703
159,Thành phố nào có lượng hàng trả lại qua Web nhiều hơn là trả trực tiếp tại cửa hàng?,"SELECT ca.ca_city
FROM customer_address ca
WHERE (SELECT COUNT(*) FROM web_returns wr WHERE wr.wr_refunded_addr_sk = ca.ca_address_sk) > 
      (SELECT COUNT(*) FROM store_returns sr WHERE sr.sr_addr_sk = ca.ca_address_sk)
LIMIT 10;","SELECT ca.ca_city
FROM customer_address ca
WHERE (SELECT COUNT(*) FROM web_returns wr WHERE wr.wr_refunded_addr_sk = ca.ca_address_sk) > 
      (SELECT COUNT(*) FROM store_returns sr WHERE sr.sr_addr_sk = ca.ca_address_sk)
LIMIT 10",True,True,10,1,,,0.036187171936035156
162,Trang web (Web page) nào đang mang lại doanh thu cao nhất cho hệ thống trong năm 2002?,"SELECT wp.wp_url, SUM(ws.ws_sales_price) AS revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_url
ORDER BY revenue DESC LIMIT 1;","SELECT wp.wp_url, SUM(ws.ws_sales_price) AS revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_url
ORDER BY revenue DESC LIMIT 1",True,True,1,2,,,0.006337404251098633
163,Tìm các sản phẩm có lượng tồn kho dưới 10 đơn vị trong quý 1 năm 2002.,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1 AND inv.inv_quantity_on_hand < 10;","SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1 AND inv.inv_quantity_on_hand < 10",True,True,50,2,,,0.006258964538574219
165,Liệt kê 5 Website đang hoạt động (không có ngày kết thúc web_rec_end_date) và ngày bắt đầu của chúng.,"SELECT web_name, web_rec_start_date
FROM web_site
WHERE web_rec_end_date IS NULL
LIMIT 5;","SELECT web_name, web_rec_start_date
FROM web_site
WHERE web_rec_end_date IS NULL
LIMIT 5",True,True,5,2,,,0.002004861831665039
166,Có bao nhiêu mặt hàng 'Electronics' được bán qua các trang web tự động tạo (wp_autogen_flag = 'Y'),"SELECT COUNT(*)
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics' AND wp.wp_autogen_flag = 'Y';","SELECT COUNT(*)
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics' AND wp.wp_autogen_flag = 'Y'",True,True,1,1,,,0.005522966384887695
167,Tính trung bình số lượng sản phẩm mỗi đơn hàng trên các trang web có URL chứa từ 'sales',"SELECT AVG(ws_quantity)
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
WHERE wp.wp_url LIKE '%sales%';","SELECT AVG(ws_quantity)
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
WHERE wp.wp_url LIKE '%sales%'",True,True,1,1,,,0.001924276351928711
168,Tính tổng doanh thu Web thu được từ khách hàng nhận hàng tại bang 'California' (CA).,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'CA';","SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'CA'",True,True,1,1,,,0.004536867141723633
169,Phương thức vận chuyển nào mang lại lợi nhuận Web cao nhất cho các đơn hàng gửi đến 'Texas'?,"SELECT sm.sm_type, SUM(ws.ws_net_profit) AS total_profit
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
GROUP BY sm.sm_type
ORDER BY total_profit DESC LIMIT 1;","SELECT sm.sm_type, SUM(ws.ws_net_profit) AS total_profit
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
GROUP BY sm.sm_type
ORDER BY total_profit DESC LIMIT 1",True,True,1,2,,,0.0069773197174072266
170,Liệt kê 5 thành phố có chi phí vận chuyển qua Web (ws_ext_ship_cost) cao nhất trong năm 2002.,"SELECT ca.ca_city, SUM(ws.ws_ext_ship_cost) AS total_ship_cost
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY ca.ca_city
ORDER BY total_ship_cost DESC LIMIT 5;","SELECT ca.ca_city, SUM(ws.ws_ext_ship_cost) AS total_ship_cost
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY ca.ca_city
ORDER BY total_ship_cost DESC LIMIT 5",True,True,5,2,,,0.01825261116027832
171,Website nào có tỷ lệ thuế (web_tax_percentage) cao nhất trong hệ thống?,"SELECT web_name, web_tax_percentage
FROM web_site
ORDER BY web_tax_percentage DESC LIMIT 1;","SELECT web_name, web_tax_percentage
FROM web_site
ORDER BY web_tax_percentage DESC LIMIT 1",True,True,1,2,,,0.0020933151245117188
172,Khách hàng nào đã mua hàng trên Web vào khung giờ từ 2 giờ đến 4 giờ sáng?,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour BETWEEN 2 AND 4;","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour BETWEEN 2 AND 4",True,True,50,2,,,0.011518478393554688
173,Tìm 3 trang Web page có lượng sản phẩm khác nhau (distinct items) được bán ra nhiều nhất.,"SELECT wp.wp_url, COUNT(DISTINCT ws.ws_item_sk) AS item_variety
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
GROUP BY wp.wp_url
ORDER BY item_variety DESC LIMIT 3;","SELECT wp.wp_url, COUNT(DISTINCT ws.ws_item_sk) AS item_variety
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
GROUP BY wp.wp_url
ORDER BY item_variety DESC LIMIT 3",True,True,1,2,,,0.016326427459716797
174,Thống kê cho tôi xem những hộ gia đình có từ 4 xe hơi trở lên thì thường mua loại hàng (category) nào nhiều nhất?,"SELECT i.i_category, COUNT(*) AS purchase_count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE hd.hd_vehicle_count >= 4
GROUP BY i.i_category
ORDER BY purchase_count DESC;","SELECT i.i_category, COUNT(*) AS purchase_count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE hd.hd_vehicle_count >= 4
GROUP BY i.i_category
ORDER BY purchase_count DESC",True,True,11,2,,,0.014092445373535156
175,Tính doanh thu trung bình từ những khách hàng chỉ sở hữu duy nhất 1 chiếc xe ô tô.,"SELECT AVG(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 1;","SELECT AVG(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 1",True,True,1,1,,,0.00800013542175293
176,Những gia đình có trên 5 người phụ thuộc (Dependents) thường hay trả lại hàng với lý do gì?,"SELECT r.r_reason_desc, COUNT(*) AS count
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE hd.hd_dep_count > 5
GROUP BY r.r_reason_desc
ORDER BY count DESC;","SELECT r.r_reason_desc, COUNT(*) AS count
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE hd.hd_dep_count > 5
GROUP BY r.r_reason_desc
ORDER BY count DESC",True,True,34,2,,,0.012625455856323242
177,Tính tổng tiền thuế (ss_ext_tax) thu được từ các hộ gia đình không có người phụ thuộc nào.,"SELECT SUM(ss.ss_ext_tax)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_dep_count = 0;","SELECT SUM(ss.ss_ext_tax)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_dep_count = 0",True,True,1,1,,,0.006922721862792969
178,Thống kê doanh thu Catalog theo từng nhóm khả năng chi tiêu trong năm 2002.,"SELECT hd.hd_buy_potential, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY hd.hd_buy_potential;","SELECT hd.hd_buy_potential, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY hd.hd_buy_potential",True,True,6,2,,,0.029789447784423828
179,Tìm những hộ gia đình có thu nhập mức thấp nhất nhưng lại sở hữu từ 2 xe hơi trở lên,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_income_band_sk = (SELECT MIN(ib_income_band_sk) FROM income_band)
  AND hd.hd_vehicle_count >= 2;","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_income_band_sk = (SELECT MIN(ib_income_band_sk) FROM income_band)
  AND hd.hd_vehicle_count >= 2",True,True,50,2,,,0.006482124328613281
180,"Trong các ngày lễ, nhóm gia đình có thu nhập trung bình thường mua loại hàng gì nhất?","SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE d.d_holiday = 'Y' AND hd.hd_income_band_sk BETWEEN 8 AND 12
GROUP BY i.i_category
ORDER BY count DESC LIMIT 1;","SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE d.d_holiday = 'Y' AND hd.hd_income_band_sk BETWEEN 8 AND 12
GROUP BY i.i_category
ORDER BY count DESC LIMIT 1",True,True,1,2,,,0.010560989379882812
181,Có bao nhiêu khách hàng sinh năm 1990 mà gia đình có đúng 2 xe hơi và 2 người phụ thuộc?,"SELECT COUNT(*)
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE c.c_birth_year = 1990 AND hd.hd_vehicle_count = 2 AND hd.hd_dep_count = 2;","SELECT COUNT(*)
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE c.c_birth_year = 1990 AND hd.hd_vehicle_count = 2 AND hd.hd_dep_count = 2",True,True,1,1,,,0.0022804737091064453
183,Hãy liệt kê 5 kho hàng có diện tích mặt sàn lớn nhất và tính tổng số lượng sản phẩm hiện có trong các kho này.,"SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, SUM(inv.inv_quantity_on_hand) AS total_inventory
FROM warehouse w
JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk
GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft
ORDER BY w.w_warehouse_sq_ft DESC
LIMIT 5;","SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, SUM(inv.inv_quantity_on_hand) AS total_inventory
FROM warehouse w
JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk
GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft
ORDER BY w.w_warehouse_sq_ft DESC
LIMIT 5",True,True,5,3,,,0.04265141487121582
184,Bạn hãy xác định xem trung tâm hỗ trợ nào có chi phí vận hành bao gồm thuế và phí vận chuyển cao nhất cho các đơn hàng Catalog.,"SELECT cc.cc_name, SUM(cs.cs_ext_tax + cs.cs_ext_ship_cost) AS total_operating_cost
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
GROUP BY cc.cc_name
ORDER BY total_operating_cost DESC
LIMIT 1;","SELECT cc.cc_name, SUM(cs.cs_ext_tax + cs.cs_ext_ship_cost) AS total_operating_cost
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
GROUP BY cc.cc_name
ORDER BY total_operating_cost DESC
LIMIT 1",True,True,1,2,,,0.010986804962158203
185,Liệt kê danh sách các trang Catalog có chứa nhiều hơn 50 sản phẩm khác nhau và sắp xếp theo số lượng giảm dần.,"SELECT cp.cp_catalog_page_number, COUNT(DISTINCT cs_item_sk) AS item_count
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
GROUP BY cp.cp_catalog_page_number
ORDER BY item_count DESC;","SELECT cp.cp_catalog_page_number, COUNT(DISTINCT cs_item_sk) AS item_count
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
GROUP BY cp.cp_catalog_page_number
ORDER BY item_count DESC",True,True,50,2,,,0.04617452621459961
186,Xác định phương thức vận chuyển nào thường được sử dụng nhiều nhất cho các đơn hàng từ Web gửi đến khách hàng ở bang Texas,"SELECT sm.sm_type, COUNT(*) AS usage_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
GROUP BY sm.sm_type
ORDER BY usage_count DESC LIMIT 1;","SELECT sm.sm_type, COUNT(*) AS usage_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
GROUP BY sm.sm_type
ORDER BY usage_count DESC LIMIT 1",True,True,1,2,,,0.007218122482299805
187,Hãy cho tôi biết lý do hàng đầu khiến khách hàng trả lại sản phẩm mua từ Web là gì và số lượng tương ứng là bao nhiêu,"SELECT r.r_reason_desc, COUNT(*) AS return_count
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
GROUP BY r.r_reason_desc
ORDER BY return_count DESC LIMIT 1;","SELECT r.r_reason_desc, COUNT(*) AS return_count
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
GROUP BY r.r_reason_desc
ORDER BY return_count DESC LIMIT 1",True,True,1,2,,,0.00550389289855957
189,Bạn hãy tính tổng doanh thu bán đồ điện tử trong khoảng thời gian từ 18 giờ đến 21 giờ tối hàng ngày.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE i.i_category = 'Electronics' AND t.t_hour BETWEEN 18 AND 21;","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE i.i_category = 'Electronics' AND t.t_hour BETWEEN 18 AND 21",True,True,1,1,,,0.005041599273681641
191,Tính giúp tôi tổng số lượng hàng tồn kho của các sản phẩm có màu sắc là xanh dương và thuộc sản phẩm váy,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_color = 'blue' AND i.i_class = 'dresses';","SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_color = 'blue' AND i.i_class = 'dresses'",True,True,1,1,,,0.001950979232788086
192,Bạn hãy thống kê giúp tôi tổng doanh thu từ các khách hàng nữ có trình độ học vấn là Cao Đẳng và hiện đang có xếp hạng  tín dụng ở mức Tốt,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F' 
  AND cd.cd_education_status = 'College' 
  AND cd.cd_credit_rating = 'Good';","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F' 
  AND cd.cd_education_status = 'College' 
  AND cd.cd_credit_rating = 'Good'",True,True,1,1,,,0.009408235549926758
193,Hãy cho tôi biết những khách hàng đã lập gia đình và có ước tính mức mua sắm trên năm ngàn đô la thường ưa chuộng danh mục hàng hóa nào nhất,"SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND cd.cd_purchase_estimate > 5000
GROUP BY i.i_category
ORDER BY count DESC LIMIT 1;","SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND cd.cd_purchase_estimate > 5000
GROUP BY i.i_category
ORDER BY count DESC LIMIT 1",True,True,1,2,,,0.0196688175201416
194,Xác định giúp tôi xem có bao nhiêu khách hàng có số lượng người phụ thuộc đang đi làm lớn hơn hai và đã từng mua hàng tại hệ thống cửa hàng.,"SELECT COUNT(DISTINCT ss_customer_sk)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_dep_employed_count > 2;","SELECT COUNT(DISTINCT ss_customer_sk)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_dep_employed_count > 2",True,True,1,1,,,0.04871869087219238
195,Liệt kê danh sách năm khách hàng có xếp hạng tín dụng thấp nhất nhưng lại thực hiện nhiều giao dịch trả hàng nhất tại các trung tâm hỗ trợ trực tuyến.,"SELECT c.c_first_name, c.c_last_name, COUNT(wr.wr_item_sk) AS return_count
FROM web_returns wr
JOIN customer c ON wr.wr_refunded_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_credit_rating = 'Low Risk'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY return_count DESC LIMIT 5;","SELECT c.c_first_name, c.c_last_name, COUNT(wr.wr_item_sk) AS return_count
FROM web_returns wr
JOIN customer c ON wr.wr_refunded_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_credit_rating = 'Low Risk'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY return_count DESC LIMIT 5",True,True,5,3,,,0.01993536949157715
196,Bạn hãy kiểm tra giúp tôi xem trang Catalog số một có chứa bao nhiêu mặt hàng thuộc danh mục sách và tổng giá trị của những mặt hàng đó là bao nhiêu,"SELECT COUNT(cs.cs_item_sk), SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cp.cp_catalog_page_number = 1 AND i.i_category = 'Books';","SELECT COUNT(cs.cs_item_sk), SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cp.cp_catalog_page_number = 1 AND i.i_category = 'Books'",True,True,1,2,,,0.0042765140533447266
197,Bạn hãy xác định xem nhà sản xuất nào có nhiều sản phẩm được liệt kê trên các trang Catalog nhất và tổng số lượng đơn hàng tương ứng của họ là bao nhiêu.,"SELECT i.i_manufact, COUNT(cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
GROUP BY i.i_manufact
ORDER BY COUNT(DISTINCT i.i_item_sk) DESC LIMIT 1;","SELECT i.i_manufact, COUNT(cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
GROUP BY i.i_manufact
ORDER BY COUNT(DISTINCT i.i_item_sk) DESC LIMIT 1",True,True,1,2,,,0.0268094539642334
198,Hãy thống kê giúp tôi số lượng đơn hàng Web bị trả lại với lý do là sản phẩm không giống như hình ảnh hiển thị trên trang web trực tuyến của công ty,"SELECT COUNT(*)
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%wrong image%';","SELECT COUNT(*)
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%wrong image%'",True,True,1,1,,,0.0012302398681640625
199,Bạn hãy tính tổng số tiền mặt đã hoàn trả cho khách hàng khi họ thực hiện trả hàng tại các cửa hàng vật lý trong suốt tháng mười hai năm 2002,"SELECT SUM(sr.sr_refunded_cash)
FROM store_returns sr
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 12;","SELECT SUM(sr.sr_refunded_cash)
FROM store_returns sr
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 12",True,True,1,1,,,0.0022385120391845703
200,Bạn hãy liệt kê năm mặt hàng có tần suất bị trả lại cao nhất tại các kho hàng nằm ở khu vực miền Tây do gặp sự cố hư hỏng trong lúc vận chuyển,"SELECT i.i_item_desc, COUNT(*) AS return_count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN warehouse w ON sr.sr_store_sk = w.w_warehouse_sk -- Giả định liên kết qua store_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%damaged%'
GROUP BY i.i_item_desc
ORDER BY return_count DESC LIMIT 5;","SELECT i.i_item_desc, COUNT(*) AS return_count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN warehouse w ON sr.sr_store_sk = w.w_warehouse_sk -- Giả định liên kết qua store_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%damaged%'
GROUP BY i.i_item_desc
ORDER BY return_count DESC LIMIT 5",True,True,5,2,,,0.005972862243652344
201,"Bạn hãy tìm tên của những khách hàng vừa có giao dịch mua hàng tại cửa hàng, vừa thực hiện trả hàng thông qua kênh trực tuyến Web trong cùng một quý.","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk
JOIN date_dim d1 ON ss.ss_sold_date_sk = d1.d_date_sk
JOIN date_dim d2 ON wr.wr_returned_date_sk = d2.d_date_sk
WHERE d1.d_year = d2.d_year AND d1.d_qoy = d2.d_qoy;","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk
JOIN date_dim d1 ON ss.ss_sold_date_sk = d1.d_date_sk
JOIN date_dim d2 ON wr.wr_returned_date_sk = d2.d_date_sk
WHERE d1.d_year = d2.d_year AND d1.d_qoy = d2.d_qoy",True,True,50,2,,,0.03147745132446289
202,Bạn hãy liệt kê danh sách mười khách hàng chi tiêu mạnh tay nhất cho các mặt hàng thời trang nữ thông qua kênh Web trong suốt giai đoạn năm 2001,"SELECT c.c_first_name, SUM(ws.ws_sales_price) AS total_spend
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY total_spend DESC LIMIT 10;","SELECT c.c_first_name, SUM(ws.ws_sales_price) AS total_spend
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY total_spend DESC LIMIT 10",True,True,10,2,,,0.009996414184570312
203,Bạn hãy tính giúp tôi mức lợi nhuận ròng trung bình cho mỗi mặt hàng được bán tại cửa hàng cho các khách hàng đã lập gia đình và hiện đang cư trú tại bang California,"SELECT AVG(ss.ss_net_profit)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE cd.cd_marital_status = 'M' AND ca.ca_state = 'CA';","SELECT AVG(ss.ss_net_profit)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE cd.cd_marital_status = 'M' AND ca.ca_state = 'CA'",True,True,1,1,,,0.008925914764404297
204,Tính  giúp tôi tổng số tiền thuế mà các khách hàng có trình độ học vấn cao đã chi trả cho việc mua sắm trên mạng vào những ngày cuối tuần.,"SELECT SUM(ws.ws_ext_tax)
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_weekend = 'Y';","SELECT SUM(ws.ws_ext_tax)
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_weekend = 'Y'",True,True,1,1,,,0.012379169464111328
205,"Hãy liệt kê cho tôi năm thương hiệu sản phẩm có tổng doanh thu cao nhất vào khung giờ buổi sáng, cụ thể là từ tám giờ sáng đến mười hai giờ trưa tại hệ thống cửa hàng","SELECT i.i_brand, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE t.t_hour BETWEEN 8 AND 12
GROUP BY i.i_brand
ORDER BY revenue DESC LIMIT 5;","SELECT i.i_brand, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE t.t_hour BETWEEN 8 AND 12
GROUP BY i.i_brand
ORDER BY revenue DESC LIMIT 5",True,True,5,2,,,0.014998435974121094
206,Thống kê tổng doanh thu bán lẻ từ những hộ gia đình không sở hữu xe ô tô nào nhưng lại có từ hai người phụ thuộc trở lên trong hồ sơ nhân khẩu học,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 0 AND hd.hd_dep_count >= 2;","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 0 AND hd.hd_dep_count >= 2",True,True,1,1,,,0.005998373031616211
207,Hãy cho tôi biết tổng doanh thu thu được từ các sản phẩm thuộc danh mục đồ điện tử đã được bán thông qua trang số năm trong cuốn danh mục Catalog,"SELECT SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cp.cp_catalog_page_number = 5 AND i.i_category = 'Electronics';","SELECT SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cp.cp_catalog_page_number = 5 AND i.i_category = 'Electronics'",True,True,1,1,,,0.005326509475708008
208,Bạn hãy tìm giúp tôi danh sách các mặt hàng đã được mua trực tuyến và sau đó bị khách hàng trả lại ngay trong cùng một tháng bán hàng đó,"SELECT DISTINCT i.i_item_desc
FROM web_sales ws
JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d1 ON ws.ws_sold_date_sk = d1.d_date_sk
JOIN date_dim d2 ON wr.wr_returned_date_sk = d2.d_date_sk
WHERE d1.d_moy = d2.d_moy AND d1.d_year = d2.d_year;","SELECT DISTINCT i.i_item_desc
FROM web_sales ws
JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d1 ON ws.ws_sold_date_sk = d1.d_date_sk
JOIN date_dim d2 ON wr.wr_returned_date_sk = d2.d_date_sk
WHERE d1.d_moy = d2.d_moy AND d1.d_year = d2.d_year",True,True,50,1,,,0.025186777114868164
209,Xác định xem lý do hàng đầu khiến các khách hàng nữ trả lại hàng hóa đã mua qua kênh Catalog là do lỗi sản phẩm hay không hài lòng,"SELECT r.r_reason_desc, COUNT(*) AS count
FROM catalog_returns cr
JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F'
GROUP BY r.r_reason_desc
ORDER BY count DESC LIMIT 1;","SELECT r.r_reason_desc, COUNT(*) AS count
FROM catalog_returns cr
JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F'
GROUP BY r.r_reason_desc
ORDER BY count DESC LIMIT 1",True,True,1,2,,,0.01581406593322754
210,Tìm giúp tôi ba nhà sản xuất có mức giá vốn nhập hàng trung bình thấp nhất cho các mặt hàng đang được kinh doanh trong hệ thống,"SELECT i_manufact, AVG(i_wholesale_cost) AS avg_cost
FROM item
GROUP BY i_manufact
ORDER BY avg_cost ASC LIMIT 3;","SELECT i_manufact, AVG(i_wholesale_cost) AS avg_cost
FROM item
GROUP BY i_manufact
ORDER BY avg_cost ASC LIMIT 3",True,True,3,2,,,0.0023241043090820312
211,Bạn hãy cho tôi biết ngày nào trong tuần thường có số lượng đơn hàng bán ra cao nhất đối với danh mục sách trên trang web trực tuyến,"SELECT d.d_day_name, COUNT(*) AS sales_count
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY d.d_day_name
ORDER BY sales_count DESC LIMIT 1;","SELECT d.d_day_name, COUNT(*) AS sales_count
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY d.d_day_name
ORDER BY sales_count DESC LIMIT 1",True,True,1,2,,,0.009002685546875
212,Hãy tính tổng lợi nhuận từ các cửa hàng do quản lý có tên bắt đầu bằng chữ 'W' điều hành trong suốt cả năm 2001,"SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_manager LIKE 'W%' AND d.d_year = 2001;","SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_manager LIKE 'W%' AND d.d_year = 2001",True,True,1,1,,,0.006575107574462891
213,Thống kê số lượng trang web có chứa trên năm hình ảnh minh họa và đã từng phát sinh giao dịch bán các mặt hàng gia dụng.,"SELECT COUNT(DISTINCT wp.wp_web_page_sk)
FROM web_page wp
JOIN web_sales ws ON wp.wp_web_page_sk = ws.ws_web_page_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE wp.wp_image_count > 5 AND i.i_category = 'Home';","SELECT COUNT(DISTINCT wp.wp_web_page_sk)
FROM web_page wp
JOIN web_sales ws ON wp.wp_web_page_sk = ws.ws_web_page_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE wp.wp_image_count > 5 AND i.i_category = 'Home'",True,True,1,1,,,0.0058057308197021484
214,So sánh tổng số lượng sản phẩm bán ra trong các ngày lễ so với các ngày bình thường để đánh giá sức mua của khách hàng,"SELECT d.d_holiday, SUM(ss.ss_quantity)
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
GROUP BY d.d_holiday;","SELECT d.d_holiday, SUM(ss.ss_quantity)
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
GROUP BY d.d_holiday",True,True,2,2,,,0.009665966033935547
215,Hãy tìm lợi nhuận thu được từ những người đàn ông đã ly hôn khi họ mua đồ điện tử thông qua kênh bán hàng Catalog của công ty,"SELECT SUM(cs.cs_net_profit)
FROM catalog_sales cs
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cd.cd_gender = 'M' AND cd.cd_marital_status = 'D' AND i.i_category = 'Electronics';","SELECT SUM(cs.cs_net_profit)
FROM catalog_sales cs
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cd.cd_gender = 'M' AND cd.cd_marital_status = 'D' AND i.i_category = 'Electronics'",True,True,1,1,,,0.015335321426391602
216,Hãy giúp tôi tìm ra ba khách hàng có mức chi tiêu cao nhất tại mỗi tiểu bang và hiển thị thứ hạng của họ dựa trên tổng doanh thu bán hàng qua hệ thống Web,"SELECT * FROM (
    SELECT ca.ca_state, c.c_first_name, SUM(ws.ws_sales_price) AS total_spent,
           DENSE_RANK() OVER (PARTITION BY ca.ca_state ORDER BY SUM(ws.ws_sales_price) DESC) AS rank
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    GROUP BY ca.ca_state, c.c_customer_sk, c.c_first_name
) tmp WHERE rank <= 3;","SELECT * FROM (
    SELECT ca.ca_state, c.c_first_name, SUM(ws.ws_sales_price) AS total_spent,
           DENSE_RANK() OVER (PARTITION BY ca.ca_state ORDER BY SUM(ws.ws_sales_price) DESC) AS rank
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    GROUP BY ca.ca_state, c.c_customer_sk, c.c_first_name
) tmp WHERE rank <= 3",True,True,50,4,,,0.03379368782043457
217,Bạn hãy thực hiện phân chia danh sách khách hàng thành bốn nhóm bằng nhau dựa trên giá trị ước tính mức độ mua sắm trong hồ sơ nhân khẩu học của họ,"SELECT c_first_name, c_last_name, cd_purchase_estimate,
       NTILE(4) OVER (ORDER BY cd_purchase_estimate DESC) AS customer_segment
FROM customer
JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk;","SELECT c_first_name, c_last_name, cd_purchase_estimate,
       NTILE(4) OVER (ORDER BY cd_purchase_estimate DESC) AS customer_segment
FROM customer
JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk",True,True,50,4,,,0.024987220764160156
218,Hãy xác định xem mặt hàng nào là sản phẩm được mua nhiều thứ hai bởi khách hàng có mã số 188 dựa trên số lượng sản phẩm.,"SELECT * FROM (
    SELECT ss_item_sk, ss_quantity,
           ROW_NUMBER() OVER (ORDER BY ss_quantity DESC) AS item_seq
    FROM store_sales
    WHERE ss_customer_sk = 188
) tmp WHERE item_seq = 2;","SELECT * FROM (
    SELECT ss_item_sk, ss_quantity,
           ROW_NUMBER() OVER (ORDER BY ss_quantity DESC) AS item_seq
    FROM store_sales
    WHERE ss_customer_sk = 188
) tmp WHERE item_seq = 2",True,True,1,3,,,0.004588127136230469
219,Bạn hãy tính mức chi tiêu trung bình di động của khách hàng Javier Lewis dựa trên ba giao dịch mua hàng gần nhất của ông ấy tại hệ thống cửa hàng.,"SELECT ss_ticket_number, ss_sales_price,
       AVG(ss_sales_price) OVER (ORDER BY ss_sold_date_sk ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_avg
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE c.c_first_name = 'Javier' AND c.c_last_name = 'Lewis';","SELECT ss_ticket_number, ss_sales_price,
       AVG(ss_sales_price) OVER (ORDER BY ss_sold_date_sk ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_avg
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE c.c_first_name = 'Javier' AND c.c_last_name = 'Lewis'",True,True,10,3,,,0.0037665367126464844
220,Bạn hãy tìm những khách hàng sống trong các căn hộ chung cư có tổng chi tiêu cao hơn mức chi tiêu trung bình của tất cả khách hàng trong cùng khu vực đó,"SELECT c_first_name, total_spent, avg_area_spent
FROM (
    SELECT c.c_first_name, SUM(ss.ss_sales_price) AS total_spent,
           AVG(SUM(ss.ss_sales_price)) OVER (PARTITION BY ca.ca_location_type) AS avg_area_spent
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    WHERE ca.ca_location_type = 'condo'
    GROUP BY c.c_customer_sk, c.c_first_name, ca.ca_location_type
) tmp WHERE total_spent > avg_area_spent;","SELECT c_first_name, total_spent, avg_area_spent
FROM (
    SELECT c.c_first_name, SUM(ss.ss_sales_price) AS total_spent,
           AVG(SUM(ss.ss_sales_price)) OVER (PARTITION BY ca.ca_location_type) AS avg_area_spent
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    WHERE ca.ca_location_type = 'condo'
    GROUP BY c.c_customer_sk, c.c_first_name, ca.ca_location_type
) tmp WHERE total_spent > avg_area_spent",True,True,50,3,,,0.02446293830871582
221,Bạn hãy tính toán giá trị đơn hàng trung bình của kênh Web trong mỗi giờ và hiển thị thứ hạng của các khung giờ dựa trên mức độ sinh lời,"SELECT t_hour, avg_profit,
       RANK() OVER (ORDER BY avg_profit DESC) AS hour_rank
FROM (
    SELECT t.t_hour, AVG(ws.ws_net_profit) AS avg_profit
    FROM web_sales ws
    JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
    GROUP BY t.t_hour
) tmp;","SELECT t_hour, avg_profit,
       RANK() OVER (ORDER BY avg_profit DESC) AS hour_rank
FROM (
    SELECT t.t_hour, AVG(ws.ws_net_profit) AS avg_profit
    FROM web_sales ws
    JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
    GROUP BY t.t_hour
) tmp",True,True,24,3,,,0.006444215774536133
222,Hãy giúp tôi xác định ngày đầu tiên và ngày cuối cùng mà khách hàng Latisha Hamilton đã thực hiện mua sắm tại cửa hàng,"SELECT DISTINCT 
       FIRST_VALUE(d_date) OVER (ORDER BY d_date ASC) AS first_purchase,
       LAST_VALUE(d_date) OVER (ORDER BY d_date ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_purchase
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE c.c_first_name = 'Latisha' AND c.c_last_name = 'Hamilton';","SELECT DISTINCT 
       FIRST_VALUE(d_date) OVER (ORDER BY d_date ASC) AS first_purchase,
       LAST_VALUE(d_date) OVER (ORDER BY d_date ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_purchase
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE c.c_first_name = 'Latisha' AND c.c_last_name = 'Hamilton'",True,True,1,2,,,0.004173994064331055
223,Bạn hãy xếp hạng các kho hàng dựa trên tổng lượng hàng tồn kho của sản phẩm có màu xanh dương hiện đang có mặt trong hệ thống kho bãi,"SELECT w_warehouse_name, total_qty,
       RANK() OVER (ORDER BY total_qty DESC) AS stock_rank
FROM (
    SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_qty
    FROM inventory inv
    JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
    JOIN item i ON inv.inv_item_sk = i.i_item_sk
    WHERE i.i_color = 'blue'
    GROUP BY w.w_warehouse_name
) tmp;","SELECT w_warehouse_name, total_qty,
       RANK() OVER (ORDER BY total_qty DESC) AS stock_rank
FROM (
    SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_qty
    FROM inventory inv
    JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
    JOIN item i ON inv.inv_item_sk = i.i_item_sk
    WHERE i.i_color = 'blue'
    GROUP BY w.w_warehouse_name
) tmp",True,True,5,3,,,0.01194906234741211
224,Bạn hãy thống kê giúp tôi tổng doanh thu của các mặt hàng thương hiệu 'Home' được bán cho những khách hàng đang sống trong các căn hộ chung cư,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_location_type = 'condo' AND i.i_brand = 'Home';","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_location_type = 'condo' AND i.i_brand = 'Home'",True,True,1,1,,,0.0024864673614501953
225,Hãy liệt kê danh sách email của các khách hàng nam hiện đang cư trú tại các ngôi nhà dành cho một gia đình có múi giờ là -7,"SELECT c.c_email_address
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'M' 
  AND ca.ca_location_type = 'single family' 
  AND ca.ca_gmt_offset = -7.00;","SELECT c.c_email_address
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'M' 
  AND ca.ca_location_type = 'single family' 
  AND ca.ca_gmt_offset = -7.00",True,True,50,1,,,0.008336544036865234
226,Hãy cho tôi biết mặt hàng có mã số sản phẩm là một trăm bốn mươi sáu đã mang lại bao nhiêu doanh thu trên kênh bán hàng trực tuyến Web,"SELECT SUM(ws_sales_price)
FROM web_sales
WHERE ws_item_sk = 146;","SELECT SUM(ws_sales_price)
FROM web_sales
WHERE ws_item_sk = 146",True,True,1,1,,,0.0018558502197265625
227,"Bạn hãy liệt kê các giao dịch tại cửa hàng đang gây ra mức thua lỗ lớn nhất, cụ thể là có lợi nhuận ròng âm hơn bảy trăm đô la","SELECT ss_ticket_number, ss_net_profit
FROM store_sales
WHERE ss_net_profit < -700.00
ORDER BY ss_net_profit ASC;","SELECT ss_ticket_number, ss_net_profit
FROM store_sales
WHERE ss_net_profit < -700.00
ORDER BY ss_net_profit ASC",True,True,50,2,,,0.02119612693786621
228,Bạn hãy thống kê tổng số tiền thuế thu được từ các đơn hàng Catalog của những hộ gia đình có mức khả năng chi tiêu từ năm trăm đến một ngàn đô la.,"SELECT SUM(cs.cs_ext_tax)
FROM catalog_sales cs
JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_buy_potential = '501-1000';","SELECT SUM(cs.cs_ext_tax)
FROM catalog_sales cs
JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_buy_potential = '501-1000'",True,True,1,1,,,0.006952762603759766
229,Bạn hãy tính tổng số tiền chiết khấu đã được áp dụng cho những khách hàng nam hiện đang sinh sống tại khu vực có múi giờ âm bảy,"SELECT SUM(ss.ss_ext_discount_amt)
FROM store_sales ss
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'M' AND ca.ca_gmt_offset = -7.00;","SELECT SUM(ss.ss_ext_discount_amt)
FROM store_sales ss
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'M' AND ca.ca_gmt_offset = -7.00",True,True,1,1,,,0.024738311767578125
230,Hãy tìm giúp tôi tổng mức tổn thất ròng từ việc trả hàng qua Catalog đối với mặt hàng có mã số sản phẩm là một trăm năm mươi tư,"SELECT SUM(cr_net_loss)
FROM catalog_returns
WHERE cr_item_sk = 154;","SELECT SUM(cr_net_loss)
FROM catalog_returns
WHERE cr_item_sk = 154",True,True,1,1,,,0.001081705093383789
231,Hãy cho tôi biết tổng lợi nhuận thu được từ các sản phẩm màu xanh dương được bán tại hệ thống cửa hàng cho các khách hàng độc thân,"SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_color = 'blue' AND cd.cd_marital_status = 'S';","SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_color = 'blue' AND cd.cd_marital_status = 'S'",True,True,1,1,,,0.007253170013427734
232,Hãy liệt kê tên và mã địa chỉ của năm khách hàng có số lượng người phụ thuộc đang đi làm lớn hơn hai và hiện đang sống ở bang California,"SELECT c.c_first_name, ca.ca_address_id
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_dep_employed_count > 2 AND ca.ca_state = 'CA'
LIMIT 5;","SELECT c.c_first_name, ca.ca_address_id
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_dep_employed_count > 2 AND ca.ca_state = 'CA'
LIMIT 5",True,True,5,2,,,0.006044864654541016
233,Bạn hãy giúp tôi xác định xem nhà sản xuất nào có nhiều sản phẩm được bán nhất cho những hộ gia đình không sở hữu xe ô tô nào.,"SELECT i.i_manufact, COUNT(*) AS sold_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 0
GROUP BY i.i_manufact
ORDER BY sold_qty DESC LIMIT 1;","SELECT i.i_manufact, COUNT(*) AS sold_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 0
GROUP BY i.i_manufact
ORDER BY sold_qty DESC LIMIT 1",True,True,1,2,,,0.010810613632202148
234,Hãy cho tôi biết tổng doanh thu thực tế thu được từ các đơn hàng Web phát sinh vào khung giờ khuya từ mười giờ đêm đến hai giờ sáng hôm sau,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour IN (22, 23, 0, 1);","SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour IN (22, 23, 0, 1)",True,True,1,1,,,0.004740715026855469
235,Bạn hãy liệt kê mười món đồ có giá vốn nhập hàng thấp nhất nhưng lại mang về lợi nhuận dương cao nhất trên hệ thống bán lẻ Web,"SELECT i.i_item_desc, ws.ws_net_profit
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ws.ws_net_profit > 0
ORDER BY i.i_wholesale_cost ASC, ws.ws_net_profit DESC
LIMIT 10;","SELECT i.i_item_desc, ws.ws_net_profit
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ws.ws_net_profit > 0
ORDER BY i.i_wholesale_cost ASC, ws.ws_net_profit DESC
LIMIT 10",True,True,10,2,,,0.00479578971862793
236,Hãy giúp tôi tìm xem có bao nhiêu đơn hàng bị trả lại tại cửa hàng có giá trị hoàn tiền mặt lớn hơn năm trăm đô la vào quý bốn năm hai ngàn lẻ hai,"SELECT COUNT(*)
FROM store_returns sr
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE sr.sr_refunded_cash > 500.00 AND d.d_year = 2002 AND d.d_qoy = 4;","SELECT COUNT(*)
FROM store_returns sr
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE sr.sr_refunded_cash > 500.00 AND d.d_year = 2002 AND d.d_qoy = 4",True,True,1,1,,,0.0020885467529296875
237,Bạn hãy tính tổng lợi nhuận ròng thu được từ kênh Web của nhóm khách hàng có thu nhập từ mức năm mươi ngàn đô la trở lên và có trên bốn người phụ thuộc,"SELECT SUM(ws.ws_net_profit)
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_lower_bound >= 50000 AND hd.hd_dep_count > 4;","SELECT SUM(ws.ws_net_profit)
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_lower_bound >= 50000 AND hd.hd_dep_count > 4",True,True,1,1,,,0.006277799606323242
238,Bạn hãy thống kê giúp tôi tổng doanh thu của các sản phẩm thuộc danh mục 'Books' được bán tại các cửa hàng ở bang Texas cho những khách hàng đang sống trong căn hộ 'condo',"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Books' 
  AND s.s_state = 'TX' 
  AND ca.ca_location_type = 'condo';","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Books' 
  AND s.s_state = 'TX' 
  AND ca.ca_location_type = 'condo'",True,True,1,1,,,0.0040624141693115234
239,Hãy thống kê số lượng đơn hàng Catalog được đặt trong khung giờ từ tám giờ tối đến mười giờ đêm bởi những khách hàng cư trú tại bang California,"SELECT COUNT(*)
FROM catalog_sales cs
JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk
JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk
WHERE t.t_hour BETWEEN 20 AND 22 
  AND ca.ca_state = 'CA';","SELECT COUNT(*)
FROM catalog_sales cs
JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk
JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk
WHERE t.t_hour BETWEEN 20 AND 22 
  AND ca.ca_state = 'CA'",True,True,1,1,,,0.004579067230224609
240,Bạn hãy thống kê giúp tôi tổng doanh thu của các sản phẩm thuộc danh mục Music được bán tại hệ thống cửa hàng cho các khách hàng đang cư trú tại bang Texas trong suốt năm 2001,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND ca.ca_state = 'TX' AND d.d_year = 2001;","SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND ca.ca_state = 'TX' AND d.d_year = 2001",True,True,1,1,,,0.01056814193725586
241,Hãy cho tôi biết mức chi tiêu trung bình cho các mặt hàng thời trang Women của những khách hàng nữ có trình độ học vấn là Tiến sĩ khi họ mua sắm trực tuyến trên hệ thống Web,"SELECT AVG(ws.ws_sales_price)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Women' AND cd.cd_gender = 'F' AND cd.cd_education_status = 'Advanced Degree';","SELECT AVG(ws.ws_sales_price)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Women' AND cd.cd_gender = 'F' AND cd.cd_education_status = 'Advanced Degree'",True,True,1,1,,,0.009402036666870117
242,Bạn hãy tính toán tổng lợi nhuận ròng thu được từ các sản phẩm danh mục Home khi bán cho những hộ gia đình sống trong các căn hộ chung cư và sở hữu từ hai xe ô tô trở lên,"SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk
WHERE i.i_category = 'Home' AND ca.ca_location_type = 'condo' AND hd.hd_vehicle_count >= 2;","SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk
WHERE i.i_category = 'Home' AND ca.ca_location_type = 'condo' AND hd.hd_vehicle_count >= 2",True,True,1,1,,,0.00958251953125
243,Bạn hãy thống kê giúp tôi tổng doanh thu của các sản phẩm thuộc danh mục Music được bán qua trang web và được vận chuyển bằng phương thức giao hàng hỏa tốc OVERNIGHT cho những khách hàng đang sống trong căn hộ chung cư,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Music' 
  AND sm.sm_type = 'OVERNIGHT' 
  AND ca.ca_location_type = 'condo';","SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Music' 
  AND sm.sm_type = 'OVERNIGHT' 
  AND ca.ca_location_type = 'condo'",True,True,1,1,,,0.00705718994140625
244,Hãy tính toán chi phí vận chuyển trung bình cho các mặt hàng thời trang Women được gửi đến bang Texas bằng phương thức giao hàng NEXT DAY thông qua hệ thống bán hàng trực tuyến Web,"SELECT AVG(ws.ws_ext_ship_cost)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Women' 
  AND sm.sm_type = 'NEXT DAY' 
  AND ca.ca_state = 'TX';","SELECT AVG(ws.ws_ext_ship_cost)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Women' 
  AND sm.sm_type = 'NEXT DAY' 
  AND ca.ca_state = 'TX'",True,True,1,1,,,0.005432605743408203
245,Bạn hãy so sánh lợi nhuận ròng giữa hai phương thức vận chuyển REGULAR và EXPRESS đối với các mặt hàng danh mục Home được bán trên kênh Web trong suốt năm 2001,"SELECT sm.sm_type, SUM(ws.ws_net_profit) AS total_profit
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' 
  AND sm.sm_type IN ('REGULAR', 'EXPRESS') 
  AND d.d_year = 2001
GROUP BY sm.sm_type;","SELECT sm.sm_type, SUM(ws.ws_net_profit) AS total_profit
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' 
  AND sm.sm_type IN ('REGULAR', 'EXPRESS') 
  AND d.d_year = 2001
GROUP BY sm.sm_type",True,True,2,2,,,0.0054988861083984375
246,Thống kê giúp tôi tổng số lượng sản phẩm Children được bán qua kênh Catalog và vận chuyển bằng đường bộ LIBRARY cho những khách hàng nữ đã lập gia đình.,"SELECT SUM(cs.cs_quantity)
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Children' 
  AND sm.sm_type = 'LIBRARY' 
  AND cd.cd_gender = 'F' 
  AND cd.cd_marital_status = 'M';","SELECT SUM(cs.cs_quantity)
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Children' 
  AND sm.sm_type = 'LIBRARY' 
  AND cd.cd_gender = 'F' 
  AND cd.cd_marital_status = 'M'",True,True,1,1,,,0.009566307067871094
247,Bạn hãy tìm giúp tôi tổng tiền thuế thu được từ các đơn hàng Catalog của danh mục Jewelry được vận chuyển bằng phương thức TWO DAY đến khu vực có múi giờ là âm bảy,"SELECT SUM(cs.cs_ext_tax)
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' 
  AND sm.sm_type = 'TWO DAY' 
  AND ca.ca_gmt_offset = -7.00;","SELECT SUM(cs.cs_ext_tax)
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' 
  AND sm.sm_type = 'TWO DAY' 
  AND ca.ca_gmt_offset = -7.00",True,True,1,1,,,0.005640506744384766
248,Hãy liệt kê danh sách năm khách hàng có trình độ học vấn là Tiến sĩ đã chi tiêu nhiều nhất cho các mặt hàng Shoes vận chuyển qua phương thức OVERNIGHT trên hệ thống Catalog.,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_sales_price) AS total_spend
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Shoes' 
  AND sm.sm_type = 'OVERNIGHT' 
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spend DESC LIMIT 5;","SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_sales_price) AS total_spend
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Shoes' 
  AND sm.sm_type = 'OVERNIGHT' 
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spend DESC LIMIT 5",True,True,5,3,,,0.019545316696166992
249,Thống kê giúp tôi số lượng đơn hàng trực tuyến của danh mục Men được đặt bởi những khách hàng sinh sau năm một chín tám mươi và chọn phương thức giao hàng TWO DAY.,"SELECT COUNT(ws.ws_order_number)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Men' 
  AND c.c_birth_year > 1980 
  AND sm.sm_type = 'TWO DAY';","SELECT COUNT(ws.ws_order_number)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Men' 
  AND c.c_birth_year > 1980 
  AND sm.sm_type = 'TWO DAY'",True,True,1,1,,,0.006499767303466797
250,Hãy thống kê tổng số tiền hoàn lại cho những khách hàng sống tại các ngôi nhà dành cho một gia đình khi họ trả lại các mặt hàng Sports được giao bằng phương thức REGULAR,"SELECT SUM(wr.wr_refunded_cash)
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
JOIN web_sales ws ON wr.wr_item_sk = ws.ws_item_sk AND wr.wr_order_number = ws.ws_order_number
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Sports' 
  AND sm.sm_type = 'REGULAR' 
  AND ca.ca_location_type = 'single family';","SELECT SUM(wr.wr_refunded_cash)
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
JOIN web_sales ws ON wr.wr_item_sk = ws.ws_item_sk AND wr.wr_order_number = ws.ws_order_number
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Sports' 
  AND sm.sm_type = 'REGULAR' 
  AND ca.ca_location_type = 'single family'",True,True,1,1,,,0.007618904113769531
252,Bạn hãy tìm giúp tôi mức lợi nhuận trung bình của các đơn hàng Catalog được xử lý bởi trung tâm hỗ trợ có diện tích mặt sàn lớn nhất trong hệ thống,"SELECT cc.cc_name, AVG(cs.cs_net_profit) AS avg_profit
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
WHERE cc.cc_sq_ft = (SELECT MAX(cc_sq_ft) FROM call_center)
GROUP BY cc.cc_name;","SELECT cc.cc_name, AVG(cs.cs_net_profit) AS avg_profit
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
WHERE cc.cc_sq_ft = (SELECT MAX(cc_sq_ft) FROM call_center)
GROUP BY cc.cc_name",True,True,1,2,,,0.005964517593383789
253,Bạn hãy tính toán lợi nhuận ròng từ các sản phẩm danh mục Home được bán qua Website có ngày bắt đầu hoạt động sớm nhất trong hệ thống.,"SELECT web.web_name, SUM(ws.ws_net_profit)
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE web.web_rec_start_date = (SELECT MIN(web_rec_start_date) FROM web_site)
  AND i.i_category = 'Home'
GROUP BY web.web_name;","SELECT web.web_name, SUM(ws.ws_net_profit)
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE web.web_rec_start_date = (SELECT MIN(web_rec_start_date) FROM web_site)
  AND i.i_category = 'Home'
GROUP BY web.web_name",True,True,5,2,,,0.005766630172729492
254,Thống kê tổng số đơn hàng Jewelry được giao bằng dịch vụ EXPRESS thông qua các trang web có lượng khách truy cập (mã số thuế) 0.11,"SELECT COUNT(*)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE sm.sm_type = 'EXPRESS' AND web.web_tax_percentage = 0.11 AND i.i_category = 'Jewelry';","SELECT COUNT(*)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE sm.sm_type = 'EXPRESS' AND web.web_tax_percentage = 0.11 AND i.i_category = 'Jewelry'",True,True,1,1,,,0.0027463436126708984
255,Hãy liệt kê danh sách các mã sản phẩm và số lượng tồn kho tương ứng của chúng tại kho hàng có mã số là một,"SELECT inv_item_sk, inv_quantity_on_hand 
FROM inventory 
WHERE inv_warehouse_sk = 1;","SELECT inv_item_sk, inv_quantity_on_hand 
FROM inventory 
WHERE inv_warehouse_sk = 1",True,True,50,2,,,0.00079345703125
256,Bạn hãy thống kê tổng số lượng hàng tồn kho cho tất cả các sản phẩm thuộc danh mục hàng Music,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';","SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'",True,True,1,1,,,0.009412288665771484
257,Bạn hãy liệt kê tên các sản phẩm thuộc danh mục Children và số lượng tồn kho hiện tại,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
LIMIT 10;","SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
LIMIT 10",True,True,10,2,,,0.0031061172485351562
258,Bạn hãy thống kê tổng số lượng hàng tồn kho của các sản phẩm thuộc danh mục 'Music' tại tất cả các kho hàng trong suốt quý một của năm 2002,"SELECT i.i_category, SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002 AND d.d_qoy = 1
GROUP BY i.i_category;","SELECT i.i_category, SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002 AND d.d_qoy = 1
GROUP BY i.i_category",True,True,1,2,,,0.004865884780883789
259,Hãy cho tôi biết lượng tồn kho trung bình của các mặt hàng thời trang 'Women' vào những ngày cuối tuần trong tháng mười hai năm 2001,"SELECT AVG(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_weekend = 'Y' 
  AND d.d_year = 2001 AND d.d_moy = 12;","SELECT AVG(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_weekend = 'Y' 
  AND d.d_year = 2001 AND d.d_moy = 12",True,True,1,1,,,0.0033812522888183594
262,"Bạn hãy thống kê tổng lợi nhuận dự kiến nếu chúng ta bán hết toàn bộ lượng hàng tồn kho của danh mục 'Music' hiện có, dựa trên mức giá bán lẻ hiện tại của từng sản phẩm.","SELECT SUM((i.i_current_price - i.i_wholesale_cost) * inv.inv_quantity_on_hand) AS potential_profit
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';","SELECT SUM((i.i_current_price - i.i_wholesale_cost) * inv.inv_quantity_on_hand) AS potential_profit
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'",True,True,1,1,,,0.010869264602661133
264,Bạn hãy liệt kê năm nhà sản xuất có lượng tồn kho danh mục 'Children' bị sụt giảm nhiều nhất khi so sánh giữa quý một và quý hai năm 2002,"SELECT i.i_manufact, 
       SUM(CASE WHEN d.d_qoy = 1 THEN inv.inv_quantity_on_hand ELSE 0 END) - 
       SUM(CASE WHEN d.d_qoy = 2 THEN inv.inv_quantity_on_hand ELSE 0 END) AS stock_drop
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_manufact
ORDER BY stock_drop DESC LIMIT 5;","SELECT i.i_manufact, 
       SUM(CASE WHEN d.d_qoy = 1 THEN inv.inv_quantity_on_hand ELSE 0 END) - 
       SUM(CASE WHEN d.d_qoy = 2 THEN inv.inv_quantity_on_hand ELSE 0 END) AS stock_drop
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_manufact
ORDER BY stock_drop DESC LIMIT 5",True,True,5,2,,,0.010699272155761719
265,Bạn hãy tính toán sự chênh lệch về lượng hàng tồn kho của danh mục 'Children' giữa các kho hàng có múi giờ âm bảy và các kho hàng ở múi giờ âm năm.,"SELECT w.w_gmt_offset, SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children' AND w.w_gmt_offset IN (-7.00, -5.00)
GROUP BY w.w_gmt_offset;","SELECT w.w_gmt_offset, SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children' AND w.w_gmt_offset IN (-7.00, -5.00)
GROUP BY w.w_gmt_offset",True,True,1,2,,,0.01046609878540039
266,Hãy so sánh tổng lượng hàng tồn của danh mục 'Home' tại các kho phục vụ phương thức vận chuyển 'EXPRESS' so với phương thức 'REGULAR,"SELECT sm.sm_type, SUM(inv.inv_quantity_on_hand) AS total_inventory
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Home' AND sm.sm_type IN ('EXPRESS', 'REGULAR')
GROUP BY sm.sm_type;","SELECT sm.sm_type, SUM(inv.inv_quantity_on_hand) AS total_inventory
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Home' AND sm.sm_type IN ('EXPRESS', 'REGULAR')
GROUP BY sm.sm_type",True,True,2,2,,,0.09353470802307129
267,Hãy so sánh sự chênh lệch về tổng lượng tồn kho của danh mục 'Home' giữa các kho hàng có diện tích trên một triệu feet vuông và dưới một triệu feet vuông,"SELECT CASE WHEN w.w_warehouse_sq_ft > 1000000 THEN 'Large' ELSE 'Small' END AS warehouse_size,
       SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY warehouse_size;","SELECT CASE WHEN w.w_warehouse_sq_ft > 1000000 THEN 'Large' ELSE 'Small' END AS warehouse_size,
       SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY warehouse_size",True,True,1,2,,,0.014269351959228516
268,Bạn hãy liệt kê năm nhà sản xuất có lượng hàng tồn kho danh mục 'Children' bị sụt giảm nhiều nhất khi so sánh giữa quý 3 và quý 4 năm 2002,"SELECT i.i_manufact, 
       SUM(CASE WHEN d.d_qoy = 3 THEN inv.inv_quantity_on_hand ELSE 0 END) - 
       SUM(CASE WHEN d.d_qoy = 4 THEN inv.inv_quantity_on_hand ELSE 0 END) AS stock_reduction
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_manufact
ORDER BY stock_reduction DESC LIMIT 5;","SELECT i.i_manufact, 
       SUM(CASE WHEN d.d_qoy = 3 THEN inv.inv_quantity_on_hand ELSE 0 END) - 
       SUM(CASE WHEN d.d_qoy = 4 THEN inv.inv_quantity_on_hand ELSE 0 END) AS stock_reduction
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_manufact
ORDER BY stock_reduction DESC LIMIT 5",True,True,5,2,,,0.00888681411743164
270,Hãy tìm địa chỉ cụ thể bao gồm tên đường và thành phố của các kho hàng hiện đang lưu trữ sản phẩm Electronics có màu đỏ,"SELECT DISTINCT w.w_street_name, w.w_city, w.w_state
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics' AND i.i_color = 'red';","SELECT DISTINCT w.w_street_name, w.w_city, w.w_state
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics' AND i.i_color = 'red'",True,True,5,3,,,0.009398460388183594
271,Bạn hãy hiển thị tên của những khách hàng ở bang California đã từng mua mặt hàng Women mà hiện nay mặt hàng đó vẫn còn tồn kho tại kho hàng địa phương.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk
WHERE ca.ca_state = 'CA' AND inv.inv_quantity_on_hand > 0;","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk
WHERE ca.ca_state = 'CA' AND inv.inv_quantity_on_hand > 0",True,True,50,2,,,0.29186415672302246
272,Hãy hiển thị danh sách các trang web page có chứa hình ảnh minh họa và đã từng bán các mặt hàng Jewelry cho khách hàng có trình độ học vấn là Tiến sĩ.,"SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND cd.cd_education_status = 'Advanced Degree' AND wp.wp_image_count > 0;","SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND cd.cd_education_status = 'Advanced Degree' AND wp.wp_image_count > 0",True,True,1,1,,,0.011174201965332031
273,Hãy tìm các đơn hàng Catalog sử dụng dịch vụ EXPRESS mà mặt hàng trong đơn đó hiện nay đã hết sạch hàng trong hệ thống kho bãi,"SELECT DISTINCT cs.cs_order_number
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk
WHERE sm.sm_type = 'EXPRESS' AND inv.inv_quantity_on_hand = 0;","SELECT DISTINCT cs.cs_order_number
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk
WHERE sm.sm_type = 'EXPRESS' AND inv.inv_quantity_on_hand = 0",True,True,50,1,,,0.017244338989257812
275,Hãy hiển thị tên và email của khách hàng ở bang 'California' có trình độ 'Advanced Degree' đã từng mua đồ 'Jewelry' qua kênh Web.,"SELECT DISTINCT c.c_first_name, c.c_last_name, c.c_email_address
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'CA' AND cd.cd_education_status = 'Advanced Degree' AND i.i_category = 'Jewelry';","SELECT DISTINCT c.c_first_name, c.c_last_name, c.c_email_address
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'CA' AND cd.cd_education_status = 'Advanced Degree' AND i.i_category = 'Jewelry'",True,True,50,3,,,0.017182350158691406
276,Bạn hãy liệt kê các loại hình cư trú của những khách hàng ở 'Virginia' đã mua sản phẩm 'Shoes' được giao bằng phương thức 'OVERNIGHT',"SELECT DISTINCT ca.ca_location_type
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA' AND sm.sm_type = 'OVERNIGHT' AND i.i_category = 'Shoes';","SELECT DISTINCT ca.ca_location_type
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA' AND sm.sm_type = 'OVERNIGHT' AND i.i_category = 'Shoes'",True,True,4,1,,,0.007295131683349609
277,Bạn hãy tìm URL của các trang web page đã thực hiện bán mặt hàng 'Music' cho khách hàng sống tại cùng bang với kho hàng cung cấp.,"SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Music' AND w.w_state = ca.ca_state;","SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Music' AND w.w_state = ca.ca_state",True,True,1,1,,,0.008380889892578125
278,Hãy liệt kê tên các Website đã từng bán mặt hàng 'Sports' cho khách hàng có trình độ học vấn là 'College' tại bang 'Iowa',"SELECT DISTINCT web.web_name
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND cd.cd_education_status = 'College' AND ca.ca_state = 'IA';","SELECT DISTINCT web.web_name
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND cd.cd_education_status = 'College' AND ca.ca_state = 'IA'",True,True,5,1,,,0.007674217224121094
279,Bạn hãy hiển thị tên các nhà sản xuất của sản phẩm 'Books' bị trả lại qua kênh Catalog bởi khách hàng sống tại bang 'Kentucky',"SELECT DISTINCT i.i_manufact
FROM catalog_returns cr
JOIN item i ON cr.cr_item_sk = i.i_item_sk
JOIN customer_address ca ON cr.cr_refunded_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Books' AND ca.ca_state = 'KY';","SELECT DISTINCT i.i_manufact
FROM catalog_returns cr
JOIN item i ON cr.cr_item_sk = i.i_item_sk
JOIN customer_address ca ON cr.cr_refunded_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Books' AND ca.ca_state = 'KY'",True,True,50,1,,,0.005364179611206055
280,Bạn hãy hiển thị địa chỉ tên đường của các kho hàng đang chứa sản phẩm 'Electronics' màu xanh dương phục vụ cho phương thức vận chuyển 'EXPRESS,"SELECT DISTINCT w.w_street_name
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Electronics' AND i.i_color = 'blue' AND sm.sm_type = 'EXPRESS';","SELECT DISTINCT w.w_street_name
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Electronics' AND i.i_color = 'blue' AND sm.sm_type = 'EXPRESS'",True,True,5,1,,,0.017787694931030273
281,Bạn hãy hiển thị tên Website và mã số thuế của nó nếu Website đó đã từng bán đồ 'Women' cho khách hàng ở 'Virginia' có trên hai người phụ thuộc,"SELECT DISTINCT web.web_name, web.web_tax_percentage
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Women' AND ca.ca_state = 'VA' AND cd.cd_dep_count > 2;","SELECT DISTINCT web.web_name, web.web_tax_percentage
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Women' AND ca.ca_state = 'VA' AND cd.cd_dep_count > 2",True,True,18,2,,,0.009670734405517578
282,Hãy hiển thị tên người quản lý trung tâm hỗ trợ đã xử lý việc hoàn lại cho mặt hàng 'Home' của những khách hàng có xếp hạng tín dụng 'Good',"SELECT DISTINCT cc.cc_manager
FROM catalog_returns cr
JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
JOIN item i ON cr.cr_item_sk = i.i_item_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Home' AND cd.cd_credit_rating = 'Good';","SELECT DISTINCT cc.cc_manager
FROM catalog_returns cr
JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
JOIN item i ON cr.cr_item_sk = i.i_item_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Home' AND cd.cd_credit_rating = 'Good'",True,True,4,1,,,0.006902217864990234
283,Hãy hiển thị tên người quản lý trung tâm hỗ trợ call center đã xử lý việc trả hàng 'Men' cho những khách hàng có bằng '4 yr Degree' sống tại bang 'North Carolina'.,"SELECT DISTINCT cc.cc_manager
FROM catalog_returns cr
JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON cr.cr_refunded_addr_sk = ca.ca_address_sk
JOIN item i ON cr.cr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men' AND cd.cd_education_status = '4 yr Degree' AND ca.ca_state = 'NC';","SELECT DISTINCT cc.cc_manager
FROM catalog_returns cr
JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON cr.cr_refunded_addr_sk = ca.ca_address_sk
JOIN item i ON cr.cr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men' AND cd.cd_education_status = '4 yr Degree' AND ca.ca_state = 'NC'",True,True,4,1,,,0.006152629852294922
284,Bạn hãy liệt kê tên các nhà sản xuất có sản phẩm thuộc danh mục Home hiện đang được bày bán tại các cửa hàng có trên hai trăm nhân viên phục vụ,"SELECT DISTINCT i.i_manufact
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home' AND s.s_number_employees > 200;","SELECT DISTINCT i.i_manufact
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home' AND s.s_number_employees > 200",True,True,50,1,,,0.008164167404174805
285,Liệt kê các loại hình cư trú của những khách hàng ở bang Virginia đã mua sản phẩm Children thông qua phương thức vận chuyển hỏa tốc ,"SELECT DISTINCT ca.ca_location_type
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA' AND sm.sm_type = 'OVERNIGHT' AND i.i_category = 'Children';","SELECT DISTINCT ca.ca_location_type
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA' AND sm.sm_type = 'OVERNIGHT' AND i.i_category = 'Children'",True,True,4,1,,,0.006768941879272461
286,Hiển thị danh sách các thương hiệu sản phẩm thuộc danh mục hàng Shoes,SELECT DISTINCT i_brand FROM item WHERE i_category = 'Shoes';,SELECT DISTINCT i_brand FROM item WHERE i_category = 'Shoes',True,True,9,1,,,0.0016493797302246094
287,Hiển thị tên Website và mã số thuế của nó nếu Website đó đã bán hàng Sports cho những hộ gia đình sở hữu trên ba xe ô tô,"SELECT DISTINCT web.web_name, web.web_tax_percentage
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND hd.hd_vehicle_count > 3;","SELECT DISTINCT web.web_name, web.web_tax_percentage
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND hd.hd_vehicle_count > 3",True,True,18,2,,,0.005753278732299805
288,Tìm danh sách tên các khách hàng đã từng mua mặt hàng 'Music' thông qua kênh Web nhưng lại thực hiện việc trả lại hàng đó thông qua kênh Catalog,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
WHERE c.c_customer_sk IN (
    SELECT ws_bill_customer_sk FROM web_sales ws 
    JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_category = 'Music'
)
AND c.c_customer_sk IN (
    SELECT cr_refunded_customer_sk FROM catalog_returns cr 
    JOIN item i ON cr.cr_item_sk = i.i_item_sk WHERE i.i_category = 'Music'
);","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
WHERE c.c_customer_sk IN (
    SELECT ws_bill_customer_sk FROM web_sales ws 
    JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_category = 'Music'
)
AND c.c_customer_sk IN (
    SELECT cr_refunded_customer_sk FROM catalog_returns cr 
    JOIN item i ON cr.cr_item_sk = i.i_item_sk WHERE i.i_category = 'Music'
)",True,True,50,2,,,0.018071889877319336
289,Tìm tên người quản lý cửa hàng đã bán mặt hàng 'Shoes' được giao bằng dịch vụ 'OVERNIGHT' cho những khách hàng sống cùng bang với địa điểm cửa hàng đó,"SELECT DISTINCT s.s_manager
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk -- Giả định liên kết giao hàng
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Shoes' AND sm.sm_type = 'OVERNIGHT' AND s.s_state = ca.ca_state;","SELECT DISTINCT s.s_manager
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk -- Giả định liên kết giao hàng
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Shoes' AND sm.sm_type = 'OVERNIGHT' AND s.s_state = ca.ca_state",True,True,6,1,,,0.019550323486328125
290,Liệt kê danh sách tên những khách hàng có trình độ 'College' đã mua đồ 'Men' tại cửa hàng vào năm 2001 nhưng chưa bao giờ mua hàng qua trang Web,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001
EXCEPT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk;","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001
EXCEPT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk",True,True,50,2,,,0.06598544120788574
291,Hãy tìm tên các quản lý trung tâm hỗ trợ đã xử lý đơn hàng 'Sports' cho khách hàng độc thân vào khung giờ từ mười giờ đêm đến hai giờ sáng,"SELECT DISTINCT cc.cc_manager
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND cd.cd_marital_status = 'S' AND t.t_hour IN (22, 23, 0, 1);","SELECT DISTINCT cc.cc_manager
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND cd.cd_marital_status = 'S' AND t.t_hour IN (22, 23, 0, 1)",True,True,4,1,,,0.01713705062866211
292,Bạn hãy liệt kê tên các khách hàng đã từng mua đồ 'Electronics' qua kênh Web nhưng cũng đồng thời thực hiện mua hàng trực tiếp tại các cửa hàng ở bang 'Texas'.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
  AND c.c_customer_sk IN (SELECT ws_bill_customer_sk FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics')
  AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics');","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
  AND c.c_customer_sk IN (SELECT ws_bill_customer_sk FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics')
  AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics')",True,True,50,2,,,0.011898994445800781
293,Liệt kê danh sách tên các khách hàng 'độc thân' đã mua đồ 'Jewelry' qua kênh Web nhưng chưa bao giờ thực hiện bất kỳ giao dịch nào qua kênh Catalog,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Jewelry'
EXCEPT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk;","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Jewelry'
EXCEPT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk",True,True,50,2,,,0.052160024642944336
294,Tìm tên các Website đã bán đồ 'Women' cho khách hàng có xếp hạng tín dụng 'Good' thông qua phương thức vận chuyển 'OVERNIGHT' mà đơn hàng đó sau này bị trả lại.,"SELECT DISTINCT web.web_name
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Women' AND sm.sm_type = 'OVERNIGHT' AND cd.cd_credit_rating = 'Good';","SELECT DISTINCT web.web_name
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Women' AND sm.sm_type = 'OVERNIGHT' AND cd.cd_credit_rating = 'Good'",True,True,5,1,,,0.014427900314331055
296,Liệt kê tên các trung tâm hỗ trợ đã xử lý đơn hàng 'Jewelry' cho các hộ gia đình sở hữu trên ba xe ô tô thông qua phương thức vận chuyển 'NEXT DAY,"SELECT DISTINCT cc.cc_name
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND sm.sm_type = 'NEXT DAY' AND hd.hd_vehicle_count > 3;","SELECT DISTINCT cc.cc_name
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND sm.sm_type = 'NEXT DAY' AND hd.hd_vehicle_count > 3",True,True,3,1,,,0.006698131561279297
297,Bạn hãy liệt kê tên các khách hàng đã từng mua mặt hàng 'Music' trực tiếp tại cửa hàng nhưng lại thực hiện trả lại món hàng đó thông qua hệ thống Web,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND EXISTS (
      SELECT 1 FROM web_returns wr 
      WHERE wr.wr_refunded_customer_sk = c.c_customer_sk AND wr.wr_item_sk = i.i_item_sk
  );","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND EXISTS (
      SELECT 1 FROM web_returns wr 
      WHERE wr.wr_refunded_customer_sk = c.c_customer_sk AND wr.wr_item_sk = i.i_item_sk
  )",True,True,13,2,,,0.029560565948486328
298,Hãy liệt kê tên các kho hàng đang lưu trữ sản phẩm 'Shoes' mà có số lượng tồn kho cao hơn mức tồn kho trung bình của tất cả các kho trong cùng bang đó.,"WITH AvgStock AS (
    SELECT w_state, AVG(inv_quantity_on_hand) as state_avg
    FROM inventory JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk
    GROUP BY w_state
)
SELECT DISTINCT w.w_warehouse_name
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN AvgStock ast ON w.w_state = ast.w_state
WHERE i.i_category = 'Shoes' AND inv.inv_quantity_on_hand > ast.state_avg;","WITH AvgStock AS (
    SELECT w_state, AVG(inv_quantity_on_hand) as state_avg
    FROM inventory JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk
    GROUP BY w_state
)
SELECT DISTINCT w.w_warehouse_name
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN AvgStock ast ON w.w_state = ast.w_state
WHERE i.i_category = 'Shoes' AND inv.inv_quantity_on_hand > ast.state_avg",True,True,5,1,,,0.05016207695007324
299,Bạn hãy tìm tên những khách hàng có trình độ 'Advanced Degree' đã mua đồ 'Jewelry' qua kênh Web và cũng đã từng mua đồ 'Home' qua kênh Catalog,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_education_status = 'Advanced Degree'
INTERSECT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
JOIN item i1 ON ws.ws_item_sk = i1.i_item_sk WHERE i1.i_category = 'Jewelry'
INTERSECT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk
JOIN item i2 ON cs.cs_item_sk = i2.i_item_sk WHERE i2.i_category = 'Home';","SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_education_status = 'Advanced Degree'
INTERSECT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
JOIN item i1 ON ws.ws_item_sk = i1.i_item_sk WHERE i1.i_category = 'Jewelry'
INTERSECT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk
JOIN item i2 ON cs.cs_item_sk = i2.i_item_sk WHERE i2.i_category = 'Home'",True,True,50,2,,,0.03388786315917969
300,Tìm URL của những trang web page đã bán đồ 'Women' cho khách hàng có xếp hạng tín dụng 'Good' thông qua hệ thống Website có ngày hoạt động sớm nhất.,"SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Women' AND cd.cd_credit_rating = 'Good'
  AND web.web_rec_start_date = (SELECT MIN(web_rec_start_date) FROM web_site);","SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Women' AND cd.cd_credit_rating = 'Good'
  AND web.web_rec_start_date = (SELECT MIN(web_rec_start_date) FROM web_site)",True,True,1,1,,,0.011403083801269531
301,Ai mua đồ Shoes nhiều nhất ở TX vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.016201496124267578
303,Tổng doanh thu của Women tại bang KY năm 2002 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002",True,True,1,1,,,0.01169276237487793
304,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01510167121887207
307,"Trong năm 2002, khách hàng ở GA mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.013340950012207031
309,Khách hàng có bằng Secondary tại NC thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.0191805362701416
310,Liệt kê 10 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở GA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10",True,True,10,5,,,0.011387109756469727
311,Ai mua đồ Men nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.01630234718322754
312,Năm ngoái dân ở IL mua Jewelry nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.02291250228881836
313,Có bao nhiêu đơn hàng Electronics bị trả lại tại VA vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2002;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2002",True,True,1,3,,,0.008955001831054688
314,Tìm email của các khách hàng VIP ở IA đã mua đồ Sports trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC",True,True,50,4,,,0.018932342529296875
315,Tìm 10 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10",True,True,10,5,,,0.012485265731811523
316,Tìm email của các khách hàng VIP ở IA đã mua đồ Electronics trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Electronics'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Electronics'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC",True,True,50,4,,,0.017705440521240234
317,Giá bán trung bình của mặt hàng Books trong năm 1999 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 1999
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 1999
GROUP BY i.i_category",True,True,1,4,,,0.00660252571105957
318,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Home tại TX.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10",True,True,10,5,,,0.018945932388305664
320,So sánh lợi nhuận của Women giữa kênh Web và Catalog tại KY.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel",True,True,2,2,,,0.010371923446655273
321,Doanh số của Home tại GA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'GA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'GA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'GA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'GA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.017591476440429688
322,Ai mua đồ Music nhiều nhất ở KY vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.013469457626342773
323,Năm 2000 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_year",True,True,1,4,,,0.0032625198364257812
324,Có bao nhiêu đơn hàng Shoes bị trả lại tại IL vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001",True,True,1,3,,,0.0055310726165771484
327,So sánh lợi nhuận của Jewelry giữa kênh Web và Web tại TX.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel",True,True,1,2,,,0.007336139678955078
328,Thống kê tổng số lượng Women được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.014732837677001953
330,Tìm email của các khách hàng VIP ở VA đã mua đồ Shoes trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Shoes'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Shoes'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC",True,True,50,4,,,0.018899917602539062
331,Năm ngoái dân ở TX mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.02928948402404785
332,Tìm 5 sản phẩm Home có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5",True,True,5,5,,,0.013631343841552734
333,Khách hàng có bằng 2 yr Degree tại GA thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.02565455436706543
334,"Trong năm 2001, khách hàng ở KS mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.015776634216308594
335,Ai mua đồ Women nhiều nhất ở TX vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.020549774169921875
337,Ai mua đồ Sports nhiều nhất ở IA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.01419687271118164
338,Cho tôi xem danh sách sản phẩm Music bán chạy nhất ở KS.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10",True,True,10,6,,,0.013787031173706055
339,Thống kê tổng số lượng Women được mua bởi những khách hàng có trình độ 2 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND cd.cd_education_status = '2 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND cd.cd_education_status = '2 yr Degree'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.0162966251373291
341,Năm 2001 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year",True,True,1,4,,,0.0032873153686523438
342,"Năm 1999, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC",True,True,3,2,,,0.005622386932373047
343,Tỷ lệ trả hàng của Electronics ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Electronics' as category,
    'GA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Electronics' as category,
    'GA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.035329580307006836
344,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Home tại KY.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 5;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 5",True,True,5,5,,,0.01637411117553711
345,Tỷ lệ trả hàng của Books ở IA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Books' as category,
    'IA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Books' as category,
    'IA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.037766218185424805
346,Năm ngoái dân ở TX mua Sports nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Sports'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Sports'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.021281957626342773
347,"Hàng Women trả lại ở GA có nhiều không, xem số liệu năm 2002 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.011065959930419922
348,Tổng doanh thu của Women tại bang IA năm 2000 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000",True,True,1,1,,,0.013593196868896484
349,Tìm 5 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5",True,True,5,5,,,0.009387731552124023
351,Năm ngoái dân ở IL mua Sports nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Sports'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Sports'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.022954225540161133
352,Ai mua đồ Books nhiều nhất ở MO vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'MO'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'MO'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.015975475311279297
353,Năm 2001 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year",True,True,1,4,,,0.005308866500854492
354,Giá bán trung bình của mặt hàng Music trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 2000
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 2000
GROUP BY i.i_category",True,True,1,4,,,0.006440639495849609
355,So sánh lợi nhuận của Jewelry giữa kênh Store và Web tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
ORDER BY channel",True,True,2,2,,,0.010364294052124023
356,Thống kê tổng số lượng Home được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.017069578170776367
357,Năm 2001 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year",True,True,1,4,,,0.0027806758880615234
358,"Trong quý 4 năm 2000, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Men?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Men'
  AND d.d_year = 2000
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Men'
  AND d.d_year = 2000
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01400136947631836
359,Tỷ lệ trả hàng của Men ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'GA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'GA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03710317611694336
360,Giá bán trung bình của mặt hàng Electronics trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
GROUP BY i.i_category",True,True,1,4,,,0.006426811218261719
361,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.016698598861694336
362,Tổng doanh thu của Children tại bang IL năm 2002 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002",True,True,1,1,,,0.011694908142089844
364,Tìm 10 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10",True,True,10,5,,,0.011180639266967773
365,Tổng doanh thu của Shoes tại bang IL năm 2000 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2000;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2000",True,True,1,1,,,0.012861490249633789
366,So sánh lợi nhuận của Men giữa kênh Web và Catalog tại KS.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel",True,True,2,2,,,0.008549690246582031
367,Tổng doanh thu của Women tại bang TX năm 2001 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001",True,True,1,1,,,0.010846853256225586
368,So sánh lợi nhuận của Music giữa kênh Store và Catalog tại VA.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'VA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'VA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'VA'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'VA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'VA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'VA'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel",True,True,2,2,,,0.01100921630859375
369,Khách hàng có bằng 4 yr Degree tại KS thường mua Sports qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.0176694393157959
370,Tổng doanh thu của Sports tại bang IL năm 2002 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002",True,True,1,1,,,0.009959697723388672
371,Doanh số của Shoes tại NC năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.01568889617919922
373,Thống kê tổng số lượng Children được mua bởi những khách hàng có trình độ College.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND cd.cd_education_status = 'College'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND cd.cd_education_status = 'College'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.015360593795776367
374,Năm ngoái dân ở IL mua Children nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.02187657356262207
376,"Trong năm 2002, khách hàng ở IL mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.017255067825317383
377,"Trong quý 4 năm 1999, nhóm khách hàng Primary chi bao nhiêu tiền cho Men?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.015414714813232422
378,Năm 2002 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year",True,True,1,4,,,0.003473520278930664
380,Có bao nhiêu đơn hàng Women bị trả lại tại VA vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2000;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2000",True,True,1,3,,,0.00860452651977539
381,"Hàng Sports trả lại ở GA có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.007189273834228516
382,Có bao nhiêu đơn hàng Music bị trả lại tại NC vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002",True,True,1,3,,,0.0061228275299072266
383,"Trong quý 4 năm 2002, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Shoes?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.014855146408081055
384,Giá bán trung bình của mặt hàng Electronics trong năm 1999 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
GROUP BY i.i_category",True,True,1,4,,,0.006953001022338867
385,"Hàng Home trả lại ở IA có nhiều không, xem số liệu năm 2002 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.007848262786865234
386,Năm ngoái dân ở TX mua Children nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.0261538028717041
387,Doanh số của Electronics tại IA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.026118755340576172
388,"Trong quý 4 năm 2000, nhóm khách hàng Advanced Degree chi bao nhiêu tiền cho Sports?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Sports'
  AND d.d_year = 2000
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Sports'
  AND d.d_year = 2000
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01931166648864746
389,Doanh số của Sports tại KY năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.02845144271850586
390,"Trong năm 2001, khách hàng ở VA mua nhiều Music không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Music'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Music'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.01739215850830078
391,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Jewelry tại NC.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'NC'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 3;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'NC'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 3",True,True,3,5,,,0.02271723747253418
392,Tìm 10 sản phẩm Children có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10",True,True,10,5,,,0.010793685913085938
393,Năm 2000 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_year",True,True,1,4,,,0.0036394596099853516
394,Ai mua đồ Men nhiều nhất ở GA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'GA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'GA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.014194726943969727
395,"Năm 2002, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC",True,True,3,2,,,0.0061762332916259766
396,Tìm 10 sản phẩm Sports có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10",True,True,10,5,,,0.011354446411132812
397,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở IA.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10",True,True,10,6,,,0.012792587280273438
398,Tỷ lệ trả hàng của Women ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'VA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Women' as category,
    'VA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'VA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Women' as category,
    'VA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03679966926574707
399,Doanh số của Electronics tại NC năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.017803192138671875
400,Có bao nhiêu đơn hàng Electronics bị trả lại tại MO vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001",True,True,1,3,,,0.006345987319946289
401,Khách hàng có bằng Secondary tại VA thường mua Women qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.018034696578979492
402,Tìm email của các khách hàng VIP ở TX đã mua đồ Sports trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC",True,True,50,4,,,0.017948627471923828
403,Giá bán trung bình của mặt hàng Men trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 2002
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 2002
GROUP BY i.i_category",True,True,1,4,,,0.00784754753112793
404,Liệt kê 10 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở VA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'VA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'VA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10",True,True,10,5,,,0.011774778366088867
405,Khách hàng có bằng Primary tại IA thường mua Shoes qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Primary'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Shoes'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Primary'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Shoes'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Primary'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Shoes'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Primary'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Shoes'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Primary'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Shoes'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Primary'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Shoes'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.018762826919555664
406,"Trong quý 4 năm 2002, nhóm khách hàng College chi bao nhiêu tiền cho Sports?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Sports'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Sports'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.017216205596923828
407,Tìm 10 sản phẩm Men có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10",True,True,10,5,,,0.012154579162597656
408,Doanh số của Shoes tại IL năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.022119998931884766
409,Tổng doanh thu của Music tại bang KS năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999",True,True,1,1,,,0.01127171516418457
410,Tìm email của các khách hàng VIP ở VA đã mua đồ Jewelry trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC",True,True,50,4,,,0.018349409103393555
411,Doanh số của Men tại VA năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.01653122901916504
412,Khách hàng có bằng College tại IA thường mua Sports qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.017966508865356445
413,Thống kê tổng số lượng Sports được mua bởi những khách hàng có trình độ Primary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND cd.cd_education_status = 'Primary'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND cd.cd_education_status = 'Primary'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.015221834182739258
414,Năm ngoái dân ở NC mua Books nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.02008199691772461
415,Cho tôi xem danh sách sản phẩm Children bán chạy nhất ở MO.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'MO'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'MO'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10",True,True,10,6,,,0.012265682220458984
416,Giá bán trung bình của mặt hàng Shoes trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
GROUP BY i.i_category",True,True,1,4,,,0.008272886276245117
418,Có bao nhiêu đơn hàng Men bị trả lại tại GA vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000",True,True,1,3,,,0.00845956802368164
419,Tổng doanh thu của Sports tại bang IA năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999",True,True,1,1,,,0.010299921035766602
420,Năm ngoái dân ở KS mua Jewelry nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.020272254943847656
421,Tìm 5 sản phẩm Children có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5",True,True,5,5,,,0.012414216995239258
422,Có bao nhiêu đơn hàng Electronics bị trả lại tại TX vào năm 1999?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999",True,True,1,3,,,0.0065538883209228516
423,Giá bán trung bình của mặt hàng Jewelry trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
GROUP BY i.i_category",True,True,1,4,,,0.007399320602416992
424,Thống kê tổng số lượng Shoes được mua bởi những khách hàng có trình độ Advanced Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.016876220703125
425,Khách hàng có bằng 2 yr Degree tại KS thường mua Home qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.01758885383605957
426,Liệt kê 3 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3",True,True,3,5,,,0.010390996932983398
427,"Hàng Music trả lại ở TX có nhiều không, xem số liệu năm 2001 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.008347749710083008
428,So sánh lợi nhuận của Children giữa kênh Web và Web tại KY.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel",True,True,1,2,,,0.006696224212646484
429,Giá bán trung bình của mặt hàng Women trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND d.d_year = 2000
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND d.d_year = 2000
GROUP BY i.i_category",True,True,1,4,,,0.007602691650390625
430,Năm ngoái dân ở TX mua Books nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.022009849548339844
431,Có bao nhiêu đơn hàng Shoes bị trả lại tại MO vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2002;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2002",True,True,1,3,,,0.007073163986206055
432,Cho tôi xem danh sách sản phẩm Women bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10",True,True,10,6,,,0.011693239212036133
433,Năm 2002 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year",True,True,1,4,,,0.005017995834350586
434,Giá bán trung bình của mặt hàng Sports trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 2001
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 2001
GROUP BY i.i_category",True,True,1,4,,,0.005940437316894531
435,Có bao nhiêu đơn hàng Shoes bị trả lại tại IA vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000",True,True,1,3,,,0.00736546516418457
436,Liệt kê 5 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở GA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'GA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'GA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5",True,True,5,5,,,0.010306596755981445
437,Năm 1999 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY d.d_year",True,True,1,4,,,0.005288600921630859
439,So sánh lợi nhuận của Electronics giữa kênh Store và Catalog tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel",True,True,2,2,,,0.01489710807800293
440,Năm ngoái dân ở IL mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.024044036865234375
441,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại KS.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10",True,True,10,5,,,0.02507758140563965
442,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại GA.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 3;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 3",True,True,3,5,,,0.018198490142822266
443,Tỷ lệ trả hàng của Men ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03744959831237793
444,Có bao nhiêu đơn hàng Books bị trả lại tại IL vào năm 1999?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999",True,True,1,3,,,0.007496833801269531
445,Doanh số của Jewelry tại TX năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.0189211368560791
446,Tìm 3 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3",True,True,3,5,,,0.011795520782470703
447,Doanh số của Women tại IA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.018219709396362305
448,Khách hàng có bằng Advanced Degree tại KS thường mua Shoes qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Shoes'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Shoes'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Shoes'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Shoes'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Shoes'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Shoes'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.01883840560913086
449,Có bao nhiêu đơn hàng Jewelry bị trả lại tại TX vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001",True,True,1,3,,,0.009435415267944336
450,Có bao nhiêu đơn hàng Home bị trả lại tại IL vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002",True,True,1,3,,,0.008120298385620117
451,Doanh số của Books tại VA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'VA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'VA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'VA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'VA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.015813350677490234
453,Ai mua đồ Shoes nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.015408754348754883
454,"Hàng Books trả lại ở KS có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.007640361785888672
455,Tỷ lệ trả hàng của Children ở TX có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'TX'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Children' as category,
    'TX' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'TX'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Children' as category,
    'TX' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.0365903377532959
456,Cho tôi xem danh sách sản phẩm Books bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10",True,True,10,6,,,0.011667728424072266
457,Khách hàng có bằng College tại IA thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.01677250862121582
458,Giá bán trung bình của mặt hàng Music trong năm 1999 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 1999
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 1999
GROUP BY i.i_category",True,True,1,4,,,0.007085084915161133
459,Doanh số của Men tại MO năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'MO' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'MO' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'MO' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'MO' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.015414953231811523
460,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Sports tại VA.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 5;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 5",True,True,5,5,,,0.018582582473754883
461,Năm 1999 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY d.d_year",True,True,1,4,,,0.003657817840576172
462,So sánh lợi nhuận của Books giữa kênh Store và Web tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
ORDER BY channel",True,True,2,2,,,0.00935816764831543
463,Tìm email của các khách hàng VIP ở IA đã mua đồ Women trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Women'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Women'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC",True,True,50,4,,,0.017737865447998047
464,Giá bán trung bình của mặt hàng Electronics trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 2000
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 2000
GROUP BY i.i_category",True,True,1,4,,,0.006793498992919922
465,Doanh số của Men tại NC năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'NC' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'NC' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'NC' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'NC' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.01625227928161621
466,Năm 2002 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year;","SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year",True,True,1,4,,,0.0033957958221435547
467,So sánh lợi nhuận của Children giữa kênh Store và Catalog tại VA.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel",True,True,2,2,,,0.010673761367797852
468,Tìm email của các khách hàng VIP ở NC đã mua đồ Shoes trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC",True,True,50,4,,,0.018045425415039062
469,"Trong năm 2001, khách hàng ở MO mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.012600898742675781
470,Doanh số của Jewelry tại GA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.01624155044555664
471,Tìm 3 sản phẩm Electronics có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3",True,True,3,5,,,0.011524200439453125
472,Khách hàng có bằng 4 yr Degree tại TX thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.01939702033996582
473,"Hàng Women trả lại ở IL có nhiều không, xem số liệu năm 1999 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.007941961288452148
474,Thống kê tổng số lượng Children được mua bởi những khách hàng có trình độ 2 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND cd.cd_education_status = '2 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND cd.cd_education_status = '2 yr Degree'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.014823675155639648
475,Tìm email của các khách hàng VIP ở KY đã mua đồ Children trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Children'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Children'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC",True,True,50,4,,,0.025429725646972656
476,Năm ngoái dân ở VA mua Jewelry nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.026708126068115234
477,Tìm email của các khách hàng VIP ở TX đã mua đồ Women trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Women'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Women'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC",True,True,50,4,,,0.021489381790161133
478,Tổng doanh thu của Books tại bang GA năm 2001 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2001;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2001",True,True,1,1,,,0.01756572723388672
479,Cho tôi xem danh sách sản phẩm Books bán chạy nhất ở IA.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10",True,True,10,6,,,0.016813993453979492
480,Ai mua đồ Electronics nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.01660323143005371
481,So sánh lợi nhuận của Music giữa kênh Catalog và Catalog tại KS.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
ORDER BY channel",True,True,1,2,,,0.008366107940673828
482,Ai mua đồ Home nhiều nhất ở NC vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.016759634017944336
483,Liệt kê 5 thương hiệu Men được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5",True,True,5,5,,,0.01210927963256836
484,Tỷ lệ trả hàng của Shoes ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Shoes' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Shoes' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.035080671310424805
485,"Trong năm 2001, khách hàng ở NC mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.013871431350708008
486,Khách hàng có bằng Secondary tại KS thường mua Music qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Music'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Music'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Music'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Music'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Music'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Music'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.018334627151489258
488,Ai mua đồ Books nhiều nhất ở KS vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.015235424041748047
490,Ai mua đồ Sports nhiều nhất ở KY vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.01607990264892578
491,Có bao nhiêu đơn hàng Sports bị trả lại tại NC vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002",True,True,1,3,,,0.006160259246826172
492,Giá bán trung bình của mặt hàng Shoes trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY i.i_category",True,True,1,4,,,0.0068798065185546875
494,"Năm 2000, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC",True,True,3,2,,,0.006047964096069336
496,Liệt kê 5 thương hiệu Men được ưa chuộng nhất bởi khách hàng ở IA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5",True,True,5,5,,,0.01073455810546875
497,Khách hàng có bằng 4 yr Degree tại IA thường mua Men qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.0191953182220459
498,Có bao nhiêu đơn hàng Women bị trả lại tại VA vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2001;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2001",True,True,1,3,,,0.00635075569152832
499,Tìm email của các khách hàng VIP ở GA đã mua đồ Sports trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC",True,True,50,4,,,0.019549131393432617
501,"Hàng Books trả lại ở TX có nhiều không, xem số liệu năm 1999 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.009331941604614258
502,So sánh lợi nhuận của Children giữa kênh Web và Catalog tại IL.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel",True,True,2,2,,,0.010060548782348633
503,Khách hàng có bằng Advanced Degree tại KS thường mua Home qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.024754762649536133
505,Doanh số của Electronics tại GA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.020378828048706055
506,Tìm 5 sản phẩm Children có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5",True,True,5,5,,,0.010883808135986328
507,"Trong quý 4 năm 2002, nhóm khách hàng 4 yr Degree chi bao nhiêu tiền cho Music?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree'
  AND i.i_category = 'Music'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree'
  AND i.i_category = 'Music'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01683831214904785
508,Cho tôi xem danh sách sản phẩm Music bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10",True,True,10,6,,,0.01135110855102539
509,Thống kê tổng số lượng Electronics được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01628589630126953
511,"Hàng Children trả lại ở GA có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.0071146488189697266
512,Giá bán trung bình của mặt hàng Home trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY i.i_category",True,True,1,4,,,0.007590293884277344
513,Tìm 10 sản phẩm Men có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10",True,True,10,5,,,0.013071298599243164
514,Liệt kê 10 thương hiệu Children được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10",True,True,9,5,,,0.01489567756652832
515,Tổng doanh thu của Books tại bang KS năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999",True,True,1,1,,,0.010828971862792969
516,"Hàng Men trả lại ở NC có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.008324861526489258
517,Ai mua đồ Children nhiều nhất ở IL vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.0157928466796875
518,So sánh lợi nhuận của Music giữa kênh Web và Web tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel",True,True,1,2,,,0.00743556022644043
519,Tìm email của các khách hàng VIP ở MO đã mua đồ Children trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Children'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Children'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC",True,True,50,4,,,0.018366336822509766
521,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Home tại MO.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10",True,True,10,5,,,0.018803119659423828
522,Có bao nhiêu đơn hàng Children bị trả lại tại IA vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002",True,True,1,3,,,0.008524179458618164
523,"Trong năm 2001, khách hàng ở MO mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.012593507766723633
525,Doanh số của Home tại TX năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'TX' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'TX' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'TX' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'TX' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.018522024154663086
526,"Năm 1999, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC",True,True,3,2,,,0.0067598819732666016
527,Tổng doanh thu của Sports tại bang GA năm 2001 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2001;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2001",True,True,1,1,,,0.01157379150390625
528,Giá bán trung bình của mặt hàng Women trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND d.d_year = 2001
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND d.d_year = 2001
GROUP BY i.i_category",True,True,1,4,,,0.006890296936035156
529,Ai mua đồ Sports nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.01566290855407715
530,"Năm 2002, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC",True,True,3,2,,,0.0060269832611083984
531,"Năm 2001, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC",True,True,3,2,,,0.0050640106201171875
532,Tỷ lệ trả hàng của Books ở NC có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'NC'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Books' as category,
    'NC' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'NC'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Books' as category,
    'NC' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03930473327636719
533,Có bao nhiêu đơn hàng Men bị trả lại tại NC vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000",True,True,1,3,,,0.006101131439208984
536,Tìm email của các khách hàng VIP ở IA đã mua đồ Men trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Men'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Men'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC",True,True,50,4,,,0.01721644401550293
537,Năm ngoái dân ở VA mua Women nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.021298646926879883
538,Năm ngoái dân ở GA mua Men nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.02481245994567871
539,Năm ngoái dân ở IA mua Music nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Music'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Music'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.028897523880004883
540,Tổng doanh thu của Home tại bang GA năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'GA'
  AND d.d_year = 1999;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'GA'
  AND d.d_year = 1999",True,True,1,1,,,0.013199329376220703
541,"Trong năm 2001, khách hàng ở TX mua nhiều Men không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.01572418212890625
542,Giá bán trung bình của mặt hàng Books trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 2000
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 2000
GROUP BY i.i_category",True,True,1,4,,,0.007396221160888672
543,Tổng doanh thu của Music tại bang NC năm 2002 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002",True,True,1,1,,,0.011818885803222656
544,Khách hàng có bằng Secondary tại VA thường mua Books qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Books'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Books'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Books'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Books'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Books'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Books'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.021584033966064453
545,Tổng doanh thu của Home tại bang KY năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'KY'
  AND d.d_year = 1999;","SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'KY'
  AND d.d_year = 1999",True,True,1,1,,,0.013267755508422852
546,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở TX.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10",True,True,10,6,,,0.017563819885253906
547,Tìm email của các khách hàng VIP ở KY đã mua đồ Sports trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC",True,True,50,4,,,0.018962860107421875
548,Tìm email của các khách hàng VIP ở IL đã mua đồ Home trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC",True,True,50,4,,,0.02149796485900879
549,Ai mua đồ Jewelry nhiều nhất ở IA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.01817798614501953
550,Tìm 10 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10",True,True,10,5,,,0.014855623245239258
551,Doanh số của Sports tại VA năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'VA' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'VA' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'VA' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'VA' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.019579172134399414
552,Liệt kê 5 thương hiệu Home được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5",True,True,5,5,,,0.013393402099609375
553,So sánh lợi nhuận của Music giữa kênh Catalog và Web tại NC.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
ORDER BY channel",True,True,2,2,,,0.011506795883178711
554,Có bao nhiêu đơn hàng Men bị trả lại tại KY vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2000;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2000",True,True,1,3,,,0.007027387619018555
555,Khách hàng có bằng 2 yr Degree tại KS thường mua Women qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.01738119125366211
556,"Trong quý 4 năm 2001, nhóm khách hàng Secondary chi bao nhiêu tiền cho Books?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.016612768173217773
557,Giá bán trung bình của mặt hàng Music trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 2002
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 2002
GROUP BY i.i_category",True,True,1,4,,,0.0068819522857666016
558,Năm ngoái dân ở MO mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.021489381790161133
559,Khách hàng có bằng 4 yr Degree tại KS thường mua Electronics qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.019063234329223633
560,Tìm email của các khách hàng VIP ở GA đã mua đồ Music trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Music'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Music'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC",True,True,50,4,,,0.017859220504760742
561,"Trong quý 4 năm 1999, nhóm khách hàng Secondary chi bao nhiêu tiền cho Men?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.015739917755126953
562,Tỷ lệ trả hàng của Women ở NC có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'NC'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Women' as category,
    'NC' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'NC'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Women' as category,
    'NC' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03924083709716797
563,Giá bán trung bình của mặt hàng Home trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY i.i_category",True,True,1,4,,,0.007069110870361328
564,Khách hàng có bằng Advanced Degree tại KY thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.02124810218811035
565,Liệt kê 3 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IL'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IL'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3",True,True,3,5,,,0.009648561477661133
566,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ Advanced Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.018340587615966797
567,Cho tôi xem danh sách sản phẩm Shoes bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10",True,True,10,6,,,0.011574268341064453
568,Liệt kê 5 thương hiệu Shoes được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5",True,True,5,5,,,0.00986790657043457
569,Tìm 3 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3",True,True,3,5,,,0.01265573501586914
570,"Trong năm 2001, khách hàng ở IL mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.012520790100097656
572,"Trong năm 2000, khách hàng ở NC mua nhiều Shoes không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.01160287857055664
573,Có bao nhiêu đơn hàng Shoes bị trả lại tại TX vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001",True,True,1,3,,,0.007377147674560547
574,"Năm 2002, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC",True,True,3,2,,,0.005751371383666992
575,"Hàng Children trả lại ở KS có nhiều không, xem số liệu năm 2002 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.011391162872314453
577,Tỷ lệ trả hàng của Men ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'VA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'VA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03765392303466797
578,"Trong năm 2000, khách hàng ở NC mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
GROUP BY ca.ca_state, i.i_category;","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.012618541717529297
579,Có bao nhiêu đơn hàng Electronics bị trả lại tại NC vào năm 1999?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999",True,True,1,3,,,0.00822591781616211
580,Tìm 5 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5",True,True,5,5,,,0.014055013656616211
581,Tìm 5 sản phẩm Sports có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5",True,True,5,5,,,0.01453542709350586
582,Năm ngoái dân ở IA mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.019270658493041992
583,Khách hàng có bằng 4 yr Degree tại GA thường mua Sports qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;","WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC",True,True,3,2,,,0.01866769790649414
584,Tỷ lệ trả hàng của Electronics ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Electronics' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Electronics' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03830885887145996
587,Doanh số của Women tại IA năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;","WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py",True,True,1,6,,,0.017094135284423828
588,Tìm email của các khách hàng VIP ở KS đã mua đồ Electronics trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Electronics'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Electronics'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC",True,True,50,4,,,0.015848398208618164
589,Giá bán trung bình của mặt hàng Books trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY i.i_category;","SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY i.i_category",True,True,1,4,,,0.007934331893920898
590,Có bao nhiêu đơn hàng Men bị trả lại tại MO vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001",True,True,1,3,,,0.006224155426025391
591,Tìm 3 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;","SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3",True,True,3,5,,,0.012051582336425781
592,Thống kê tổng số lượng Men được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01631760597229004
593,Liệt kê 3 thương hiệu Music được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3;","SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3",True,True,3,5,,,0.009469747543334961
594,So sánh lợi nhuận của Sports giữa kênh Catalog và Web tại GA.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
ORDER BY channel;","WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
ORDER BY channel",True,True,2,2,,,0.010256767272949219
595,Có bao nhiêu đơn hàng Sports bị trả lại tại MO vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;","SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001",True,True,1,3,,,0.007739543914794922
597,Tìm email của các khách hàng VIP ở IL đã mua đồ Jewelry trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC",True,True,50,4,,,0.01732921600341797
599,"Hàng Music trả lại ở KS có nhiều không, xem số liệu năm 1999 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.009129047393798828
600,Ai mua đồ Men nhiều nhất ở IL vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1",True,True,1,4,,,0.013181924819946289
601,Tổng doanh thu của Home tại bang NC năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999",True,True,1,1,,,0.012089729309082031
602,Năm ngoái dân ở IA mua Men nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.022369384765625
603,Cho tôi xem danh sách sản phẩm Men bán chạy nhất ở IA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.014739513397216797
604,Cho tôi xem danh sách sản phẩm Men bán chạy nhất ở NC.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.014024972915649414
605,Năm ngoái dân ở IL mua Books nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.022585391998291016
607,Năm 2002 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year",True,True,1,4,,,0.007800102233886719
608,Doanh số của Electronics tại KS năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.02370452880859375
609,Tỷ lệ trả hàng của Jewelry ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'IL'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'IL' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'IL'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'IL' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03926348686218262
611,Ai mua đồ Books nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.015209436416625977
612,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10",True,True,10,5,,,0.01813507080078125
613,Có bao nhiêu đơn hàng Men bị trả lại tại TX vào năm 1999?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999",True,True,1,3,,,0.011360883712768555
614,Giá bán trung bình của mặt hàng Sports trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2001
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2001
 GROUP BY i.i_category",True,True,1,4,,,0.006961345672607422
615,Ai mua đồ Electronics nhiều nhất ở TX vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.01815485954284668
616,Ai mua đồ Shoes nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.014084577560424805
617,Tìm email của các khách hàng VIP ở TX đã mua đồ Men trên 1000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Men'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Men'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC",True,True,50,4,,,0.019092559814453125
618,"Trong quý 4 năm 2002, nhóm khách hàng Secondary chi bao nhiêu tiền cho Shoes?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2002
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2002
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.014419317245483398
619,Giá bán trung bình của mặt hàng Jewelry trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2000
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2000
 GROUP BY i.i_category",True,True,1,4,,,0.006337881088256836
621,Có bao nhiêu đơn hàng Children bị trả lại tại IL vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001",True,True,1,3,,,0.006679534912109375
622,"Trong năm 2001, khách hàng ở IA mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.011256933212280273
623,"Hàng Women trả lại ở KY có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.007322549819946289
624,Doanh số của Men tại GA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.016821622848510742
626,So sánh lợi nhuận của Music giữa kênh Catalog và Catalog tại TX.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel",True,True,1,2,,,0.008130311965942383
627,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ College.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01660609245300293
628,Giá bán trung bình của mặt hàng Women trong năm 2002 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND d.d_year = 2002
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND d.d_year = 2002
 GROUP BY i.i_category",True,True,1,4,,,0.007205486297607422
629,Doanh số của Music tại KY năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.017934322357177734
630,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Electronics tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3",True,True,3,5,,,0.01728081703186035
632,Có bao nhiêu đơn hàng Music bị trả lại tại KS vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002",True,True,1,3,,,0.00821375846862793
633,"Trong năm 2001, khách hàng ở MO mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.013147830963134766
634,Tỷ lệ trả hàng của Shoes ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Shoes' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Shoes' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.04012942314147949
635,"Trong quý 4 năm 2000, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Books?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01636028289794922
636,Thống kê tổng số lượng Home được mua bởi những khách hàng có trình độ College.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.018880367279052734
637,Có bao nhiêu đơn hàng Women bị trả lại tại TX vào năm 2000?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2000;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2000",True,True,1,3,,,0.006462574005126953
638,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5",True,True,5,5,,,0.0173642635345459
639,"Hàng Home trả lại ở MO có nhiều không, xem số liệu năm 2001 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.009547233581542969
640,Giá bán trung bình của mặt hàng Music trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 1999
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 1999
 GROUP BY i.i_category",True,True,1,4,,,0.006299257278442383
641,Tổng doanh thu của Jewelry tại bang NC năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999",True,True,1,1,,,0.012148857116699219
642,Tỷ lệ trả hàng của Shoes ở TX có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'TX'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Shoes' as category,
  'TX' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'TX'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Shoes' as category,
  'TX' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.04062604904174805
643,"Trong năm 2000, khách hàng ở GA mua nhiều Children không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Children'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Children'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.015270233154296875
644,Thống kê tổng số lượng Electronics được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.017599105834960938
645,Tìm 10 sản phẩm Men có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10",True,True,10,5,,,0.012209177017211914
646,Có bao nhiêu đơn hàng Electronics bị trả lại tại MO vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2002;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2002",True,True,1,3,,,0.008566141128540039
647,Khách hàng có bằng 4 yr Degree tại MO thường mua Sports qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.01793527603149414
648,"Hàng Music trả lại ở KY có nhiều không, xem số liệu năm 2001 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.009624958038330078
649,Tìm email của các khách hàng VIP ở NC đã mua đồ Music trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Music'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Music'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC",True,True,50,4,,,0.017256975173950195
651,Giá bán trung bình của mặt hàng Home trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY i.i_category",True,True,1,4,,,0.009195089340209961
652,Tổng doanh thu của Shoes tại bang KY năm 2002 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002",True,True,1,1,,,0.010803937911987305
653,Cho tôi xem danh sách sản phẩm Electronics bán chạy nhất ở IL.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.012882232666015625
655,"Hàng Home trả lại ở NC có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.013982057571411133
657,Doanh số của Music tại NC năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'NC' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'NC' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'NC' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'NC' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.016199111938476562
658,Doanh số của Home tại NC năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'NC' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'NC' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'NC' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'NC' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.016246557235717773
659,Năm ngoái dân ở KS mua Books nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.024969816207885742
660,So sánh lợi nhuận của Men giữa kênh Store và Catalog tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
 ORDER BY channel",True,True,2,2,,,0.014407873153686523
661,"Hàng Home trả lại ở TX có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.011960983276367188
662,"Năm 1999, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.01036214828491211
664,Ai mua đồ Men nhiều nhất ở KS vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.02257990837097168
665,Liệt kê 10 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10",True,True,10,5,,,0.013514041900634766
666,Cho tôi xem danh sách sản phẩm Electronics bán chạy nhất ở KS.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.015050888061523438
667,"Trong năm 2001, khách hàng ở KS mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.014173507690429688
668,Tìm 3 sản phẩm Men có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 3;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 3",True,True,3,5,,,0.013196468353271484
669,Có bao nhiêu đơn hàng Music bị trả lại tại TX vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002",True,True,1,3,,,0.01171731948852539
671,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Music tại KS.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3",True,True,3,5,,,0.02387261390686035
672,"Trong năm 2001, khách hàng ở GA mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Women'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Women'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.014397382736206055
673,"Năm 2000, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.006380796432495117
676,Ai mua đồ Children nhiều nhất ở MO vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'MO'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'MO'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.01435708999633789
677,"Trong năm 2001, khách hàng ở GA mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.01199960708618164
678,Ai mua đồ Women nhiều nhất ở IL vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.015426397323608398
679,Tỷ lệ trả hàng của Men ở MO có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'MO'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'MO' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'MO'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'MO' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.040960073471069336
680,Năm 2001 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Catalog' as channel,
  SUM(cs.cs_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM catalog_sales cs
 JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Catalog' as channel,
  SUM(cs.cs_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM catalog_sales cs
 JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year",True,True,1,4,,,0.0029883384704589844
681,Liệt kê 5 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5",True,True,5,5,,,0.012250900268554688
682,Cho tôi xem danh sách sản phẩm Women bán chạy nhất ở IA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.012980937957763672
683,Tỷ lệ trả hàng của Books ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Books' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Books' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.04281187057495117
684,Khách hàng có bằng 4 yr Degree tại IA thường mua Music qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.019704341888427734
685,Năm ngoái dân ở GA mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.024016618728637695
686,"Trong quý 4 năm 1999, nhóm khách hàng Primary chi bao nhiêu tiền cho Children?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Primary'
  AND i.i_category = 'Children'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Primary'
  AND i.i_category = 'Children'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.02077484130859375
687,Năm 2002 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year",True,True,1,4,,,0.003048419952392578
689,Doanh số của Electronics tại NC năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 2002
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 2001
 )
 SELECT 
  2002 as current_year,
  cy.revenue as current_revenue,
  2001 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 2002
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'NC' AND d.d_year = 2001
 )
 SELECT 
  2002 as current_year,
  cy.revenue as current_revenue,
  2001 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.015341758728027344
690,"Trong năm 2000, khách hàng ở MO mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.016789913177490234
691,"Năm 2002, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.005399465560913086
692,Doanh số của Music tại MO năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'MO' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'MO' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'MO' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'MO' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.016892433166503906
693,Liệt kê 5 thương hiệu Shoes được ưa chuộng nhất bởi khách hàng ở TX.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5",True,True,5,5,,,0.011287689208984375
694,Năm ngoái dân ở KS mua Women nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.0226595401763916
695,Tổng doanh thu của Jewelry tại bang TX năm 2000 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2000;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2000",True,True,1,1,,,0.016385316848754883
696,So sánh lợi nhuận của Sports giữa kênh Catalog và Web tại IL.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel",True,True,2,2,,,0.009848356246948242
697,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.017602205276489258
698,"Hàng Jewelry trả lại ở GA có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'GA'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'GA'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.009379148483276367
699,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Sports tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10",True,True,10,5,,,0.018160581588745117
700,Tỷ lệ trả hàng của Sports ở KY có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Sports' as category,
  'KY' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Sports' as category,
  'KY' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03990960121154785
701,Tìm 5 sản phẩm Electronics có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5",True,True,5,5,,,0.009937524795532227
702,Cho tôi xem danh sách sản phẩm Children bán chạy nhất ở KY.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.013155221939086914
703,Năm 2001 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year",True,True,1,4,,,0.0051250457763671875
704,Tỷ lệ trả hàng của Women ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'VA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Women' as category,
  'VA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'VA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Women' as category,
  'VA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.03787994384765625
705,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Jewelry tại KS.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3",True,True,3,5,,,0.017793893814086914
706,Ai mua đồ Children nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.016607046127319336
707,Thống kê tổng số lượng Music được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.015569686889648438
708,Tìm 10 sản phẩm Electronics có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10",True,True,10,5,,,0.012944459915161133
709,Khách hàng có bằng Primary tại KY thường mua Sports qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.0198361873626709
710,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Secondary'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Secondary'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.015753984451293945
713,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Men tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5",True,True,5,5,,,0.01801323890686035
714,Tìm email của các khách hàng VIP ở GA đã mua đồ Electronics trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC",True,True,50,4,,,0.017559289932250977
715,"Hàng Music trả lại ở TX có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.009262561798095703
716,Khách hàng có bằng 4 yr Degree tại GA thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.017523527145385742
717,Tổng doanh thu của Sports tại bang IL năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999",True,True,1,1,,,0.01149439811706543
718,Thống kê tổng số lượng Shoes được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Secondary'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Secondary'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01746511459350586
719,So sánh lợi nhuận của Sports giữa kênh Web và Catalog tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
 ORDER BY channel",True,True,2,2,,,0.008424997329711914
720,"Trong quý 4 năm 2001, nhóm khách hàng Secondary chi bao nhiêu tiền cho Home?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.018095970153808594
721,Năm ngoái dân ở VA mua Men nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.026206016540527344
722,Ai mua đồ Home nhiều nhất ở MO vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.021703481674194336
723,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại KS.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3",True,True,3,5,,,0.018404722213745117
724,Năm 2001 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year",True,True,1,4,,,0.003360271453857422
725,"Năm 2002, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.006840705871582031
726,Ai mua đồ Electronics nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.021241188049316406
727,"Trong quý 4 năm 2000, nhóm khách hàng College chi bao nhiêu tiền cho Children?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Children'
  AND d.d_year = 2000
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Children'
  AND d.d_year = 2000
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.021173715591430664
728,Giá bán trung bình của mặt hàng Men trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 1999
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 1999
 GROUP BY i.i_category",True,True,1,4,,,0.009941339492797852
729,Tìm 10 sản phẩm Music có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10",True,True,10,5,,,0.01059103012084961
730,"Hàng Shoes trả lại ở IL có nhiều không, xem số liệu năm 2000 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.008769512176513672
731,Giá bán trung bình của mặt hàng Women trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND d.d_year = 1999
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND d.d_year = 1999
 GROUP BY i.i_category",True,True,1,4,,,0.006573200225830078
732,"Trong năm 2000, khách hàng ở KS mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.015079021453857422
733,Ai mua đồ Jewelry nhiều nhất ở IL vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.016609668731689453
734,"Trong quý 4 năm 1999, nhóm khách hàng Secondary chi bao nhiêu tiền cho Men?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01698589324951172
736,"Hàng Men trả lại ở KS có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.01181483268737793
738,Thống kê tổng số lượng Shoes được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.020650148391723633
739,Tìm 5 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND d.d_year = 1999
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND d.d_year = 1999
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5",True,True,5,5,,,0.00980520248413086
740,Tìm email của các khách hàng VIP ở MO đã mua đồ Electronics trên 5000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC",True,True,50,4,,,0.0194547176361084
741,Tìm email của các khách hàng VIP ở VA đã mua đồ Electronics trên 5000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC",True,True,50,4,,,0.01831364631652832
742,Tìm email của các khách hàng VIP ở IL đã mua đồ Jewelry trên 1000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC",True,True,50,4,,,0.020827293395996094
743,Giá bán trung bình của mặt hàng Jewelry trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
 GROUP BY i.i_category",True,True,1,4,,,0.007714748382568359
744,So sánh lợi nhuận của Home giữa kênh Catalog và Catalog tại KY.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KY'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KY'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KY'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KY'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KY'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KY'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel",True,True,1,2,,,0.00764155387878418
745,"Năm 2001, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.006216287612915039
746,Năm ngoái dân ở IA mua Jewelry nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.020129680633544922
747,Giá bán trung bình của mặt hàng Music trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2000
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2000
 GROUP BY i.i_category",True,True,1,4,,,0.008000373840332031
748,Cho tôi xem danh sách sản phẩm Sports bán chạy nhất ở KY.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.011837482452392578
750,Liệt kê 10 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở KS.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10",True,True,10,5,,,0.012194156646728516
751,Ai mua đồ Books nhiều nhất ở IA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.01781153678894043
752,"Trong năm 1999, khách hàng ở VA mua nhiều Electronics không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Electronics'
  AND d.d_year = 1999
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Electronics'
  AND d.d_year = 1999
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.014795780181884766
753,Giá bán trung bình của mặt hàng Electronics trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
 GROUP BY i.i_category",True,True,1,4,,,0.00641322135925293
754,Tìm 10 sản phẩm Children có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10",True,True,10,5,,,0.009702444076538086
755,Doanh số của Electronics tại IA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.017924070358276367
756,"Trong năm 2000, khách hàng ở KY mua nhiều Books không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.01349639892578125
757,"Hàng Women trả lại ở MO có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'MO'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'MO'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.0062143802642822266
758,"Hàng Home trả lại ở TX có nhiều không, xem số liệu năm 2001 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.007860660552978516
759,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Music tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3",True,True,3,5,,,0.01504206657409668
760,So sánh lợi nhuận của Books giữa kênh Store và Web tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel",True,True,2,2,,,0.008953332901000977
761,"Trong năm 2002, khách hàng ở KY mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.012195587158203125
762,Ai mua đồ Shoes nhiều nhất ở VA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'VA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'VA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.012274980545043945
763,"Năm 1999, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.0051076412200927734
764,"Năm 2000, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.00505518913269043
765,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại TX.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10",True,True,10,5,,,0.018340110778808594
767,Giá bán trung bình của mặt hàng Electronics trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2000
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2000
 GROUP BY i.i_category",True,True,1,4,,,0.006453037261962891
768,Năm ngoái dân ở IA mua Music nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Music'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Music'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.02050948143005371
769,Có bao nhiêu đơn hàng Home bị trả lại tại MO vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001",True,True,1,3,,,0.007500171661376953
770,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5",True,True,5,5,,,0.01722884178161621
771,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại VA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'VA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'VA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3",True,True,3,5,,,0.018517255783081055
772,Doanh số của Jewelry tại NC năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'NC' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'NC' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'NC' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'NC' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.01548147201538086
773,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Men tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3",True,True,3,5,,,0.015336751937866211
774,So sánh lợi nhuận của Music giữa kênh Catalog và Catalog tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel",True,True,1,2,,,0.006947994232177734
775,Doanh số của Children tại NC năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'NC' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'NC' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'NC' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'NC' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.016063928604125977
776,Năm 2000 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2000
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2000
 GROUP BY d.d_year",True,True,1,4,,,0.0037527084350585938
777,Doanh số của Music tại KY năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.01809072494506836
778,Tìm 10 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10",True,True,10,5,,,0.013424396514892578
779,Liệt kê 3 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở KS.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3",True,True,3,5,,,0.01152491569519043
781,Doanh số của Shoes tại IA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IA' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IA' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IA' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IA' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.021457672119140625
782,Có bao nhiêu đơn hàng Home bị trả lại tại IL vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001",True,True,1,3,,,0.007946014404296875
783,So sánh lợi nhuận của Children giữa kênh Store và Web tại VA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel",True,True,2,2,,,0.011536121368408203
784,Tìm email của các khách hàng VIP ở TX đã mua đồ Jewelry trên 5000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Jewelry'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Jewelry'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC",True,True,50,4,,,0.019391775131225586
785,"Năm 2000, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.005506038665771484
786,"Năm 1999, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.0055696964263916016
787,So sánh lợi nhuận của Women giữa kênh Store và Web tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel",True,True,2,2,,,0.009836435317993164
788,Tổng doanh thu của Jewelry tại bang IA năm 2002 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002",True,True,1,1,,,0.008606195449829102
789,"Trong quý 4 năm 1999, nhóm khách hàng College chi bao nhiêu tiền cho Jewelry?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Jewelry'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Jewelry'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01392984390258789
790,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10",True,True,10,5,,,0.017059803009033203
791,Năm ngoái dân ở GA mua Women nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.0164792537689209
792,Có bao nhiêu đơn hàng Electronics bị trả lại tại IL vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001",True,True,1,3,,,0.006918430328369141
793,Năm 2002 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Catalog' as channel,
  SUM(cs.cs_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM catalog_sales cs
 JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Catalog' as channel,
  SUM(cs.cs_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM catalog_sales cs
 JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year",True,True,1,4,,,0.0027687549591064453
794,"Trong quý 4 năm 2001, nhóm khách hàng Advanced Degree chi bao nhiêu tiền cho Sports?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Sports'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Sports'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.013498067855834961
795,Doanh số của Men tại VA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.017039060592651367
796,Liệt kê 10 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở IA.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10",True,True,10,5,,,0.011586904525756836
797,Tổng doanh thu của Home tại bang IA năm 2001 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2001;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2001",True,True,1,1,,,0.010678291320800781
798,Doanh số của Children tại VA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.016014575958251953
799,Tỷ lệ trả hàng của Jewelry ở KS có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'KS'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'KS' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'KS'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'KS' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.031903982162475586
800,"Trong năm 2001, khách hàng ở IA mua nhiều Shoes không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.01056528091430664
801,So sánh lợi nhuận của Men giữa kênh Web và Web tại IL.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
 )
 SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
 )
 SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
 ORDER BY channel",True,True,1,2,,,0.0056760311126708984
802,"Trong năm 2001, khách hàng ở NC mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Women'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Women'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.011806964874267578
803,Khách hàng có bằng Advanced Degree tại MO thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.015015125274658203
804,"Trong quý 4 năm 1999, nhóm khách hàng Advanced Degree chi bao nhiêu tiền cho Shoes?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Shoes'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Shoes'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01483917236328125
805,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND cd.cd_education_status = '4 yr Degree'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND cd.cd_education_status = '4 yr Degree'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.015436410903930664
806,Doanh số của Children tại KS năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.015729665756225586
807,"Hàng Music trả lại ở IA có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.00701141357421875
808,Tỷ lệ trả hàng của Men ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'VA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'VA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'VA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'VA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.033518075942993164
809,Thống kê tổng số lượng Men được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.016658544540405273
810,Có bao nhiêu đơn hàng Women bị trả lại tại MO vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001",True,True,1,3,,,0.006595134735107422
811,Năm ngoái dân ở KS mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.017536163330078125
812,Tỷ lệ trả hàng của Men ở KS có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'KS' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'KS' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.030221939086914062
814,Doanh số của Shoes tại NC năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.014944791793823242
815,Giá bán trung bình của mặt hàng Men trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY i.i_category",True,True,1,4,,,0.007208824157714844
816,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở NC.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.01072382926940918
818,"Hàng Home trả lại ở IA có nhiều không, xem số liệu năm 2000 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.006811857223510742
819,Khách hàng có bằng 4 yr Degree tại IL thường mua Shoes qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.020357608795166016
820,Ai mua đồ Children nhiều nhất ở IL vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.014276981353759766
821,Ai mua đồ Sports nhiều nhất ở NC vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.013723134994506836
822,Khách hàng có bằng Advanced Degree tại VA thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.01688861846923828
823,"Trong năm 2002, khách hàng ở VA mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.011209964752197266
824,Tổng doanh thu của Jewelry tại bang IA năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999",True,True,1,1,,,0.008984088897705078
825,Liệt kê 10 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10",True,True,10,5,,,0.009295940399169922
826,Tìm email của các khách hàng VIP ở TX đã mua đồ Electronics trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC",True,True,50,4,,,0.01878833770751953
827,Tỷ lệ trả hàng của Women ở MO có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'MO'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Women' as category,
  'MO' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'MO'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Women' as category,
  'MO' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.030449390411376953
828,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại IL.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3",True,True,3,5,,,0.018233776092529297
830,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại KY.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5",True,True,5,5,,,0.016171932220458984
831,Liệt kê 3 thương hiệu Home được ưa chuộng nhất bởi khách hàng ở VA.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3",True,True,3,5,,,0.008700847625732422
832,Doanh số của Women tại NC năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'NC' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'NC' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'NC' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'NC' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.01662421226501465
833,Giá bán trung bình của mặt hàng Sports trong năm 2002 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2002
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2002
 GROUP BY i.i_category",True,True,1,4,,,0.008128881454467773
834,So sánh lợi nhuận của Books giữa kênh Store và Web tại TX.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel",True,True,2,2,,,0.01347804069519043
835,Thống kê tổng số lượng Sports được mua bởi những khách hàng có trình độ College.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.01539468765258789
836,Tỷ lệ trả hàng của Jewelry ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.034806013107299805
837,Doanh số của Jewelry tại MO năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.012943029403686523
838,Tìm email của các khách hàng VIP ở MO đã mua đồ Home trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC",True,True,50,4,,,0.01859736442565918
839,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở GA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'GA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'GA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.012982368469238281
840,Năm ngoái dân ở IL mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.017091035842895508
841,"Hàng Electronics trả lại ở KS có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.006231546401977539
842,Tìm 10 sản phẩm Music có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10",True,True,10,5,,,0.00975489616394043
843,"Trong quý 4 năm 2001, nhóm khách hàng College chi bao nhiêu tiền cho Home?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.013815641403198242
844,"Trong năm 2002, khách hàng ở VA mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Women'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Women'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.010487079620361328
845,"Trong năm 2000, khách hàng ở IL mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Women'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Women'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.01074528694152832
846,Tìm 3 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 1999
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 3;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 1999
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 3",True,True,3,5,,,0.011888980865478516
847,So sánh lợi nhuận của Shoes giữa kênh Store và Web tại MO.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel",True,True,2,2,,,0.009163379669189453
848,"Trong quý 4 năm 1999, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Women?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Women'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Women'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.012192010879516602
849,So sánh lợi nhuận của Men giữa kênh Catalog và Web tại GA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel",True,True,2,2,,,0.00876617431640625
851,Có bao nhiêu đơn hàng Shoes bị trả lại tại KY vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002",True,True,1,3,,,0.005743265151977539
852,Ai mua đồ Electronics nhiều nhất ở IA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.013641357421875
853,Khách hàng có bằng 2 yr Degree tại GA thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.01898050308227539
855,Tìm 5 sản phẩm Children có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5",True,True,5,5,,,0.009956598281860352
856,Tổng doanh thu của Music tại bang NC năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999",True,True,1,1,,,0.010102987289428711
857,So sánh lợi nhuận của Books giữa kênh Catalog và Web tại TX.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel;","WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel",True,True,2,2,,,0.007790803909301758
858,Giá bán trung bình của mặt hàng Electronics trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2001
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2001
 GROUP BY i.i_category",True,True,1,4,,,0.00716400146484375
859,Năm ngoái dân ở KY mua Jewelry nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.018033504486083984
860,Năm ngoái dân ở NC mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.02064681053161621
861,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ Advanced Degree.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Advanced Degree'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Advanced Degree'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.017771482467651367
862,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Women tại TX.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10",True,True,10,5,,,0.017180204391479492
863,Giá bán trung bình của mặt hàng Music trong năm 2002 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2002
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2002
 GROUP BY i.i_category",True,True,1,4,,,0.008490800857543945
864,Liệt kê 3 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3",True,True,3,5,,,0.011446237564086914
865,Ai mua đồ Children nhiều nhất ở KY vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.013872385025024414
866,"Hàng Music trả lại ở NC có nhiều không, xem số liệu năm 2000 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.0057947635650634766
867,Doanh số của Home tại KS năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;","WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py",True,True,1,6,,,0.015129327774047852
868,"Hàng Electronics trả lại ở NC có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.007387876510620117
869,Tìm 5 sản phẩm Home có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5",True,True,5,5,,,0.009593963623046875
870,"Hàng Sports trả lại ở TX có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year",True,True,1,7,,,0.007132291793823242
871,Năm 1999 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 1999
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 1999
 GROUP BY d.d_year",True,True,1,4,,,0.0026397705078125
872,Có bao nhiêu đơn hàng Books bị trả lại tại MO vào năm 1999?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'MO'
  AND d.d_year = 1999;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'MO'
  AND d.d_year = 1999",True,True,1,3,,,0.0053675174713134766
873,Tổng doanh thu của Music tại bang KY năm 2001 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2001;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2001",True,True,1,1,,,0.00778651237487793
875,Tổng doanh thu của Women tại bang NC năm 2000 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000;","SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000",True,True,1,1,,,0.011517524719238281
876,Liệt kê 5 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5",True,True,5,5,,,0.010661602020263672
877,Khách hàng có bằng 2 yr Degree tại VA thường mua Women qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.021517038345336914
878,Giá bán trung bình của mặt hàng Sports trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2000
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2000
 GROUP BY i.i_category",True,True,1,4,,,0.008458137512207031
879,"Trong năm 1999, khách hàng ở IA mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_year = 1999
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_year = 1999
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.010998010635375977
880,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = '4 yr Degree'
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = '4 yr Degree'
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.016208887100219727
881,"Trong năm 2002, khách hàng ở VA mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Men'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Men'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category",True,True,1,5,,,0.013842344284057617
882,Năm 1999 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 1999
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 1999
 GROUP BY d.d_year",True,True,1,4,,,0.005930423736572266
883,Khách hàng có bằng Advanced Degree tại IL thường mua Home qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.023709774017333984
884,Năm ngoái dân ở IA mua Children nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;","SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category",True,True,1,7,,,0.017681360244750977
885,Tìm email của các khách hàng VIP ở IL đã mua đồ Women trên 1000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Women'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Women'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC",True,True,50,4,,,0.016956329345703125
886,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Men tại IL.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5",True,True,5,5,,,0.015836715698242188
887,Cho tôi xem danh sách sản phẩm Women bán chạy nhất ở VA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;","SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10",True,True,10,6,,,0.012396097183227539
888,"Năm 2000, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.006122112274169922
889,Khách hàng có bằng College tại KY thường mua Children qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.020614147186279297
890,"Năm 1999, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC",True,True,3,2,,,0.005089998245239258
891,Liệt kê 3 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở VA.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;","SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3",True,True,3,5,,,0.010276317596435547
892,Năm 2000 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2000
 GROUP BY d.d_year;","SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2000
 GROUP BY d.d_year",True,True,1,4,,,0.00350189208984375
893,Khách hàng có bằng Secondary tại VA thường mua Sports qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.01623058319091797
894,Khách hàng có bằng 4 yr Degree tại MO thường mua Men qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;","WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC",True,True,3,2,,,0.019473791122436523
895,"Trong quý 4 năm 2002, nhóm khách hàng 4 yr Degree chi bao nhiêu tiền cho Men?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '4 yr Degree'
  AND i.i_category = 'Men'
  AND d.d_year = 2002
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '4 yr Degree'
  AND i.i_category = 'Men'
  AND d.d_year = 2002
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category",True,True,1,4,,,0.012596607208251953
896,Ai mua đồ Women nhiều nhất ở KY vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;","SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1",True,True,1,4,,,0.012815713882446289
897,Giá bán trung bình của mặt hàng Music trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2001
 GROUP BY i.i_category;","SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2001
 GROUP BY i.i_category",True,True,1,4,,,0.006314754486083984
899,Tỷ lệ trả hàng của Books ở IA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Books' as category,
  'IA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;","WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Books' as category,
  'IA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa",True,True,1,5,,,0.036107540130615234
900,Có bao nhiêu đơn hàng Children bị trả lại tại IA vào năm 1999?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999;","SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999",True,True,1,3,,,0.00604248046875
901,Doanh thu kênh web trong quý 3 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_qoy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_qoy = 3",True,True,1,1,,,0.00209808349609375
902,Top 5 khách hàng chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.01840996742248535
903,Doanh thu kênh web trong quý 1 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_qoy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_qoy = 1",True,True,1,1,,,0.001676321029663086
904,Top 20 khách hàng ở bang GA chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007404804229736328
905,Doanh thu kênh web trong quý 2 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 2",True,True,1,1,,,0.0029392242431640625
906,Top 50 loại trang web có doanh thu cao nhất năm 1998,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50",True,True,8,2,,,0.006678104400634766
907,Top 5 loại trang web có doanh thu cao nhất năm 2003,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.003725767135620117
908,Top 20 loại trang web có doanh thu cao nhất năm 1999,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20",True,True,8,2,,,0.00536799430847168
909,Số lượng đơn hàng web theo phương thức giao hàng trong năm 2002,"SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.006951093673706055
910,Top 3 sản phẩm bán chạy nhất trên kênh web năm 1999,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.016812562942504883
911,Top 10 website có doanh thu kênh web cao nhất năm 2000,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,5,2,,,0.0055561065673828125
912,Doanh thu kênh web trong tháng 6 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 6;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 6",True,True,1,1,,,0.0026166439056396484
913,Doanh thu kênh web trong quý 4 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_qoy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_qoy = 4",True,True,1,1,,,0.0019693374633789062
914,Doanh thu kênh web trong quý 3 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 3",True,True,1,1,,,0.0017817020416259766
915,Top 10 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007294654846191406
916,Doanh thu kênh web trong quý 1 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 1",True,True,1,1,,,0.002402782440185547
917,Top 10 loại trang web có doanh thu cao nhất năm 2003,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10",True,True,7,2,,,0.0029478073120117188
918,Top 10 khách hàng ở bang MI chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007593631744384766
919,Doanh thu kênh web trong quý 2 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_qoy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_qoy = 2",True,True,1,1,,,0.0026254653930664062
920,Doanh thu kênh web trong quý 3 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3",True,True,1,1,,,0.0021827220916748047
921,Số lượng đơn hàng web theo phương thức giao hàng trong năm 2003,"SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.0047931671142578125
922,Giá bán trung bình theo danh mục trên kênh web năm 1999,"SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_category;","SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_category",True,True,11,2,,,0.014087915420532227
923,Giá bán trung bình theo danh mục trên kênh web năm 2000,"SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_category;","SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_category",True,True,11,2,,,0.01250457763671875
924,Top 10 khách hàng chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.005105495452880859
925,Doanh thu kênh web trong quý 2 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 2",True,True,1,1,,,0.0028748512268066406
926,Top 5 loại trang web có doanh thu cao nhất năm 1999,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.005299568176269531
927,Số lượng đơn hàng web theo phương thức giao hàng trong năm 2001,"SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.007423877716064453
928,Top 50 sản phẩm bán chạy nhất trên kênh web năm 1999,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.01637744903564453
929,Giá bán trung bình theo danh mục trên kênh web năm 1998,"SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_category;","SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_category",True,True,11,2,,,0.012389183044433594
930,Top 3 khách hàng chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.016934633255004883
931,Top 10 website có doanh thu kênh web cao nhất năm 1998,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,5,2,,,0.00561213493347168
932,Top 50 khách hàng chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007962942123413086
933,Số lượng đơn hàng web theo phương thức giao hàng trong năm 1999,"SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.009490966796875
934,Top 5 sản phẩm bán chạy nhất trên kênh web năm 1999,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.016413211822509766
935,Top 50 loại trang web có doanh thu cao nhất năm 2000,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50",True,True,8,2,,,0.006307840347290039
936,Top 20 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008532285690307617
937,Doanh thu kênh web trong tháng 8 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 8;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 8",True,True,1,1,,,0.0024137496948242188
938,Doanh thu kênh web trong quý 1 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_qoy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_qoy = 1",True,True,1,1,,,0.0024552345275878906
939,Doanh thu kênh web trong tháng 3 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 3",True,True,1,1,,,0.002142667770385742
940,Top 50 website có doanh thu kênh web cao nhất năm 1998,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,5,2,,,0.005998849868774414
941,Top 20 website có doanh thu kênh web cao nhất năm 2002,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,5,2,,,0.004614830017089844
942,Top 50 sản phẩm bán chạy nhất trên kênh web năm 1998,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.015505075454711914
943,Doanh thu kênh web trong quý 3 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_qoy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_qoy = 3",True,True,1,1,,,0.0011909008026123047
944,Top 20 sản phẩm bán chạy nhất trên kênh web năm 1999,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.01580023765563965
945,Số lượng đơn hàng web theo phương thức giao hàng trong năm 1998,"SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.00782632827758789
946,Top 3 loại trang web có doanh thu cao nhất năm 2003,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.004037380218505859
947,Top 50 sản phẩm bán chạy nhất trên kênh web năm 2002,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.015438318252563477
948,Top 5 khách hàng chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.019359588623046875
949,Doanh thu kênh web trong tháng 9 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 9;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 9",True,True,1,1,,,0.002284526824951172
950,Tổng doanh thu kênh web trong năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002",True,True,1,1,,,0.002443075180053711
951,Giá bán trung bình theo danh mục trên kênh web năm 2001,"SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_category;","SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_category",True,True,11,2,,,0.012192964553833008
952,Tổng doanh thu kênh web trong năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998",True,True,1,1,,,0.002309560775756836
953,Top 3 khách hàng chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.019217967987060547
954,Top 3 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008142232894897461
955,Doanh thu kênh web trong tháng 9 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 9;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 9",True,True,1,1,,,0.002308368682861328
956,Top 20 khách hàng ở bang MO chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007818222045898438
957,Top 10 khách hàng chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.019067764282226562
958,Top 20 loại trang web có doanh thu cao nhất năm 1998,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20",True,True,8,2,,,0.004924774169921875
959,Top 5 khách hàng chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.018983125686645508
960,Top 50 khách hàng ở bang IA chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007798194885253906
961,Top 3 khách hàng chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.020319223403930664
962,Tổng doanh thu kênh web trong năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999",True,True,1,1,,,0.002295970916748047
963,Top 50 khách hàng ở bang WY chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.006426334381103516
964,Top 10 website có doanh thu kênh web cao nhất năm 2001,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,5,2,,,0.005537986755371094
965,Top 20 website có doanh thu kênh web cao nhất năm 2003,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,5,2,,,0.004556417465209961
966,Tổng doanh thu kênh web trong năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003",True,True,1,1,,,0.0015654563903808594
967,Top 5 website có doanh thu kênh web cao nhất năm 2000,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.0052106380462646484
968,Top 3 loại trang web có doanh thu cao nhất năm 1998,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.006368875503540039
969,Top 5 khách hàng chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.019489765167236328
970,Top 20 khách hàng chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.020705223083496094
971,Doanh thu kênh web trong tháng 1 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 1",True,True,1,1,,,0.002702474594116211
972,Top 20 sản phẩm bán chạy nhất trên kênh web năm 2003,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.005429744720458984
973,Top 10 khách hàng chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.017775297164916992
974,Top 5 loại trang web có doanh thu cao nhất năm 1998,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.0055959224700927734
975,Top 3 loại trang web có doanh thu cao nhất năm 1999,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.005626678466796875
976,Doanh thu kênh web trong quý 1 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1",True,True,1,1,,,0.002559185028076172
977,Top 5 khách hàng ở bang MS chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.0073566436767578125
978,Top 5 sản phẩm bán chạy nhất trên kênh web năm 2003,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.005339622497558594
979,Top 20 sản phẩm bán chạy nhất trên kênh web năm 2000,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.016849994659423828
980,Top 50 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,16,4,,,0.0058841705322265625
981,Top 5 loại trang web có doanh thu cao nhất năm 2002,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.005791187286376953
982,Top 5 sản phẩm bán chạy nhất trên kênh web năm 2000,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.01563572883605957
983,Doanh thu kênh web trong quý 3 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 3",True,True,1,1,,,0.003981113433837891
984,Top 5 sản phẩm bán chạy nhất trên kênh web năm 2001,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.017249584197998047
985,Top 10 loại trang web có doanh thu cao nhất năm 2002,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10",True,True,7,2,,,0.005557537078857422
986,Top 10 sản phẩm bán chạy nhất trên kênh web năm 2002,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.015645980834960938
987,Top 50 sản phẩm bán chạy nhất trên kênh web năm 2001,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.01718902587890625
988,Top 3 sản phẩm bán chạy nhất trên kênh web năm 1998,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.01622605323791504
989,Tổng doanh thu kênh web trong năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000",True,True,1,1,,,0.0027151107788085938
990,Doanh thu kênh web trong tháng 5 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 5;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 5",True,True,1,1,,,0.0008802413940429688
991,Doanh thu kênh web trong tháng 8 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 8;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 8",True,True,1,1,,,0.0008678436279296875
992,Top 20 loại trang web có doanh thu cao nhất năm 2002,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20",True,True,7,2,,,0.005072355270385742
993,Doanh thu kênh web trong quý 2 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_qoy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_qoy = 2",True,True,1,1,,,0.0009865760803222656
994,Top 3 loại trang web có doanh thu cao nhất năm 2000,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.005571842193603516
995,Top 50 khách hàng ở bang FL chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008016347885131836
996,Doanh thu kênh web trong tháng 5 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 5;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 5",True,True,1,1,,,0.003490447998046875
997,Doanh thu kênh web trong tháng 3 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 3",True,True,1,1,,,0.0021429061889648438
998,Doanh thu kênh web trong tháng 6 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 6;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 6",True,True,1,1,,,0.0007901191711425781
999,Doanh thu kênh web trong tháng 2 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 2",True,True,1,1,,,0.0008444786071777344
1000,Top 3 website có doanh thu kênh web cao nhất năm 2001,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.004877328872680664
1001,Top 20 khách hàng chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.024499893188476562
1002,Top 3 sản phẩm bán chạy nhất trên kênh web năm 2000,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.022799253463745117
1003,Giá bán trung bình theo danh mục trên kênh web năm 2003,"SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_category;","SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_category",True,True,11,2,,,0.0049207210540771484
1004,Top 20 loại trang web có doanh thu cao nhất năm 2003,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20",True,True,7,2,,,0.003545999526977539
1005,Top 10 loại trang web có doanh thu cao nhất năm 1998,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10",True,True,8,2,,,0.006546735763549805
1006,Doanh thu kênh web trong quý 2 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2",True,True,1,1,,,0.003905057907104492
1007,Top 10 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.0078277587890625
1008,Top 20 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007589817047119141
1009,Top 50 khách hàng ở bang AZ chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007299900054931641
1010,Top 5 khách hàng ở bang CT chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.0064585208892822266
1011,Top 3 website có doanh thu kênh web cao nhất năm 2002,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.005400180816650391
1012,Top 5 loại trang web có doanh thu cao nhất năm 2000,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.005445241928100586
1013,Top 3 website có doanh thu kênh web cao nhất năm 2003,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.0032231807708740234
1014,Giá bán trung bình theo danh mục trên kênh web năm 2002,"SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_category;","SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_price
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_category",True,True,11,2,,,0.012673139572143555
1015,Top 20 khách hàng chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.005735635757446289
1016,Top 5 website có doanh thu kênh web cao nhất năm 2002,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.0052013397216796875
1017,Top 10 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007908821105957031
1019,Top 50 khách hàng chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.01883697509765625
1020,Top 50 sản phẩm bán chạy nhất trên kênh web năm 2003,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.004586935043334961
1021,Top 10 khách hàng ở bang IN chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.00904703140258789
1022,Doanh thu kênh web trong quý 4 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 4",True,True,1,1,,,0.0022270679473876953
1023,Top 5 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,2,4,,,0.006274700164794922
1024,Top 20 website có doanh thu kênh web cao nhất năm 2001,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,5,2,,,0.005563020706176758
1025,Top 5 khách hàng chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.005265951156616211
1026,Top 5 website có doanh thu kênh web cao nhất năm 1999,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.005551576614379883
1027,Top 50 loại trang web có doanh thu cao nhất năm 2002,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50",True,True,7,2,,,0.0052449703216552734
1028,Top 50 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.00709080696105957
1029,Top 10 khách hàng chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.020048141479492188
1030,Doanh thu kênh web trong tháng 4 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 4",True,True,1,1,,,0.0017132759094238281
1031,Top 20 website có doanh thu kênh web cao nhất năm 1998,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,5,2,,,0.006325483322143555
1032,Top 50 loại trang web có doanh thu cao nhất năm 1999,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50",True,True,8,2,,,0.004414081573486328
1033,Top 20 sản phẩm bán chạy nhất trên kênh web năm 2001,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.01650834083557129
1034,Tổng doanh thu kênh web trong năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001",True,True,1,1,,,0.0024285316467285156
1035,Top 5 website có doanh thu kênh web cao nhất năm 2001,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.0052547454833984375
1036,Top 50 khách hàng ở bang GA chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,6,4,,,0.006616830825805664
1037,Doanh thu kênh web trong quý 4 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_qoy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_qoy = 4",True,True,1,1,,,0.0010097026824951172
1038,Doanh thu kênh web trong tháng 3 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 3",True,True,1,1,,,0.001909494400024414
1039,Top 10 website có doanh thu kênh web cao nhất năm 1999,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,5,2,,,0.0053937435150146484
1040,Số lượng đơn hàng web theo phương thức giao hàng trong năm 2000,"SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT ws.ws_order_number) AS order_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.007030963897705078
1041,Top 3 khách hàng chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.005403280258178711
1042,Top 5 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.006571769714355469
1043,Top 10 sản phẩm bán chạy nhất trên kênh web năm 1999,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.0168306827545166
1044,Top 50 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,2,4,,,0.006567955017089844
1045,Top 3 khách hàng chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.01824021339416504
1046,Top 3 khách hàng ở bang MO chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.0077936649322509766
1047,Top 10 website có doanh thu kênh web cao nhất năm 2003,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,5,2,,,0.00401759147644043
1048,Top 20 loại trang web có doanh thu cao nhất năm 2001,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20",True,True,7,2,,,0.005573749542236328
1049,Top 50 website có doanh thu kênh web cao nhất năm 2000,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,5,2,,,0.0052645206451416016
1050,Doanh thu kênh web trong quý 4 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 4",True,True,1,1,,,0.002229452133178711
1051,Top 20 khách hàng chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.02058553695678711
1052,Top 20 khách hàng ở bang GA chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008038520812988281
1053,Doanh thu kênh web trong tháng 4 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 4",True,True,1,1,,,0.0022325515747070312
1054,Top 10 khách hàng ở bang WA chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.006809711456298828
1055,Top 20 khách hàng chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.023512601852416992
1056,Top 10 loại trang web có doanh thu cao nhất năm 2001,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10",True,True,7,2,,,0.006228446960449219
1057,Top 10 loại trang web có doanh thu cao nhất năm 2000,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10",True,True,8,2,,,0.006646633148193359
1058,Top 50 khách hàng ở bang CA chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.006998300552368164
1059,Top 3 sản phẩm bán chạy nhất trên kênh web năm 2003,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.005334377288818359
1060,Doanh thu kênh web trong tháng 10 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 10;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 10",True,True,1,1,,,0.002443552017211914
1061,Doanh thu kênh web trong quý 4 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4",True,True,1,1,,,0.00274658203125
1062,Top 50 khách hàng ở bang DE chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,8,4,,,0.007369279861450195
1063,Top 20 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.00876927375793457
1064,Top 3 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007333993911743164
1065,Top 5 khách hàng chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.0215756893157959
1066,Doanh thu kênh web trong quý 1 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 1",True,True,1,1,,,0.002878904342651367
1067,Top 20 khách hàng ở bang CT chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.0077495574951171875
1068,Top 20 sản phẩm bán chạy nhất trên kênh web năm 1998,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.02308940887451172
1069,Top 5 khách hàng ở bang WV chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009581327438354492
1070,Doanh thu kênh web trong tháng 3 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 3",True,True,1,1,,,0.0030019283294677734
1071,Top 10 khách hàng ở bang WV chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009184837341308594
1072,Top 50 loại trang web có doanh thu cao nhất năm 2001,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50",True,True,7,2,,,0.006325244903564453
1073,Top 3 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008835792541503906
1074,Top 50 khách hàng chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.024515390396118164
1075,Doanh thu kênh web trong tháng 9 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 9;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 9",True,True,1,1,,,0.0035114288330078125
1076,Doanh thu kênh web trong tháng 7 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 7;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 7",True,True,1,1,,,0.002727985382080078
1077,Top 20 website có doanh thu kênh web cao nhất năm 2000,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,5,2,,,0.006596088409423828
1078,Top 10 khách hàng chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.031003713607788086
1079,Doanh thu kênh web trong tháng 8 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 8;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 8",True,True,1,1,,,0.0046117305755615234
1080,Top 5 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,2,4,,,0.011653661727905273
1081,Top 3 khách hàng chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.024458885192871094
1082,Top 50 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,1,4,,,0.007464408874511719
1083,Doanh thu kênh web trong tháng 10 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 10;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 10",True,True,1,1,,,0.0028684139251708984
1084,Doanh thu kênh web trong tháng 11 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 11;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 11",True,True,1,1,,,0.002385854721069336
1085,Doanh thu kênh web trong tháng 8 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 8;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 8",True,True,1,1,,,0.0023508071899414062
1086,Top 3 website có doanh thu kênh web cao nhất năm 2000,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.0053272247314453125
1087,Top 20 loại trang web có doanh thu cao nhất năm 2000,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 20",True,True,8,2,,,0.0058879852294921875
1088,Top 10 sản phẩm bán chạy nhất trên kênh web năm 2000,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.018861770629882812
1089,Top 5 khách hàng ở bang IA chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009099245071411133
1090,Doanh thu kênh web trong tháng 8 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 8;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 8",True,True,1,1,,,0.003780364990234375
1091,Top 10 khách hàng ở bang FL chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,3,4,,,0.006597995758056641
1092,Doanh thu kênh web trong quý 4 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4",True,True,1,1,,,0.003085613250732422
1093,Top 10 khách hàng ở bang CA chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009651899337768555
1094,Top 50 khách hàng chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.023313045501708984
1095,Top 10 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,1,4,,,0.007806301116943359
1096,Doanh thu kênh web trong tháng 6 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 6;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 6",True,True,1,1,,,0.0024797916412353516
1097,Top 10 sản phẩm bán chạy nhất trên kênh web năm 1998,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.01810145378112793
1098,Doanh thu kênh web trong tháng 11 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 11;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 11",True,True,1,1,,,0.003070831298828125
1099,Top 50 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009951353073120117
1100,Doanh thu kênh web trong tháng 1 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 1",True,True,1,1,,,0.0027997493743896484
1101,Top 10 khách hàng chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.0199432373046875
1102,Top 50 khách hàng chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.018489837646484375
1103,Top 50 khách hàng chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.019927978515625
1104,Top 3 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00914764404296875
1105,Doanh thu kênh web trong tháng 5 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 5;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 5",True,True,1,1,,,0.002828836441040039
1106,Doanh thu kênh web trong tháng 11 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 11;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 11",True,True,1,1,,,0.0033087730407714844
1107,Top 3 khách hàng ở bang ID chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009404659271240234
1108,Top 50 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008510112762451172
1109,Top 50 khách hàng ở bang KS chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.011068582534790039
1110,Top 5 loại trang web có doanh thu cao nhất năm 2001,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.007579326629638672
1111,Top 3 loại trang web có doanh thu cao nhất năm 2002,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.006028652191162109
1112,Top 10 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.00987386703491211
1113,Top 50 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008015632629394531
1114,Top 50 website có doanh thu kênh web cao nhất năm 2002,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,5,2,,,0.006035804748535156
1115,Top 50 khách hàng ở bang MS chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007753610610961914
1116,Top 3 website có doanh thu kênh web cao nhất năm 1999,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.006075859069824219
1117,Doanh thu kênh web trong tháng 5 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 5;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 5",True,True,1,1,,,0.0021746158599853516
1118,Top 3 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008889436721801758
1119,Doanh thu kênh web trong tháng 1 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 1",True,True,1,1,,,0.00235748291015625
1120,Top 5 sản phẩm bán chạy nhất trên kênh web năm 2002,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.01780414581298828
1121,Top 50 website có doanh thu kênh web cao nhất năm 2003,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,5,2,,,0.004220008850097656
1122,Top 20 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,3,4,,,0.006497383117675781
1123,Top 50 website có doanh thu kênh web cao nhất năm 2001,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,5,2,,,0.00590062141418457
1124,Top 3 loại trang web có doanh thu cao nhất năm 2001,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.005974531173706055
1125,Doanh thu kênh web trong tháng 2 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 2",True,True,1,1,,,0.0024590492248535156
1126,Doanh thu kênh web trong tháng 4 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 4",True,True,1,1,,,0.0020172595977783203
1127,Doanh thu kênh web trong tháng 3 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 3",True,True,1,1,,,0.0024771690368652344
1128,Top 20 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,3,4,,,0.00664210319519043
1130,Doanh thu kênh web trong tháng 2 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 2",True,True,1,1,,,0.0028831958770751953
1131,Top 50 khách hàng ở bang AZ chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,47,4,,,0.007640361785888672
1132,Top 5 khách hàng ở bang MS chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.00892949104309082
1133,Doanh thu kênh web trong quý 1 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1",True,True,1,1,,,0.003253459930419922
1134,Doanh thu kênh web trong tháng 6 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 6;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 6",True,True,1,1,,,0.0020797252655029297
1136,Top 5 khách hàng ở bang UT chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.00818943977355957
1137,Top 5 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,1,4,,,0.00806879997253418
1138,Top 20 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,17,4,,,0.00763702392578125
1139,Top 20 sản phẩm bán chạy nhất trên kênh web năm 2002,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.020266056060791016
1140,Top 10 loại trang web có doanh thu cao nhất năm 1999,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 10",True,True,8,2,,,0.00781702995300293
1141,Doanh thu kênh web trong tháng 1 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 1",True,True,1,1,,,0.0037584304809570312
1142,Top 50 khách hàng ở bang WV chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.012537956237792969
1143,Top 50 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.0107421875
1144,Doanh thu kênh web trong tháng 7 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 7;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 7",True,True,1,1,,,0.0024111270904541016
1145,Top 20 khách hàng ở bang TN chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.012541770935058594
1146,Doanh thu kênh web trong quý 3 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 3",True,True,1,1,,,0.0030736923217773438
1147,Doanh thu kênh web trong tháng 6 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 6;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 6",True,True,1,1,,,0.002129793167114258
1148,Top 5 sản phẩm bán chạy nhất trên kênh web năm 1998,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.020980119705200195
1149,Top 5 khách hàng ở bang CA chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.01144862174987793
1150,Top 5 website có doanh thu kênh web cao nhất năm 2003,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.005134105682373047
1151,Top 10 website có doanh thu kênh web cao nhất năm 2002,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,5,2,,,0.006943225860595703
1152,Doanh thu kênh web trong tháng 3 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 3;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 3",True,True,1,1,,,0.002607107162475586
1153,Top 20 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009891510009765625
1154,Top 3 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.01132655143737793
1155,Top 10 sản phẩm bán chạy nhất trên kênh web năm 2003,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.008708953857421875
1156,Top 10 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,4,4,,,0.007998228073120117
1157,Doanh thu kênh web trong quý 2 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2",True,True,1,1,,,0.002536296844482422
1158,Doanh thu kênh web trong tháng 2 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 2",True,True,1,1,,,0.0020384788513183594
1159,Top 50 khách hàng ở bang ID chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007019758224487305
1160,Top 50 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.0076961517333984375
1161,Top 3 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00833582878112793
1162,Doanh thu kênh web trong tháng 7 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 7;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 7",True,True,1,1,,,0.0023956298828125
1163,Doanh thu kênh web trong tháng 12 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12",True,True,1,1,,,0.002285003662109375
1164,Top 3 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007715702056884766
1165,Top 50 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,48,4,,,0.008180379867553711
1166,Top 10 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.0075435638427734375
1167,Top 10 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.00842428207397461
1168,Top 10 khách hàng ở bang GA chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.01003265380859375
1169,Top 50 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009797334671020508
1170,Top 20 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,5,4,,,0.007198333740234375
1171,Doanh thu kênh web trong tháng 4 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 4",True,True,1,1,,,0.0034418106079101562
1172,Doanh thu kênh web trong tháng 9 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 9;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 9",True,True,1,1,,,0.0033380985260009766
1173,Top 5 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008605480194091797
1174,Top 5 website có doanh thu kênh web cao nhất năm 1998,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.005871295928955078
1175,Top 20 website có doanh thu kênh web cao nhất năm 1999,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,5,2,,,0.006936311721801758
1176,Top 5 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008898735046386719
1177,Doanh thu kênh web trong tháng 6 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 6;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 6",True,True,1,1,,,0.002195596694946289
1178,Top 50 khách hàng ở bang NY chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.0077898502349853516
1179,Top 10 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.008702516555786133
1180,Top 3 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009792566299438477
1181,Top 3 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.013833284378051758
1182,Top 3 sản phẩm bán chạy nhất trên kênh web năm 2001,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.0287015438079834
1183,Doanh thu kênh web trong tháng 12 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 12;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 12",True,True,1,1,,,0.0014798641204833984
1184,Top 3 khách hàng ở bang NJ chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.0076792240142822266
1185,Top 50 loại trang web có doanh thu cao nhất năm 2003,"SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50;","SELECT wp.wp_type, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY wp.wp_type
ORDER BY total_revenue DESC
LIMIT 50",True,True,7,2,,,0.005353212356567383
1186,Doanh thu kênh web trong tháng 11 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 11;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 11",True,True,1,1,,,0.001325845718383789
1187,Top 5 khách hàng ở bang WY chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008907318115234375
1188,Top 20 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.011148691177368164
1189,Top 50 website có doanh thu kênh web cao nhất năm 1999,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,5,2,,,0.005845546722412109
1190,Doanh thu kênh web trong tháng 12 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 12;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 12",True,True,1,1,,,0.003414630889892578
1191,Doanh thu kênh web trong tháng 4 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 4",True,True,1,1,,,0.003419637680053711
1192,Top 20 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,4,4,,,0.006754875183105469
1193,Top 3 sản phẩm bán chạy nhất trên kênh web năm 2002,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.021153926849365234
1194,Top 20 khách hàng ở bang MO chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,5,4,,,0.008423328399658203
1195,Top 50 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,17,4,,,0.008447647094726562
1196,Top 20 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,18,4,,,0.007727384567260742
1197,Top 10 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007607460021972656
1198,Doanh thu kênh web trong tháng 12 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 12;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 12",True,True,1,1,,,0.0033397674560546875
1199,Doanh thu kênh web trong tháng 7 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 7;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 7",True,True,1,1,,,0.001234292984008789
1200,Top 5 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.00824737548828125
1201,Doanh thu kênh web trong tháng 1 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 1",True,True,1,1,,,0.002857685089111328
1202,Top 5 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008461952209472656
1203,Top 5 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007820844650268555
1204,Top 50 khách hàng ở bang SC chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007325887680053711
1205,Top 3 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007584333419799805
1206,Top 5 khách hàng ở bang NH chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.00840306282043457
1207,Top 50 khách hàng ở bang NV chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008844614028930664
1208,Top 3 khách hàng ở bang NV chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007729291915893555
1209,Top 20 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007928133010864258
1210,Doanh thu kênh web trong tháng 5 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 5;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 5",True,True,1,1,,,0.0031518936157226562
1211,Doanh thu kênh web trong tháng 7 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 7;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 7",True,True,1,1,,,0.0022940635681152344
1212,Doanh thu kênh web trong tháng 10 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 10;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 10",True,True,1,1,,,0.0028264522552490234
1213,Doanh thu kênh web trong tháng 10 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 10;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 10",True,True,1,1,,,0.0022058486938476562
1214,Top 10 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,5,4,,,0.008810281753540039
1215,Doanh thu kênh web trong tháng 4 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 4;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 4",True,True,1,1,,,0.002834796905517578
1217,Top 3 khách hàng ở bang AK chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,2,4,,,0.006832122802734375
1218,Top 5 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008453369140625
1219,Doanh thu kênh web trong tháng 8 năm 2001 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 8;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 8",True,True,1,1,,,0.0027489662170410156
1220,Doanh thu kênh web trong tháng 7 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 7;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 7",True,True,1,1,,,0.0030975341796875
1221,Top 20 khách hàng ở bang AK chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.011051654815673828
1222,Top 20 khách hàng ở bang FL chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010663509368896484
1223,Top 50 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009312868118286133
1224,Top 3 khách hàng ở bang WA chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008394479751586914
1225,Doanh thu kênh web trong tháng 2 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 2;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 2",True,True,1,1,,,0.0024521350860595703
1226,Top 3 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007922887802124023
1227,Doanh thu kênh web trong tháng 1 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 1;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 1",True,True,1,1,,,0.002402782440185547
1228,Doanh thu kênh web trong tháng 9 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 9;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 9",True,True,1,1,,,0.0023632049560546875
1229,Top 50 sản phẩm bán chạy nhất trên kênh web năm 2000,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.019811630249023438
1230,Top 20 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008394241333007812
1231,Top 3 khách hàng ở bang TN chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.010959625244140625
1232,Doanh thu kênh web trong tháng 5 năm 1999 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 5;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 5",True,True,1,1,,,0.002566814422607422
1233,Top 10 sản phẩm bán chạy nhất trên kênh web năm 2001,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.023583173751831055
1234,Top 20 khách hàng chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.02611374855041504
1235,Top 20 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,3,4,,,0.007402896881103516
1236,Top 50 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,4,4,,,0.007999181747436523
1237,Top 50 khách hàng ở bang AZ chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007761478424072266
1238,Top 20 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009917736053466797
1239,Top 5 khách hàng ở bang MI chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009592056274414062
1240,Top 5 khách hàng ở bang NM chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.012244462966918945
1241,Top 20 khách hàng ở bang CT chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008843183517456055
1242,Top 5 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,3,4,,,0.015603780746459961
1243,Top 5 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.01429605484008789
1244,Top 20 khách hàng ở bang GA chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,6,4,,,0.010443925857543945
1245,Top 50 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.015373945236206055
1246,Top 3 khách hàng ở bang IN chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.014424800872802734
1247,Top 50 khách hàng ở bang WV chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.013791799545288086
1248,Top 50 khách hàng ở bang OK chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.012021541595458984
1249,Top 50 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.011847257614135742
1250,Top 20 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009596109390258789
1251,Top 50 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,2,4,,,0.009021759033203125
1252,Top 20 khách hàng ở bang NC chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.017555952072143555
1253,Top 50 khách hàng ở bang NV chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008149385452270508
1254,Top 5 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,4,4,,,0.007465362548828125
1255,Top 3 khách hàng ở bang NY chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007806301116943359
1256,Top 10 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,2,4,,,0.006749391555786133
1257,Top 50 khách hàng ở bang UT chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007791757583618164
1258,Top 5 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008457422256469727
1259,Top 50 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,22,4,,,0.007046699523925781
1260,Doanh thu kênh web trong tháng 11 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 11;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 11",True,True,1,1,,,0.002366781234741211
1261,Top 5 khách hàng ở bang NM chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007654905319213867
1262,Top 20 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008998394012451172
1263,Top 5 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,4,4,,,0.00891423225402832
1264,Top 3 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,2,4,,,0.008100748062133789
1265,Top 20 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.0099334716796875
1266,Top 50 khách hàng ở bang UT chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,2,4,,,0.00677943229675293
1267,Top 5 khách hàng ở bang WV chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009198188781738281
1268,Top 3 khách hàng ở bang KS chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009983301162719727
1269,Top 50 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.010598421096801758
1270,Top 5 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,1,4,,,0.008010149002075195
1271,Top 5 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009618282318115234
1272,Top 10 khách hàng ở bang OK chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009477376937866211
1273,Top 50 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,16,4,,,0.008721351623535156
1274,Top 3 khách hàng ở bang IA chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.010535717010498047
1275,Top 50 khách hàng ở bang MO chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009364604949951172
1276,Top 10 khách hàng ở bang WV chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.011334657669067383
1277,Doanh thu kênh web trong tháng 10 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 10;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 10",True,True,1,1,,,0.00142669677734375
1278,Top 3 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008755683898925781
1279,Top 50 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007653951644897461
1280,Top 20 khách hàng ở bang NJ chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007512569427490234
1281,Top 5 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,2,4,,,0.007253885269165039
1282,Top 3 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007576465606689453
1285,Top 50 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,38,4,,,0.007370710372924805
1286,Top 5 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.010009527206420898
1287,Doanh thu kênh web trong tháng 11 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 11;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 11",True,True,1,1,,,0.0038199424743652344
1288,Top 50 khách hàng ở bang DE chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,4,4,,,0.008021354675292969
1289,Top 50 khách hàng ở bang OK chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.010311603546142578
1290,Top 50 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,18,4,,,0.011419534683227539
1291,Top 3 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008950471878051758
1292,Top 10 khách hàng ở bang MO chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.010462760925292969
1293,Top 10 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,3,4,,,0.006913423538208008
1294,Top 3 website có doanh thu kênh web cao nhất năm 1998,"SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT w.web_name, SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY w.web_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.0059697628021240234
1295,Top 3 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009792804718017578
1296,Top 3 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.010374069213867188
1297,Top 10 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,1,4,,,0.0065996646881103516
1298,Top 10 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007437705993652344
1299,Top 10 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007163047790527344
1300,Top 10 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.008558511734008789
1301,Top 10 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009360551834106445
1302,Top 5 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008892059326171875
1303,Doanh thu kênh web trong tháng 9 năm 2003 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 9;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 9",True,True,1,1,,,0.0017004013061523438
1304,Top 3 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.010539531707763672
1305,Top 5 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008824348449707031
1306,Top 50 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,28,4,,,0.00843191146850586
1307,Top 50 khách hàng ở bang MD chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007807254791259766
1308,Top 20 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,3,4,,,0.006786823272705078
1309,Top 20 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008762359619140625
1310,Top 20 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007822751998901367
1311,Doanh thu kênh web trong tháng 10 năm 2000 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 10;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 10",True,True,1,1,,,0.0037238597869873047
1312,Top 20 khách hàng ở bang MS chi tiêu nhiều nhất trên kênh web năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,1,4,,,0.007787227630615234
1313,Top 5 khách hàng ở bang NV chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.00821542739868164
1314,Top 50 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,17,4,,,0.008220911026000977
1315,Top 50 khách hàng ở bang MA chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,45,4,,,0.008238077163696289
1316,Top 3 khách hàng ở bang NJ chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007759809494018555
1317,Doanh thu kênh web trong tháng 12 năm 2002 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 12;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 12",True,True,1,1,,,0.003094196319580078
1319,Top 3 khách hàng ở bang TN chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.010372161865234375
1320,Top 3 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.011022090911865234
1321,Doanh thu kênh web trong tháng 12 năm 1998 là bao nhiêu,"SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 12;","SELECT SUM(ws.ws_net_paid) AS total_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 12",True,True,1,1,,,0.0026171207427978516
1322,Top 5 khách hàng ở bang UT chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.010936975479125977
1323,Top 10 khách hàng ở bang MO chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.012525320053100586
1324,Top 10 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.010854005813598633
1325,Top 5 khách hàng ở bang DE chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.00861501693725586
1326,Top 50 khách hàng ở bang MO chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.012391090393066406
1328,Top 50 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008735179901123047
1329,Top 50 khách hàng ở bang WY chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009128093719482422
1330,Top 50 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.011063575744628906
1331,Top 50 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh web năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.011117696762084961
1332,Top 10 khách hàng ở bang AK chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009145975112915039
1333,Top 10 khách hàng ở bang MS chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.011867761611938477
1334,Top 50 khách hàng ở bang NM chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.00948190689086914
1335,Top 20 khách hàng ở bang CT chi tiêu nhiều nhất trên kênh web năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009748697280883789
1336,Top 10 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.010846853256225586
1337,Top 20 khách hàng ở bang MS chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009767770767211914
1338,Top 3 khách hàng ở bang KS chi tiêu nhiều nhất trên kênh web năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.010125398635864258
1340,Top 5 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh web năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008715629577636719
1341,Top 5 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh web năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ws.ws_net_paid) AS total_spent
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007889270782470703
1342,Top 3 catalog page có doanh thu cao nhất năm 2001,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.023567676544189453
1343,Giá bán trung bình theo danh mục trên kênh catalog năm 2003,"SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_category;","SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_category",True,True,11,2,,,0.0032808780670166016
1344,Top 20 catalog page có doanh thu cao nhất năm 1999,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20",True,True,20,2,,,0.020153522491455078
1345,Top 5 sản phẩm bán chạy nhất trên kênh catalog năm 2002,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.028817415237426758
1346,Giá bán trung bình theo danh mục trên kênh catalog năm 2000,"SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_category;","SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_category",True,True,11,2,,,0.03476834297180176
1347,Số lượng đơn hàng catalog theo phương thức giao hàng trong năm 1999,"SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.01478433609008789
1348,Top 10 call center có doanh thu catalog cao nhất năm 2001,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,3,2,,,0.008433818817138672
1349,Top 3 catalog page có doanh thu cao nhất năm 1998,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.02571868896484375
1350,Top 3 catalog page có doanh thu cao nhất năm 2000,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.021235942840576172
1351,Top 50 khách hàng ở bang ID chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.011065244674682617
1352,Doanh thu kênh catalog trong tháng 12 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 12;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 12",True,True,1,1,,,0.0016047954559326172
1353,Doanh thu kênh catalog trong tháng 9 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 9;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 9",True,True,1,1,,,0.001924276351928711
1354,Top 20 catalog page có doanh thu cao nhất năm 2002,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20",True,True,20,2,,,0.02558112144470215
1355,Top 5 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.010628938674926758
1356,Top 20 catalog page có doanh thu cao nhất năm 1998,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20",True,True,20,2,,,0.024638652801513672
1357,Top 5 call center có doanh thu catalog cao nhất năm 2003,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,3,2,,,0.0034003257751464844
1358,Top 20 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.011454105377197266
1359,Top 50 call center có doanh thu catalog cao nhất năm 2003,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,3,2,,,0.003103017807006836
1360,Top 5 sản phẩm bán chạy nhất trên kênh catalog năm 2003,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.006381034851074219
1361,Doanh thu kênh catalog trong tháng 12 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 12;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 12",True,True,1,1,,,0.0018162727355957031
1362,Top 20 khách hàng ở bang IA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.014661550521850586
1363,Top 20 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.013108253479003906
1364,Doanh thu kênh catalog trong tháng 3 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 3;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 3",True,True,1,1,,,0.0024700164794921875
1365,Giá bán trung bình theo danh mục trên kênh catalog năm 2001,"SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_category;","SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_category",True,True,11,2,,,0.028539180755615234
1366,Doanh thu kênh catalog trong tháng 2 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 2;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 2",True,True,1,1,,,0.001783609390258789
1367,Top 20 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010378360748291016
1368,Tổng doanh thu kênh catalog trong năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998",True,True,1,1,,,0.0023338794708251953
1369,Tổng doanh thu kênh catalog trong năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999",True,True,1,1,,,0.0022215843200683594
1370,Top 20 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.038275957107543945
1371,Top 50 khách hàng ở bang MI chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.00981760025024414
1372,Top 10 sản phẩm bán chạy nhất trên kênh catalog năm 2000,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.032396554946899414
1373,Top 10 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009325027465820312
1374,Top 3 call center có doanh thu catalog cao nhất năm 2002,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.00842142105102539
1375,Tổng doanh thu kênh catalog trong năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002",True,True,1,1,,,0.002396821975708008
1376,Tổng số đơn hàng kênh catalog trong năm 2001,"SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001;","SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001",True,True,1,1,,,0.00508427619934082
1377,Top 10 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.038742780685424805
1378,Top 50 call center có doanh thu catalog cao nhất năm 1998,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,3,2,,,0.0066874027252197266
1379,Tổng doanh thu kênh catalog trong năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003",True,True,1,1,,,0.0011448860168457031
1380,Tổng số đơn hàng kênh catalog trong năm 2000,"SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000;","SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000",True,True,1,1,,,0.006102085113525391
1381,Doanh thu kênh catalog trong tháng 1 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 1;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 1",True,True,1,1,,,0.0015988349914550781
1382,Top 20 sản phẩm bán chạy nhất trên kênh catalog năm 2003,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.0042498111724853516
1383,Top 20 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,1,4,,,0.007447957992553711
1384,Số lượng đơn hàng catalog theo phương thức giao hàng trong năm 2001,"SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.013137340545654297
1385,Tổng số đơn hàng kênh catalog trong năm 1999,"SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999;","SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999",True,True,1,1,,,0.006613492965698242
1386,Top 20 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.04311561584472656
1387,Top 50 sản phẩm bán chạy nhất trên kênh catalog năm 2001,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.03837847709655762
1388,Top 20 call center có doanh thu catalog cao nhất năm 1999,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,3,2,,,0.006729602813720703
1389,Top 5 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.036481380462646484
1390,Doanh thu kênh catalog trong tháng 1 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 1;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 1",True,True,1,1,,,0.0027599334716796875
1391,Top 20 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008387565612792969
1392,Doanh thu kênh catalog trong tháng 11 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 11;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 11",True,True,1,1,,,0.0016143321990966797
1393,Top 20 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009039163589477539
1394,Top 50 catalog page có doanh thu cao nhất năm 2001,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50",True,True,50,2,,,0.023133277893066406
1395,Số lượng đơn hàng catalog theo phương thức giao hàng trong năm 2000,"SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.017487525939941406
1396,Top 5 sản phẩm bán chạy nhất trên kênh catalog năm 2001,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.04024314880371094
1397,Top 3 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.013344526290893555
1398,Top 50 sản phẩm bán chạy nhất trên kênh catalog năm 2000,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.036991119384765625
1399,Số lượng đơn hàng catalog theo phương thức giao hàng trong năm 2002,"SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.01579761505126953
1400,Top 10 khách hàng ở bang CT chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.00690460205078125
1401,Top 20 khách hàng ở bang NH chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,3,4,,,0.006432294845581055
1402,Doanh thu kênh catalog trong tháng 8 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 8;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 8",True,True,1,1,,,0.002365589141845703
1403,Doanh thu kênh catalog trong tháng 12 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 12;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 12",True,True,1,1,,,0.0019550323486328125
1404,Top 50 catalog page có doanh thu cao nhất năm 1998,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50",True,True,50,2,,,0.020718097686767578
1405,Tổng số đơn hàng kênh catalog trong năm 2002,"SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002;","SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002",True,True,1,1,,,0.005357503890991211
1406,Doanh thu kênh catalog trong tháng 8 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 8;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 8",True,True,1,1,,,0.0014348030090332031
1407,Doanh thu kênh catalog trong tháng 11 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 11;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 11",True,True,1,1,,,0.001013040542602539
1408,Giá bán trung bình theo danh mục trên kênh catalog năm 2002,"SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_category;","SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_category",True,True,11,2,,,0.027387619018554688
1409,Tổng doanh thu kênh catalog trong năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000",True,True,1,1,,,0.004228115081787109
1410,Tổng số đơn hàng kênh catalog trong năm 1998,"SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998;","SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998",True,True,1,1,,,0.008944511413574219
1411,Top 50 catalog page có doanh thu cao nhất năm 2003,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50",True,True,50,2,,,0.005160093307495117
1412,Top 20 call center có doanh thu catalog cao nhất năm 2000,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,3,2,,,0.006552696228027344
1413,Top 3 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.005732297897338867
1414,Top 10 khách hàng ở bang OK chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.008571624755859375
1415,Top 10 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.010501384735107422
1416,Top 50 catalog page có doanh thu cao nhất năm 1999,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50",True,True,50,2,,,0.02596259117126465
1417,Top 3 khách hàng ở bang CA chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008507728576660156
1418,Top 3 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.014200210571289062
1419,Doanh thu kênh catalog trong tháng 9 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 9;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 9",True,True,1,1,,,0.002144336700439453
1420,Doanh thu kênh catalog trong tháng 5 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 5;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 5",True,True,1,1,,,0.0029358863830566406
1421,Top 50 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.040308475494384766
1422,Doanh thu kênh catalog trong tháng 3 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 3;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 3",True,True,1,1,,,0.0027730464935302734
1423,Top 5 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.0067903995513916016
1424,Top 5 call center có doanh thu catalog cao nhất năm 2000,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,3,2,,,0.00804448127746582
1425,Top 20 sản phẩm bán chạy nhất trên kênh catalog năm 1999,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.033997297286987305
1426,Top 3 call center có doanh thu catalog cao nhất năm 1999,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.008845090866088867
1427,Top 5 khách hàng ở bang IN chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008929729461669922
1428,Top 5 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.042523860931396484
1429,Top 3 call center có doanh thu catalog cao nhất năm 2003,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.0031936168670654297
1430,Giá bán trung bình theo danh mục trên kênh catalog năm 1998,"SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_category;","SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_category",True,True,11,2,,,0.029370784759521484
1431,Top 20 catalog page có doanh thu cao nhất năm 2001,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20",True,True,20,2,,,0.0211484432220459
1432,Số lượng đơn hàng catalog theo phương thức giao hàng trong năm 2003,"SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.003786325454711914
1433,Giá bán trung bình theo danh mục trên kênh catalog năm 1999,"SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_category;","SELECT i.i_category, AVG(cs.cs_sales_price) AS avg_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_category",True,True,11,2,,,0.024761438369750977
1434,Top 20 catalog page có doanh thu cao nhất năm 2003,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20",True,True,20,2,,,0.005036354064941406
1435,Tổng số đơn hàng kênh catalog trong năm 2003,"SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003;","SELECT COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003",True,True,1,1,,,0.003618001937866211
1436,Top 20 call center có doanh thu catalog cao nhất năm 2002,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,3,2,,,0.010448217391967773
1437,Doanh thu kênh catalog trong tháng 11 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 11;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 11",True,True,1,1,,,0.0018384456634521484
1438,Top 20 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.01023244857788086
1439,Top 50 sản phẩm bán chạy nhất trên kênh catalog năm 1999,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.03150463104248047
1440,Top 10 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.03792929649353027
1441,Tổng doanh thu kênh catalog trong năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001",True,True,1,1,,,0.0036258697509765625
1442,Top 10 catalog page có doanh thu cao nhất năm 1999,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10",True,True,10,2,,,0.02315354347229004
1443,Top 3 sản phẩm bán chạy nhất trên kênh catalog năm 1998,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.03111886978149414
1444,Top 3 khách hàng ở bang MS chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009505271911621094
1445,Top 50 sản phẩm bán chạy nhất trên kênh catalog năm 2003,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.006022930145263672
1446,Doanh thu kênh catalog trong tháng 2 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 2;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 2",True,True,1,1,,,0.0011692047119140625
1447,Top 5 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.00817251205444336
1448,Top 10 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.039510488510131836
1449,Top 3 catalog page có doanh thu cao nhất năm 2003,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.0032875537872314453
1450,Top 10 catalog page có doanh thu cao nhất năm 2001,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10",True,True,10,2,,,0.022071361541748047
1451,Top 10 call center có doanh thu catalog cao nhất năm 1999,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,3,2,,,0.009202718734741211
1452,Top 3 call center có doanh thu catalog cao nhất năm 2000,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.010075569152832031
1453,Top 20 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.04197192192077637
1454,Top 50 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.037946224212646484
1455,Doanh thu kênh catalog trong tháng 12 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 12;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 12",True,True,1,1,,,0.003154277801513672
1456,Top 3 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.0364382266998291
1457,Top 10 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.03784060478210449
1458,Top 3 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008646488189697266
1459,Doanh thu kênh catalog trong tháng 4 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 4;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 4",True,True,1,1,,,0.0014824867248535156
1460,Top 3 catalog page có doanh thu cao nhất năm 2002,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.025496721267700195
1461,Top 3 call center có doanh thu catalog cao nhất năm 2001,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.0066242218017578125
1462,Top 10 sản phẩm bán chạy nhất trên kênh catalog năm 2003,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.00482940673828125
1463,Số lượng đơn hàng catalog theo phương thức giao hàng trong năm 1998,"SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY sm.sm_type
ORDER BY order_count DESC;","SELECT sm.sm_type, COUNT(DISTINCT cs.cs_order_number) AS order_count
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY sm.sm_type
ORDER BY order_count DESC",True,True,6,2,,,0.010820865631103516
1464,Top 20 call center có doanh thu catalog cao nhất năm 1998,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,3,2,,,0.009813785552978516
1465,Top 5 catalog page có doanh thu cao nhất năm 1999,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.02418684959411621
1466,Top 5 khách hàng ở bang AZ chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008378744125366211
1467,Doanh thu kênh catalog trong tháng 11 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 11;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 11",True,True,1,1,,,0.002131223678588867
1468,Top 5 khách hàng ở bang CT chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007983684539794922
1469,Top 3 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009321451187133789
1470,Top 3 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.037351369857788086
1471,Doanh thu kênh catalog trong tháng 10 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 10;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 10",True,True,1,1,,,0.002147674560546875
1472,Top 50 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.047103166580200195
1473,Doanh thu kênh catalog trong tháng 8 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 8;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 8",True,True,1,1,,,0.003061056137084961
1474,Top 50 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,49,4,,,0.008363008499145508
1475,Top 20 sản phẩm bán chạy nhất trên kênh catalog năm 2000,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.037276506423950195
1476,Doanh thu kênh catalog trong tháng 10 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 10;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 10",True,True,1,1,,,0.00177764892578125
1477,Top 5 call center có doanh thu catalog cao nhất năm 1998,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,3,2,,,0.012819290161132812
1478,Top 5 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008012771606445312
1479,Doanh thu kênh catalog trong tháng 3 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 3;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 3",True,True,1,1,,,0.0023369789123535156
1480,Top 50 call center có doanh thu catalog cao nhất năm 1999,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,3,2,,,0.013613700866699219
1481,Top 5 catalog page có doanh thu cao nhất năm 2002,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.02896904945373535
1482,Doanh thu kênh catalog trong tháng 1 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 1;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 1",True,True,1,1,,,0.002536296844482422
1483,Top 10 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.010535240173339844
1484,Top 50 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007952213287353516
1485,Doanh thu kênh catalog trong tháng 5 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 5;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 5",True,True,1,1,,,0.0014455318450927734
1486,Top 3 sản phẩm bán chạy nhất trên kênh catalog năm 2002,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.031122922897338867
1487,Doanh thu kênh catalog trong tháng 6 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 6;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 6",True,True,1,1,,,0.0031359195709228516
1488,Top 10 sản phẩm bán chạy nhất trên kênh catalog năm 1998,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.032218217849731445
1489,Top 3 sản phẩm bán chạy nhất trên kênh catalog năm 1999,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.03144049644470215
1490,Top 50 call center có doanh thu catalog cao nhất năm 2001,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,3,2,,,0.009325742721557617
1491,Top 50 catalog page có doanh thu cao nhất năm 2002,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50",True,True,50,2,,,0.023006677627563477
1492,Top 5 catalog page có doanh thu cao nhất năm 2001,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.022058963775634766
1493,Top 5 call center có doanh thu catalog cao nhất năm 2001,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,3,2,,,0.010789155960083008
1494,Top 10 sản phẩm bán chạy nhất trên kênh catalog năm 1999,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.029968738555908203
1495,Top 3 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008158683776855469
1496,Doanh thu kênh catalog trong tháng 8 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 8;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 8",True,True,1,1,,,0.003445148468017578
1497,Top 5 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.006592512130737305
1498,Top 50 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.03803110122680664
1499,Top 3 sản phẩm bán chạy nhất trên kênh catalog năm 2001,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.030399799346923828
1500,Top 10 catalog page có doanh thu cao nhất năm 1998,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10",True,True,10,2,,,0.01988506317138672
1501,Top 5 sản phẩm bán chạy nhất trên kênh catalog năm 2000,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.03156161308288574
1502,Top 3 khách hàng ở bang CT chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008569717407226562
1503,Top 3 khách hàng ở bang KS chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.01030874252319336
1504,Top 20 call center có doanh thu catalog cao nhất năm 2003,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,3,2,,,0.0036089420318603516
1505,Top 50 khách hàng ở bang OK chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008859634399414062
1506,Top 3 call center có doanh thu catalog cao nhất năm 1998,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.012875795364379883
1507,Top 50 sản phẩm bán chạy nhất trên kênh catalog năm 1998,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.03307533264160156
1508,Top 10 call center có doanh thu catalog cao nhất năm 2002,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,3,2,,,0.008146286010742188
1509,Top 50 catalog page có doanh thu cao nhất năm 2000,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 50",True,True,50,2,,,0.02771162986755371
1510,Doanh thu kênh catalog trong tháng 7 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 7;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 7",True,True,1,1,,,0.0034072399139404297
1511,Doanh thu kênh catalog trong tháng 5 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 5;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 5",True,True,1,1,,,0.0018877983093261719
1512,Doanh thu kênh catalog trong tháng 3 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 3;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 3",True,True,1,1,,,0.0023164749145507812
1513,Top 50 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.01261138916015625
1514,Top 10 catalog page có doanh thu cao nhất năm 2002,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10",True,True,10,2,,,0.02376103401184082
1515,Top 10 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.036986589431762695
1516,Top 10 catalog page có doanh thu cao nhất năm 2000,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10",True,True,10,2,,,0.021039962768554688
1517,Top 50 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.03909182548522949
1518,Top 5 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.006296634674072266
1519,Top 5 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.0368504524230957
1520,Doanh thu kênh catalog trong tháng 6 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 6;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 6",True,True,1,1,,,0.002460479736328125
1521,Top 5 khách hàng ở bang NY chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.0077855587005615234
1522,Top 5 call center có doanh thu catalog cao nhất năm 1999,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,3,2,,,0.00974130630493164
1523,Top 10 catalog page có doanh thu cao nhất năm 2003,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 10",True,True,10,2,,,0.0038661956787109375
1524,Doanh thu kênh catalog trong tháng 8 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 8;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 8",True,True,1,1,,,0.0012319087982177734
1525,Top 5 khách hàng ở bang NM chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009562492370605469
1526,Doanh thu kênh catalog trong tháng 7 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 7;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 7",True,True,1,1,,,0.0019299983978271484
1527,Top 50 khách hàng ở bang MA chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008872270584106445
1528,Top 10 call center có doanh thu catalog cao nhất năm 2000,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,3,2,,,0.012757062911987305
1529,Top 50 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.011045217514038086
1530,Top 10 sản phẩm bán chạy nhất trên kênh catalog năm 2001,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.03790640830993652
1531,Top 5 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009857892990112305
1532,Top 10 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.00927424430847168
1533,Top 5 catalog page có doanh thu cao nhất năm 1998,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.026070356369018555
1534,Top 20 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009400129318237305
1535,Top 3 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00911569595336914
1536,Top 3 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008859872817993164
1537,Top 5 catalog page có doanh thu cao nhất năm 2000,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.026183128356933594
1538,Top 3 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.0420534610748291
1539,Top 3 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.03875565528869629
1540,Top 10 khách hàng ở bang WA chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.013052940368652344
1541,Top 20 call center có doanh thu catalog cao nhất năm 2001,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 20",True,True,3,2,,,0.011187076568603516
1542,Top 50 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.012438774108886719
1543,Doanh thu kênh catalog trong tháng 3 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 3;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 3",True,True,1,1,,,0.0024259090423583984
1544,Top 10 call center có doanh thu catalog cao nhất năm 2003,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,3,2,,,0.0028839111328125
1545,Top 50 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009914636611938477
1546,Doanh thu kênh catalog trong tháng 3 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 3;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 3",True,True,1,1,,,0.0015380382537841797
1547,Top 5 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.04618024826049805
1548,Top 5 khách hàng ở bang TN chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.010857820510864258
1549,Top 5 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.010468482971191406
1550,Doanh thu kênh catalog trong tháng 10 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 10;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 10",True,True,1,1,,,0.0029921531677246094
1551,Top 5 khách hàng ở bang SC chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'SC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'SC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.010250329971313477
1552,Doanh thu kênh catalog trong tháng 6 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 6;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 6",True,True,1,1,,,0.001619100570678711
1553,Doanh thu kênh catalog trong tháng 11 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 11;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 11",True,True,1,1,,,0.002184629440307617
1554,Top 3 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009760379791259766
1555,Doanh thu kênh catalog trong tháng 4 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 4;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 4",True,True,1,1,,,0.0031249523162841797
1556,Top 5 call center có doanh thu catalog cao nhất năm 2002,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 5",True,True,3,2,,,0.009077310562133789
1557,Top 50 khách hàng ở bang IN chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.012686014175415039
1558,Doanh thu kênh catalog trong tháng 8 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 8;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 8",True,True,1,1,,,0.001967191696166992
1559,Top 5 catalog page có doanh thu cao nhất năm 2003,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 5",True,True,5,2,,,0.0038709640502929688
1560,Top 3 catalog page có doanh thu cao nhất năm 1999,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 3",True,True,3,2,,,0.021681785583496094
1561,Top 50 khách hàng ở bang IN chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.010100603103637695
1562,Doanh thu kênh catalog trong tháng 9 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 9;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 9",True,True,1,1,,,0.0030927658081054688
1563,Top 50 call center có doanh thu catalog cao nhất năm 2002,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,3,2,,,0.008078813552856445
1564,Top 20 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.040845632553100586
1565,Top 10 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.0067255496978759766
1566,Top 10 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009811878204345703
1567,Top 3 khách hàng ở bang NH chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.01007986068725586
1568,Top 5 sản phẩm bán chạy nhất trên kênh catalog năm 1999,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.03463125228881836
1569,Top 3 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009641885757446289
1570,Top 20 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.011383295059204102
1571,Top 50 khách hàng ở bang FL chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009601593017578125
1572,Top 20 sản phẩm bán chạy nhất trên kênh catalog năm 2001,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.02978658676147461
1573,Top 20 khách hàng ở bang TN chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.00845956802368164
1574,Doanh thu kênh catalog trong tháng 4 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 4;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 4",True,True,1,1,,,0.0018336772918701172
1575,Top 5 khách hàng ở bang WY chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.01045536994934082
1576,Doanh thu kênh catalog trong tháng 4 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 4;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 4",True,True,1,1,,,0.0017194747924804688
1577,Doanh thu kênh catalog trong tháng 10 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 10;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 10",True,True,1,1,,,0.0019278526306152344
1578,Top 50 khách hàng ở bang NM chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.011064291000366211
1579,Top 50 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.010597944259643555
1580,Doanh thu kênh catalog trong tháng 10 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 10;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 10",True,True,1,1,,,0.0017848014831542969
1581,Doanh thu kênh catalog trong tháng 6 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 6;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 6",True,True,1,1,,,0.0027914047241210938
1582,Top 20 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,11,4,,,0.007848739624023438
1583,Top 3 khách hàng ở bang MO chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.012778520584106445
1584,Top 10 call center có doanh thu catalog cao nhất năm 1998,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 10",True,True,3,2,,,0.007027149200439453
1585,Top 3 khách hàng ở bang TN chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.006833791732788086
1586,Top 10 sản phẩm bán chạy nhất trên kênh catalog năm 2002,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 10",True,True,10,2,,,0.03366208076477051
1587,Doanh thu kênh catalog trong tháng 7 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 7;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 7",True,True,1,1,,,0.0017955303192138672
1588,Top 50 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,1,4,,,0.006962776184082031
1589,Top 3 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.039873361587524414
1590,Top 3 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.010043621063232422
1591,Top 10 khách hàng ở bang MI chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009381294250488281
1592,Doanh thu kênh catalog trong tháng 6 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 6;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 6",True,True,1,1,,,0.0014004707336425781
1593,Top 5 khách hàng ở bang GA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.01033329963684082
1594,Top 5 khách hàng ở bang KS chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008873939514160156
1595,Top 20 khách hàng ở bang NY chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007409572601318359
1596,Top 5 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.00762939453125
1597,Top 20 khách hàng ở bang NH chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007445812225341797
1598,Top 20 khách hàng ở bang WA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.00836324691772461
1599,Top 10 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009430885314941406
1600,Top 50 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,11,4,,,0.008392333984375
1601,Top 20 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009026050567626953
1602,Doanh thu kênh catalog trong tháng 12 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12",True,True,1,1,,,0.002028942108154297
1603,Top 50 khách hàng ở bang IA chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.010190963745117188
1604,Top 5 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009302377700805664
1605,Top 3 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.01447749137878418
1606,Top 20 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008638381958007812
1607,Top 5 khách hàng ở bang MA chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007738828659057617
1608,Doanh thu kênh catalog trong tháng 10 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 10;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 10",True,True,1,1,,,0.0025115013122558594
1609,Top 5 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.038565874099731445
1610,Doanh thu kênh catalog trong tháng 4 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 4;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 4",True,True,1,1,,,0.002634763717651367
1611,Top 5 khách hàng ở bang TN chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007398128509521484
1612,Top 20 khách hàng ở bang IN chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008283138275146484
1613,Top 5 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.00932621955871582
1614,Doanh thu kênh catalog trong tháng 9 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 9;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 9",True,True,1,1,,,0.002406597137451172
1615,Doanh thu kênh catalog trong tháng 1 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 1;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 1",True,True,1,1,,,0.0012404918670654297
1616,Top 20 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,8,4,,,0.005702018737792969
1617,Top 10 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009520769119262695
1618,Top 5 sản phẩm bán chạy nhất trên kênh catalog năm 1998,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5",True,True,5,2,,,0.034888505935668945
1619,Top 10 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.0081787109375
1620,Top 20 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010614156723022461
1621,Top 10 khách hàng ở bang SC chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'SC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'SC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,7,4,,,0.007689952850341797
1622,Doanh thu kênh catalog trong tháng 12 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 12;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 12",True,True,1,1,,,0.002184152603149414
1623,Top 5 khách hàng ở bang CA chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007738828659057617
1624,Top 20 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.01329660415649414
1625,Top 20 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008681297302246094
1626,Top 10 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007966041564941406
1627,Top 5 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008668184280395508
1628,Top 5 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009672403335571289
1629,Top 5 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.0061855316162109375
1630,Top 50 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,8,4,,,0.0060732364654541016
1631,Doanh thu kênh catalog trong tháng 9 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 9;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 9",True,True,1,1,,,0.003916740417480469
1632,Top 10 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.010006427764892578
1633,Doanh thu kênh catalog trong tháng 11 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 11;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 11",True,True,1,1,,,0.0039386749267578125
1634,Doanh thu kênh catalog trong tháng 5 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 5;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 5",True,True,1,1,,,0.002387523651123047
1635,Top 3 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009784221649169922
1636,Top 50 sản phẩm bán chạy nhất trên kênh catalog năm 2002,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 50",True,True,50,2,,,0.0346980094909668
1637,Top 5 khách hàng ở bang AZ chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,1,4,,,0.007775306701660156
1638,Top 3 sản phẩm bán chạy nhất trên kênh catalog năm 2000,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.03366994857788086
1639,Top 50 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,28,4,,,0.007521629333496094
1640,Top 20 khách hàng ở bang FL chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,6,4,,,0.0068018436431884766
1641,Top 10 khách hàng ở bang NM chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.006422281265258789
1642,Top 20 khách hàng ở bang OK chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009333372116088867
1643,Top 5 khách hàng ở bang ID chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008659124374389648
1644,Top 20 khách hàng ở bang DE chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,18,4,,,0.0075109004974365234
1645,Top 20 khách hàng ở bang MO chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.0092926025390625
1646,Top 10 khách hàng ở bang IA chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007525444030761719
1647,Doanh thu kênh catalog trong tháng 2 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 2;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 2",True,True,1,1,,,0.0021359920501708984
1648,Top 20 sản phẩm bán chạy nhất trên kênh catalog năm 2002,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.028745412826538086
1649,Doanh thu kênh catalog trong tháng 2 năm 2000 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 2;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 2",True,True,1,1,,,0.0013349056243896484
1650,Top 50 khách hàng ở bang SC chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'SC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'SC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007760047912597656
1652,Top 50 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009088277816772461
1653,Top 5 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008977651596069336
1654,Top 20 sản phẩm bán chạy nhất trên kênh catalog năm 1998,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 20",True,True,20,2,,,0.029879331588745117
1655,Top 10 khách hàng ở bang WY chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.01005244255065918
1656,Doanh thu kênh catalog trong tháng 4 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 4;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 4",True,True,1,1,,,0.001455068588256836
1657,Doanh thu kênh catalog trong tháng 1 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 1;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 1",True,True,1,1,,,0.0020203590393066406
1658,Top 20 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010469198226928711
1659,Top 3 khách hàng ở bang AZ chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008253812789916992
1660,Top 3 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007488250732421875
1661,Top 5 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.01206517219543457
1662,Top 5 khách hàng ở bang ID chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.010132789611816406
1663,Top 20 khách hàng ở bang WY chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.012699604034423828
1664,Top 20 khách hàng chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.04242753982543945
1665,Top 10 khách hàng ở bang NH chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007160186767578125
1666,Top 5 khách hàng ở bang WY chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007075309753417969
1667,Top 50 call center có doanh thu catalog cao nhất năm 2000,"SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50;","SELECT cc.cc_name, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cc.cc_name
ORDER BY total_revenue DESC
LIMIT 50",True,True,3,2,,,0.011176586151123047
1668,Top 3 sản phẩm bán chạy nhất trên kênh catalog năm 2003,"SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3;","SELECT i.i_item_desc, SUM(cs.cs_quantity) AS total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 3",True,True,3,2,,,0.007570505142211914
1669,Top 5 khách hàng ở bang NC chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009289741516113281
1670,Top 10 khách hàng ở bang GA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.011115074157714844
1671,Top 5 khách hàng ở bang CA chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009992122650146484
1672,Top 3 khách hàng ở bang ID chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007990360260009766
1673,Top 3 khách hàng ở bang DE chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008460521697998047
1674,Top 5 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007279872894287109
1675,Top 3 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007134199142456055
1676,Top 3 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00983119010925293
1677,Top 50 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.00832509994506836
1678,Top 20 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010296106338500977
1679,Top 10 khách hàng ở bang MI chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007383823394775391
1680,Top 5 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008744239807128906
1681,Top 20 khách hàng ở bang KS chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007877111434936523
1682,Top 3 khách hàng ở bang AK chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,2,4,,,0.006114006042480469
1683,Top 20 catalog page có doanh thu cao nhất năm 2000,"SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20;","SELECT cp.cp_catalog_page_id, SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY cp.cp_catalog_page_id
ORDER BY total_revenue DESC
LIMIT 20",True,True,20,2,,,0.021770238876342773
1684,Top 10 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007502317428588867
1685,Top 20 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010633468627929688
1686,Top 10 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,1,4,,,0.006904125213623047
1687,Top 20 khách hàng ở bang ID chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008143186569213867
1688,Top 3 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007990360260009766
1689,Top 20 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,15,4,,,0.00639796257019043
1690,Top 20 khách hàng ở bang MI chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,5,4,,,0.005554676055908203
1691,Top 3 khách hàng ở bang MI chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007119178771972656
1692,Top 10 khách hàng ở bang SD chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.010666847229003906
1693,Top 3 khách hàng ở bang NJ chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.011946916580200195
1694,Top 20 khách hàng ở bang NH chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010337591171264648
1695,Top 3 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007833480834960938
1696,Doanh thu kênh catalog trong tháng 5 năm 2002 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 5;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 5",True,True,1,1,,,0.0021924972534179688
1697,Top 20 khách hàng ở bang MD chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008011102676391602
1698,Top 20 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009357929229736328
1699,Top 3 khách hàng ở bang FL chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008394002914428711
1700,Top 5 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.006447315216064453
1701,Top 3 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.0066432952880859375
1702,Top 5 khách hàng ở bang WV chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008980274200439453
1703,Top 10 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.008329391479492188
1704,Top 50 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.013133049011230469
1705,Top 20 khách hàng ở bang NJ chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,2,4,,,0.007615566253662109
1706,Top 3 khách hàng ở bang UT chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.006070613861083984
1707,Top 3 khách hàng ở bang OK chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007699489593505859
1708,Top 50 khách hàng ở bang SD chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'SD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'SD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.010810613632202148
1709,Top 5 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.010439395904541016
1710,Top 5 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.006723165512084961
1711,Top 50 khách hàng ở bang NJ chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.0076596736907958984
1712,Top 20 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008702278137207031
1713,Top 20 khách hàng ở bang IA chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010980367660522461
1714,Top 20 khách hàng ở bang KS chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,14,4,,,0.006976604461669922
1715,Top 3 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.010358572006225586
1716,Doanh thu kênh catalog trong tháng 1 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 1;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 1",True,True,1,1,,,0.002499103546142578
1717,Top 5 khách hàng ở bang WA chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,1,4,,,0.005342721939086914
1718,Top 3 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009320259094238281
1719,Top 20 khách hàng ở bang UT chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009127616882324219
1720,Top 5 khách hàng ở bang MA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007854938507080078
1721,Top 10 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.008512735366821289
1722,Doanh thu kênh catalog trong tháng 2 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 2;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 2",True,True,1,1,,,0.0021314620971679688
1723,Top 3 khách hàng ở bang MI chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00643467903137207
1724,Top 5 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.007991790771484375
1725,Top 3 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.006535053253173828
1726,Top 50 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008603334426879883
1727,Top 20 khách hàng ở bang MT chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,9,4,,,0.006361246109008789
1728,Top 5 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.009818315505981445
1729,Doanh thu kênh catalog trong tháng 7 năm 2001 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 7;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_moy = 7",True,True,1,1,,,0.0013899803161621094
1730,Doanh thu kênh catalog trong tháng 2 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 2;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 2",True,True,1,1,,,0.001155853271484375
1731,Top 5 khách hàng ở bang FL chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.0058803558349609375
1732,Top 20 khách hàng ở bang SD chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'SD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'SD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,6,4,,,0.006541728973388672
1733,Top 20 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.00876474380493164
1734,Top 20 khách hàng ở bang IN chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'IN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007738351821899414
1735,Top 3 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009030818939208984
1736,Top 10 khách hàng ở bang WY chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009062528610229492
1737,Top 50 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.01038360595703125
1738,Top 50 khách hàng ở bang AR chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009355306625366211
1739,Top 20 khách hàng ở bang DE chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010166406631469727
1740,Top 20 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009404182434082031
1741,Top 5 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008249282836914062
1742,Top 50 khách hàng ở bang ME chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008474111557006836
1743,Top 20 khách hàng ở bang NV chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008371829986572266
1744,Top 3 khách hàng ở bang NH chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007249593734741211
1745,Top 3 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009808540344238281
1746,Top 20 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.010251998901367188
1747,Top 50 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.012256383895874023
1748,Top 10 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009320259094238281
1749,Top 20 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008562088012695312
1750,Top 20 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008555889129638672
1751,Top 20 khách hàng ở bang NY chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,7,4,,,0.006661176681518555
1752,Top 5 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008486747741699219
1753,Top 20 khách hàng ở bang WI chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008432388305664062
1754,Top 3 khách hàng ở bang KS chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009907007217407227
1755,Top 3 khách hàng ở bang VA chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00943756103515625
1756,Top 3 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009241819381713867
1757,Top 50 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008646249771118164
1758,Top 3 khách hàng ở bang AZ chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.0075762271881103516
1759,Top 10 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007941484451293945
1760,Top 50 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009689569473266602
1761,Top 10 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.008887290954589844
1762,Top 5 khách hàng ở bang NJ chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.01201629638671875
1763,Top 3 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008118629455566406
1764,Top 10 khách hàng ở bang AZ chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.012504339218139648
1765,Top 3 khách hàng ở bang CA chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.011152267456054688
1766,Top 20 khách hàng ở bang ND chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.013332128524780273
1767,Top 20 khách hàng ở bang MN chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,9,4,,,0.006788969039916992
1768,Top 50 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,27,4,,,0.009058475494384766
1769,Top 10 khách hàng ở bang MS chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.010945320129394531
1770,Top 10 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.008308172225952148
1771,Top 20 khách hàng ở bang CO chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008629083633422852
1772,Top 10 khách hàng ở bang WA chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'WA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,1,4,,,0.0060312747955322266
1773,Top 20 khách hàng ở bang UT chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,4,4,,,0.0064697265625
1774,Top 10 khách hàng ở bang NM chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.008982419967651367
1775,Top 20 khách hàng ở bang SD chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'SD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'SD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009980440139770508
1776,Top 20 khách hàng ở bang NJ chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009186744689941406
1777,Doanh thu kênh catalog trong tháng 7 năm 1999 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 7;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_moy = 7",True,True,1,1,,,0.0023415088653564453
1778,Top 20 khách hàng ở bang UT chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.007941007614135742
1779,Top 10 khách hàng ở bang WV chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007440090179443359
1780,Top 50 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,11,4,,,0.006063938140869141
1781,Top 3 khách hàng ở bang DE chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00749659538269043
1782,Top 10 khách hàng ở bang PA chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.008514165878295898
1783,Top 50 khách hàng ở bang VT chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'VT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009108304977416992
1784,Top 50 khách hàng ở bang CA chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.009467840194702148
1785,Top 5 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.006508827209472656
1786,Top 3 khách hàng ở bang TX chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009803295135498047
1787,Top 20 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,16,4,,,0.009165525436401367
1788,Top 10 khách hàng ở bang DC chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,8,4,,,0.0073337554931640625
1789,Top 20 khách hàng ở bang NV chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.009043216705322266
1790,Top 5 khách hàng ở bang LA chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008416414260864258
1791,Top 10 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009263753890991211
1792,Top 50 khách hàng ở bang MI chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.012389183044433594
1793,Top 3 khách hàng ở bang OK chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009896278381347656
1794,Top 3 khách hàng ở bang RI chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.008025646209716797
1795,Top 3 khách hàng ở bang NC chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.009113550186157227
1796,Top 3 khách hàng ở bang MD chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.007996797561645508
1797,Top 20 khách hàng ở bang TN chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.00768280029296875
1798,Top 20 khách hàng ở bang AK chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008803844451904297
1799,Doanh thu kênh catalog trong tháng 5 năm 1998 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 5;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND d.d_moy = 5",True,True,1,1,,,0.002080202102661133
1800,Top 20 khách hàng ở bang GA chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.011637210845947266
1801,Top 20 khách hàng ở bang OK chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,20,4,,,0.008496999740600586
1802,Top 50 khách hàng ở bang AL chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008376121520996094
1803,Top 3 khách hàng ở bang UT chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00890970230102539
1804,Top 3 khách hàng ở bang IL chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.010390520095825195
1805,Top 10 khách hàng ở bang OR chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.00995326042175293
1806,Top 10 khách hàng ở bang MD chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,4,4,,,0.009847879409790039
1807,Doanh thu kênh catalog trong tháng 7 năm 2003 là bao nhiêu,"SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 7;","SELECT SUM(cs.cs_net_paid) AS total_revenue
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND d.d_moy = 7",True,True,1,1,,,0.001211404800415039
1808,Top 10 khách hàng ở bang MD chi tiêu nhiều nhất trên kênh catalog năm 2000,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.011543512344360352
1809,Top 3 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00791025161743164
1810,Top 50 khách hàng ở bang OH chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'OH'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008392572402954102
1811,Top 20 khách hàng ở bang NM chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'NM'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,5,4,,,0.0065212249755859375
1812,Top 10 khách hàng ở bang KY chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009855508804321289
1813,Top 5 khách hàng ở bang NY chi tiêu nhiều nhất trên kênh catalog năm 2002,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 5",True,True,5,4,,,0.008062362670898438
1814,Top 20 khách hàng ở bang HI chi tiêu nhiều nhất trên kênh catalog năm 2003,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2003 AND ca.ca_state = 'HI'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 20",True,True,1,4,,,0.00571131706237793
1815,Top 50 khách hàng ở bang NE chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.007323741912841797
1816,Top 10 khách hàng ở bang DE chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.007735013961791992
1817,Top 50 khách hàng ở bang CA chi tiêu nhiều nhất trên kênh catalog năm 2001,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 50",True,True,50,4,,,0.008733034133911133
1818,Top 10 khách hàng ở bang NV chi tiêu nhiều nhất trên kênh catalog năm 1998,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 10",True,True,10,4,,,0.009584188461303711
1819,Top 3 khách hàng ở bang TN chi tiêu nhiều nhất trên kênh catalog năm 1999,"SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3;","SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spent DESC
LIMIT 3",True,True,3,4,,,0.00790095329284668
1820,"Cho biết top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.02645564079284668
1821,"Giúp tôi top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.04110312461853027
1822,Hãy doanh thu lũy kế theo tháng của danh mục Home tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.013170242309570312
1823,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WI trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.017733335494995117
1824,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CO trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.018851041793823242
1826,Top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03256940841674805
1827,Cho biết top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.032655954360961914
1828,Cho biết doanh thu theo giờ bán hàng của từng cửa hàng trong quý 4 năm 2002 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.03285050392150879
1829,Cho biết doanh thu theo giờ bán hàng của từng cửa hàng trong quý 3 năm 1998 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.02455878257751465
1832,Giúp tôi top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.027908802032470703
1833,Tìm top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03404092788696289
1834,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IL trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,17,6,,,0.014708757400512695
1835,Cho biết doanh thu lũy kế theo tháng của danh mục Jewelry tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.013118982315063477
1837,Doanh thu theo giờ bán hàng của từng cửa hàng trong quý 3 năm 2002 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.028116464614868164
1838,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IL trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.015810012817382812
1839,"Giúp tôi top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.02537846565246582
1842,Giúp tôi doanh thu theo giờ bán hàng của từng cửa hàng trong quý 2 năm 1999 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.02015233039855957
1843,Doanh thu theo giờ bán hàng của từng cửa hàng trong quý 4 năm 2001 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.03461909294128418
1844,"Top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.04259467124938965
1845,Liệt kê doanh thu lũy kế theo tháng của danh mục Books tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.011838436126708984
1846,"Top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.03200936317443848
1847,"Liệt kê top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.024960041046142578
1848,"Cho biết top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.04968142509460449
1849,Giúp tôi doanh thu lũy kế theo tháng của danh mục Home tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.015226602554321289
1850,Doanh thu lũy kế theo tháng của danh mục Jewelry tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.012673616409301758
1851,Top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.031071186065673828
1852,Tìm top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.0277557373046875
1853,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IL trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,17,6,,,0.015611886978149414
1855,Hãy top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03786468505859375
1857,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ME trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.013445615768432617
1858,Cho biết top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.030857324600219727
1860,Giúp tôi doanh thu theo giờ bán hàng của từng cửa hàng trong quý 2 năm 1998 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.02063465118408203
1861,Giúp tôi doanh thu lũy kế theo tháng của danh mục Children tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.013689517974853516
1862,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ID trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018883466720581055
1863,Top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.028120756149291992
1864,Hãy doanh thu lũy kế theo tháng của danh mục Sports tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01258397102355957
1865,Doanh thu lũy kế theo tháng của danh mục Music tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.014482975006103516
1867,"Hãy top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.035128116607666016
1868,"Cho biết top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.032674312591552734
1870,Liệt kê doanh thu lũy kế theo tháng của danh mục Women tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.007988691329956055
1871,Giúp tôi doanh thu lũy kế theo tháng của danh mục Sports tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01360774040222168
1872,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WV trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.015642166137695312
1874,"Liệt kê top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2003, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2003 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2003 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.019263744354248047
1875,Cho biết doanh thu lũy kế theo tháng của danh mục Music tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.01126861572265625
1876,Cho biết doanh thu lũy kế theo tháng của danh mục Shoes tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.017004966735839844
1877,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ME trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01875162124633789
1879,"Liệt kê top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.038411855697631836
1880,"Top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.04338335990905762
1881,Giúp tôi top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03416323661804199
1884,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MD trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.020143747329711914
1886,Giúp tôi doanh thu lũy kế theo tháng của danh mục Sports tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01645350456237793
1887,"Giúp tôi top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.038870811462402344
1888,"Tìm top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.061598777770996094
1889,"Top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.026630401611328125
1890,Tìm doanh thu lũy kế theo tháng của danh mục Men tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01427602767944336
1892,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang LA trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'LA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'LA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018263578414916992
1894,Giúp tôi doanh thu theo giờ bán hàng của từng cửa hàng trong quý 1 năm 1998 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.024508237838745117
1895,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CT trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.022635459899902344
1896,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KY trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.017347335815429688
1898,"Liệt kê top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.02842855453491211
1899,Hãy doanh thu lũy kế theo tháng của danh mục Jewelry tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.012438774108886719
1901,Hãy doanh thu theo giờ bán hàng của từng cửa hàng trong quý 4 năm 1999 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.0359494686126709
1903,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MS trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01642775535583496
1904,Liệt kê top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.026929378509521484
1905,Doanh thu lũy kế theo tháng của danh mục Women tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01439976692199707
1906,Doanh thu lũy kế theo tháng của danh mục Music tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01775979995727539
1907,"Tìm top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.02671027183532715
1908,Tìm doanh thu lũy kế theo tháng của danh mục Electronics tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.010708808898925781
1909,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WY trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015903711318969727
1910,Hãy doanh thu theo giờ bán hàng của từng cửa hàng trong quý 1 năm 1999 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.01878833770751953
1911,"Hãy top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.02815532684326172
1912,Tìm top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NH trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.016787052154541016
1913,"Tìm top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.032356977462768555
1914,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang SD trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.018160104751586914
1915,Top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.040970563888549805
1916,"Hãy top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.027208566665649414
1917,Giúp tôi doanh thu lũy kế theo tháng của danh mục Men tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.016997098922729492
1918,"Giúp tôi top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.04993391036987305
1919,Liệt kê doanh thu lũy kế theo tháng của danh mục Men tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.014583110809326172
1920,Tìm top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.030080318450927734
1921,Tìm doanh thu lũy kế theo tháng của danh mục Music tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.015773773193359375
1922,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OR trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.019346237182617188
1923,Liệt kê top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03728771209716797
1924,Hãy top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.02756190299987793
1925,Cho biết top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03000640869140625
1926,"Tìm top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.030177593231201172
1927,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang UT trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01882338523864746
1928,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AK trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,2,6,,,0.011154413223266602
1929,"Cho biết top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.03557753562927246
1930,Liệt kê doanh thu lũy kế theo tháng của danh mục Books tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.013593673706054688
1931,Hãy top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03107428550720215
1932,"Top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.03673386573791504
1933,Tìm doanh thu theo giờ bán hàng của từng cửa hàng trong quý 3 năm 2001 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.029636621475219727
1934,"Hãy top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.03995084762573242
1935,Doanh thu theo giờ bán hàng của từng cửa hàng trong quý 1 năm 2000 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.021384000778198242
1938,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WA trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.021343469619750977
1939,Top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.027751684188842773
1940,Liệt kê doanh thu theo giờ bán hàng của từng cửa hàng trong quý 2 năm 2002 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.024007797241210938
1942,Doanh thu lũy kế theo tháng của danh mục Sports tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01880669593811035
1943,"Tìm top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.030665874481201172
1945,Cho biết top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.049417734146118164
1946,Liệt kê top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.05407381057739258
1947,Top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03677773475646973
1948,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang FL trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.02388143539428711
1949,Cho biết top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.024926185607910156
1953,Cho biết doanh thu lũy kế theo tháng của danh mục Shoes tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01596212387084961
1954,Hãy top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.024569034576416016
1955,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang UT trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01953864097595215
1956,"Tìm top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.034673452377319336
1957,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang FL trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.019092559814453125
1958,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ME trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.020128726959228516
1960,Tìm doanh thu lũy kế theo tháng của danh mục Women tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.016431093215942383
1961,Top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.030623197555541992
1962,"Hãy top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.026579856872558594
1963,Giúp tôi top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.023062467575073242
1964,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VT trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.015593767166137695
1966,Tìm doanh thu lũy kế theo tháng của danh mục Children tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.012263059616088867
1967,Top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03201556205749512
1968,Doanh thu theo giờ bán hàng của từng cửa hàng trong quý 1 năm 2001 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.02076435089111328
1970,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WI trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,11,6,,,0.01783275604248047
1971,"Tìm tỷ trọng doanh thu theo mức giá ở bang TN trong năm 2001 (low < 100, mid < 500)","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 100 THEN 'low'
           WHEN ss.ss_sales_price < 500 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 2001 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC;","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 100 THEN 'low'
           WHEN ss.ss_sales_price < 500 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 2001 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC",True,True,33,4,,,0.06529593467712402
1972,Doanh thu lũy kế theo tháng của danh mục Sports tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.009747505187988281
1973,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VT trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015420913696289062
1974,Giúp tôi top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03275489807128906
1975,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MT trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.020974159240722656
1977,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CA trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.021152734756469727
1978,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MS trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.021651744842529297
1979,Liệt kê doanh thu lũy kế theo tháng của danh mục Music tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.017073392868041992
1980,"Cho biết top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.04883289337158203
1981,Giúp tôi doanh thu theo giờ bán hàng của từng cửa hàng trong quý 2 năm 2000 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.0217435359954834
1982,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OH trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018416643142700195
1983,Liệt kê top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03716254234313965
1985,"Liệt kê top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.042223215103149414
1986,"Cho biết top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.024226903915405273
1987,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang CT trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012152433395385742
1988,"Cho biết top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.026981353759765625
1989,Hãy top 10 phương thức giao hàng có doanh thu web cao nhất trong năm 2003,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,6,6,,,0.007428646087646484
1990,Hãy top 10 khách hàng chi tiêu nhiều nhất theo website ở bang VA trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.015088319778442383
1991,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NV trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01251673698425293
1992,Hãy top 10 phương thức giao hàng có doanh thu web cao nhất trong năm 2000,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,6,6,,,0.013372182846069336
1993,Hãy top 5 kho hàng theo doanh thu web của từng website trong năm 1999,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,5,,,0.011788368225097656
1994,Cho biết top 3 kho hàng theo doanh thu web của từng website trong năm 2002,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,5,,,0.011940240859985352
1995,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang OK trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.013264656066894531
1996,Hãy top 10 khách hàng chi tiêu nhiều nhất theo website ở bang TX trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.0166318416595459
1997,Hãy doanh thu lũy kế theo tháng của loại trang welcome trong năm 1998,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.009710311889648438
1998,"Top 3 danh mục có lợi nhuận cao nhất theo từng website trong năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk",True,True,15,5,,,0.043184518814086914
1999,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NH trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011752605438232422
2000,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02426624298095703
2001,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02498912811279297
2002,Doanh thu lũy kế theo tháng của loại trang general trong năm 2003,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.006659269332885742
2003,Liệt kê top 5 kho hàng theo doanh thu web của từng website trong năm 2001,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,5,,,0.010918140411376953
2004,Hãy top 3 kho hàng theo doanh thu web của từng website trong năm 1999,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,5,,,0.01114034652709961
2005,Liệt kê doanh thu lũy kế theo tháng của loại trang order trong năm 2003,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.00666046142578125
2006,Giúp tôi top 10 kho hàng theo doanh thu web của từng website trong năm 1999,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,25,5,,,0.012262344360351562
2007,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02787947654724121
2008,Top 3 phương thức giao hàng có doanh thu web cao nhất trong năm 2003,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,3,6,,,0.007376670837402344
2009,Tìm doanh thu lũy kế theo tháng của loại trang ad trong năm 2003,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.005518436431884766
2010,"Tìm top 10 danh mục có lợi nhuận cao nhất theo từng website trong năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk",True,True,50,5,,,0.04286479949951172
2011,"Hãy top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.029488325119018555
2012,Top 10 kho hàng theo doanh thu web của từng website trong năm 2001,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,25,5,,,0.011142969131469727
2013,Cho biết doanh thu lũy kế theo tháng của loại trang protected trong năm 2000,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.010141611099243164
2014,Giúp tôi doanh thu lũy kế theo tháng của loại trang ad trong năm 1999,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.010123729705810547
2015,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang CO trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.015037298202514648
2016,Liệt kê top 3 phương thức giao hàng có doanh thu web cao nhất trong năm 1998,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,3,6,,,0.014183998107910156
2017,Liệt kê doanh thu lũy kế theo tháng của loại trang welcome trong năm 2002,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.009234189987182617
2018,Liệt kê top 3 kho hàng theo doanh thu web của từng website trong năm 2000,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,5,,,0.009665966033935547
2019,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.02335190773010254
2020,Liệt kê doanh thu lũy kế theo tháng của loại trang order trong năm 1998,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008722543716430664
2021,Top 5 phương thức giao hàng có doanh thu web cao nhất trong năm 2000,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,5,6,,,0.011409759521484375
2022,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang VA trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.014358758926391602
2023,"Cho biết top 10 danh mục có lợi nhuận cao nhất theo từng website trong năm 2003, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk",True,True,50,5,,,0.011991500854492188
2024,Liệt kê doanh thu lũy kế theo tháng của loại trang general trong năm 2001,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.009638786315917969
2025,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang CT trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.009721517562866211
2026,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.021581172943115234
2027,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.02511763572692871
2028,Giúp tôi top 5 phương thức giao hàng có doanh thu web cao nhất trong năm 1999,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,5,6,,,0.013790130615234375
2029,Tìm doanh thu lũy kế theo tháng của loại trang protected trong năm 2001,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.011149168014526367
2030,"Giúp tôi top 10 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.026482582092285156
2031,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang AK trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.011321544647216797
2032,"Tìm top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02732253074645996
2033,"Cho biết top 3 danh mục có lợi nhuận cao nhất theo từng website trong năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk",True,True,15,5,,,0.0402829647064209
2034,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang WY trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012728691101074219
2035,"Hãy top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.01156163215637207
2037,Giúp tôi top 5 phương thức giao hàng có doanh thu web cao nhất trong năm 1998,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,5,6,,,0.013906002044677734
2038,Hãy doanh thu lũy kế theo tháng của loại trang welcome trong năm 1999,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008105278015136719
2039,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.027364253997802734
2040,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.028555870056152344
2041,Top 3 phương thức giao hàng có doanh thu web cao nhất trong năm 2001,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,3,6,,,0.012676477432250977
2042,Giúp tôi top 3 kho hàng theo doanh thu web của từng website trong năm 2001,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,5,,,0.011651039123535156
2043,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang VA trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.013554096221923828
2044,Liệt kê top 10 kho hàng theo doanh thu web của từng website trong năm 2002,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,25,5,,,0.01039576530456543
2045,Cho biết top 5 kho hàng theo doanh thu web của từng website trong năm 2003,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,5,,,0.007279157638549805
2046,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02727985382080078
2047,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang TX trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.016083717346191406
2048,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MO trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,24,6,,,0.014507055282592773
2049,Liệt kê doanh thu lũy kế theo tháng của loại trang protected trong năm 1999,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.00818777084350586
2050,"Hãy top 10 danh mục có lợi nhuận cao nhất theo từng website trong năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk",True,True,50,5,,,0.0465395450592041
2051,Liệt kê doanh thu lũy kế theo tháng của loại trang protected trong năm 1998,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.010581016540527344
2052,"Cho biết top 3 danh mục có lợi nhuận cao nhất theo từng website trong năm 2003, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk",True,True,15,5,,,0.010997295379638672
2053,Hãy doanh thu lũy kế theo tháng của loại trang welcome trong năm 2003,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.005243062973022461
2054,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.025368928909301758
2055,Cho biết top 10 phương thức giao hàng có doanh thu web cao nhất trong năm 2002,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,6,6,,,0.011967658996582031
2056,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang SD trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013384103775024414
2057,Cho biết top 10 kho hàng theo doanh thu web của từng website trong năm 2003,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,25,5,,,0.007658243179321289
2058,"Cho biết top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.022739648818969727
2059,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MN trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012538671493530273
2060,"Tìm top 5 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.02218341827392578
2061,"Liệt kê top 5 danh mục có lợi nhuận cao nhất theo từng website trong năm 2003, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk",True,True,25,5,,,0.0075342655181884766
2062,"Top 5 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.022164344787597656
2063,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo website ở bang GA trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01036834716796875
2064,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang CT trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.010739564895629883
2065,Liệt kê top 5 kho hàng theo doanh thu web của từng website trong năm 2002,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,5,,,0.009282350540161133
2066,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.025783777236938477
2067,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.0194857120513916
2068,Liệt kê doanh thu lũy kế theo tháng của loại trang order trong năm 1999,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006831169128417969
2069,Giúp tôi top 3 phương thức giao hàng có doanh thu web cao nhất trong năm 2002,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,3,6,,,0.012767553329467773
2070,Liệt kê doanh thu lũy kế theo tháng của loại trang dynamic trong năm 2003,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.005629777908325195
2071,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.019871234893798828
2072,Giúp tôi doanh thu lũy kế theo tháng của loại trang order trong năm 2002,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008077621459960938
2073,Hãy top 3 kho hàng theo doanh thu web của từng website trong năm 2003,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,5,,,0.00797414779663086
2074,Liệt kê top 5 phương thức giao hàng có doanh thu web cao nhất trong năm 2003,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,5,6,,,0.007135152816772461
2075,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.022566795349121094
2076,"Tìm top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.019552230834960938
2077,"Tìm top 5 danh mục có lợi nhuận cao nhất theo từng website trong năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk",True,True,25,5,,,0.035121917724609375
2078,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang CT trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011841535568237305
2079,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NH trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012285470962524414
2080,"Giúp tôi top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.022454023361206055
2081,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang MI trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011281967163085938
2082,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang IL trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013386011123657227
2083,Hãy doanh thu lũy kế theo tháng của loại trang ad trong năm 1998,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.009443998336791992
2084,Doanh thu lũy kế theo tháng của loại trang dynamic trong năm 1998,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.0058879852294921875
2085,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.009299516677856445
2086,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang SD trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.011035919189453125
2087,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang NH trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01013636589050293
2088,"Top 3 danh mục có lợi nhuận cao nhất theo từng website trong năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk",True,True,15,5,,,0.03787350654602051
2089,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.022161245346069336
2090,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang TN trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.009837865829467773
2091,"Top 5 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.0196378231048584
2092,Tìm doanh thu lũy kế theo tháng của loại trang order trong năm 2001,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007238626480102539
2093,"Liệt kê top 3 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.025504350662231445
2094,"Giúp tôi top 10 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02465367317199707
2095,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang KS trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.009635210037231445
2096,"Liệt kê top 3 danh mục có lợi nhuận cao nhất theo từng website trong năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk",True,True,15,5,,,0.03666543960571289
2097,Liệt kê top 10 phương thức giao hàng có doanh thu web cao nhất trong năm 1999,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,6,6,,,0.01274418830871582
2098,"Top 10 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.017949342727661133
2099,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo website ở bang IL trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012345314025878906
2100,Hãy top 5 kho hàng theo doanh thu web của từng website trong năm 2000,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,5,,,0.009986639022827148
2101,"Tìm top 10 danh mục có lợi nhuận cao nhất theo từng website trong năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1999
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk",True,True,50,5,,,0.038271427154541016
2102,"Cho biết top 5 danh mục có lợi nhuận cao nhất theo từng website trong năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk",True,True,25,5,,,0.03310680389404297
2103,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang KS trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.0098114013671875
2104,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang MS trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.014811277389526367
2105,Cho biết doanh thu lũy kế theo tháng của loại trang general trong năm 1998,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008804082870483398
2106,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang TN trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013072490692138672
2107,Top 3 phương thức giao hàng có doanh thu web cao nhất trong năm 1999,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,3,6,,,0.014301061630249023
2108,Hãy doanh thu lũy kế theo tháng của loại trang dynamic trong năm 2000,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007299661636352539
2109,"Top 3 danh mục có lợi nhuận cao nhất theo từng website trong năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY web_name, rk",True,True,15,5,,,0.03495955467224121
2110,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang DC trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,18,6,,,0.012330770492553711
2111,"Liệt kê top 10 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.021938085556030273
2112,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.019324779510498047
2113,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang DC trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011380910873413086
2114,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.021542072296142578
2115,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang FL trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.01088571548461914
2116,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MN trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012502670288085938
2117,"Giúp tôi top 10 danh mục có lợi nhuận cao nhất theo từng website trong năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2002
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk",True,True,50,5,,,0.03465533256530762
2118,Tìm top 3 phương thức giao hàng có doanh thu web cao nhất trong năm 2000,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,3,6,,,0.012002706527709961
2119,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo website ở bang PA trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01380777359008789
2120,"Liệt kê top 5 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.02101588249206543
2121,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang AL trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011223793029785156
2122,"Tìm top 5 danh mục có lợi nhuận cao nhất theo từng website trong năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk",True,True,25,5,,,0.047514915466308594
2123,Giúp tôi top 10 phương thức giao hàng có doanh thu web cao nhất trong năm 2001,"WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT sm.sm_type, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY sm.sm_type, d.d_year
)
SELECT sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY d_year ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,6,6,,,0.014724254608154297
2124,Liệt kê doanh thu lũy kế theo tháng của loại trang feedback trong năm 2002,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.00786447525024414
2125,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NH trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.010224103927612305
2126,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.020704030990600586
2127,Cho biết doanh thu lũy kế theo tháng của loại trang dynamic trong năm 2002,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.00629734992980957
2128,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NC trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.010909557342529297
2129,Liệt kê doanh thu lũy kế theo tháng của loại trang feedback trong năm 2000,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006050586700439453
2130,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MA trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.010527372360229492
2131,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NV trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.009829044342041016
2132,"Giúp tôi top 5 danh mục có lợi nhuận cao nhất theo từng website trong năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk",True,True,25,5,,,0.04062032699584961
2133,Cho biết doanh thu lũy kế theo tháng của loại trang feedback trong năm 2003,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.004914760589599609
2134,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.022262096405029297
2135,Tìm top 5 khách hàng chi tiêu nhiều nhất theo website ở bang VA trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012049436569213867
2136,"Tìm top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.009943962097167969
2137,Cho biết doanh thu lũy kế theo tháng của loại trang welcome trong năm 2001,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008399009704589844
2138,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.022660017013549805
2139,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang PA trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.010919570922851562
2140,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang PA trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.009478092193603516
2141,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang ME trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.011972427368164062
2142,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MT trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013775825500488281
2143,"Top 3 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.025551319122314453
2144,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang WV trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.010750293731689453
2145,Doanh thu lũy kế theo tháng của loại trang feedback trong năm 1999,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007970333099365234
2146,"Liệt kê top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.01896524429321289
2147,Cho biết top 10 kho hàng theo doanh thu web của từng website trong năm 2000,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,25,5,,,0.010373830795288086
2148,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NV trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.013139724731445312
2149,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang WA trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012163400650024414
2150,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang SD trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.013081550598144531
2151,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang WV trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.014070749282836914
2152,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang TX trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.015505313873291016
2153,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NE trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010321378707885742
2154,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang ND trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007861137390136719
2155,Doanh thu lũy kế theo tháng của danh mục Home trên catalog trong năm 2003,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.002750396728515625
2156,Liệt kê top 10 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 1999,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1999
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1999
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk",True,True,30,5,,,0.07550263404846191
2157,Liệt kê top 3 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 1999,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1999
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1999
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk",True,True,9,5,,,0.07967472076416016
2158,Top 10 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2003,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.007207393646240234
2159,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MT trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009145259857177734
2160,Hãy top 10 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2003,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2003
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2003
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk",True,True,30,5,,,0.0075626373291015625
2161,Giúp tôi top 10 catalog page có doanh thu cao nhất trong năm 2000 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk",True,True,50,5,,,0.03281140327453613
2162,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang UT trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,4,5,,,0.0064127445220947266
2163,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009477853775024414
2164,Liệt kê doanh thu lũy kế theo tháng của danh mục Home trên catalog trong năm 1998,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.0055522918701171875
2165,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NY trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010050535202026367
2166,Cho biết top 5 kho hàng theo doanh thu catalog trong năm 1999 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk",True,True,25,7,,,0.03630542755126953
2167,Hãy top 3 kho hàng theo doanh thu catalog trong năm 1999 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk",True,True,15,7,,,0.033547163009643555
2168,Hãy doanh thu lũy kế theo tháng của danh mục Books trên catalog trong năm 2000,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Books'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Books'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006727933883666992
2169,Cho biết top 10 kho hàng theo doanh thu catalog trong năm 2001 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk",True,True,30,7,,,0.02919173240661621
2170,Cho biết doanh thu lũy kế theo tháng của danh mục Children trên catalog trong năm 2002,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Children'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Children'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008827686309814453
2171,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang ND trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009612798690795898
2172,Cho biết top 10 catalog page có doanh thu cao nhất trong năm 1998 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk",True,True,50,5,,,0.028599977493286133
2173,Liệt kê top 3 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 1998,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.008022069931030273
2174,Top 3 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2001,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.010472536087036133
2175,Giúp tôi top 10 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 1999,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.007269859313964844
2176,Giúp tôi top 10 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 1998,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1998
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1998
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk",True,True,30,5,,,0.07077932357788086
2177,Top 10 catalog page có doanh thu cao nhất trong năm 1999 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk",True,True,50,5,,,0.02971625328063965
2178,Hãy top 10 kho hàng theo doanh thu catalog trong năm 2003 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk",True,True,30,7,,,0.009349584579467773
2179,Hãy doanh thu lũy kế theo tháng của danh mục Shoes trên catalog trong năm 1999,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Shoes'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Shoes'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006456136703491211
2180,Tìm top 5 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 1998,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1998
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1998
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk",True,True,15,5,,,0.07216191291809082
2181,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang AZ trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008242130279541016
2182,Liệt kê top 5 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2002,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.007205963134765625
2183,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010856151580810547
2184,Giúp tôi top 10 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 1998,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.00807952880859375
2185,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NE trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009868144989013672
2186,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010034322738647461
2187,Tìm doanh thu lũy kế theo tháng của danh mục Music trên catalog trong năm 2000,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Music'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Music'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.004853487014770508
2188,Hãy top 5 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2000,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2000
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2000
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk",True,True,15,5,,,0.06758809089660645
2189,Cho biết top 10 kho hàng theo doanh thu catalog trong năm 2000 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk",True,True,30,7,,,0.03624129295349121
2190,Tìm top 5 catalog page có doanh thu cao nhất trong năm 1998 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk",True,True,50,5,,,0.026656627655029297
2191,Top 5 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 1999,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1999
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1999
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk",True,True,15,5,,,0.07003664970397949
2192,Liệt kê top 3 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2002,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.007443428039550781
2193,Tìm top 10 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2001,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.007300853729248047
2194,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008055448532104492
2195,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang UT trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.00816798210144043
2196,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010780811309814453
2197,Giúp tôi doanh thu lũy kế theo tháng của danh mục Women trên catalog trong năm 1999,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Women'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Women'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007914543151855469
2198,Tìm top 3 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2003,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2003
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2003
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk",True,True,9,5,,,0.008641719818115234
2199,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang OH trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008316993713378906
2200,Cho biết top 3 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2000,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.013181924819946289
2201,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AL trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.01144099235534668
2202,Cho biết top 5 catalog page có doanh thu cao nhất trong năm 2002 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk",True,True,50,5,,,0.027046680450439453
2203,Top 5 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2001,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2001
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2001
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk",True,True,15,5,,,0.07375741004943848
2204,Liệt kê doanh thu lũy kế theo tháng của danh mục Men trên catalog trong năm 2000,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008041620254516602
2205,Giúp tôi doanh thu lũy kế theo tháng của danh mục Electronics trên catalog trong năm 2001,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006870746612548828
2206,Cho biết top 3 catalog page có doanh thu cao nhất trong năm 2002 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk",True,True,36,5,,,0.03249478340148926
2207,Cho biết top 10 kho hàng theo doanh thu catalog trong năm 1998 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk",True,True,30,7,,,0.0421605110168457
2208,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.011068344116210938
2209,Tìm top 3 kho hàng theo doanh thu catalog trong năm 2002 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk",True,True,15,7,,,0.03927898406982422
2210,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang SD trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.01167750358581543
2211,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.00882720947265625
2212,Tìm top 5 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 1999,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.009925365447998047
2213,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang AK trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.014509201049804688
2214,Hãy top 3 catalog page có doanh thu cao nhất trong năm 2000 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk",True,True,36,5,,,0.03133440017700195
2215,Cho biết top 3 kho hàng theo doanh thu catalog trong năm 2003 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk",True,True,15,7,,,0.008170843124389648
2216,Tìm top 3 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2001,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2001
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2001
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk",True,True,9,5,,,0.07961082458496094
2217,Liệt kê top 3 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2003,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.0071506500244140625
2218,Hãy top 3 kho hàng theo doanh thu catalog trong năm 1998 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk",True,True,15,7,,,0.03218817710876465
2219,Liệt kê doanh thu lũy kế theo tháng của danh mục Jewelry trên catalog trong năm 2000,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.005771160125732422
2220,Liệt kê top 3 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2002,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2002
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2002
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk",True,True,9,5,,,0.07448291778564453
2221,Liệt kê top 5 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2000,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.008460521697998047
2222,Liệt kê top 5 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2003,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2003
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2003
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk",True,True,15,5,,,0.011753082275390625
2223,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MI trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.011931896209716797
2224,Liệt kê top 3 kho hàng theo doanh thu catalog trong năm 2000 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk",True,True,15,7,,,0.040380001068115234
2225,Tìm top 3 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 1998,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1998
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 1998
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk",True,True,9,5,,,0.07583308219909668
2226,Hãy top 5 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 1998,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.009965896606445312
2227,Tìm doanh thu lũy kế theo tháng của danh mục Home trên catalog trong năm 2002,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007679939270019531
2228,Tìm top 5 catalog page có doanh thu cao nhất trong năm 2003 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk",True,True,5,5,,,0.005959033966064453
2229,Cho biết top 3 catalog page có doanh thu cao nhất trong năm 2003 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk",True,True,3,5,,,0.005053043365478516
2230,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008492231369018555
2231,Cho biết top 5 catalog page có doanh thu cao nhất trong năm 2001 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk",True,True,50,5,,,0.03808736801147461
2232,Giúp tôi top 5 kho hàng theo doanh thu catalog trong năm 2002 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk",True,True,25,7,,,0.028460025787353516
2233,Liệt kê top 3 catalog page có doanh thu cao nhất trong năm 2001 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk",True,True,36,5,,,0.030073165893554688
2234,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang ND trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009280920028686523
2235,Doanh thu lũy kế theo tháng của danh mục Sports trên catalog trong năm 1999,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Sports'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Sports'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007373809814453125
2236,Cho biết top 5 catalog page có doanh thu cao nhất trong năm 1999 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk",True,True,50,5,,,0.0332796573638916
2237,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang RI trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008940458297729492
2238,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang HI trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.00941014289855957
2239,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MT trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010284185409545898
2240,Hãy top 10 catalog page có doanh thu cao nhất trong năm 2002 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk",True,True,50,5,,,0.02738356590270996
2241,Top 5 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2003,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.00706028938293457
2242,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MN trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010849952697753906
2243,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang VA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.012357473373413086
2244,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MT trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010739564895629883
2245,Tìm top 10 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2002,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.008638143539428711
2246,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang VT trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.011968612670898438
2247,Liệt kê top 10 catalog page có doanh thu cao nhất trong năm 2003 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk",True,True,10,5,,,0.0056722164154052734
2248,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NJ trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010028600692749023
2249,Cho biết top 3 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 1999,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.010045528411865234
2250,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008684158325195312
2251,Tìm doanh thu lũy kế theo tháng của danh mục Men trên catalog trong năm 1998,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006167173385620117
2252,Cho biết doanh thu lũy kế theo tháng của danh mục Home trên catalog trong năm 2000,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.009926795959472656
2253,Liệt kê doanh thu lũy kế theo tháng của danh mục Women trên catalog trong năm 2002,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Women'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Women'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.009752750396728516
2254,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009482383728027344
2255,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NY trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.01353764533996582
2256,Hãy doanh thu lũy kế theo tháng của danh mục Men trên catalog trong năm 2003,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.0043964385986328125
2257,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang GA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.012634754180908203
2258,Tìm top 10 kho hàng theo doanh thu catalog trong năm 1999 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk",True,True,30,7,,,0.030747652053833008
2259,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang ME trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009445428848266602
2260,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang ID trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,6,5,,,0.0053179264068603516
2261,Giúp tôi doanh thu lũy kế theo tháng của danh mục Music trên catalog trong năm 1999,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Music'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Music'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006856441497802734
2262,Liệt kê top 5 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2002,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2002
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2002
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY cc_name, rk",True,True,15,5,,,0.07355690002441406
2263,Liệt kê doanh thu lũy kế theo tháng của danh mục Books trên catalog trong năm 2003,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Books'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Books'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.0038726329803466797
2264,Top 5 kho hàng theo doanh thu catalog trong năm 1998 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk",True,True,25,7,,,0.030737638473510742
2265,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CT trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.0075986385345458984
2266,Hãy doanh thu lũy kế theo tháng của danh mục Music trên catalog trong năm 2002,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Music'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Music'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.0074160099029541016
2267,Cho biết top 10 catalog page có doanh thu cao nhất trong năm 2001 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 10
ORDER BY d_moy, rk",True,True,50,5,,,0.030789852142333984
2268,Doanh thu lũy kế theo tháng của danh mục Men trên catalog trong năm 2002,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006814241409301758
2269,Hãy top 3 catalog page có doanh thu cao nhất trong năm 1998 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk",True,True,36,5,,,0.02696990966796875
2270,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009910106658935547
2271,Giúp tôi top 10 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2002,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2002
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2002
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk",True,True,30,5,,,0.07092976570129395
2272,Liệt kê doanh thu lũy kế theo tháng của danh mục Sports trên catalog trong năm 2002,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Sports'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Sports'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006774425506591797
2273,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NJ trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.0078122615814208984
2274,Doanh thu lũy kế theo tháng của danh mục Children trên catalog trong năm 1999,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Children'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Children'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006410837173461914
2275,Top 5 catalog page có doanh thu cao nhất trong năm 2000 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 5
ORDER BY d_moy, rk",True,True,50,5,,,0.025157451629638672
2276,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.00980520248413086
2277,Doanh thu lũy kế theo tháng của danh mục Shoes trên catalog trong năm 2000,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Shoes'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Shoes'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006959438323974609
2278,Liệt kê top 5 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2001,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.009073734283447266
2279,Cho biết doanh thu lũy kế theo tháng của danh mục Music trên catalog trong năm 2003,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Music'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Music'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.0059757232666015625
2280,Hãy doanh thu lũy kế theo tháng của danh mục Men trên catalog trong năm 2001,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008283853530883789
2281,Giúp tôi top 5 kho hàng theo doanh thu catalog trong năm 2001 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk",True,True,25,7,,,0.03286433219909668
2282,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010570764541625977
2283,Liệt kê top 5 kho hàng theo doanh thu catalog trong năm 2000 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk",True,True,25,7,,,0.040694475173950195
2284,Giúp tôi doanh thu lũy kế theo tháng của danh mục Men trên catalog trong năm 1999,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Men'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008687496185302734
2285,Liệt kê doanh thu lũy kế theo tháng của danh mục Jewelry trên catalog trong năm 2003,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Jewelry'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Jewelry'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.003935575485229492
2286,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NY trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008400678634643555
2287,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NV trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.01101231575012207
2288,Top 10 kho hàng theo doanh thu catalog trong năm 2002 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY w_warehouse_name, rk",True,True,30,7,,,0.03925585746765137
2289,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MO trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.00894021987915039
2290,Cho biết doanh thu lũy kế theo tháng của danh mục Children trên catalog trong năm 2000,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Children'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Children'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.00653386116027832
2291,Liệt kê doanh thu lũy kế theo tháng của danh mục Books trên catalog trong năm 1999,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Books'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Books'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006857156753540039
2292,Cho biết top 10 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2001,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2001
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2001
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk",True,True,30,5,,,0.07592248916625977
2293,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang VA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.011795997619628906
2294,Tìm doanh thu lũy kế theo tháng của danh mục Children trên catalog trong năm 1998,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Children'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Children'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007991313934326172
2295,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang KS trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.012860536575317383
2296,Liệt kê top 5 kho hàng theo doanh thu catalog trong năm 2003 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY w_warehouse_name, rk",True,True,25,7,,,0.0076084136962890625
2297,Doanh thu lũy kế theo tháng của danh mục Shoes trên catalog trong năm 2002,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Shoes'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Shoes'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007193326950073242
2298,Hãy doanh thu lũy kế theo tháng của danh mục Shoes trên catalog trong năm 1998,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Shoes'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Shoes'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.005219459533691406
2299,Hãy top 3 catalog page có doanh thu cao nhất trong năm 1999 và thứ hạng theo tháng,"WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk;","WITH monthly AS (
  SELECT cp.cp_catalog_page_id, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY cp.cp_catalog_page_id, d.d_year, d.d_moy
)
SELECT cp_catalog_page_id, d_year, d_moy, revenue,
       RANK() OVER (PARTITION BY d_moy ORDER BY revenue DESC) AS rk
FROM monthly
QUALIFY rk <= 3
ORDER BY d_moy, rk",True,True,36,5,,,0.028760910034179688
2300,Giúp tôi doanh thu lũy kế theo tháng của danh mục Women trên catalog trong năm 2001,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Women'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Women'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006623029708862305
2301,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MN trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009412765502929688
2302,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008473396301269531
2303,Cho biết doanh thu lũy kế theo tháng của danh mục Sports trên catalog trong năm 1998,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Sports'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Sports'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.00708460807800293
2304,Tìm top 10 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2000,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2000
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2000
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY cc_name, rk",True,True,30,5,,,0.07535839080810547
2305,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang UT trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008011817932128906
2307,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010097265243530273
2308,Doanh thu lũy kế theo tháng của danh mục Books trên catalog trong năm 2001,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Books'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Books'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.00953817367553711
2309,Cho biết doanh thu lũy kế theo tháng của danh mục Sports trên catalog trong năm 2001,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Sports'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Sports'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.011382579803466797
2310,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010470867156982422
2311,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang RI trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008290529251098633
2312,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NE trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009135246276855469
2313,Hãy doanh thu lũy kế theo tháng của danh mục Electronics trên catalog trong năm 2003,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Electronics'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Electronics'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.0038459300994873047
2314,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MT trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.0069391727447509766
2315,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011381387710571289
2316,Giúp tôi doanh thu lũy kế theo tháng của danh mục Jewelry trên catalog trong năm 2002,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008307456970214844
2317,Giúp tôi doanh thu lũy kế theo tháng của danh mục Home trên catalog trong năm 2001,"WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT i.i_category, d.d_year, d.d_moy,
         SUM(cs.cs_net_paid) AS revenue
  FROM catalog_sales cs
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Home'
  GROUP BY i.i_category, d.d_year, d.d_moy
)
SELECT i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006337642669677734
2318,Giúp tôi top 3 kho hàng theo doanh thu catalog trong năm 2001 và giá trị đơn hàng trung bình,"WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk;","WITH agg AS (
  SELECT wh.w_warehouse_name, sm.sm_type, d.d_year,
         SUM(cs.cs_net_paid) AS revenue,
         COUNT(DISTINCT cs.cs_order_number) AS orders
  FROM catalog_sales cs
  JOIN warehouse wh ON cs.cs_warehouse_sk = wh.w_warehouse_sk
  JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY wh.w_warehouse_name, sm.sm_type, d.d_year
)
SELECT w_warehouse_name, sm_type, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       RANK() OVER (PARTITION BY w_warehouse_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY w_warehouse_name, rk",True,True,15,7,,,0.03109288215637207
2319,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang UT trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009441137313842773
2320,Cho biết top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.022936105728149414
2321,Hãy top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.030382156372070312
2322,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MA trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.017737627029418945
2323,Cho biết top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.033293962478637695
2324,"Tìm top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.026774883270263672
2325,Hãy top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.02663588523864746
2326,Liệt kê doanh thu lũy kế theo tháng của danh mục Sports tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Sports'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.012310981750488281
2327,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OH trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'OH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'OH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,12,6,,,0.016355276107788086
2328,"Giúp tôi top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.03353714942932129
2329,"Hãy top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.025403499603271484
2330,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KY trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.014645576477050781
2331,"Cho biết top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2003, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2003 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2003 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.021982908248901367
2332,Liệt kê doanh thu lũy kế theo tháng của danh mục Electronics tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.016821622848510742
2333,Hãy doanh thu theo giờ bán hàng của từng cửa hàng trong quý 3 năm 1999 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.02494192123413086
2334,Tìm doanh thu lũy kế theo tháng của danh mục Home tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.012711524963378906
2335,Hãy doanh thu theo giờ bán hàng của từng cửa hàng trong quý 2 năm 2001 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 2
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.024300575256347656
2336,"Cho biết top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.03304862976074219
2337,Hãy doanh thu theo giờ bán hàng của từng cửa hàng trong quý 4 năm 2000 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.04363369941711426
2338,"Tìm top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.02433300018310547
2339,"Tìm top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.02817535400390625
2340,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VT trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.015134334564208984
2341,Hãy doanh thu theo giờ bán hàng của từng cửa hàng trong quý 1 năm 2002 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.018447399139404297
2342,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang DE trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,29,6,,,0.014022588729858398
2343,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang GA trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.0198822021484375
2344,Tìm doanh thu lũy kế theo tháng của danh mục Electronics tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.013840198516845703
2345,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IN trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.014972209930419922
2346,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.014621257781982422
2347,"Cho biết top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.04264426231384277
2348,Cho biết top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03140592575073242
2349,Cho biết top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03696322441101074
2350,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MS trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,12,6,,,0.015933990478515625
2351,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ME trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015081167221069336
2352,Top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.02942800521850586
2353,Giúp tôi doanh thu lũy kế theo tháng của danh mục Electronics tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.012487649917602539
2354,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01564931869506836
2355,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.014973878860473633
2356,Liệt kê top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.02773261070251465
2357,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AR trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.019222259521484375
2358,Hãy top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.02968430519104004
2359,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NC trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.019845008850097656
2360,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VA trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,16,6,,,0.015511512756347656
2361,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CT trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.017226696014404297
2362,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CA trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.017954111099243164
2363,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OK trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.014698266983032227
2364,Hãy top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.02005600929260254
2365,Giúp tôi top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.029027700424194336
2366,Tìm doanh thu lũy kế theo tháng của danh mục Children tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.013957023620605469
2367,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ME trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,1,6,,,0.010295391082763672
2368,Tìm doanh thu lũy kế theo tháng của danh mục Children tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.012060880661010742
2369,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IN trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015184402465820312
2370,"Hãy top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.034149885177612305
2371,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang SD trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.019908428192138672
2372,"Cho biết top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2003, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2003 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2003 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.020147323608398438
2373,Top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.0323033332824707
2374,Cho biết doanh thu lũy kế theo tháng của danh mục Books tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.013341426849365234
2375,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NE trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016911745071411133
2376,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TN trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01918172836303711
2377,Top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.029537200927734375
2378,Doanh thu lũy kế theo tháng của danh mục Men tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.012012720108032227
2379,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WV trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,10,6,,,0.013303041458129883
2380,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TN trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.014965295791625977
2381,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NM trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01288151741027832
2382,Cho biết doanh thu lũy kế theo tháng của danh mục Men tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.011805534362792969
2383,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WI trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.015802860260009766
2384,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KY trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,16,6,,,0.013422012329101562
2385,Tìm doanh thu theo giờ bán hàng của từng cửa hàng trong quý 3 năm 2000 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 3
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.02660846710205078
2386,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang HI trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,1,6,,,0.010125160217285156
2387,Giúp tôi top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.024387598037719727
2388,Tìm top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.025585174560546875
2389,Giúp tôi doanh thu lũy kế theo tháng của danh mục Shoes tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.014980792999267578
2390,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AZ trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018027067184448242
2391,Tìm top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TN trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018755197525024414
2392,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KS trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.015570640563964844
2393,Liệt kê doanh thu lũy kế theo tháng của danh mục Home tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.010087966918945312
2394,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AL trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.013916730880737305
2395,Liệt kê doanh thu lũy kế theo tháng của danh mục Shoes tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.0140380859375
2396,"Giúp tôi top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.024186372756958008
2397,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MD trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01958942413330078
2398,"Top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.03037714958190918
2399,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NE trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01885819435119629
2400,"Giúp tôi top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.04346346855163574
2401,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NC trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018027067184448242
2402,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.012902975082397461
2403,Cho biết top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.035181522369384766
2404,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AK trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.016649246215820312
2405,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OK trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.017799854278564453
2406,"Liệt kê top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.03105020523071289
2407,Hãy doanh thu lũy kế theo tháng của danh mục Music tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Music'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.011406183242797852
2408,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang HI trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.018645763397216797
2409,Doanh thu lũy kế theo tháng của danh mục Shoes tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.015555381774902344
2410,"Top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.042701005935668945
2411,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VT trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.012649774551391602
2412,Hãy top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.028053998947143555
2413,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.015480518341064453
2414,Cho biết doanh thu lũy kế theo tháng của danh mục Children tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.013456106185913086
2415,"Giúp tôi top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.04281282424926758
2416,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ME trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.014644861221313477
2417,Hãy doanh thu lũy kế theo tháng của danh mục Books tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.013808250427246094
2418,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NC trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,17,6,,,0.01433420181274414
2419,Tìm top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IL trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.017026424407958984
2420,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TX trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01930999755859375
2421,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VA trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.014106512069702148
2422,"Hãy tỷ trọng doanh thu theo mức giá ở bang TN trong năm 1998 (low < 20, mid < 100)","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 20 THEN 'low'
           WHEN ss.ss_sales_price < 100 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 1998 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC;","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 20 THEN 'low'
           WHEN ss.ss_sales_price < 100 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 1998 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC",True,True,33,4,,,0.05881381034851074
2423,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang HI trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.0168912410736084
2424,Liệt kê top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.025887727737426758
2425,Giúp tôi doanh thu theo giờ bán hàng của từng cửa hàng trong quý 1 năm 2003 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2003 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 2003 AND d.d_qoy = 1
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.00975489616394043
2426,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IL trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016288042068481445
2427,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IL trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01688361167907715
2428,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NC trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.014647483825683594
2429,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CT trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,2,6,,,0.01474142074584961
2430,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NH trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.014375448226928711
2431,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MD trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.017536640167236328
2432,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WV trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.017245054244995117
2433,"Hãy top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.02397298812866211
2434,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VT trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.013361692428588867
2435,Hãy top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.033002614974975586
2436,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang PA trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.02018141746520996
2437,Top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.030797958374023438
2438,Giúp tôi doanh thu lũy kế theo tháng của danh mục Home tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.015581369400024414
2439,Tìm top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IN trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.014551162719726562
2440,Doanh thu lũy kế theo tháng của danh mục Home tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Home'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.007829427719116211
2441,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CO trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01586747169494629
2442,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AK trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.012991905212402344
2443,Giúp tôi doanh thu lũy kế theo tháng của danh mục Books tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.015596389770507812
2444,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VT trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.018069744110107422
2445,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MS trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018425464630126953
2446,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WA trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,5,6,,,0.011705398559570312
2447,"Tìm top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.03893160820007324
2448,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NE trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.016383647918701172
2449,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KY trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015411853790283203
2450,Cho biết top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.024788618087768555
2451,Tìm doanh thu lũy kế theo tháng của danh mục Jewelry tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.012144804000854492
2452,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NC trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.012935876846313477
2453,Giúp tôi doanh thu lũy kế theo tháng của danh mục Women tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.010890722274780273
2454,"Liệt kê top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.04065418243408203
2455,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ND trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015676021575927734
2456,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AK trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.017247676849365234
2457,Tìm top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.02972722053527832
2458,Liệt kê doanh thu lũy kế theo tháng của danh mục Jewelry tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.014395952224731445
2459,"Tỷ trọng doanh thu theo mức giá ở bang TN trong năm 2002 (low < 20, mid < 100)","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 20 THEN 'low'
           WHEN ss.ss_sales_price < 100 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 2002 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC;","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 20 THEN 'low'
           WHEN ss.ss_sales_price < 100 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 2002 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC",True,True,33,4,,,0.054543495178222656
2460,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OR trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01566481590270996
2461,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AL trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01630854606628418
2462,Hãy top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.01987934112548828
2463,Cho biết doanh thu lũy kế theo tháng của danh mục Electronics tại từng cửa hàng trong năm 2001,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.012138128280639648
2464,Cho biết top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.022110700607299805
2465,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MT trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016048669815063477
2466,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NY trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.017190933227539062
2467,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NV trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.015168190002441406
2468,"Top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.02577805519104004
2469,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IA trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015115022659301758
2470,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KY trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018022537231445312
2471,"Hãy top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.03010845184326172
2472,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang UT trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016144990921020508
2473,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01640605926513672
2474,Liệt kê top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03158378601074219
2475,Liệt kê doanh thu lũy kế theo tháng của danh mục Men tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Men'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.011476993560791016
2476,"Liệt kê top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.02630448341369629
2477,Hãy top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.029468297958374023
2478,Giúp tôi top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03476095199584961
2479,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IL trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016014575958251953
2480,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TX trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.020100116729736328
2481,Liệt kê top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.025289535522460938
2482,Tìm top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2001 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2001
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.028658628463745117
2483,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MT trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.0148773193359375
2484,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NH trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.013795852661132812
2485,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang FL trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.015466928482055664
2486,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MS trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01715850830078125
2487,Top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.026942968368530273
2488,Cho biết doanh thu lũy kế theo tháng của danh mục Women tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.014265775680541992
2489,Liệt kê top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.024924516677856445
2490,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TN trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.015348672866821289
2491,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NY trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01855015754699707
2492,Giúp tôi doanh thu lũy kế theo tháng của danh mục Shoes tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Shoes'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.01200246810913086
2493,"Liệt kê top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.02714848518371582
2494,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WY trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.013943195343017578
2495,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang HI trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01661849021911621
2496,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CT trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.02133774757385254
2497,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CO trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.020097732543945312
2498,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NM trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01799488067626953
2499,Doanh thu lũy kế theo tháng của danh mục Children tại từng cửa hàng trong năm 2003,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND i.i_category = 'Children'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,6,6,,,0.009417533874511719
2500,Top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.027942180633544922
2501,Doanh thu lũy kế theo tháng của danh mục Books tại từng cửa hàng trong năm 1998,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND i.i_category = 'Books'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.014090776443481445
2502,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WI trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.016248703002929688
2503,Tìm top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.029964447021484375
2504,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AR trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,18,6,,,0.011569023132324219
2505,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VT trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,4,6,,,0.010370254516601562
2506,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang DE trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,25,6,,,0.013501167297363281
2507,Hãy top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.030623674392700195
2508,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang FL trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.019407033920288086
2509,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MT trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01562976837158203
2510,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MT trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,9,6,,,0.01578354835510254
2511,Liệt kê doanh thu theo giờ bán hàng của từng cửa hàng trong quý 4 năm 1998 và mức trung bình của từng cửa hàng,"WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour;","WITH hourly AS (
  SELECT s.s_store_name, d.d_year, t.t_hour,
         SUM(ss.ss_net_paid) AS revenue,
         COUNT(*) AS order_cnt
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 4
  GROUP BY s.s_store_name, d.d_year, t.t_hour
)
SELECT s_store_name, d_year, t_hour, revenue, order_cnt,
       AVG(revenue) OVER (PARTITION BY s_store_name) AS avg_revenue_per_store
FROM hourly
ORDER BY s_store_name, t_hour",True,True,50,6,,,0.03319835662841797
2512,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CT trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.012571096420288086
2513,Giúp tôi top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.027654647827148438
2514,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MS trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,12,6,,,0.013137340545654297
2515,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang PA trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.015867948532104492
2516,"Liệt kê top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.03519010543823242
2517,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WV trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.022664308547973633
2518,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KS trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.017971515655517578
2519,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NM trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01626420021057129
2520,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MT trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,9,6,,,0.012387275695800781
2521,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IN trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.019923686981201172
2522,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NV trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.021532058715820312
2523,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NV trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.017383813858032227
2524,"Hãy top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.032616376876831055
2525,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.024615764617919922
2526,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IL trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.022231101989746094
2527,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WV trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.02237415313720703
2528,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,17,6,,,0.02365255355834961
2529,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NJ trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.02285313606262207
2530,"Liệt kê top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.04721570014953613
2531,Tìm top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WI trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.023225069046020508
2532,"Tìm top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 2002, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2002 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.05285239219665527
2533,"Top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 2 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 2
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.04269814491271973
2534,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang DE trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,24,6,,,0.02271270751953125
2535,Liệt kê doanh thu lũy kế theo tháng của danh mục Women tại từng cửa hàng trong năm 1999,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND i.i_category = 'Women'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.016653060913085938
2536,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang RI trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.019648075103759766
2537,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang DC trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,11,6,,,0.01995563507080078
2538,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KS trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.02406167984008789
2539,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CA trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018457412719726562
2540,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang PA trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01626300811767578
2541,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang PA trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,14,6,,,0.013024091720581055
2542,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CA trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01822686195373535
2543,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.020910978317260742
2544,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang SD trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.019939899444580078
2545,Tìm doanh thu lũy kế theo tháng của danh mục Electronics tại từng cửa hàng trong năm 2000,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01594996452331543
2546,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NM trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.019378185272216797
2547,"Tìm tỷ trọng doanh thu theo mức giá ở bang TN trong năm 1999 (low < 100, mid < 500)","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 100 THEN 'low'
           WHEN ss.ss_sales_price < 500 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 1999 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC;","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 100 THEN 'low'
           WHEN ss.ss_sales_price < 500 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 1999 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC",True,True,33,4,,,0.0646975040435791
2548,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OK trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.015709877014160156
2549,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CA trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01658916473388672
2550,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TX trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.0174105167388916
2551,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OR trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.024935007095336914
2552,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NV trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.019990921020507812
2553,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WV trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.02057337760925293
2554,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WV trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,9,6,,,0.015229225158691406
2555,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.013897180557250977
2556,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.016534805297851562
2557,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NH trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,4,6,,,0.012366533279418945
2558,"Tìm tỷ trọng doanh thu theo mức giá ở bang TN trong năm 2002 (low < 100, mid < 500)","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 100 THEN 'low'
           WHEN ss.ss_sales_price < 500 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 2002 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC;","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 100 THEN 'low'
           WHEN ss.ss_sales_price < 500 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 2002 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC",True,True,33,4,,,0.06570839881896973
2559,"Liệt kê top 5 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY s_store_name, rk",True,True,30,5,,,0.03381919860839844
2560,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TX trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016939163208007812
2561,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang UT trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.015600442886352539
2562,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MD trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.019402265548706055
2563,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NV trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.0163266658782959
2564,Liệt kê top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.028979778289794922
2565,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AK trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.014381647109985352
2566,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01596665382385254
2567,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VA trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016005754470825195
2568,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TN trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01855158805847168
2569,"Cho biết top 3 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2001 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY s_store_name, rk",True,True,18,5,,,0.04878997802734375
2570,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OR trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018943071365356445
2571,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang RI trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.018422842025756836
2572,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CO trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.017993450164794922
2573,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MT trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.019447803497314453
2574,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WY trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01659846305847168
2575,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WY trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016489267349243164
2576,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OK trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.0219576358795166
2577,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang SD trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.02016472816467285
2578,Hãy doanh thu lũy kế theo tháng của danh mục Jewelry tại từng cửa hàng trong năm 2002,"WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy;","WITH monthly AS (
  SELECT s.s_store_name, i.i_category, d.d_year, d.d_moy,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
  GROUP BY s.s_store_name, i.i_category, d.d_year, d.d_moy
)
SELECT s_store_name, i_category, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY s_store_name, i_category, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY s_store_name, d_moy",True,True,50,6,,,0.01648402214050293
2579,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang PA trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,17,6,,,0.014906644821166992
2580,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.017637014389038086
2581,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MS trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.019576549530029297
2582,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VA trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.017133712768554688
2583,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ND trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ND'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ND'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.020965099334716797
2584,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WI trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.019405603408813477
2585,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WI trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.016335010528564453
2586,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NV trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NV'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.016081571578979492
2587,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KS trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.024224281311035156
2588,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NC trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.021872282028198242
2589,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NE trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.019731760025024414
2590,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016326189041137695
2591,Tìm top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.03413271903991699
2592,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang SC trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01609325408935547
2593,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WY trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.016280651092529297
2594,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang HI trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.021803855895996094
2595,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CT trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.018973112106323242
2596,"Top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 1 năm 1999, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1999 AND d.d_qoy = 1
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.028051376342773438
2597,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AR trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01502084732055664
2598,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang GA trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,28,6,,,0.014819622039794922
2599,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NC trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.013402938842773438
2600,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NE trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01264643669128418
2601,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AZ trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,2,6,,,0.009608268737792969
2602,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MA trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015511274337768555
2603,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NE trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,16,6,,,0.013056278228759766
2604,Tìm top 5 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.02022099494934082
2605,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MT trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01432347297668457
2606,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KY trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.012778520584106445
2607,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ID trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.014248132705688477
2608,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CO trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.014511585235595703
2609,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang RI trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.014850139617919922
2610,Top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2002 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.026277542114257812
2611,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KS trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015473127365112305
2612,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang HI trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'HI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.012951374053955078
2613,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang FL trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01579880714416504
2614,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang RI trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,1,6,,,0.01272726058959961
2615,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ND trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.02231884002685547
2616,Cho biết top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1998 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.02926182746887207
2617,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang SC trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.02222895622253418
2618,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.0186307430267334
2619,"Giúp tôi top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 4 năm 2000, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 2000 AND d.d_qoy = 4
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.04504847526550293
2620,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01638197898864746
2621,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ME trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ME'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,1,6,,,0.013210773468017578
2622,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ID trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.014120101928710938
2623,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang SC trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01725935935974121
2624,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MS trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.015403509140014648
2625,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NH trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.016080379486083984
2626,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MI trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.018320322036743164
2627,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NE trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.016900300979614258
2628,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WI trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.019045591354370117
2629,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OH trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OH'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01657271385192871
2630,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IA trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.015598058700561523
2631,Tìm top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang DE trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.012395858764648438
2632,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,12,6,,,0.013484001159667969
2633,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NE trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,20,6,,,0.013825178146362305
2634,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CA trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,12,6,,,0.011501312255859375
2635,"Giúp tôi top 10 danh mục có lợi nhuận cao nhất ở từng cửa hàng trong quý 3 năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk;","WITH agg AS (
  SELECT s.s_store_name, i.i_category,
         SUM(ss.ss_net_profit) AS net_profit,
         SUM(ss.ss_quantity) AS qty,
         SUM(COALESCE(sr.sr_return_quantity, 0)) AS return_qty
  FROM store_sales ss
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  LEFT JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  WHERE d.d_year = 1998 AND d.d_qoy = 3
  GROUP BY s.s_store_name, i.i_category
)
SELECT s_store_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY s_store_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY s_store_name, rk",True,True,50,5,,,0.036733388900756836
2636,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MI trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.016353368759155273
2637,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MO trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.013800859451293945
2638,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NM trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.014880180358886719
2639,"Liệt kê tỷ trọng doanh thu theo mức giá ở bang TN trong năm 1998 (low < 50, mid < 200)","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 50 THEN 'low'
           WHEN ss.ss_sales_price < 200 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 1998 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC;","WITH base AS (
  SELECT i.i_category,
         CASE
           WHEN ss.ss_sales_price < 50 THEN 'low'
           WHEN ss.ss_sales_price < 200 THEN 'mid'
           ELSE 'high'
         END AS price_tier,
         SUM(ss.ss_net_paid) AS revenue
  FROM store_sales ss
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  WHERE d.d_year = 1998 AND s.s_state = 'TN'
  GROUP BY i.i_category, price_tier
)
SELECT i_category, price_tier, revenue,
       revenue::DOUBLE / NULLIF(SUM(revenue) OVER (PARTITION BY i_category), 0) AS revenue_share
FROM base
ORDER BY i_category, revenue_share DESC",True,True,33,4,,,0.05760049819946289
2640,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TN trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.013626575469970703
2641,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VA trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.0163419246673584
2642,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang GA trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.018239259719848633
2643,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MD trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01631927490234375
2644,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VA trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.018882036209106445
2645,Top 3 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 50),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 50
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.029753446578979492
2646,Top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MD trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.018004417419433594
2647,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AZ trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015137910842895508
2648,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang PA trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01417231559753418
2649,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OR trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.014562845230102539
2650,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WY trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01514124870300293
2651,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NY trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,14,6,,,0.011256694793701172
2652,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TN trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.018419742584228516
2653,Top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TX trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.017426252365112305
2654,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang SC trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'SC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'SC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.018786191940307617
2655,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TX trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.020935535430908203
2656,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang FL trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,12,6,,,0.013790369033813477
2657,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IA trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.016060829162597656
2658,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ID trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.017422914505004883
2659,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang VA trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.019994497299194336
2660,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CO trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,8,6,,,0.016695022583007812
2661,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang DE trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,17,6,,,0.016126155853271484
2662,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OK trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,15,6,,,0.017750024795532227
2663,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MD trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,2,6,,,0.012412548065185547
2664,Tìm top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang LA trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'LA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'LA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.018618106842041016
2665,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang GA trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.020574569702148438
2666,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,11,6,,,0.01270437240600586
2667,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang KS trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'KS'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.018625497817993164
2668,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MN trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01825404167175293
2669,Giúp tôi top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 1999 (lọc số lượng bán > 20),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 20
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.030485153198242188
2670,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MD trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.013629913330078125
2671,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NC trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.01492762565612793
2672,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CO trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.018630504608154297
2673,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NJ trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.014944791793823242
2674,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang ID trong năm 2003,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ID'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,3,6,,,0.01047658920288086
2675,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang UT trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01526188850402832
2676,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang DC trong năm 1998,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,12,6,,,0.012352943420410156
2677,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang MD trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.0130157470703125
2678,Cho biết top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2000 (lọc số lượng bán > 10),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 10
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.027607440948486328
2679,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang GA trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'GA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.01956033706665039
2680,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang RI trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015113353729248047
2681,Hãy top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CA trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.017052888870239258
2682,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang OK trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.016617774963378906
2683,Hãy top 10 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TN trong năm 2000,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY s_store_name, rn",True,True,50,6,,,0.015549659729003906
2684,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AZ trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.014470577239990234
2685,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NC trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.015212297439575195
2686,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang WA trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.011817455291748047
2687,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang AZ trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AZ'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.013773202896118164
2688,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang CA trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015552282333374023
2689,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang IA trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.02009725570678711
2690,Top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NY trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.019299983978271484
2691,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang TX trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY s_store_name, rn",True,True,18,6,,,0.023027658462524414
2692,Tìm top 10 lý do hoàn trả có tỷ lệ hoàn trả cao nhất trong năm 2003 (lọc số lượng bán > 5),"WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, i.i_category,
         SUM(sr.sr_return_quantity) AS return_qty,
         SUM(ss.ss_quantity) AS sold_qty
  FROM store_sales ss
  JOIN store_returns sr
    ON ss.ss_ticket_number = sr.sr_ticket_number
   AND ss.ss_item_sk = sr.sr_item_sk
   AND ss.ss_store_sk = sr.sr_store_sk
  JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2003
  GROUP BY r.r_reason_desc, i.i_category
  HAVING SUM(ss.ss_quantity) > 5
)
SELECT r_reason_desc, i_category, return_qty, sold_qty,
       return_qty::DOUBLE / NULLIF(sold_qty, 0) AS return_rate,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY return_qty DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,6,,,0.0290069580078125
2693,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang LA trong năm 1999,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'LA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'LA'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.01932382583618164
2694,Tìm top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang NE trong năm 2001,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.019644498825073242
2695,Hãy top 5 khách hàng chi tiêu nhiều nhất theo từng cửa hàng ở bang RI trong năm 2002,"WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn;","WITH cust_sales AS (
  SELECT s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ss.ss_net_paid) AS total_spent
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON ss.ss_store_sk = s.s_store_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
  GROUP BY s.s_store_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT s_store_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY s_store_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY s_store_name, rn",True,True,30,6,,,0.015881776809692383
2696,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang ID trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ID'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ID'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.011473655700683594
2697,Tìm doanh thu lũy kế theo tháng của loại trang welcome trong năm 2000,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'welcome'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008109807968139648
2698,"Giúp tôi top 5 danh mục có lợi nhuận cao nhất theo từng website trong năm 2001, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 2001
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY web_name, rk",True,True,25,5,,,0.04198908805847168
2699,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang SC trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.010769128799438477
2700,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang KY trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.010610818862915039
2701,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang AL trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.013665914535522461
2702,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang GA trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.013641357421875
2703,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang PA trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.011270999908447266
2704,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang ND trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,9,6,,,0.011330366134643555
2705,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MT trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.01432347297668457
2706,"Hãy top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.01052999496459961
2707,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.025693178176879883
2708,Giúp tôi top 10 kho hàng theo doanh thu web của từng website trong năm 1998,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,25,5,,,0.009505748748779297
2709,Tìm top 5 khách hàng chi tiêu nhiều nhất theo website ở bang OR trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.0129547119140625
2710,"Giúp tôi top 10 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.019635915756225586
2711,Top 3 kho hàng theo doanh thu web của từng website trong năm 1998,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,5,,,0.01080942153930664
2712,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.023183107376098633
2713,Hãy doanh thu lũy kế theo tháng của loại trang feedback trong năm 1998,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007260799407958984
2714,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang DE trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012787342071533203
2715,"Hãy top 10 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.026513099670410156
2716,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang AL trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012372493743896484
2717,Hãy top 10 khách hàng chi tiêu nhiều nhất theo website ở bang KS trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,27,6,,,0.009810924530029297
2718,Giúp tôi doanh thu lũy kế theo tháng của loại trang ad trong năm 2000,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008830070495605469
2719,"Liệt kê top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.026308536529541016
2720,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang DC trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,10,6,,,0.01003122329711914
2721,"Top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.01125335693359375
2722,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang MN trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.010785102844238281
2723,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang ND trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,9,6,,,0.008412599563598633
2724,"Liệt kê top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.024133682250976562
2725,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang HI trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'HI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'HI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,49,6,,,0.011463403701782227
2726,Doanh thu lũy kế theo tháng của loại trang general trong năm 2000,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.0070531368255615234
2727,Hãy top 10 khách hàng chi tiêu nhiều nhất theo website ở bang IA trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,39,6,,,0.00957798957824707
2728,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang AK trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012048482894897461
2729,Liệt kê doanh thu lũy kế theo tháng của loại trang dynamic trong năm 1999,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008415699005126953
2730,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NV trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,5,6,,,0.009519100189208984
2731,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.019170761108398438
2732,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MT trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,14,6,,,0.01405644416809082
2733,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang NJ trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01400303840637207
2734,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.008768081665039062
2735,"Top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.024972915649414062
2736,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang GA trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.013910531997680664
2737,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MA trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01066136360168457
2738,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang ND trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.010540246963500977
2739,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MS trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012398958206176758
2740,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NE trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.014459848403930664
2741,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.011962413787841797
2742,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang AL trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01376962661743164
2743,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo website ở bang SD trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.015013694763183594
2744,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang AR trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,4,6,,,0.010041236877441406
2745,"Liệt kê top 10 danh mục có lợi nhuận cao nhất theo từng website trong năm 1998, kèm tỷ lệ hoàn trả","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk;","WITH agg AS (
  SELECT w.web_name, i.i_category,
         SUM(ws.ws_net_profit) AS net_profit,
         SUM(ws.ws_quantity) AS qty,
         SUM(COALESCE(wr.wr_return_quantity, 0)) AS return_qty
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  LEFT JOIN web_returns wr
    ON ws.ws_order_number = wr.wr_order_number
   AND ws.ws_item_sk = wr.wr_item_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, i.i_category
)
SELECT web_name, i_category, net_profit,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY web_name ORDER BY net_profit DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY web_name, rk",True,True,50,5,,,0.048655033111572266
2746,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang GA trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012257099151611328
2747,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang AL trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,10,6,,,0.008690357208251953
2748,"Cho biết top 3 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02443671226501465
2749,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.028067588806152344
2750,Doanh thu lũy kế theo tháng của loại trang general trong năm 2002,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.010357856750488281
2751,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.03317117691040039
2752,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang SC trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012004375457763672
2753,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MS trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,4,6,,,0.00968313217163086
2754,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang OK trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012344837188720703
2755,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MO trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,24,6,,,0.012110710144042969
2756,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang UT trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012904167175292969
2757,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang WI trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011673688888549805
2758,Hãy top 10 khách hàng chi tiêu nhiều nhất theo website ở bang ME trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.011344671249389648
2759,"Top 3 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.021736860275268555
2760,"Liệt kê top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.023192167282104492
2761,"Tìm top 5 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.019325733184814453
2762,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang VT trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012505531311035156
2763,"Tìm top 5 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.022636890411376953
2764,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MI trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.009937763214111328
2765,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang VA trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.013659000396728516
2766,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang AL trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012340068817138672
2767,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NE trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012803316116333008
2768,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.028779268264770508
2769,"Giúp tôi top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.012368917465209961
2770,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang KS trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.01322793960571289
2771,Doanh thu lũy kế theo tháng của loại trang protected trong năm 2002,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.011809110641479492
2772,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang FL trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'FL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'FL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01486063003540039
2773,"Giúp tôi top 5 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.031691551208496094
2774,"Liệt kê top 5 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.025241613388061523
2775,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02913832664489746
2776,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.030434131622314453
2777,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang SC trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013982057571411133
2778,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang OR trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013678312301635742
2779,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.02207183837890625
2780,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang AR trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012145519256591797
2781,"Top 10 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02451181411743164
2782,"Giúp tôi top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.021773338317871094
2783,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.022576093673706055
2784,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NJ trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.014925718307495117
2785,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang SD trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.010970592498779297
2786,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang NC trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012847185134887695
2787,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang KY trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012437820434570312
2788,"Liệt kê top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.022704362869262695
2789,"Cho biết top 10 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02821946144104004
2790,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang OK trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011264801025390625
2791,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang CT trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,4,6,,,0.00800323486328125
2792,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang NV trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.014864206314086914
2793,Hãy top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MO trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.014796257019042969
2794,"Top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.024921894073486328
2795,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.022806167602539062
2796,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang MT trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.010639190673828125
2797,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang WY trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.011261463165283203
2798,"Top 3 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.009466886520385742
2799,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang CT trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012139558792114258
2800,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang AK trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012263059616088867
2801,Cho biết top 5 kho hàng theo doanh thu web của từng website trong năm 1998,"WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH agg AS (
  SELECT w.web_name, wh.w_warehouse_name, d.d_year,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN warehouse wh ON ws.ws_warehouse_sk = wh.w_warehouse_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998
  GROUP BY w.web_name, wh.w_warehouse_name, d.d_year
)
SELECT web_name, w_warehouse_name, d_year, revenue,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY revenue DESC) AS rn
FROM agg
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,5,,,0.010156631469726562
2802,"Top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02327585220336914
2803,"Tìm top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.022550582885742188
2804,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang PA trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011996269226074219
2805,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang CO trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012682199478149414
2806,Cho biết doanh thu lũy kế theo tháng của loại trang ad trong năm 2002,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008037090301513672
2807,Hãy top 10 khách hàng chi tiêu nhiều nhất theo website ở bang ID trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ID'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ID'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012581348419189453
2808,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NV trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.009374618530273438
2809,Hãy doanh thu lũy kế theo tháng của loại trang protected trong năm 2003,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND wp.wp_type = 'protected'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,1,5,,,0.0046176910400390625
2810,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang CO trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.010657787322998047
2811,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang OR trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,4,6,,,0.009194612503051758
2812,"Top 3 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.01827836036682129
2813,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang TN trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012463569641113281
2814,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MD trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012146711349487305
2815,"Top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.021291255950927734
2816,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02232193946838379
2817,"Top 5 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.030313968658447266
2818,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang WA trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,19,6,,,0.009881734848022461
2819,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.024334192276000977
2820,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.01170969009399414
2821,Liệt kê doanh thu lũy kế theo tháng của loại trang dynamic trong năm 2001,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'dynamic'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.006583213806152344
2822,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang WV trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.014281511306762695
2823,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang SD trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.013729095458984375
2824,"Tìm top 5 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.025794029235839844
2825,"Liệt kê top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.023893117904663086
2826,"Liệt kê top 3 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.012507438659667969
2827,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.011915445327758789
2828,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.010746479034423828
2829,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang GA trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012336015701293945
2830,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.024029970169067383
2831,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang TN trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012518882751464844
2832,Tìm top 5 khách hàng chi tiêu nhiều nhất theo website ở bang NJ trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01189732551574707
2833,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MA trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,5,6,,,0.010089874267578125
2834,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang SC trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,5,6,,,0.00897979736328125
2835,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02470684051513672
2836,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang WV trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.013886690139770508
2837,"Cho biết top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02356553077697754
2838,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MI trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.014107465744018555
2839,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang VA trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011894464492797852
2840,"Top 3 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02491927146911621
2841,Tìm doanh thu lũy kế theo tháng của loại trang general trong năm 1999,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND wp.wp_type = 'general'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.007314443588256836
2842,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo website ở bang CA trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.0141143798828125
2843,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.010721206665039062
2844,"Giúp tôi top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02399754524230957
2845,"Top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.027601242065429688
2846,Cho biết doanh thu lũy kế theo tháng của loại trang ad trong năm 2001,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'ad'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008930444717407227
2847,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NM trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NM'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NM'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012359380722045898
2848,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang WY trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.01155996322631836
2849,"Giúp tôi top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.010008096694946289
2850,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang LA trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'LA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'LA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01264190673828125
2851,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang NY trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.010457992553710938
2852,"Top 10 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.024843215942382812
2853,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MT trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.010045289993286133
2854,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang CO trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,14,6,,,0.009960651397705078
2855,"Giúp tôi top 5 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.02269887924194336
2856,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02144169807434082
2857,"Giúp tôi top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.010698556900024414
2858,"Liệt kê top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.0093994140625
2859,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.020428895950317383
2860,"Top 10 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02296161651611328
2861,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang ND trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.011513710021972656
2862,"Cho biết top 3 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.009104013442993164
2863,"Giúp tôi top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.010706186294555664
2864,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang AL trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.016318798065185547
2865,"Top 5 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.0233461856842041
2866,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang AZ trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.011258125305175781
2867,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang IN trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,5,6,,,0.00997781753540039
2868,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang WV trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.015349149703979492
2869,Doanh thu lũy kế theo tháng của loại trang feedback trong năm 2001,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND wp.wp_type = 'feedback'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008958578109741211
2870,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang IN trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01273965835571289
2871,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.03449654579162598
2872,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang GA trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.013658761978149414
2873,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo website ở bang TX trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011065006256103516
2874,"Liệt kê top 10 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02610301971435547
2875,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang AZ trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01514124870300293
2876,Doanh thu lũy kế theo tháng của loại trang order trong năm 2000,"WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy;","WITH monthly AS (
  SELECT wp.wp_type, d.d_year, d.d_moy,
         SUM(ws.ws_net_paid) AS revenue
  FROM web_sales ws
  JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND wp.wp_type = 'order'
  GROUP BY wp.wp_type, d.d_year, d.d_moy
)
SELECT wp_type, d_year, d_moy, revenue,
       SUM(revenue) OVER (PARTITION BY wp_type, d_year ORDER BY d_moy) AS running_revenue
FROM monthly
ORDER BY d_moy",True,True,12,5,,,0.008542299270629883
2877,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang TN trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012114286422729492
2878,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02277684211730957
2879,"Tìm top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.028621673583984375
2880,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NV trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012235403060913086
2881,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang OK trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013372421264648438
2882,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang UT trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.014509439468383789
2883,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NE trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012453556060791016
2884,"Hãy top 5 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.023249387741088867
2885,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MD trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.015349864959716797
2886,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang UT trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012444496154785156
2887,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang NJ trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012006998062133789
2888,"Tìm top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.023598909378051758
2889,"Giúp tôi top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.010139703750610352
2890,"Liệt kê top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.030591249465942383
2891,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang TN trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,15,6,,,0.010851860046386719
2892,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang SD trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.018094539642333984
2893,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NM trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NM'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NM'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.011239767074584961
2894,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang IN trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.013017654418945312
2895,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NH trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01097416877746582
2896,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang KY trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012998819351196289
2897,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang IL trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.018134355545043945
2898,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang RI trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.01235651969909668
2899,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.033757925033569336
2900,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang ME trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01602935791015625
2901,"Giúp tôi top 5 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.021683931350708008
2902,"Cho biết top 3 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02266836166381836
2903,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang CT trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.010968208312988281
2904,"Hãy top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.02498030662536621
2905,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang OR trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.01685047149658203
2906,"Tìm top 3 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02133011817932129
2907,"Liệt kê top 5 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.025821208953857422
2908,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.021008968353271484
2909,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang IN trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012156963348388672
2910,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang AZ trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AZ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AZ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.010339736938476562
2911,"Top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.011069059371948242
2912,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.01876974105834961
2913,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NY trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,4,6,,,0.011126279830932617
2914,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo website ở bang AK trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01260828971862793
2915,"Top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.011498212814331055
2916,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang MS trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011930227279663086
2917,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MS trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.010272502899169922
2918,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang KS trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.018252849578857422
2919,"Liệt kê top 5 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.02129197120666504
2920,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang KS trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.014914989471435547
2921,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang OH trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.014845609664916992
2922,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02600884437561035
2923,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang IA trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.011700630187988281
2924,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang AZ trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01307988166809082
2925,"Top 5 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.020279884338378906
2926,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NV trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,5,6,,,0.008275985717773438
2927,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang KY trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012366294860839844
2928,"Giúp tôi top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.012020349502563477
2929,"Top 5 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.02106642723083496
2930,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang OR trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01585555076599121
2931,Liệt kê top 5 khách hàng chi tiêu nhiều nhất theo website ở bang UT trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.011926889419555664
2932,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang FL trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.011420726776123047
2933,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MD trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.014972686767578125
2934,"Liệt kê top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng 501-1000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '501-1000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02582693099975586
2935,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang IL trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.010702848434448242
2936,Cho biết top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NJ trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NJ'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.013570547103881836
2937,"Cho biết top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.023494958877563477
2938,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MT trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.011835098266601562
2939,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang MA trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,5,6,,,0.008725404739379883
2940,Tìm top 5 khách hàng chi tiêu nhiều nhất theo website ở bang DC trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,9,6,,,0.009758472442626953
2941,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NY trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011390209197998047
2942,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.009516716003417969
2943,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang IN trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.009997844696044922
2944,"Cho biết top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.02385568618774414
2945,"Giúp tôi top 5 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính F, tiềm năng Unknown)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = 'Unknown'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.020294189453125
2946,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MS trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.011651039123535156
2947,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang OH trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012285709381103516
2948,"Tìm top 3 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.01972031593322754
2949,"Top 10 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.011123418807983398
2950,"Top 3 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.027700424194335938
2951,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang KS trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.010905027389526367
2952,Hãy top 10 khách hàng chi tiêu nhiều nhất theo website ở bang RI trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.010353565216064453
2953,"Tìm top 5 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.023259639739990234
2954,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang SC trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.011525154113769531
2955,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang MS trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011611223220825195
2956,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo website ở bang OH trong năm 1998,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.014687299728393555
2957,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang WY trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.014572381973266602
2958,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang WY trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.013685941696166992
2959,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất theo website ở bang MA trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.015642404556274414
2960,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang ME trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.014702320098876953
2961,"Top 3 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.023310422897338867
2962,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MA trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012187719345092773
2963,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất theo website ở bang NV trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01287388801574707
2964,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang CO trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012338876724243164
2965,"Liệt kê top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.023598670959472656
2966,"Hãy top 3 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính F, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.024597644805908203
2967,"Giúp tôi top 3 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.022182703018188477
2968,"Top 10 nhóm khách hàng theo doanh thu web trong năm 1998 (giới tính M, tiềm năng 5001-10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '5001-10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.023640155792236328
2969,Tìm top 5 khách hàng chi tiêu nhiều nhất theo website ở bang DE trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'DE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'DE'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01134490966796875
2970,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang OK trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.011842727661132812
2971,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang FL trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012337207794189453
2972,Liệt kê top 3 khách hàng chi tiêu nhiều nhất theo website ở bang IL trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012455224990844727
2973,Tìm top 10 khách hàng chi tiêu nhiều nhất theo website ở bang IA trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.01272726058959961
2974,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang MO trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.013960123062133789
2975,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang DC trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,18,6,,,0.011455774307250977
2976,Top 5 khách hàng chi tiêu nhiều nhất theo website ở bang PA trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01349020004272461
2977,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang MT trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012224912643432617
2978,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang WY trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WY'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.01294708251953125
2979,"Cho biết top 10 nhóm khách hàng theo doanh thu web trong năm 1999 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.026932716369628906
2980,"Top 3 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.024672746658325195
2981,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MO trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013552188873291016
2982,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang IN trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IN'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.012332916259765625
2983,Top 10 khách hàng chi tiêu nhiều nhất theo website ở bang CT trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012402772903442383
2984,Liệt kê top 10 khách hàng chi tiêu nhiều nhất theo website ở bang AK trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.017647266387939453
2985,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang ND trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.015119791030883789
2986,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang ND trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.012542963027954102
2987,"Top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.012400627136230469
2988,Tìm top 3 khách hàng chi tiêu nhiều nhất theo website ở bang WV trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.010323047637939453
2989,Hãy top 10 khách hàng chi tiêu nhiều nhất theo website ở bang RI trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.015023469924926758
2990,Top 3 khách hàng chi tiêu nhiều nhất theo website ở bang NH trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.01176309585571289
2991,"Tìm top 10 nhóm khách hàng theo doanh thu web trong năm 2000 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.026485443115234375
2992,Tìm top 5 khách hàng chi tiêu nhiều nhất theo website ở bang UT trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013690948486328125
2993,Hãy top 5 khách hàng chi tiêu nhiều nhất theo website ở bang MS trong năm 2001,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.015383720397949219
2994,"Liệt kê top 3 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính M, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY rk",True,True,1,7,,,0.011033296585083008
2995,"Liệt kê top 5 nhóm khách hàng theo doanh thu web trong năm 2003 (giới tính F, tiềm năng 0-500)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '0-500'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.015247106552124023
2996,Cho biết top 5 khách hàng chi tiêu nhiều nhất theo website ở bang TX trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.013143301010131836
2997,Tìm top 5 khách hàng chi tiêu nhiều nhất theo website ở bang UT trong năm 2000,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'UT'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 5
ORDER BY web_name, rn",True,True,25,6,,,0.012651920318603516
2998,"Cho biết top 5 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính F, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.022512435913085938
2999,"Liệt kê top 5 nhóm khách hàng theo doanh thu web trong năm 2002 (giới tính M, tiềm năng >10000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND cd.cd_gender = 'M' AND hd.hd_buy_potential = '>10000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 5
ORDER BY rk",True,True,1,7,,,0.027812480926513672
3000,Hãy top 3 khách hàng chi tiêu nhiều nhất theo website ở bang VA trong năm 2002,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 3
ORDER BY web_name, rn",True,True,15,6,,,0.014333724975585938
3001,"Hãy top 10 nhóm khách hàng theo doanh thu web trong năm 2001 (giới tính F, tiềm năng 1001-5000)","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk;","WITH agg AS (
  SELECT cd.cd_gender, hd.hd_buy_potential, d.d_year,
         SUM(ws.ws_net_paid) AS revenue,
         COUNT(DISTINCT ws.ws_order_number) AS orders
  FROM web_sales ws
  JOIN customer c ON ws.ws_ship_customer_sk = c.c_customer_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND cd.cd_gender = 'F' AND hd.hd_buy_potential = '1001-5000'
  GROUP BY cd.cd_gender, hd.hd_buy_potential, d.d_year
)
SELECT cd_gender, hd_buy_potential, d_year, revenue, orders,
       revenue::DOUBLE / NULLIF(orders, 0) AS avg_order_value,
       DENSE_RANK() OVER (PARTITION BY cd_gender ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY rk",True,True,1,7,,,0.025852441787719727
3002,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NC trong năm 2003,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NC'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,13,6,,,0.010208606719970703
3003,Cho biết top 10 khách hàng chi tiêu nhiều nhất theo website ở bang NH trong năm 1999,"WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn;","WITH cust_sales AS (
  SELECT w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(ws.ws_net_paid) AS total_spent
  FROM web_sales ws
  JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
  GROUP BY w.web_name, c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT web_name, c_customer_sk, c_first_name, c_last_name, total_spent,
       ROW_NUMBER() OVER (PARTITION BY web_name ORDER BY total_spent DESC) AS rn
FROM cust_sales
QUALIFY rn <= 10
ORDER BY web_name, rn",True,True,50,6,,,0.011762857437133789
3004,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009263038635253906
3005,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009518861770629883
3006,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang KY trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'KY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'KY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009667634963989258
3007,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang SD trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.01159048080444336
3008,Tìm top 3 danh mục có doanh thu catalog cao nhất theo từng call center trong năm 2000,"WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2000
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk;","WITH agg AS (
  SELECT cc.cc_name, i.i_category,
         SUM(cs.cs_net_paid) AS revenue,
         SUM(cs.cs_quantity) AS qty,
         SUM(COALESCE(cr.cr_return_quantity, 0)) AS return_qty
  FROM catalog_sales cs
  JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  LEFT JOIN catalog_returns cr
    ON cs.cs_order_number = cr.cr_order_number
   AND cs.cs_item_sk = cr.cr_item_sk
  WHERE d.d_year = 2000
  GROUP BY cc.cc_name, i.i_category
)
SELECT cc_name, i_category, revenue,
       CASE WHEN qty > 0 THEN return_qty::DOUBLE / qty ELSE 0 END AS return_rate,
       RANK() OVER (PARTITION BY cc_name ORDER BY revenue DESC) AS rk
FROM agg
QUALIFY rk <= 3
ORDER BY cc_name, rk",True,True,9,5,,,0.08064794540405273
3009,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AR trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.0055882930755615234
3010,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang VA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.01001596450805664
3011,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MD trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008151531219482422
3012,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008250236511230469
3013,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MS trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009579658508300781
3014,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang ME trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007961511611938477
3015,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang CT trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008161544799804688
3016,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NH trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008709192276000977
3017,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang ND trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.00897216796875
3018,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008586645126342773
3019,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CT trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008717775344848633
3020,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang FL trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.01084589958190918
3021,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MT trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.00908350944519043
3022,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,9,5,,,0.008260726928710938
3023,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang AR trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009332418441772461
3024,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008669376373291016
3025,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AR trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.011580705642700195
3026,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang GA trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.017965316772460938
3027,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WY trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009026527404785156
3028,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MD trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007758140563964844
3029,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NH trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009837865829467773
3030,Giúp tôi top 10 lý do hoàn trả có mức tổn thất cao nhất trên catalog trong năm 2000,"WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk;","WITH agg AS (
  SELECT r.r_reason_desc, cc.cc_name, d.d_year,
         SUM(cr.cr_net_loss) AS net_loss
  FROM catalog_returns cr
  JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk
  JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
  JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
  GROUP BY r.r_reason_desc, cc.cc_name, d.d_year
)
SELECT r_reason_desc, cc_name, d_year, net_loss,
       DENSE_RANK() OVER (PARTITION BY r_reason_desc ORDER BY net_loss DESC) AS rk
FROM agg
QUALIFY rk <= 10
ORDER BY r_reason_desc, rk",True,True,50,5,,,0.009943008422851562
3031,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang KS trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008380651473999023
3032,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NV trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008214950561523438
3033,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NM trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007835149765014648
3034,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NY trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008757591247558594
3035,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang UT trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009746074676513672
3036,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010629892349243164
3037,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MN trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.0077245235443115234
3038,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang DC trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.005864620208740234
3039,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AK trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007638216018676758
3040,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang LA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008496522903442383
3041,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.00868082046508789
3042,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang ME trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007769346237182617
3043,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008496761322021484
3044,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang SD trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.01340174674987793
3045,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IA trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.013843774795532227
3046,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011718034744262695
3047,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MD trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010764598846435547
3048,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang ID trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007788896560668945
3049,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang ND trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.00999760627746582
3050,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang VT trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008581876754760742
3051,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.012475728988647461
3052,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WI trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.006859779357910156
3053,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.012519121170043945
3054,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang UT trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007017850875854492
3055,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang FL trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010926008224487305
3056,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang FL trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007637500762939453
3057,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WY trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010573625564575195
3058,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang UT trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008577585220336914
3059,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MD trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008084774017333984
3060,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang UT trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,4,5,,,0.006804943084716797
3061,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NY trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.006011962890625
3062,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011671066284179688
3063,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang KS trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009690284729003906
3064,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WI trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.013211965560913086
3065,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WY trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,1,5,,,0.00794839859008789
3066,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AZ trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010419607162475586
3067,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MN trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,9,5,,,0.008872270584106445
3068,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IA trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007723093032836914
3069,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang OH trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009078502655029297
3070,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008400917053222656
3071,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang ND trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010215520858764648
3072,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009129047393798828
3073,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MT trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007027864456176758
3074,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang ID trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.006765842437744141
3075,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang GA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.00908517837524414
3076,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007316112518310547
3077,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MN trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.011120796203613281
3078,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang SD trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010057687759399414
3079,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang IA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.011944293975830078
3080,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009042978286743164
3081,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009012222290039062
3082,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008683204650878906
3083,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NM trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.00830221176147461
3084,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008659839630126953
3085,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NE trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009652853012084961
3086,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang KY trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'KY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.0075724124908447266
3087,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008699655532836914
3088,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang AL trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.007996320724487305
3089,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AK trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009546041488647461
3090,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang RI trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.013288021087646484
3091,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MO trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010234355926513672
3092,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang FL trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.017238378524780273
3093,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang KS trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.012887239456176758
3094,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AZ trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.012464523315429688
3095,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang PA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.016087770462036133
3096,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.018138647079467773
3097,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang AR trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,8,5,,,0.012257575988769531
3098,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang VT trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009310245513916016
3099,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.00901651382446289
3100,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010299205780029297
3101,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.013897180557250977
3102,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.0075225830078125
3103,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010320901870727539
3104,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MI trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010027408599853516
3105,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang IA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009670734405517578
3106,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NE trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010266542434692383
3107,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NY trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.006706953048706055
3108,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang KS trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.007959842681884766
3109,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang ID trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009486675262451172
3110,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WI trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.007997751235961914
3111,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang DC trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.0069484710693359375
3112,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang LA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.00764012336730957
3113,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang RI trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009372234344482422
3114,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009021282196044922
3115,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WI trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010266304016113281
3116,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang DC trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'DC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'DC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007987737655639648
3117,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IN trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.006346464157104492
3118,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007922172546386719
3119,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MA trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008595466613769531
3120,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WI trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007326841354370117
3121,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang GA trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.012664318084716797
3122,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang LA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009599685668945312
3123,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang DE trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009870052337646484
3124,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NH trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,3,5,,,0.008452653884887695
3125,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.011548519134521484
3126,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang DE trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008734703063964844
3127,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NH trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011639595031738281
3128,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MN trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009880304336547852
3129,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang KS trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.00933074951171875
3130,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang KY trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'KY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.007413625717163086
3131,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MS trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009133100509643555
3132,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009122848510742188
3133,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.007915973663330078
3134,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang GA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.00858163833618164
3135,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AZ trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007881641387939453
3136,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008878946304321289
3137,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NE trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008504629135131836
3138,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang PA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008141756057739258
3139,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang PA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.0075304508209228516
3140,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.00803685188293457
3141,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MD trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008220672607421875
3142,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WY trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008620738983154297
3143,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.006443977355957031
3144,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.007353544235229492
3145,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MS trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007846355438232422
3146,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang IN trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.01129913330078125
3147,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang VT trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.013623714447021484
3148,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AL trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.006505727767944336
3149,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang RI trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011262178421020508
3150,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang IN trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.01022028923034668
3151,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang AZ trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.00773930549621582
3152,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AR trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.006672382354736328
3153,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IN trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008603811264038086
3154,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.011467218399047852
3155,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang VA trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009895563125610352
3156,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NV trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007818460464477539
3157,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang HI trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008094072341918945
3158,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang OH trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.011532306671142578
3159,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MT trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010150432586669922
3160,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MD trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008080482482910156
3161,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang ND trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.0076448917388916016
3162,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008950471878051758
3163,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang HI trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,1,5,,,0.0058553218841552734
3164,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NE trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008830070495605469
3165,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NM trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009644269943237305
3166,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.00764775276184082
3167,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008265018463134766
3168,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang IN trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.01058506965637207
3169,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AK trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,2,5,,,0.008798837661743164
3170,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang DE trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011443138122558594
3171,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.012986898422241211
3172,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang KS trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'KS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.011948347091674805
3173,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WY trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009519338607788086
3174,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AL trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010798931121826172
3175,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NE trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010263681411743164
3176,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NE trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.013968229293823242
3177,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WY trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.01121377944946289
3178,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MS trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.01100015640258789
3179,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang DE trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010544538497924805
3180,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang PA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010411500930786133
3181,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010179996490478516
3182,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010431766510009766
3183,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang RI trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.01010584831237793
3184,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NH trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007359027862548828
3185,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.00908517837524414
3186,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang PA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009942770004272461
3187,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang OH trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010515928268432617
3188,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.007637977600097656
3189,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang OK trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'OK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009047985076904297
3190,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang ND trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'ND'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.00773167610168457
3191,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AL trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009716987609863281
3192,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MT trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008441448211669922
3193,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.01003575325012207
3194,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008487224578857422
3195,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009478092193603516
3196,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang SD trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.007459878921508789
3197,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang VT trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,2,5,,,0.006785869598388672
3198,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang VA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.011792898178100586
3199,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.013468742370605469
3200,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang PA trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,3,5,,,0.006956338882446289
3201,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MN trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008013725280761719
3202,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NJ trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009300708770751953
3203,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011888265609741211
3204,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NM trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008440971374511719
3205,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008136272430419922
3206,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NH trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009740352630615234
3207,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CA trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010251283645629883
3208,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.011753559112548828
3209,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang PA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.011610031127929688
3210,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009668588638305664
3211,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang HI trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.01255488395690918
3212,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NH trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008267402648925781
3213,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MO trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.01197361946105957
3214,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NJ trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009331226348876953
3215,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009576082229614258
3216,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang DC trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'DC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'DC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,6,5,,,0.00852060317993164
3217,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AK trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008566856384277344
3218,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010409355163574219
3219,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.00894021987915039
3220,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.012219667434692383
3221,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang FL trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008237838745117188
3222,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MN trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.00960397720336914
3223,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang VA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.013792276382446289
3224,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.0162813663482666
3225,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang WI trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009572505950927734
3226,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang CA trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010968208312988281
3227,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang VT trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.01151585578918457
3228,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang CA trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009400606155395508
3229,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WI trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.011259794235229492
3230,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.013453960418701172
3231,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NM trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007161617279052734
3232,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang IA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010036945343017578
3233,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MO trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010834217071533203
3234,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang FL trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010822772979736328
3235,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MS trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010661840438842773
3236,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MS trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010826349258422852
3237,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NH trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008707284927368164
3238,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008580446243286133
3239,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang VT trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008942127227783203
3240,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang GA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008371114730834961
3241,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NY trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.013349294662475586
3242,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.011476516723632812
3243,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.012454032897949219
3244,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang RI trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008994340896606445
3245,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WI trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.012021064758300781
3246,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WY trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008978843688964844
3247,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MT trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.011910200119018555
3248,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang OK trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.00913381576538086
3249,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NV trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007643699645996094
3250,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang GA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009273767471313477
3251,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang ID trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ID'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010314702987670898
3252,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang UT trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'UT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010413408279418945
3253,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang CA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009470939636230469
3254,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang DE trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'DE'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009168863296508789
3255,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AZ trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011346101760864258
3256,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008489847183227539
3257,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.006896495819091797
3258,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AK trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007916450500488281
3259,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang ME trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007578611373901367
3260,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang AZ trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.00807332992553711
3261,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang FL trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008207559585571289
3262,Liệt kê top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang HI trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008784770965576172
3263,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang GA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'GA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009612083435058594
3264,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009145021438598633
3265,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008086681365966797
3266,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NV trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008570194244384766
3267,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WI trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'WI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.013406515121459961
3268,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MI trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009990215301513672
3269,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009829282760620117
3270,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009377479553222656
3271,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang MI trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009970903396606445
3272,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,7,5,,,0.007242441177368164
3273,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010236263275146484
3274,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang PA trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010944128036499023
3275,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang CT trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.012188434600830078
3276,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang HI trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'HI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009917497634887695
3277,Hãy top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang RI trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'RI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.0077931880950927734
3278,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MN trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010637044906616211
3279,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang PA trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'PA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,3,5,,,0.006279468536376953
3280,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang SD trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010347843170166016
3281,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang OK trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'OK'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009226560592651367
3282,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang IL trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'IL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009217262268066406
3283,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang ME trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'ME'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.00911569595336914
3284,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008100032806396484
3285,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AL trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'AL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010368824005126953
3286,Giúp tôi top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang TX trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'TX'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009036779403686523
3287,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MO trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.007635593414306641
3288,Hãy top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang LA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008453369140625
3289,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NM trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008953094482421875
3290,Hãy top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NM trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009201288223266602
3291,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang WY trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'WY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007882833480834961
3292,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang SD trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'SD'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008004188537597656
3293,Tìm top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang IA trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'IA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.010633468627929688
3294,Cho biết top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang VA trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011964797973632812
3295,Cho biết top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang FL trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'FL'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007580280303955078
3296,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang CO trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'CO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.006272792816162109
3297,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MI trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010089397430419922
3298,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NJ trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'NJ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009301424026489258
3299,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MS trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MS'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.007283926010131836
3300,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang VT trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'VT'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.00834965705871582
3301,Tìm top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.01292276382446289
3302,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NY trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011365890502929688
3303,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang KY trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'KY'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009631156921386719
3304,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang MI trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'MI'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.011040687561035156
3305,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang SC trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'SC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008451700210571289
3306,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang LA trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'LA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010125160217285156
3307,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang NM trong năm 2003,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2003 AND ca.ca_state = 'NM'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,5,5,,,0.006590604782104492
3308,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang MO trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'MO'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.009487390518188477
3309,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AR trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.00952005386352539
3310,Top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang CA trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'CA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008352518081665039
3311,Giúp tôi top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang NC trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'NC'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.010537147521972656
3312,Tìm top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang VA trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'VA'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.010797262191772461
3313,Top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.009660959243774414
3314,Cho biết top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang WV trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'WV'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008475542068481445
3315,Giúp tôi top 10 khách hàng chi tiêu nhiều nhất trên catalog ở bang AR trong năm 2000,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000 AND ca.ca_state = 'AR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 10
ORDER BY rk",True,True,10,5,,,0.008667230606079102
3316,Top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang NH trong năm 1999,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999 AND ca.ca_state = 'NH'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.007452964782714844
3317,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang TN trong năm 2001,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2001 AND ca.ca_state = 'TN'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.009307384490966797
3318,Liệt kê top 5 khách hàng chi tiêu nhiều nhất trên catalog ở bang OR trong năm 2002,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002 AND ca.ca_state = 'OR'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 5
ORDER BY rk",True,True,5,5,,,0.008291482925415039
3319,Liệt kê top 3 khách hàng chi tiêu nhiều nhất trên catalog ở bang AZ trong năm 1998,"WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk;","WITH cust_sales AS (
  SELECT c.c_customer_sk, c.c_first_name, c.c_last_name,
         SUM(cs.cs_net_paid) AS total_spent
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1998 AND ca.ca_state = 'AZ'
  GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
)
SELECT c_customer_sk, c_first_name, c_last_name, total_spent,
       RANK() OVER (ORDER BY total_spent DESC) AS rk
FROM cust_sales
QUALIFY rk <= 3
ORDER BY rk",True,True,3,5,,,0.008229494094848633
