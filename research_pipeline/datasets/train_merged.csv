ID,Transcription,SQL Ground Truth
11,Tìm các khách hàng đến từ Nhật Bản (JP),SELECT * FROM customer WHERE c_birth_country = 'JAPAN';
335,Ai mua đồ Women nhiều nhất ở TX vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
245,Bạn hãy thống kê giúp tôi tổng doanh thu của các sản phẩm thuộc danh mục Music được bán qua trang web và được vận chuyển bằng phương thức giao hàng hỏa tốc OVERNIGHT cho những khách hàng đang sống trong căn hộ chung cư,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Music' 
  AND sm.sm_type = 'OVERNIGHT' 
  AND ca.ca_location_type = 'condo';"
679,Tỷ lệ trả hàng của Men ở MO có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'MO'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'MO' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
307,"Trong năm 2002, khách hàng ở GA mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY ca.ca_state, i.i_category;"
592,Thống kê tổng số lượng Men được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;"
119,So sánh doanh thu bán hàng tại cửa hàng giữa ca sáng (8h-12h) và ca chiều (13h-18h).,"SELECT 
  CASE WHEN t.t_hour BETWEEN 8 AND 12 THEN 'Morning'
       WHEN t.t_hour BETWEEN 13 AND 18 THEN 'Afternoon'
       ELSE 'Other' END AS shift,
  SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
GROUP BY shift;"
291,Tìm tên người quản lý cửa hàng đã bán mặt hàng 'Shoes' được giao bằng dịch vụ 'OVERNIGHT' cho những khách hàng sống cùng bang với địa điểm cửa hàng đó,"SELECT DISTINCT s.s_manager
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk -- Giả định liên kết giao hàng
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Shoes' AND sm.sm_type = 'OVERNIGHT' AND s.s_state = ca.ca_state;"
317,Giá bán trung bình của mặt hàng Books trong năm 1999 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 1999
GROUP BY i.i_category;"
30,Hiển thị chi tiết thông tin của người dùng hiện đang sử dụng tên đăng nhập là user15,SELECT * FROM customer WHERE c_login = 'user15';
56,Liệt kê khách hàng sống tại bang 'California' (CA),"SELECT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk 
WHERE ca.ca_state = 'CA';"
418,Có bao nhiêu đơn hàng Men bị trả lại tại GA vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000;"
600,Ai mua đồ Men nhiều nhất ở IL vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
851,Có bao nhiêu đơn hàng Shoes bị trả lại tại KY vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002;"
369,Khách hàng có bằng 4 yr Degree tại KS thường mua Sports qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
82,Thử tìm giúp tôi mấy khách hàng nào hay mua sắm vào đúng cái tháng sinh nhật của họ,"SELECT DISTINCT c.c_first_name, c.c_last_name, c.c_birth_month
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE c.c_birth_month = d.d_moy;"
630,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Electronics tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
376,"Trong năm 2002, khách hàng ở IL mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY ca.ca_state, i.i_category;"
863,Giá bán trung bình của mặt hàng Music trong năm 2002 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2002
 GROUP BY i.i_category;"
427,"Hàng Music trả lại ở TX có nhiều không, xem số liệu năm 2001 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001
GROUP BY i.i_category, ca.ca_state, d.d_year;"
788,Tổng doanh thu của Jewelry tại bang IA năm 2002 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002;"
570,"Trong năm 2001, khách hàng ở IL mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
698,"Hàng Jewelry trả lại ở GA có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'GA'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
287,Liệt kê các loại hình cư trú của những khách hàng ở bang Virginia đã mua sản phẩm Children thông qua phương thức vận chuyển hỏa tốc ,"SELECT DISTINCT ca.ca_location_type
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA' AND sm.sm_type = 'OVERNIGHT' AND i.i_category = 'Children';"
715,"Hàng Music trả lại ở TX có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
540,Tổng doanh thu của Home tại bang GA năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'GA'
  AND d.d_year = 1999;"
358,"Trong quý 4 năm 2000, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Men?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Men'
  AND d.d_year = 2000
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
769,Có bao nhiêu đơn hàng Home bị trả lại tại MO vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;"
846,Tìm 3 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 1999
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 3;"
719,So sánh lợi nhuận của Sports giữa kênh Web và Catalog tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
 ORDER BY channel;"
395,"Năm 2002, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
501,"Hàng Books trả lại ở TX có nhiều không, xem số liệu năm 1999 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year;"
366,So sánh lợi nhuận của Men giữa kênh Web và Catalog tại KS.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel;"
731,Giá bán trung bình của mặt hàng Women trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND d.d_year = 1999
 GROUP BY i.i_category;"
483,Liệt kê 5 thương hiệu Men được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IL'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
410,Tìm email của các khách hàng VIP ở VA đã mua đồ Jewelry trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
474,Thống kê tổng số lượng Children được mua bởi những khách hàng có trình độ 2 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND cd.cd_education_status = '2 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;"
293,Hãy tìm tên các quản lý trung tâm hỗ trợ đã xử lý đơn hàng 'Sports' cho khách hàng độc thân vào khung giờ từ mười giờ đêm đến hai giờ sáng,"SELECT DISTINCT cc.cc_manager
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND cd.cd_marital_status = 'S' AND t.t_hour IN (22, 23, 0, 1);"
8,Đếm tổng tất cả khách hàng đến từ Mỹ,"SELECT COUNT(*) AS ""TOTAL CUSTOMER"" 
FROM customer 
WHERE c_birth_country = 'UNITED STATES';"
452,Cửa hàng nào ở KY đứng đầu về doanh số Electronics vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY'
  AND i.i_category = 'Electronics'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
156,Tính xem tổng doanh thu bán hàng trên Web vào khung giờ khuya (từ 11h đêm đến 2h sáng) là bao nhiêu,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour IN (23, 0, 1, 2);"
352,Ai mua đồ Books nhiều nhất ở MO vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'MO'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
430,Năm ngoái dân ở TX mua Books nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
102,Tìm 5 mặt hàng thuộc loại 'Sports' (Thể thao) có doanh thu cao nhất trên trang web,"SELECT i.i_item_desc, SUM(ws.ws_sales_price) AS revenue
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY revenue DESC LIMIT 5;"
200,Hãy thống kê giúp tôi số lượng đơn hàng Web bị trả lại với lý do là sản phẩm không giống như hình ảnh hiển thị trên trang web trực tuyến của công ty,"SELECT COUNT(*)
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%wrong image%';"
614,Giá bán trung bình của mặt hàng Sports trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2001
 GROUP BY i.i_category;"
529,Ai mua đồ Sports nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
816,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở NC.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
381,"Hàng Sports trả lại ở GA có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;"
301,Ai mua đồ Shoes nhiều nhất ở TX vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
417,Cửa hàng nào ở IA đứng đầu về doanh số Women vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
879,"Trong năm 1999, khách hàng ở IA mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_year = 1999
 GROUP BY ca.ca_state, i.i_category;"
320,So sánh lợi nhuận của Women giữa kênh Web và Catalog tại KY.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'KY'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel;"
3,Lấy thông tin định danh và họ tên khách hàng,"SELECT c_customer_id, c_first_name, c_last_name 
FROM customer;"
255,Bạn hãy tính toán lợi nhuận ròng từ các sản phẩm danh mục Home được bán qua Website có ngày bắt đầu hoạt động sớm nhất trong hệ thống.,"SELECT web.web_name, SUM(ws.ws_net_profit)
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE web.web_rec_start_date = (SELECT MIN(web_rec_start_date) FROM web_site)
  AND i.i_category = 'Home'
GROUP BY web.web_name;"
508,Cho tôi xem danh sách sản phẩm Music bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
500,Check giùm tôi tồn kho của Shoes ở chi nhánh IA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND w.w_state = 'IA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
267,Bạn hãy tính toán sự chênh lệch về lượng hàng tồn kho của danh mục 'Children' giữa các kho hàng có múi giờ âm bảy và các kho hàng ở múi giờ âm năm.,"SELECT w.w_gmt_offset, SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children' AND w.w_gmt_offset IN (-7.00, -5.00)
GROUP BY w.w_gmt_offset;"
159,Tìm 5 món đồ đắt nhất được bán qua kênh Catalog trong năm 2002.,"SELECT DISTINCT i.i_item_desc, i.i_current_price
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
ORDER BY i.i_current_price DESC LIMIT 5;"
522,Có bao nhiêu đơn hàng Children bị trả lại tại IA vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002;"
837,Doanh số của Jewelry tại MO năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
568,Liệt kê 5 thương hiệu Shoes được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
333,Khách hàng có bằng 2 yr Degree tại GA thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'GA'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
433,Năm 2002 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year;"
306,Check giùm tôi tồn kho của Sports ở chi nhánh KS.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND w.w_state = 'KS'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
437,Năm 1999 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Store' as channel,
    SUM(ss.ss_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY d.d_year;"
527,Tổng doanh thu của Sports tại bang GA năm 2001 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2001;"
409,Tổng doanh thu của Music tại bang KS năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999;"
894,Khách hàng có bằng 4 yr Degree tại MO thường mua Men qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Men'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
360,Giá bán trung bình của mặt hàng Electronics trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
GROUP BY i.i_category;"
586,Cửa hàng nào ở TX đứng đầu về doanh số Electronics vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX'
  AND i.i_category = 'Electronics'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
656,Check giùm tôi tồn kho của Men ở chi nhánh KS.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND w.w_state = 'KS'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
660,So sánh lợi nhuận của Men giữa kênh Store và Catalog tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
 ORDER BY channel;"
213,Bạn hãy cho tôi biết ngày nào trong tuần thường có số lượng đơn hàng bán ra cao nhất đối với danh mục sách trên trang web trực tuyến,"SELECT d.d_day_name, COUNT(*) AS sales_count
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY d.d_day_name
ORDER BY sales_count DESC LIMIT 1;"
829,Cửa hàng nào ở MO đứng đầu về doanh số Sports vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'MO'
  AND i.i_category = 'Sports'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
80,Lấy cho tôi 5 mặt hàng đắt nhất nhưng lại được khách hàng sinh trước năm 1960 hay mua.,"SELECT i.i_item_desc, i.i_current_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE c.c_birth_year < 1960
GROUP BY i.i_item_desc, i.i_current_price
ORDER BY i.i_current_price DESC
LIMIT 5;"
149,Cho tôi biết mấy ông khách đã lập gia đình (Married) thì hay trả lại hàng ở cửa hàng với lý do gì nhất?,"SELECT r.r_reason_desc, COUNT(*) AS count
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE cd.cd_marital_status = 'M'
GROUP BY r.r_reason_desc
ORDER BY count DESC LIMIT 1;"
260,Bạn hãy thống kê tổng số lượng hàng tồn kho của các sản phẩm thuộc danh mục 'Music' tại tất cả các kho hàng trong suốt quý một của năm 2002,"SELECT i.i_category, SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002 AND d.d_qoy = 1
GROUP BY i.i_category;"
595,Có bao nhiêu đơn hàng Sports bị trả lại tại MO vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;"
843,"Trong quý 4 năm 2001, nhóm khách hàng College chi bao nhiêu tiền cho Home?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
383,"Trong quý 4 năm 2002, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Shoes?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
484,Tỷ lệ trả hàng của Shoes ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Shoes' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
134,Lý do phổ biến nhất mà khách hàng đưa ra khi trả lại hàng mua từ Web là gì?,"
SELECT r.r_reason_desc, COUNT(*) AS count
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
GROUP BY r.r_reason_desc
ORDER BY count DESC
LIMIT 1;"
469,"Trong năm 2001, khách hàng ở MO mua nhiều Home không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
549,Ai mua đồ Jewelry nhiều nhất ở IA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
507,"Trong quý 4 năm 2002, nhóm khách hàng 4 yr Degree chi bao nhiêu tiền cho Music?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree'
  AND i.i_category = 'Music'
  AND d.d_year = 2002
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
654,Cửa hàng nào ở VA đứng đầu về doanh số Home vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'VA'
  AND i.i_category = 'Home'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
639,"Hàng Home trả lại ở MO có nhiều không, xem số liệu năm 2001 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
753,Giá bán trung bình của mặt hàng Electronics trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
 GROUP BY i.i_category;"
282,Bạn hãy hiển thị địa chỉ tên đường của các kho hàng đang chứa sản phẩm 'Electronics' màu xanh dương phục vụ cho phương thức vận chuyển 'EXPRESS,"SELECT DISTINCT w.w_street_name
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Electronics' AND i.i_color = 'blue' AND sm.sm_type = 'EXPRESS';"
688,Cửa hàng nào ở KS đứng đầu về doanh số Music vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'KS'
  AND i.i_category = 'Music'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
706,Ai mua đồ Children nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
297,Hiển thị địa chỉ tên đường của các kho hàng đang lưu giữ sản phẩm 'Books' của cùng một nhà sản xuất với các mặt hàng 'Children' đã được bán tại bang 'Georgia',"SELECT DISTINCT w.w_street_name
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Books' AND i.i_manufact IN (
    SELECT DISTINCT i2.i_manufact 
    FROM store_sales ss 
    JOIN item i2 ON ss.ss_item_sk = i2.i_item_sk 
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    WHERE i2.i_category = 'Children' AND s.s_state = 'GA'
);"
173,Website nào có tỷ lệ thuế (web_tax_percentage) cao nhất trong hệ thống?,"SELECT web_name, web_tax_percentage
FROM web_site
ORDER BY web_tax_percentage DESC LIMIT 1;"
864,Liệt kê 3 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;"
468,Tìm email của các khách hàng VIP ở NC đã mua đồ Shoes trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;"
813,Cửa hàng nào ở IL đứng đầu về doanh số Books vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
809,Thống kê tổng số lượng Men được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
91,"Tìm 5 khách hàng có giá trị đơn hàng trung bình (Average Order Value) cao nhất, tính trên cả hai kênh Store và Web","SELECT c.c_first_name, c.c_last_name, AVG(all_sales.sales_price) AS avg_order_value
FROM customer c
JOIN (
    SELECT ss_customer_sk AS customer_sk, ss_sales_price AS sales_price FROM store_sales
    UNION ALL
    SELECT ws_bill_customer_sk AS customer_sk, ws_sales_price AS sales_price FROM web_sales
) all_sales ON c.c_customer_sk = all_sales.customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY avg_order_value DESC
LIMIT 5;"
842,Tìm 10 sản phẩm Music có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
182,"Trong các ngày lễ, nhóm gia đình có thu nhập trung bình thường mua loại hàng gì nhất?","SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE d.d_holiday = 'Y' AND hd.hd_income_band_sk BETWEEN 8 AND 12
GROUP BY i.i_category
ORDER BY count DESC LIMIT 1;"
862,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Women tại TX.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;"
803,Khách hàng có bằng Advanced Degree tại MO thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
70,Ai là người trả hàng nhiều nhất vì lý do đồ bị hỏng (damaged)?,"SELECT c.c_first_name, COUNT(*) AS damaged_returns
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%damaged%'
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY damaged_returns DESC
LIMIT 1;"
132,Tìm cho tôi 5 kho hàng có diện tích (floor space) lớn nhất và liệt kê tổng lượng hàng họ đang giữ.,"SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, SUM(inv.inv_quantity_on_hand) AS total_inv
FROM warehouse w
JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk
GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft
ORDER BY w.w_warehouse_sq_ft DESC
LIMIT 5;"
599,"Hàng Music trả lại ở KS có nhiều không, xem số liệu năm 1999 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year;"
478,Tổng doanh thu của Books tại bang GA năm 2001 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2001;"
136,Có cửa hàng nào diện tích dưới 2 triệu feet vuông mà doanh thu lại cao hơn 1 triệu đô không?,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE s.s_floor_space < 2000000
GROUP BY s.s_store_name
HAVING revenue > 1000000;"
165,Tìm các sản phẩm có lượng tồn kho dưới 10 đơn vị trong quý 1 năm 2002.,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1 AND inv.inv_quantity_on_hand < 10;"
29,Sắp xếp lại toàn bộ danh sách khách hàng trong hệ thống theo thứ tự của mã định danh khách hàng theo thứ tự tăng dần,SELECT * FROM customer ORDER BY c_customer_id;
498,Có bao nhiêu đơn hàng Women bị trả lại tại VA vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2001;"
194,Bạn hãy thống kê giúp tôi tổng doanh thu từ các khách hàng nữ có trình độ học vấn là Cao Đẳng và hiện đang có xếp hạng  tín dụng ở mức Tốt,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F' 
  AND cd.cd_education_status = 'College' 
  AND cd.cd_credit_rating = 'Good';"
312,Năm ngoái dân ở IL mua Jewelry nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
724,Năm 2001 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year;"
641,Tổng doanh thu của Jewelry tại bang NC năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;"
538,Năm ngoái dân ở GA mua Men nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
141,Có khách hàng nào mua hàng qua Web với phương thức 'AIR' nhưng lại trả hàng bằng đường 'GROUND' không?,"SELECT DISTINCT c.c_first_name
FROM web_sales ws
JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number
JOIN ship_mode sm1 ON ws.ws_ship_mode_sk = sm1.sm_ship_mode_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
WHERE sm1.sm_type = 'AIR';"
174,Khách hàng nào đã mua hàng trên Web vào khung giờ từ 2 giờ đến 4 giờ sáng?,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
WHERE t.t_hour BETWEEN 2 AND 4;"
7,Lấy ra danh sách các khách hàng hiện tại không nằm trong nhóm đối tượng khách hàng ưu tiên của cửa hàng,"SELECT c_first_name, c_last_name, c_email_address 
FROM customer 
WHERE c_preferred_cust_flag = 'N';"
582,Năm ngoái dân ở IA mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
378,Năm 2002 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY d.d_year;"
74,Tính xem tỷ lệ khách hàng có dùng mã khuyến mãi (promotion) khi mua đồ điện tử là bao nhiêu?,"SELECT 
  (SELECT COUNT(*) FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics' AND ss.ss_promo_sk IS NOT NULL) * 100.0 / 
  (SELECT COUNT(*) FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics') AS promo_ratio;"
619,Giá bán trung bình của mặt hàng Jewelry trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
332,Tìm 5 sản phẩm Home có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
887,Cho tôi xem danh sách sản phẩm Women bán chạy nhất ở VA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
146,Màu sắc nào của sản phẩm loại 'Sports' được khách hàng ở độ tuổi sinh từ 1990 trở đi ưa chuộng nhất?,"SELECT i.i_color, COUNT(*) AS count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports' AND c.c_birth_year >= 1990
GROUP BY i.i_color
ORDER BY count DESC LIMIT 1;"
235,Bạn hãy giúp tôi xác định xem nhà sản xuất nào có nhiều sản phẩm được bán nhất cho những hộ gia đình không sở hữu xe ô tô nào.,"SELECT i.i_manufact, COUNT(*) AS sold_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 0
GROUP BY i.i_manufact
ORDER BY sold_qty DESC LIMIT 1;"
221,Bạn hãy tính mức chi tiêu trung bình di động của khách hàng Javier Lewis dựa trên ba giao dịch mua hàng gần nhất của ông ấy tại hệ thống cửa hàng.,"SELECT ss_ticket_number, ss_sales_price,
       AVG(ss_sales_price) OVER (ORDER BY ss_sold_date_sk ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_avg
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
WHERE c.c_first_name = 'Javier' AND c.c_last_name = 'Lewis';"
585,Check giùm tôi tồn kho của Women ở chi nhánh IL.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND w.w_state = 'IL'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
804,"Trong quý 4 năm 1999, nhóm khách hàng Advanced Degree chi bao nhiêu tiền cho Shoes?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Shoes'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
133,Thống kê doanh thu bán hàng qua Catalog theo từng trung tâm hỗ trợ (Call Center) trong năm 2002.,"SELECT cc.cc_name, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY cc.cc_name;"
743,Giá bán trung bình của mặt hàng Jewelry trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
 GROUP BY i.i_category;"
328,Thống kê tổng số lượng Women được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
  AND cd.cd_education_status = '4 yr Degree'
GROUP BY cd.cd_education_status, i.i_category;"
186,Bạn hãy xác định xem trung tâm hỗ trợ nào có chi phí vận hành bao gồm thuế và phí vận chuyển cao nhất cho các đơn hàng Catalog.,"SELECT cc.cc_name, SUM(cs.cs_ext_tax + cs.cs_ext_ship_cost) AS total_operating_cost
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
GROUP BY cc.cc_name
ORDER BY total_operating_cost DESC
LIMIT 1;"
42,Liệt kê họ và tên của tất cả những khách hàng nào có trình độ học vấn là tiến sĩ PhD và sinh ra tại Việt Nam,"SELECT c_first_name, c_last_name FROM customer 
JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_education_status = 'PhD' AND c_birth_country = 'VN';"
552,Liệt kê 5 thương hiệu Home được ưa chuộng nhất bởi khách hàng ở NC.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
109,Liệt kê tên những khách hàng có từ 2 xe hơi trở lên và đã từng trả hàng tại cửa hàng.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk
WHERE hd.hd_vehicle_count >= 2;"
426,Liệt kê 3 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3;"
57,Tìm các khách hàng nữ sống tại bang 'NY' đã từng mua hàng.,"SELECT DISTINCT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE cd.cd_gender = 'F' AND ca.ca_state = 'NY';"
603,Cho tôi xem danh sách sản phẩm Men bán chạy nhất ở IA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
351,Năm ngoái dân ở IL mua Sports nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Sports'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
502,So sánh lợi nhuận của Children giữa kênh Web và Catalog tại IL.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'IL'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Catalog')
ORDER BY channel;"
25,Lấy địa chỉ email của những khách hàng nào đang có tên là Lan,SELECT c_email_address FROM customer WHERE c_last_name = 'Lan';
666,Cho tôi xem danh sách sản phẩm Electronics bán chạy nhất ở KS.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
434,Giá bán trung bình của mặt hàng Sports trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 2001
GROUP BY i.i_category;"
440,Năm ngoái dân ở IL mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
52,Đếm xem có bao nhiêu khách hàng là nam (M),"SELECT COUNT(*) 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE cd.cd_gender = 'M';"
412,Khách hàng có bằng College tại IA thường mua Sports qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Sports'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
824,Tổng doanh thu của Jewelry tại bang IA năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999;"
721,Năm ngoái dân ở VA mua Men nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
265,Hãy cho tôi biết những kho hàng ở bang 'California' đang chứa các mặt hàng 'Shoes' có giá bán trên một trăm đô la và liệt kê tổng số lượng tồn của từng loại phương thức vận chuyển 'EXPRESS' liên quan,"SELECT w.w_warehouse_name, i.i_item_desc, SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE w.w_state = 'CA' AND i.i_category = 'Shoes' 
  AND i.i_current_price > 100 AND sm.sm_type = 'EXPRESS'
GROUP BY w.w_warehouse_name, i.i_item_desc;"
693,Liệt kê 5 thương hiệu Shoes được ưa chuộng nhất bởi khách hàng ở TX.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5;"
618,"Trong quý 4 năm 2002, nhóm khách hàng Secondary chi bao nhiêu tiền cho Shoes?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2002
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
704,Tỷ lệ trả hàng của Women ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'VA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Women' as category,
  'VA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
356,Thống kê tổng số lượng Home được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category;"
19,Tìm khách hàng có tên bắt đầu bằng chữ 'M',"SELECT c_first_name, c_last_name 
FROM customer 
WHERE c_first_name LIKE 'M%';"
845,"Trong năm 2000, khách hàng ở IL mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Women'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;"
343,Tỷ lệ trả hàng của Electronics ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Electronics' as category,
    'GA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
84,Liệt kê cho tôi mấy khách hàng nào mua hàng nhiều nhất vào các ngày Thứ Bảy.,"SELECT c.c_first_name, COUNT(*) AS saturday_purchases
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Saturday'
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY saturday_purchases DESC
LIMIT 10;"
62,Liệt kê những khách hàng đã chi tiêu tổng cộng hơn 5000 đô la tại các cửa hàng.,"SELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) as total_spent
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
HAVING total_spent > 5000;"
273,Bạn hãy hiển thị tên của những khách hàng ở bang California đã từng mua mặt hàng Women mà hiện nay mặt hàng đó vẫn còn tồn kho tại kho hàng địa phương.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN inventory inv ON ss.ss_item_sk = inv.inv_item_sk
WHERE ca.ca_state = 'CA' AND inv.inv_quantity_on_hand > 0;"
286,Bạn hãy liệt kê tên các nhà sản xuất có sản phẩm thuộc danh mục Home hiện đang được bày bán tại các cửa hàng có trên hai trăm nhân viên phục vụ,"SELECT DISTINCT i.i_manufact
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home' AND s.s_number_employees > 200;"
363,Check giùm tôi tồn kho của Children ở chi nhánh KY.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND w.w_state = 'KY'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
890,"Năm 1999, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
13,Tìm những người sinh vào năm 2002,SELECT * FROM customer WHERE c_birth_year = 2002;
183,Có bao nhiêu khách hàng sinh năm 1990 mà gia đình có đúng 2 xe hơi và 2 người phụ thuộc?,"SELECT COUNT(*)
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE c.c_birth_year = 1990 AND hd.hd_vehicle_count = 2 AND hd.hd_dep_count = 2;"
389,Doanh số của Sports tại KY năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
722,Ai mua đồ Home nhiều nhất ở MO vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
224,Hãy giúp tôi xác định ngày đầu tiên và ngày cuối cùng mà khách hàng Latisha Hamilton đã thực hiện mua sắm tại cửa hàng,"SELECT DISTINCT 
       FIRST_VALUE(d_date) OVER (ORDER BY d_date ASC) AS first_purchase,
       LAST_VALUE(d_date) OVER (ORDER BY d_date ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_purchase
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE c.c_first_name = 'Latisha' AND c.c_last_name = 'Hamilton';"
559,Khách hàng có bằng 4 yr Degree tại KS thường mua Electronics qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Electronics'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
634,Tỷ lệ trả hàng của Shoes ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Shoes' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
645,Tìm 10 sản phẩm Men có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
531,"Năm 2001, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
528,Giá bán trung bình của mặt hàng Women trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND d.d_year = 2001
GROUP BY i.i_category;"
637,Có bao nhiêu đơn hàng Women bị trả lại tại TX vào năm 2000?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2000;"
177,Tính doanh thu trung bình từ những khách hàng chỉ sở hữu duy nhất 1 chiếc xe ô tô.,"SELECT AVG(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 1;"
605,Năm ngoái dân ở IL mua Books nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
447,Doanh số của Women tại IA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
421,Tìm 5 sản phẩm Children có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
164,Trang web (Web page) nào đang mang lại doanh thu cao nhất cho hệ thống trong năm 2002?,"SELECT wp.wp_url, SUM(ws.ws_sales_price) AS revenue
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY wp.wp_url
ORDER BY revenue DESC LIMIT 1;"
249,Bạn hãy tìm giúp tôi tổng tiền thuế thu được từ các đơn hàng Catalog của danh mục Jewelry được vận chuyển bằng phương thức TWO DAY đến khu vực có múi giờ là âm bảy,"SELECT SUM(cs.cs_ext_tax)
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON cs.cs_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' 
  AND sm.sm_type = 'TWO DAY' 
  AND ca.ca_gmt_offset = -7.00;"
741,Tìm email của các khách hàng VIP ở VA đã mua đồ Electronics trên 5000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 5000
 ORDER BY total_spent DESC;"
794,"Trong quý 4 năm 2001, nhóm khách hàng Advanced Degree chi bao nhiêu tiền cho Sports?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Sports'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
75,Lấy danh sách 5 khách hàng chi tiêu mạnh nhất nhưng lại chưa bao giờ mua hàng qua Catalog.,"SELECT c.c_first_name, SUM(ss.ss_sales_price) AS total_spent
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
WHERE c.c_customer_sk NOT IN (SELECT cs_bill_customer_sk FROM catalog_sales)
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY total_spent DESC LIMIT 5;"
114,Cho tôi biết tên những khách hàng đã chọn phương thức vận chuyển bằng đường hàng không (AIR) cho đơn hàng Web,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE sm.sm_type = 'AIR';"
515,Tổng doanh thu của Books tại bang KS năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999;"
496,Liệt kê 5 thương hiệu Men được ưa chuộng nhất bởi khách hàng ở IA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
105,Có bao nhiêu giao dịch tại cửa hàng đã sử dụng mã khuyến mãi 'Summer Special'?,"SELECT COUNT(*) 
FROM store_sales ss
JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk
WHERE p.p_promo_name = 'Summer Special';"
115,Thống kê xem kho hàng (Warehouse) nào đang xử lý nhiều đơn hàng nhất cho kênh Catalog.,"SELECT w.w_warehouse_name, COUNT(*) AS order_count
FROM catalog_sales cs
JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk
GROUP BY w.w_warehouse_name
ORDER BY order_count DESC;"
451,Doanh số của Books tại VA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'VA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'VA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
93,Tìm danh mục sản phẩm (Category) có tỷ lệ trả hàng (Return Rate) cao nhất so với số lượng bán ra trong quý 1 năm 2002,"SELECT i.i_category, 
       SUM(sr.sr_return_quantity) * 100.0 / SUM(ss.ss_quantity) AS return_rate
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1
GROUP BY i.i_category
ORDER BY return_rate DESC;"
798,Doanh số của Children tại VA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
90,Mấy món đồ nào bị trả lại nhiều nhất vì khách hàng 'không ưng ý' (did not like) trong tháng 12?,"SELECT i.i_item_desc, COUNT(*) AS count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc ILIKE '%did not like%' AND d.d_moy = 12
GROUP BY i.i_item_desc
ORDER BY count DESC;"
337,Ai mua đồ Sports nhiều nhất ở IA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
889,Khách hàng có bằng College tại KY thường mua Children qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'College'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Children'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
825,Liệt kê 10 thương hiệu Sports được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;"
836,Tỷ lệ trả hàng của Jewelry ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
548,Tìm email của các khách hàng VIP ở IL đã mua đồ Home trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Home'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
553,So sánh lợi nhuận của Music giữa kênh Catalog và Web tại NC.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'NC'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
ORDER BY channel;"
95,Tính tổng lợi nhuận từ những khách hàng mua hàng tại các cửa hàng (Store) nằm ngoài bang nơi họ đang cư trú,"SELECT SUM(ss.ss_net_profit) AS out_of_state_profit
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE ca.ca_state <> s.s_state;"
12,Có bao nhiêu khách hàng chưa cập nhật địa chỉ email?,SELECT COUNT(*) FROM customer WHERE c_email_address IS NULL;
899,Tỷ lệ trả hàng của Books ở IA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Books' as category,
  'IA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
44,Đếm xem có bao nhiêu khách hàng nam hiện đang độc thân và đã từng mua hàng lần đầu vào năm 2002,SELECT COUNT(*) FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND c_birth_year = 2002;
43,Lọc ra những địa chỉ email của những khách hàng nữ hiện đang sinh sống tại Hoa Kỳ và có xếp hạng tín dụng ở mức ưu tú,"SELECT c_email_address FROM customer 
JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk 
WHERE cd_gender = 'F' AND c_birth_country = 'USA' 
AND cd_credit_rating = 'Elite';"
330,Tìm email của các khách hàng VIP ở VA đã mua đồ Shoes trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Shoes'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
168,Có bao nhiêu mặt hàng 'Electronics' được bán qua các trang web tự động tạo (wp_autogen_flag = 'Y'),"SELECT COUNT(*)
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics' AND wp.wp_autogen_flag = 'Y';"
786,"Năm 1999, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
542,Giá bán trung bình của mặt hàng Books trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND d.d_year = 2000
GROUP BY i.i_category;"
723,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại KS.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
849,So sánh lợi nhuận của Men giữa kênh Catalog và Web tại GA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel;"
179,Tính tổng tiền thuế (ss_ext_tax) thu được từ các hộ gia đình không có người phụ thuộc nào.,"SELECT SUM(ss.ss_ext_tax)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_dep_count = 0;"
588,Tìm email của các khách hàng VIP ở KS đã mua đồ Electronics trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Electronics'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
791,Năm ngoái dân ở GA mua Women nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Women'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
598,Check giùm tôi tồn kho của Electronics ở chi nhánh IA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'IA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
178,Những gia đình có trên 5 người phụ thuộc (Dependents) thường hay trả lại hàng với lý do gì?,"SELECT r.r_reason_desc, COUNT(*) AS count
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE hd.hd_dep_count > 5
GROUP BY r.r_reason_desc
ORDER BY count DESC;"
696,So sánh lợi nhuận của Sports giữa kênh Catalog và Web tại IL.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'IL'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel;"
716,Khách hàng có bằng 4 yr Degree tại GA thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
718,Thống kê tổng số lượng Shoes được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Secondary'
 GROUP BY cd.cd_education_status, i.i_category;"
384,Giá bán trung bình của mặt hàng Electronics trong năm 1999 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
GROUP BY i.i_category;"
258,Bạn hãy thống kê tổng số lượng hàng tồn kho cho tất cả các sản phẩm thuộc danh mục hàng Music,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
443,Tỷ lệ trả hàng của Men ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'IL'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'IL' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
336,Check giùm tôi tồn kho của Electronics ở chi nhánh NC.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'NC'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
717,Tổng doanh thu của Sports tại bang IL năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999;"
16,Liệt kê những khách hàng sinh ra ở Vương quốc Anh (UK),SELECT * FROM customer WHERE c_birth_country = 'UNITED KINGDOM';
4,Tìm tất cả khách hàng đến từ Việt Nam,"SELECT * FROM customer 
WHERE c_birth_country = 'VN';"
663,Cửa hàng nào ở GA đứng đầu về doanh số Jewelry vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'GA'
  AND i.i_category = 'Jewelry'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
257,Hãy liệt kê danh sách các mã sản phẩm và số lượng tồn kho tương ứng của chúng tại kho hàng có mã số là một,"SELECT inv_item_sk, inv_quantity_on_hand 
FROM inventory 
WHERE inv_warehouse_sk = 1;"
457,Khách hàng có bằng College tại IA thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'College'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
479,Cho tôi xem danh sách sản phẩm Books bán chạy nhất ở IA.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
774,So sánh lợi nhuận của Music giữa kênh Catalog và Catalog tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
 ORDER BY channel;"
394,Ai mua đồ Men nhiều nhất ở GA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'GA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
223,Bạn hãy tính toán giá trị đơn hàng trung bình của kênh Web trong mỗi giờ và hiển thị thứ hạng của các khung giờ dựa trên mức độ sinh lời,"SELECT t_hour, avg_profit,
       RANK() OVER (ORDER BY avg_profit DESC) AS hour_rank
FROM (
    SELECT t.t_hour, AVG(ws.ws_net_profit) AS avg_profit
    FROM web_sales ws
    JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk
    GROUP BY t.t_hour
) tmp;"
530,"Năm 2002, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
458,Giá bán trung bình của mặt hàng Music trong năm 1999 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 1999
GROUP BY i.i_category;"
425,Khách hàng có bằng 2 yr Degree tại KS thường mua Home qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
325,Check giùm tôi tồn kho của Men ở chi nhánh VA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND w.w_state = 'VA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
535,Cửa hàng nào ở IA đứng đầu về doanh số Jewelry vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Jewelry'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
10,Tìm các quốc gia khác nhau có trong dữ liệu,"SELECT DISTINCT c_birth_country 
FROM customer;"
250,Hãy liệt kê danh sách năm khách hàng có trình độ học vấn là Tiến sĩ đã chi tiêu nhiều nhất cho các mặt hàng Shoes vận chuyển qua phương thức OVERNIGHT trên hệ thống Catalog.,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_sales_price) AS total_spend
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Shoes' 
  AND sm.sm_type = 'OVERNIGHT' 
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name
ORDER BY total_spend DESC LIMIT 5;"
23,Tìm tất cả các khách hàng mà hiện nay thông tin tên đăng nhập đang bị để trống trong toàn bộ cơ sở dữ liệu,SELECT * FROM customer WHERE c_login IS NULL;
357,Năm 2001 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year;"
222,Bạn hãy tìm những khách hàng sống trong các căn hộ chung cư có tổng chi tiêu cao hơn mức chi tiêu trung bình của tất cả khách hàng trong cùng khu vực đó,"SELECT c_first_name, total_spent, avg_area_spent
FROM (
    SELECT c.c_first_name, SUM(ss.ss_sales_price) AS total_spent,
           AVG(SUM(ss.ss_sales_price)) OVER (PARTITION BY ca.ca_location_type) AS avg_area_spent
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    WHERE ca.ca_location_type = 'condo'
    GROUP BY c.c_customer_sk, c.c_first_name, ca.ca_location_type
) tmp WHERE total_spent > avg_area_spent;"
606,Cửa hàng nào ở NC đứng đầu về doanh số Women vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'NC'
  AND i.i_category = 'Women'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
773,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Men tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
884,Năm ngoái dân ở IA mua Children nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
533,Có bao nhiêu đơn hàng Men bị trả lại tại NC vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000;"
341,Năm 2001 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY d.d_year;"
750,Liệt kê 10 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở KS.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;"
524,Check giùm tôi tồn kho của Sports ở chi nhánh VA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND w.w_state = 'VA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
204,Bạn hãy liệt kê danh sách mười khách hàng chi tiêu mạnh tay nhất cho các mặt hàng thời trang nữ thông qua kênh Web trong suốt giai đoạn năm 2001,"SELECT c.c_first_name, SUM(ws.ws_sales_price) AS total_spend
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2001
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY total_spend DESC LIMIT 10;"
238,Hãy giúp tôi tìm xem có bao nhiêu đơn hàng bị trả lại tại cửa hàng có giá trị hoàn tiền mặt lớn hơn năm trăm đô la vào quý bốn năm hai ngàn lẻ hai,"SELECT COUNT(*)
FROM store_returns sr
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE sr.sr_refunded_cash > 500.00 AND d.d_year = 2002 AND d.d_qoy = 4;"
94,So sánh sự thay đổi về doanh thu của loại hàng 'Electronics' giữa tháng 11 và tháng 12 năm 2001,"SELECT d.d_moy, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2001 AND d.d_moy IN (11, 12)
GROUP BY d.d_moy
ORDER BY d.d_moy;"
539,Năm ngoái dân ở IA mua Music nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Music'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
446,Tìm 3 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2002
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;"
683,Tỷ lệ trả hàng của Books ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'GA'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Books' as category,
  'GA' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
285,Hãy hiển thị tên người quản lý trung tâm hỗ trợ call center đã xử lý việc trả hàng 'Men' cho những khách hàng có bằng '4 yr Degree' sống tại bang 'North Carolina'.,"SELECT DISTINCT cc.cc_manager
FROM catalog_returns cr
JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON cr.cr_refunded_addr_sk = ca.ca_address_sk
JOIN item i ON cr.cr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men' AND cd.cd_education_status = '4 yr Degree' AND ca.ca_state = 'NC';"
185,Hãy liệt kê 5 kho hàng có diện tích mặt sàn lớn nhất và tính tổng số lượng sản phẩm hiện có trong các kho này.,"SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, SUM(inv.inv_quantity_on_hand) AS total_inventory
FROM warehouse w
JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk
GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft
ORDER BY w.w_warehouse_sq_ft DESC
LIMIT 5;"
800,"Trong năm 2001, khách hàng ở IA mua nhiều Shoes không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
435,Có bao nhiêu đơn hàng Shoes bị trả lại tại IA vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000;"
736,"Hàng Men trả lại ở KS có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
154,Thống kê tổng lợi nhuận và tiền thuế (cs_ext_tax) thu được từ kênh Catalog theo từng năm,"SELECT d.d_year, SUM(cs.cs_net_profit) AS profit, SUM(cs.cs_ext_tax) AS tax
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
GROUP BY d.d_year;"
76,Tính doanh thu từ mấy món đồ thuộc loại 'Jewelry' (Trang sức) bán cho khách hàng ở bang 'Texas'.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX';"
880,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = '4 yr Degree'
 GROUP BY cd.cd_education_status, i.i_category;"
555,Khách hàng có bằng 2 yr Degree tại KS thường mua Women qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '2 yr Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Women'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
278,Bạn hãy liệt kê các loại hình cư trú của những khách hàng ở 'Virginia' đã mua sản phẩm 'Shoes' được giao bằng phương thức 'OVERNIGHT',"SELECT DISTINCT ca.ca_location_type
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'VA' AND sm.sm_type = 'OVERNIGHT' AND i.i_category = 'Shoes';"
69,Liệt kê những khách hàng đã mua cùng một mặt hàng hơn 3 lần trong năm 2002,"SELECT c.c_first_name, i.i_item_desc, COUNT(*) as purchase_count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name, i.i_item_desc
HAVING purchase_count > 3;"
569,Tìm 3 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;"
189,Hãy cho tôi biết lý do hàng đầu khiến khách hàng trả lại sản phẩm mua từ Web là gì và số lượng tương ứng là bao nhiêu,"SELECT r.r_reason_desc, COUNT(*) AS return_count
FROM web_returns wr
JOIN reason r ON wr.wr_reason_sk = r.r_reason_sk
GROUP BY r.r_reason_desc
ORDER BY return_count DESC LIMIT 1;"
272,Hãy tìm địa chỉ cụ thể bao gồm tên đường và thành phố của các kho hàng hiện đang lưu trữ sản phẩm Electronics có màu đỏ,"SELECT DISTINCT w.w_street_name, w.w_city, w.w_state
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics' AND i.i_color = 'red';"
668,Tìm 3 sản phẩm Men có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 3;"
560,Tìm email của các khách hàng VIP ở GA đã mua đồ Music trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Music'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
237,Bạn hãy liệt kê mười món đồ có giá vốn nhập hàng thấp nhất nhưng lại mang về lợi nhuận dương cao nhất trên hệ thống bán lẻ Web,"SELECT i.i_item_desc, ws.ws_net_profit
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ws.ws_net_profit > 0
ORDER BY i.i_wholesale_cost ASC, ws.ws_net_profit DESC
LIMIT 10;"
89,Có khách hàng nào mua đồ ở cả Cửa hàng và Catalog nhưng lại chưa từng chạm vào Web không?,"SELECT c.c_first_name, c.c_last_name
FROM customer c
WHERE c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales)
  AND c.c_customer_sk IN (SELECT cs_bill_customer_sk FROM catalog_sales)
  AND c.c_customer_sk NOT IN (SELECT ws_bill_customer_sk FROM web_sales);"
793,Năm 2002 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Catalog' as channel,
  SUM(cs.cs_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM catalog_sales cs
 JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year;"
118,Tìm 5 mặt hàng thuộc nhóm 'Books' (Sách) mà khách hàng nam thường hay mua nhất.,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Books' AND cd.cd_gender = 'M'
GROUP BY i.i_item_desc
ORDER BY total_qty DESC
LIMIT 5;"
126,Mấy món đồ điện tử (Electronics) có giá trên 150 đô thường được mua nhiều nhất vào tháng mấy?,"SELECT d.d_moy, COUNT(*) AS sales_count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND i.i_current_price > 150
GROUP BY d.d_moy
ORDER BY sales_count DESC LIMIT 1;"
738,Thống kê tổng số lượng Shoes được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
290,Tìm danh sách tên các khách hàng đã từng mua mặt hàng 'Music' thông qua kênh Web nhưng lại thực hiện việc trả lại hàng đó thông qua kênh Catalog,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
WHERE c.c_customer_sk IN (
    SELECT ws_bill_customer_sk FROM web_sales ws 
    JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_category = 'Music'
)
AND c.c_customer_sk IN (
    SELECT cr_refunded_customer_sk FROM catalog_returns cr 
    JOIN item i ON cr.cr_item_sk = i.i_item_sk WHERE i.i_category = 'Music'
);"
239,Bạn hãy tính tổng lợi nhuận ròng thu được từ kênh Web của nhóm khách hàng có thu nhập từ mức năm mươi ngàn đô la trở lên và có trên bốn người phụ thuộc,"SELECT SUM(ws.ws_net_profit)
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_lower_bound >= 50000 AND hd.hd_dep_count > 4;"
1,Bạn hãy tìm tên những khách hàng có trình độ 'Advanced Degree' đã mua đồ 'Jewelry' qua kênh Web và cũng đã từng mua đồ 'Home' qua kênh Catalog,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_education_status = 'Advanced Degree'
INTERSECT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
JOIN item i1 ON ws.ws_item_sk = i1.i_item_sk WHERE i1.i_category = 'Jewelry'
INTERSECT
SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk
JOIN item i2 ON cs.cs_item_sk = i2.i_item_sk WHERE i2.i_category = 'Home';"
891,Liệt kê 3 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở VA.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;"
602,Năm ngoái dân ở IA mua Men nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Men'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
856,Tổng doanh thu của Music tại bang NC năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;"
396,Tìm 10 sản phẩm Sports có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
536,Tìm email của các khách hàng VIP ở IA đã mua đồ Men trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Men'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
127,Tìm 5 mặt hàng thuộc nhóm 'Sports' bị khách hàng trả lại nhiều nhất ở cửa hàng.,"SELECT i.i_item_desc, COUNT(*) AS return_count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC LIMIT 5;"
279,Bạn hãy tìm URL của các trang web page đã thực hiện bán mặt hàng 'Music' cho khách hàng sống tại cùng bang với kho hàng cung cấp.,"SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Music' AND w.w_state = ca.ca_state;"
697,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
117,Tính tổng doanh thu từ nhóm hàng 'dresses' (váy) bán cho khách hàng ở bang New York (NY).,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
WHERE i.i_class = 'dresses' AND ca.ca_state = 'NY';"
229,"Bạn hãy liệt kê các giao dịch tại cửa hàng đang gây ra mức thua lỗ lớn nhất, cụ thể là có lợi nhuận ròng âm hơn bảy trăm đô la","SELECT ss_ticket_number, ss_net_profit
FROM store_sales
WHERE ss_net_profit < -700.00
ORDER BY ss_net_profit ASC;"
814,Doanh số của Shoes tại NC năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'NC' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
661,"Hàng Home trả lại ở TX có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
58,Liệt kê tên khách hàng và thu nhập bình quân của họ (Income Band).,"SELECT c.c_first_name, ib.ib_lower_bound, ib.ib_upper_bound 
FROM customer c 
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk 
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk;"
785,"Năm 2000, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
275,Hãy tìm các đơn hàng Catalog sử dụng dịch vụ EXPRESS mà mặt hàng trong đơn đó hiện nay đã hết sạch hàng trong hệ thống kho bãi,"SELECT DISTINCT cs.cs_order_number
FROM catalog_sales cs
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk
WHERE sm.sm_type = 'EXPRESS' AND inv.inv_quantity_on_hand = 0;"
319,Check giùm tôi tồn kho của Electronics ở chi nhánh VA.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'VA'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
631,Cửa hàng nào ở IA đứng đầu về doanh số Women vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
145,Cho tôi biết doanh thu của thương hiệu 'Men' bán tại cửa hàng vào những ngày không phải ngày lễ (Holiday = 'N'),"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_holiday = 'N';"
714,Tìm email của các khách hàng VIP ở GA đã mua đồ Electronics trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;"
596,Cửa hàng nào ở MO đứng đầu về doanh số Books vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'MO'
  AND i.i_category = 'Books'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
817,Cửa hàng nào ở IA đứng đầu về doanh số Books vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'IA'
  AND i.i_category = 'Books'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
782,Có bao nhiêu đơn hàng Home bị trả lại tại IL vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;"
370,Tổng doanh thu của Sports tại bang IL năm 2002 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2002;"
269,Hãy so sánh sự chênh lệch về tổng lượng tồn kho của danh mục 'Home' giữa các kho hàng có diện tích trên một triệu feet vuông và dưới một triệu feet vuông,"SELECT CASE WHEN w.w_warehouse_sq_ft > 1000000 THEN 'Large' ELSE 'Small' END AS warehouse_size,
       SUM(inv.inv_quantity_on_hand) AS total_stock
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY warehouse_size;"
629,Doanh số của Music tại KY năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
308,Cửa hàng nào ở NC đứng đầu về doanh số Home vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NC'
  AND i.i_category = 'Home'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
424,Thống kê tổng số lượng Shoes được mua bởi những khách hàng có trình độ Advanced Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY cd.cd_education_status, i.i_category;"
311,Ai mua đồ Men nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
355,So sánh lợi nhuận của Jewelry giữa kênh Store và Web tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
ORDER BY channel;"
47,Tìm email của các khách hàng nam sinh ra tại nước Anh và có xếp hạng tín dụng đang ở mức thấp để gửi thông báo hỗ trợ,SELECT c_email_address FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_gender = 'M' AND c_birth_country = 'UK' AND cd_credit_rating = 'Low';
350,Check giùm tôi tồn kho của Electronics ở chi nhánh KY.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'KY'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
372,Cửa hàng nào ở IA đứng đầu về doanh số Shoes vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Shoes'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
480,Ai mua đồ Electronics nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
581,Tìm 5 sản phẩm Sports có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
262,Bạn hãy thống kê xem kho hàng nào ở khu vực múi giờ âm bảy đang lưu giữ nhiều mặt hàng 'Jewelry' nhất hiện nay,"SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_qty
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND w.w_gmt_offset = -7.00
GROUP BY w.w_warehouse_name
ORDER BY total_qty DESC LIMIT 1;"
196,Xác định giúp tôi xem có bao nhiêu khách hàng có số lượng người phụ thuộc đang đi làm lớn hơn hai và đã từng mua hàng tại hệ thống cửa hàng.,"SELECT COUNT(DISTINCT ss_customer_sk)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_dep_employed_count > 2;"
900,Có bao nhiêu đơn hàng Children bị trả lại tại IA vào năm 1999?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999;"
751,Ai mua đồ Books nhiều nhất ở IA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
108,Tính tổng doanh thu từ các mặt hàng được bán vào các ngày lễ (Holiday) trong năm 2001.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y' AND d.d_year = 2001;"
876,Liệt kê 5 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5;"
60,Tính tổng số tiền mà khách hàng 'Billy Chen' đã chi tiêu.,"SELECT SUM(ss.ss_sales_price) 
FROM customer c 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE c.c_first_name = 'Billy' AND c.c_last_name = 'Chen';"
692,Doanh số của Music tại MO năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'MO' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'MO' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
264,"Bạn hãy thống kê tổng lợi nhuận dự kiến nếu chúng ta bán hết toàn bộ lượng hàng tồn kho của danh mục 'Music' hiện có, dựa trên mức giá bán lẻ hiện tại của từng sản phẩm.","SELECT SUM((i.i_current_price - i.i_wholesale_cost) * inv.inv_quantity_on_hand) AS potential_profit
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
573,Có bao nhiêu đơn hàng Shoes bị trả lại tại TX vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001;"
101,Tìm những khách hàng sinh trước năm 1970 sống tại bang New York đã từng mua hàng ở cửa hàng,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
WHERE c.c_birth_year < 1970 AND ca.ca_state = 'NY';"
444,Có bao nhiêu đơn hàng Books bị trả lại tại IL vào năm 1999?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999;"
491,Có bao nhiêu đơn hàng Sports bị trả lại tại NC vào năm 2002?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002;"
612,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;"
807,"Hàng Music trả lại ở IA có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
799,Tỷ lệ trả hàng của Jewelry ở KS có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'KS'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'KS' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
170,Tính tổng doanh thu Web thu được từ khách hàng nhận hàng tại bang 'California' (CA).,"SELECT SUM(ws.ws_sales_price)
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'CA';"
180,Thống kê doanh thu Catalog theo từng nhóm khả năng chi tiêu trong năm 2002.,"SELECT hd.hd_buy_potential, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY hd.hd_buy_potential;"
305,Cửa hàng nào ở NC đứng đầu về doanh số Books vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
342,"Năm 1999, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
868,"Hàng Electronics trả lại ở NC có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
150,Mấy người ở bang Texas (TX) mà có từ 3 xe hơi trở lên thường mua loại hàng điện tử (Electronics) nào?,"SELECT i.i_item_desc, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX' AND hd.hd_vehicle_count >= 3 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc;"
125,Cho tôi biết 3 loại hàng (category) nào mang lại doanh thu cao nhất trên kênh Catalog.,"SELECT i.i_category, SUM(cs.cs_sales_price) AS total_revenue
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
GROUP BY i.i_category
ORDER BY total_revenue DESC LIMIT 3;"
709,Khách hàng có bằng Primary tại KY thường mua Sports qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Primary'
  AND ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
51,Hiển thị tên và email của các khách hàng nữ đã ly hôn và sinh vào tháng 8 năm 1999 tại nước Anh.,"SELECT c_first_name, c_last_name, c_email_address FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_gender = 'F' AND cd_marital_status = 'D' AND c_birth_month = 8 AND c_birth_year = 1999 AND c_birth_country = 'UK';"
354,Giá bán trung bình của mặt hàng Music trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 2000
GROUP BY i.i_category;"
831,Liệt kê 3 thương hiệu Home được ưa chuộng nhất bởi khách hàng ở VA.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'VA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 3;"
143,Tính tổng chi phí vận chuyển (ws_ext_ship_cost) cho các sản phẩm thuộc danh mục 'Jewelry' (Trang sức) gửi đến bang 'TX',"SELECT SUM(ws.ws_ext_ship_cost)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'TX';"
471,Tìm 3 sản phẩm Electronics có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 3;"
400,Có bao nhiêu đơn hàng Electronics bị trả lại tại MO vào năm 2001?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2001;"
852,Ai mua đồ Electronics nhiều nhất ở IA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
321,Doanh số của Home tại GA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'GA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'GA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
20,Liệt kê các khách hàng có danh xưng là 'Ms.',"SELECT * FROM customer 
WHERE c_salutation = 'Ms.';"
812,Tỷ lệ trả hàng của Men ở KS có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'KS'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Men' as category,
  'KS' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
713,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Men tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;"
729,Tìm 10 sản phẩm Music có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
408,Doanh số của Shoes tại IL năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IL' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
822,Khách hàng có bằng Advanced Degree tại VA thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
39,Lọc ra danh sách những khách hàng hiện tại vẫn còn đang độc thân và có trình độ cao đẳng,SELECT * FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College';
176,Thống kê cho tôi xem những hộ gia đình có từ 4 xe hơi trở lên thì thường mua loại hàng (category) nào nhiều nhất?,"SELECT i.i_category, COUNT(*) AS purchase_count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE hd.hd_vehicle_count >= 4
GROUP BY i.i_category
ORDER BY purchase_count DESC;"
246,Hãy tính toán chi phí vận chuyển trung bình cho các mặt hàng thời trang Women được gửi đến bang Texas bằng phương thức giao hàng NEXT DAY thông qua hệ thống bán hàng trực tuyến Web,"SELECT AVG(ws.ws_ext_ship_cost)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Women' 
  AND sm.sm_type = 'NEXT DAY' 
  AND ca.ca_state = 'TX';"
747,Giá bán trung bình của mặt hàng Music trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
607,Năm 2002 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year;"
680,Năm 2001 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Catalog' as channel,
  SUM(cs.cs_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM catalog_sales cs
 JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year;"
771,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại VA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'VA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
155,Liệt kê 5 cửa hàng có ít nhân viên (dưới 100 người) nhưng doanh thu năm 2001 lại đứng top đầu.,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_number_employees < 100 AND d.d_year = 2001
GROUP BY s.s_store_name
ORDER BY revenue DESC LIMIT 5;"
288,Hiển thị danh sách các thương hiệu sản phẩm thuộc danh mục hàng Shoes,SELECT DISTINCT i_brand FROM item WHERE i_category = 'Shoes';
545,Tổng doanh thu của Home tại bang KY năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'KY'
  AND d.d_year = 1999;"
18,Thống kê số lượng khách hàng theo từng năm sinh,"SELECT c_birth_year, COUNT(*) 
FROM customer 
GROUP BY c_birth_year;"
128,"Trong quý 1 năm 2000, có bao nhiêu khách hàng đã dùng mã giảm giá để mua đồ trên Web?","SELECT COUNT(DISTINCT ws_bill_customer_sk)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1 AND ws_promo_sk IS NOT NULL;"
323,Năm 2000 thì kênh Catalog mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Catalog' as channel,
    SUM(cs.cs_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM catalog_sales cs
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_year;"
256,Thống kê tổng số đơn hàng Jewelry được giao bằng dịch vụ EXPRESS thông qua các trang web có lượng khách truy cập (mã số thuế) 0.11,"SELECT COUNT(*)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE sm.sm_type = 'EXPRESS' AND web.web_tax_percentage = 0.11 AND i.i_category = 'Jewelry';"
597,Tìm email của các khách hàng VIP ở IL đã mua đồ Jewelry trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Jewelry'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
866,"Hàng Music trả lại ở NC có nhiều không, xem số liệu năm 2000 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
191,Bạn hãy tính tổng doanh thu bán đồ điện tử trong khoảng thời gian từ 18 giờ đến 21 giờ tối hàng ngày.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE i.i_category = 'Electronics' AND t.t_hour BETWEEN 18 AND 21;"
116,"Trong loại hàng 'Electronics' (Điện tử), món đồ nào có giá niêm yết cao nhất hiện nay?","SELECT i_item_desc, i_current_price
FROM item
WHERE i_category = 'Electronics'
ORDER BY i_current_price DESC
LIMIT 1;"
558,Năm ngoái dân ở MO mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
181,Tìm những hộ gia đình có thu nhập mức thấp nhất nhưng lại sở hữu từ 2 xe hơi trở lên,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_income_band_sk = (SELECT MIN(ib_income_band_sk) FROM income_band)
  AND hd.hd_vehicle_count >= 2;"
302,Check giùm tôi tồn kho của Shoes ở chi nhánh IL.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND w.w_state = 'IL'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
685,Năm ngoái dân ở GA mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
644,Thống kê tổng số lượng Electronics được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
733,Ai mua đồ Jewelry nhiều nhất ở IL vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
621,Có bao nhiêu đơn hàng Children bị trả lại tại IL vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;"
839,Cho tôi xem danh sách sản phẩm Home bán chạy nhất ở GA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'GA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
518,So sánh lợi nhuận của Music giữa kênh Web và Web tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel;"
885,Tìm email của các khách hàng VIP ở IL đã mua đồ Women trên 1000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Women'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC;"
46,Lấy danh sách các khách hàng có trình độ thạc sĩ quản trị kinh doanh (MBA) và hiện đang là khách hàng ưu tiên của hệ thống,"SELECT c_first_name, c_last_name FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_education_status = 'MBA' AND c_preferred_cust_flag = 'Y';"
815,Giá bán trung bình của mặt hàng Men trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
158,Những người lớn tuổi (sinh trước năm 1950) thường hay mua loại sách (category = 'Books') nào nhất?,"SELECT i.i_class, COUNT(*) AS count
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE c.c_birth_year < 1950 AND i.i_category = 'Books'
GROUP BY i.i_class
ORDER BY count DESC LIMIT 1;"
671,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Music tại KS.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
172,Liệt kê 5 thành phố có chi phí vận chuyển qua Web (ws_ext_ship_cost) cao nhất trong năm 2002.,"SELECT ca.ca_city, SUM(ws.ws_ext_ship_cost) AS total_ship_cost
FROM web_sales ws
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY ca.ca_city
ORDER BY total_ship_cost DESC LIMIT 5;"
17,Tìm các khách hàng sinh vào tháng 12,"SELECT c_first_name, c_last_name, c_birth_day 
FROM customer 
WHERE c_birth_month = 12;"
512,Giá bán trung bình của mặt hàng Home trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2002
GROUP BY i.i_category;"
49,Cho biết tên của những khách hàng góa vợ hoặc góa chồng sinh năm 1990 và có mức ước tính mua sắm là 6 điểm.,"SELECT c_first_name, c_last_name FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'W' AND c_birth_year = 1990 AND cd_purchase_estimate = 6"
883,Khách hàng có bằng Advanced Degree tại IL thường mua Home qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Advanced Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Home'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
756,"Trong năm 2000, khách hàng ở KY mua nhiều Books không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;"
516,"Hàng Men trả lại ở NC có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;"
622,"Trong năm 2001, khách hàng ở IA mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
481,So sánh lợi nhuận của Music giữa kênh Catalog và Catalog tại KS.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Music' AND ca.ca_state = 'KS'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Catalog')
ORDER BY channel;"
284,Hãy hiển thị tên người quản lý trung tâm hỗ trợ đã xử lý việc hoàn lại cho mặt hàng 'Home' của những khách hàng có xếp hạng tín dụng 'Good',"SELECT DISTINCT cc.cc_manager
FROM catalog_returns cr
JOIN call_center cc ON cr.cr_call_center_sk = cc.cc_call_center_sk
JOIN item i ON cr.cr_item_sk = i.i_item_sk
JOIN customer_demographics cd ON cr.cr_refunded_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Home' AND cd.cd_credit_rating = 'Good';"
594,So sánh lợi nhuận của Sports giữa kênh Catalog và Web tại GA.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'GA'
)
SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
ORDER BY channel;"
226,Bạn hãy thống kê giúp tôi tổng doanh thu của các mặt hàng thương hiệu 'Home' được bán cho những khách hàng đang sống trong các căn hộ chung cư,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_location_type = 'condo' AND i.i_brand = 'Home';"
27,"Tìm tất cả những khách hàng mà tên của họ bắt đầu bằng chữ ""B""",SELECT * FROM customer WHERE c_first_name LIKE 'B%';
705,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Jewelry tại KS.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
438,Cửa hàng nào ở IA đứng đầu về doanh số Electronics vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Electronics'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
853,Khách hàng có bằng 2 yr Degree tại GA thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'GA'
  AND i.i_category = 'Jewelry'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
365,Tổng doanh thu của Shoes tại bang IL năm 2000 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2000;"
230,Bạn hãy thống kê tổng số tiền thuế thu được từ các đơn hàng Catalog của những hộ gia đình có mức khả năng chi tiêu từ năm trăm đến một ngàn đô la.,"SELECT SUM(cs.cs_ext_tax)
FROM catalog_sales cs
JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_buy_potential = '501-1000';"
38,Liệt kê danh sách những khách hàng đang ở trạng thái góa vợ hoặc góa chồng và đang phải nuôi dưỡng một người phụ thuộc duy nhất trong gia đình,"SELECT * FROM customer_demographics 
WHERE cd_marital_status = 'W' AND cd_dep_count = 1"
867,Doanh số của Home tại KS năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Home' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
375,Cửa hàng nào ở KS đứng đầu về doanh số Sports vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS'
  AND i.i_category = 'Sports'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
470,Doanh số của Jewelry tại GA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA' AND d.d_year = 2001
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'GA' AND d.d_year = 2000
)
SELECT 
    2001 as current_year,
    cy.revenue as current_revenue,
    2000 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
869,Tìm 5 sản phẩm Home có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;"
765,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại TX.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;"
657,Doanh số của Music tại NC năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'NC' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'NC' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
195,Hãy cho tôi biết những khách hàng đã lập gia đình và có ước tính mức mua sắm trên năm ngàn đô la thường ưa chuộng danh mục hàng hóa nào nhất,"SELECT i.i_category, COUNT(*) AS count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND cd.cd_purchase_estimate > 5000
GROUP BY i.i_category
ORDER BY count DESC LIMIT 1;"
767,Giá bán trung bình của mặt hàng Electronics trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
826,Tìm email của các khách hàng VIP ở TX đã mua đồ Electronics trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Electronics'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;"
504,Cửa hàng nào ở IA đứng đầu về doanh số Women vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Women'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
871,Năm 1999 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 1999
 GROUP BY d.d_year;"
865,Ai mua đồ Children nhiều nhất ở KY vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
580,Tìm 5 sản phẩm Jewelry có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry'
  AND d.d_year = 2001
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
870,"Hàng Sports trả lại ở TX có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
163,Tìm những người hay mua hàng trên mạng vào ngày lễ nhưng chưa bao giờ bước chân vào cửa hàng.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y'
  AND c.c_customer_sk NOT IN (SELECT ss_customer_sk FROM store_sales);"
636,Thống kê tổng số lượng Home được mua bởi những khách hàng có trình độ College.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND cd.cd_education_status = 'College'
 GROUP BY cd.cd_education_status, i.i_category;"
153,Cho tôi biết lượng hàng tồn kho của các mặt hàng 'Electronics' tại kho hàng ở thành phố 'San Jose' vào ngày 2001-01-01,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND w.w_city = 'San Jose' AND d.d_date = '2001-01-01';"
617,Tìm email của các khách hàng VIP ở TX đã mua đồ Men trên 1000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Men'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 1000
 ORDER BY total_spent DESC;"
635,"Trong quý 4 năm 2000, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Books?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
681,Liệt kê 5 thương hiệu Women được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 5;"
112,Tìm những khách hàng mua đồ qua Web mà có địa chỉ nhận hàng khác hoàn toàn với địa chỉ thanh toán.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
WHERE ws.ws_bill_addr_sk <> ws.ws_ship_addr_sk;"
227,Hãy liệt kê danh sách email của các khách hàng nam hiện đang cư trú tại các ngôi nhà dành cho một gia đình có múi giờ là -7,"SELECT c.c_email_address
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'M' 
  AND ca.ca_location_type = 'single family' 
  AND ca.ca_gmt_offset = -7.00;"
623,"Hàng Women trả lại ở KY có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
104,Cho tôi biết tên cửa hàng có doanh thu cao nhất trong tháng 12 năm 2000,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12
GROUP BY s.s_store_name
ORDER BY revenue DESC LIMIT 1;"
422,Có bao nhiêu đơn hàng Electronics bị trả lại tại TX vào năm 1999?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999;"
420,Năm ngoái dân ở KS mua Jewelry nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
587,Doanh số của Women tại IA năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'IA' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
120,Những khách hàng nào đã mua sắm liên tục vào các ngày cuối tuần trong tháng 12 năm 2000?,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_moy = 12 AND d.d_day_name IN ('Saturday', 'Sunday');"
54,Đếm tổng số khách hàng nữ có trình độ 'Advanced Degree'.,"SELECT COUNT(*) 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk 
WHERE cd.cd_gender = 'F' AND cd.cd_education_status = 'Advanced Degree';"
152,Tìm xem 3 phương thức vận chuyển (ship mode) nào được dùng nhiều nhất cho mấy món đồ đắt tiền trên Web (giá trên 200).,"SELECT sm.sm_type, COUNT(*) AS usage_count
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_current_price > 200
GROUP BY sm.sm_type
ORDER BY usage_count DESC LIMIT 3;"
404,Liệt kê 10 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở VA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'VA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 10;"
848,"Trong quý 4 năm 1999, nhóm khách hàng 2 yr Degree chi bao nhiêu tiền cho Women?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = '2 yr Degree'
  AND i.i_category = 'Women'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
208,Thống kê tổng doanh thu bán lẻ từ những hộ gia đình không sở hữu xe ô tô nào nhưng lại có từ hai người phụ thuộc trở lên trong hồ sơ nhân khẩu học,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE hd.hd_vehicle_count = 0 AND hd.hd_dep_count >= 2;"
759,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Music tại IA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'IA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 3;"
854,Check giùm tôi tồn kho của Children ở chi nhánh MO.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND w.w_state = 'MO'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
9,Sắp xếp khách hàng theo năm sinh giảm dần,"SELECT c_first_name, c_last_name, c_birth_year 
FROM customer 
ORDER BY c_birth_year DESC;"
760,So sánh lợi nhuận của Books giữa kênh Store và Web tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
37,Có bao nhiêu khách hàng đang phải nuôi từ ba người phụ thuộc trở lên trong gia đình,SELECT COUNT(*) FROM customer_demographics WHERE cd_dep_count >= 3;
453,Ai mua đồ Shoes nhiều nhất ở VA vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
254,Bạn hãy tìm giúp tôi mức lợi nhuận trung bình của các đơn hàng Catalog được xử lý bởi trung tâm hỗ trợ có diện tích mặt sàn lớn nhất trong hệ thống,"SELECT cc.cc_name, AVG(cs.cs_net_profit) AS avg_profit
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
WHERE cc.cc_sq_ft = (SELECT MAX(cc_sq_ft) FROM call_center)
GROUP BY cc.cc_name;"
304,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category;"
673,"Năm 2000, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
572,"Trong năm 2000, khách hàng ở NC mua nhiều Shoes không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY ca.ca_state, i.i_category;"
624,Doanh số của Men tại GA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Men' AND ca.ca_state = 'GA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
690,"Trong năm 2000, khách hàng ở MO mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Home'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;"
651,Giá bán trung bình của mặt hàng Home trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY i.i_category;"
263,Bạn hãy liệt kê năm sản phẩm 'Children' có lượng tồn kho ít nhất tại các kho hàng thuộc bang 'California' vào những ngày lễ của năm 2002,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND w.w_state = 'CA' 
  AND d.d_holiday = 'Y' AND d.d_year = 2002
ORDER BY inv.inv_quantity_on_hand ASC LIMIT 5;"
611,Ai mua đồ Books nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
298,Liệt kê tên các trung tâm hỗ trợ đã xử lý đơn hàng 'Jewelry' cho các hộ gia đình sở hữu trên ba xe ô tô thông qua phương thức vận chuyển 'NEXT DAY,"SELECT DISTINCT cc.cc_name
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
JOIN household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND sm.sm_type = 'NEXT DAY' AND hd.hd_vehicle_count > 3;"
415,Cho tôi xem danh sách sản phẩm Children bán chạy nhất ở MO.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'MO'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
151,Thống kê xem có bao nhiêu bà nội trợ (nữ) đi mua đồ nam (category = 'Men') tại hệ thống cửa hàng.,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_gender = 'F' AND i.i_category = 'Men';"
711,Cửa hàng nào ở KS đứng đầu về doanh số Music vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'KS'
  AND i.i_category = 'Music'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
797,Tổng doanh thu của Home tại bang IA năm 2001 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2001;"
551,Doanh số của Sports tại VA năm 2002 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'VA' AND d.d_year = 2002
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Sports' AND ca.ca_state = 'VA' AND d.d_year = 2001
)
SELECT 
    2002 as current_year,
    cy.revenue as current_revenue,
    2001 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
489,Cửa hàng nào ở MO đứng đầu về doanh số Books vào tháng 6?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'MO'
  AND i.i_category = 'Books'
  AND d.d_moy = 6
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
148,Tôi muốn biết đơn vị đo lường (units) nào của sản phẩm là phổ biến nhất,"SELECT i_units, COUNT(*) AS count
FROM item
GROUP BY i_units
ORDER BY count DESC;"
147,Tính tổng doanh thu bán đồ điện tử cho nhóm khách hàng có xếp hạng tín dụng 'Good'.,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Electronics' AND cd.cd_credit_rating = 'Good';"
652,Tổng doanh thu của Shoes tại bang KY năm 2002 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2002;"
834,So sánh lợi nhuận của Books giữa kênh Store và Web tại TX.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
667,"Trong năm 2001, khách hàng ở KS mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
349,Tìm 5 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
464,Giá bán trung bình của mặt hàng Electronics trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics'
  AND d.d_year = 2000
GROUP BY i.i_category;"
326,Check giùm tôi tồn kho của Shoes ở chi nhánh TX.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND w.w_state = 'TX'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
187,Liệt kê danh sách các trang Catalog có chứa nhiều hơn 50 sản phẩm khác nhau và sắp xếp theo số lượng giảm dần.,"SELECT cp.cp_catalog_page_number, COUNT(DISTINCT cs_item_sk) AS item_count
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
GROUP BY cp.cp_catalog_page_number
ORDER BY item_count DESC;"
124,Tìm mấy ông khách hàng sinh năm 1980 sống ở bang California (CA) mà có trên 2 xe ô tô.,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
WHERE c.c_birth_year = 1980 AND ca.ca_state = 'CA' AND hd.hd_vehicle_count > 2;"
766,Check giùm tôi tồn kho của Women ở chi nhánh GA.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND w.w_state = 'GA'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
609,Tỷ lệ trả hàng của Jewelry ở IL có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'IL'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Jewelry' as category,
  'IL' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
144,"Trong quý 2 năm 2001, loại hàng nào mang lại lợi nhuận thực tế (ss_net_profit) dương cao nhất?","SELECT i.i_category, SUM(ss.ss_net_profit) AS total_profit
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2
GROUP BY i.i_category
ORDER BY total_profit DESC LIMIT 1;"
860,Năm ngoái dân ở NC mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
198,Bạn hãy kiểm tra giúp tôi xem trang Catalog số một có chứa bao nhiêu mặt hàng thuộc danh mục sách và tổng giá trị của những mặt hàng đó là bao nhiêu,"SELECT COUNT(cs.cs_item_sk), SUM(cs.cs_sales_price)
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cp.cp_catalog_page_number = 1 AND i.i_category = 'Books';"
610,Cửa hàng nào ở MO đứng đầu về doanh số Men vào tháng 12?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'MO'
  AND i.i_category = 'Men'
  AND d.d_moy = 12
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
280,Hãy liệt kê tên các Website đã từng bán mặt hàng 'Sports' cho khách hàng có trình độ học vấn là 'College' tại bang 'Iowa',"SELECT DISTINCT web.web_name
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND cd.cd_education_status = 'College' AND ca.ca_state = 'IA';"
294,Bạn hãy liệt kê tên các khách hàng đã từng mua đồ 'Electronics' qua kênh Web nhưng cũng đồng thời thực hiện mua hàng trực tiếp tại các cửa hàng ở bang 'Texas'.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
  AND c.c_customer_sk IN (SELECT ws_bill_customer_sk FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics')
  AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics');"
401,Khách hàng có bằng Secondary tại VA thường mua Women qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'VA'
      AND i.i_category = 'Women'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
123,Thống kê cho tôi xem danh sách khách hàng nam hay nữ hay đi mua sắm  vào ngày Thứ Bảy trong tuần?,"SELECT cd.cd_gender, COUNT(*) AS visit_count
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_day_name = 'Saturday'
GROUP BY cd.cd_gender;"
184,Bạn hãy thống kê giúp tôi lượng hàng tồn kho của danh mục đồ điện tử tại kho hàng ở thành phố San Jose vào ngày đầu năm 2001,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' 
  AND w.w_city = 'San Jose' 
  AND d.d_date = '2001-01-01';"
203,"Bạn hãy tìm tên của những khách hàng vừa có giao dịch mua hàng tại cửa hàng, vừa thực hiện trả hàng thông qua kênh trực tuyến Web trong cùng một quý.","SELECT DISTINCT c.c_first_name, c.c_last_name
FROM customer c
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk
JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk
JOIN date_dim d1 ON ss.ss_sold_date_sk = d1.d_date_sk
JOIN date_dim d2 ON wr.wr_returned_date_sk = d2.d_date_sk
WHERE d1.d_year = d2.d_year AND d1.d_qoy = d2.d_qoy;"
439,So sánh lợi nhuận của Electronics giữa kênh Store và Catalog tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel;"
247,Bạn hãy so sánh lợi nhuận ròng giữa hai phương thức vận chuyển REGULAR và EXPRESS đối với các mặt hàng danh mục Home được bán trên kênh Web trong suốt năm 2001,"SELECT sm.sm_type, SUM(ws.ws_net_profit) AS total_profit
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' 
  AND sm.sm_type IN ('REGULAR', 'EXPRESS') 
  AND d.d_year = 2001
GROUP BY sm.sm_type;"
416,Giá bán trung bình của mặt hàng Shoes trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2001
GROUP BY i.i_category;"
796,Liệt kê 10 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở IA.,"SELECT 
  i.i_brand,
  i.i_category,
  COUNT(*) as purchase_count,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_brand, i.i_category
 ORDER BY purchase_count DESC
 LIMIT 10;"
130,Tôi muốn xem doanh thu theo từng khung giờ trong ngày tại cửa hàng 'Northwest',"SELECT t.t_hour, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE s.s_store_name = 'Northwest'
GROUP BY t.t_hour
ORDER BY t_hour;"
638,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;"
403,Giá bán trung bình của mặt hàng Men trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 2002
GROUP BY i.i_category;"
707,Thống kê tổng số lượng Music được mua bởi những khách hàng có trình độ Primary.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Music'
  AND cd.cd_education_status = 'Primary'
 GROUP BY cd.cd_education_status, i.i_category;"
695,Tổng doanh thu của Jewelry tại bang TX năm 2000 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2000;"
818,"Hàng Home trả lại ở IA có nhiều không, xem số liệu năm 2000 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
220,Hãy xác định xem mặt hàng nào là sản phẩm được mua nhiều thứ hai bởi khách hàng có mã số 188 dựa trên số lượng sản phẩm.,"SELECT * FROM (
    SELECT ss_item_sk, ss_quantity,
           ROW_NUMBER() OVER (ORDER BY ss_quantity DESC) AS item_seq
    FROM store_sales
    WHERE ss_customer_sk = 188
) tmp WHERE item_seq = 2;"
642,Tỷ lệ trả hàng của Shoes ở TX có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'TX'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Shoes' as category,
  'TX' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
820,Ai mua đồ Children nhiều nhất ở IL vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
678,Ai mua đồ Women nhiều nhất ở IL vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
823,"Trong năm 2002, khách hàng ở VA mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;"
625,Cửa hàng nào ở VA đứng đầu về doanh số Women vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'VA'
  AND i.i_category = 'Women'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
754,Tìm 10 sản phẩm Children có lợi nhuận thấp nhất trong năm 2001.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND d.d_year = 2001
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
686,"Trong quý 4 năm 1999, nhóm khách hàng Primary chi bao nhiêu tiền cho Children?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Primary'
  AND i.i_category = 'Children'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
387,Doanh số của Electronics tại IA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
873,Tổng doanh thu của Music tại bang KY năm 2001 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2001;"
510,Check giùm tôi tồn kho của Home ở chi nhánh KS.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND w.w_state = 'KS'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
268,Hãy so sánh tổng lượng hàng tồn của danh mục 'Home' tại các kho phục vụ phương thức vận chuyển 'EXPRESS' so với phương thức 'REGULAR,"SELECT sm.sm_type, SUM(inv.inv_quantity_on_hand) AS total_inventory
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
WHERE i.i_category = 'Home' AND sm.sm_type IN ('EXPRESS', 'REGULAR')
GROUP BY sm.sm_type;"
755,Doanh số của Electronics tại IA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1999
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'IA' AND d.d_year = 1998
 )
 SELECT 
  1999 as current_year,
  cy.revenue as current_revenue,
  1998 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
442,Cho tôi biết top 3 khách hàng chi tiêu nhiều nhất cho mặt hàng Books tại GA.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'GA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 3;"
497,Khách hàng có bằng 4 yr Degree tại IA thường mua Men qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'IA'
      AND i.i_category = 'Men'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
113,Liệt kê 5 thành phố có số lượng khách hàng nữ sinh sống đông nhất.,"SELECT ca.ca_city, COUNT(*) AS female_count
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'F'
GROUP BY ca.ca_city
ORDER BY female_count DESC LIMIT 5;"
233,Hãy cho tôi biết tổng lợi nhuận thu được từ các sản phẩm màu xanh dương được bán tại hệ thống cửa hàng cho các khách hàng độc thân,"SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE i.i_color = 'blue' AND cd.cd_marital_status = 'S';"
781,Doanh số của Shoes tại IA năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IA' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'IA' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
608,Doanh số của Electronics tại KS năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Electronics' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
672,"Trong năm 2001, khách hàng ở GA mua nhiều Women không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Women'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
374,Năm ngoái dân ở IL mua Children nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
882,Năm 1999 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 1999
 GROUP BY d.d_year;"
758,"Hàng Home trả lại ở TX có nhiều không, xem số liệu năm 2001 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
234,Hãy liệt kê tên và mã địa chỉ của năm khách hàng có số lượng người phụ thuộc đang đi làm lớn hơn hai và hiện đang sống ở bang California,"SELECT c.c_first_name, ca.ca_address_id
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_dep_employed_count > 2 AND ca.ca_state = 'CA'
LIMIT 5;"
708,Tìm 10 sản phẩm Electronics có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 10;"
677,"Trong năm 2001, khách hàng ở GA mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
318,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Home tại TX.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'TX'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10;"
649,Tìm email của các khách hàng VIP ở NC đã mua đồ Music trên 10000 đô.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Music'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 HAVING SUM(ss.ss_net_paid) > 10000
 ORDER BY total_spent DESC;"
411,Doanh số của Men tại VA năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'VA' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
874,Cửa hàng nào ở KS đứng đầu về doanh số Books vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'KS'
  AND i.i_category = 'Books'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
359,Tỷ lệ trả hàng của Men ở GA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'GA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Men' as category,
    'GA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
259,Bạn hãy liệt kê tên các sản phẩm thuộc danh mục Children và số lượng tồn kho hiện tại,"SELECT i.i_item_desc, inv.inv_quantity_on_hand
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
LIMIT 10;"
628,Giá bán trung bình của mặt hàng Women trong năm 2002 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Women'
  AND d.d_year = 2002
 GROUP BY i.i_category;"
633,"Trong năm 2001, khách hàng ở MO mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'MO'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
 GROUP BY ca.ca_state, i.i_category;"
283,Bạn hãy hiển thị tên Website và mã số thuế của nó nếu Website đó đã từng bán đồ 'Women' cho khách hàng ở 'Virginia' có trên hai người phụ thuộc,"SELECT DISTINCT web.web_name, web.web_tax_percentage
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Women' AND ca.ca_state = 'VA' AND cd.cd_dep_count > 2;"
377,"Trong quý 4 năm 1999, nhóm khách hàng Primary chi bao nhiêu tiền cho Men?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
385,"Hàng Home trả lại ở IA có nhiều không, xem số liệu năm 2002 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year;"
225,Bạn hãy xếp hạng các kho hàng dựa trên tổng lượng hàng tồn kho của sản phẩm có màu xanh dương hiện đang có mặt trong hệ thống kho bãi,"SELECT w_warehouse_name, total_qty,
       RANK() OVER (ORDER BY total_qty DESC) AS stock_rank
FROM (
    SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_qty
    FROM inventory inv
    JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
    JOIN item i ON inv.inv_item_sk = i.i_item_sk
    WHERE i.i_color = 'blue'
    GROUP BY w.w_warehouse_name
) tmp;"
855,Tìm 5 sản phẩm Children có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Children'
  AND d.d_year = 2000
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;"
737,Cửa hàng nào ở IA đứng đầu về doanh số Sports vào tháng 6?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'IA'
  AND i.i_category = 'Sports'
  AND d.d_moy = 6
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
473,"Hàng Women trả lại ở IL có nhiều không, xem số liệu năm 1999 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IL'
  AND d.d_year = 1999
GROUP BY i.i_category, ca.ca_state, d.d_year;"
348,Tổng doanh thu của Women tại bang IA năm 2000 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IA'
  AND d.d_year = 2000;"
506,Tìm 5 sản phẩm Children có lợi nhuận thấp nhất trong năm 2000.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 2000
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 5;"
640,Giá bán trung bình của mặt hàng Music trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 1999
 GROUP BY i.i_category;"
888,"Năm 2000, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
850,Cửa hàng nào ở NC đứng đầu về doanh số Music vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'NC'
  AND i.i_category = 'Music'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
811,Năm ngoái dân ở KS mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KS'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
620,Cửa hàng nào ở VA đứng đầu về doanh số Home vào tháng 1?,"SELECT 
  s.s_store_name,
  s.s_city,
  s.s_state,
  SUM(ss.ss_net_paid) as total_sales
 FROM store_sales ss
 JOIN store s ON ss.ss_store_sk = s.s_store_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE s.s_state = 'VA'
  AND i.i_category = 'Home'
  AND d.d_moy = 1
 GROUP BY s.s_store_name, s.s_city, s.s_state
 ORDER BY total_sales DESC
 LIMIT 1;"
768,Năm ngoái dân ở IA mua Music nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Music'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
646,Có bao nhiêu đơn hàng Electronics bị trả lại tại MO vào năm 2002?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'MO'
  AND d.d_year = 2002;"
761,"Trong năm 2002, khách hàng ở KY mua nhiều Home không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Home'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;"
557,Giá bán trung bình của mặt hàng Music trong năm 2002 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music'
  AND d.d_year = 2002
GROUP BY i.i_category;"
859,Năm ngoái dân ở KY mua Jewelry nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
578,"Trong năm 2000, khách hàng ở NC mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = 2000
GROUP BY ca.ca_state, i.i_category;"
86,Tìm xem có khách hàng nào đã mua cùng một món đồ ở cả hai kênh Store và Web không.,"SELECT DISTINCT c.c_first_name, i.i_item_desc
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE EXISTS (
    SELECT 1 FROM web_sales ws 
    WHERE ws.ws_bill_customer_sk = c.c_customer_sk 
    AND ws.ws_item_sk = i.i_item_sk
);"
243,Hãy cho tôi biết mức chi tiêu trung bình cho các mặt hàng thời trang Women của những khách hàng nữ có trình độ học vấn là Tiến sĩ khi họ mua sắm trực tuyến trên hệ thống Web,"SELECT AVG(ws.ws_sales_price)
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
WHERE i.i_category = 'Women' AND cd.cd_gender = 'F' AND cd.cd_education_status = 'Advanced Degree';"
699,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Sports tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 10;"
160,Lọc ra mấy khách hàng chỉ đi mua trang sức (Jewelry) vào đúng hai ngày Thứ Bảy và Chủ Nhật.,"SELECT DISTINCT c.c_first_name, c.c_last_name
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_day_name IN ('Saturday', 'Sunday');"
525,Doanh số của Home tại TX năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'TX' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Home' AND ca.ca_state = 'TX' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
36,Tìm thông tin những người hiện tại đang có tình trạng hôn nhân là độc thân,SELECT * FROM customer_demographics WHERE cd_marital_status = 'S';
541,"Trong năm 2001, khách hàng ở TX mua nhiều Men không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Men'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
171,Phương thức vận chuyển nào mang lại lợi nhuận Web cao nhất cho các đơn hàng gửi đến 'Texas'?,"SELECT sm.sm_type, SUM(ws.ws_net_profit) AS total_profit
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
GROUP BY sm.sm_type
ORDER BY total_profit DESC LIMIT 1;"
655,"Hàng Home trả lại ở NC có nhiều không, xem số liệu năm 2002 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
  AND d.d_year = 2002
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
878,Giá bán trung bình của mặt hàng Sports trong năm 2000 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Sports'
  AND d.d_year = 2000
 GROUP BY i.i_category;"
762,Ai mua đồ Shoes nhiều nhất ở VA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'VA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
847,So sánh lợi nhuận của Shoes giữa kênh Store và Web tại MO.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Shoes' AND ca.ca_state = 'MO'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
734,"Trong quý 4 năm 1999, nhóm khách hàng Secondary chi bao nhiêu tiền cho Men?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
96,Liệt kê 5 mặt hàng có doanh số bán ra cao nhất trong các ngày lễ (Holiday = 'Y') của năm 2001.,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS holiday_sales
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_holiday = 'Y' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY holiday_sales DESC
LIMIT 5;"
564,Khách hàng có bằng Advanced Degree tại KY thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KY'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
241,Hãy thống kê số lượng đơn hàng Catalog được đặt trong khung giờ từ tám giờ tối đến mười giờ đêm bởi những khách hàng cư trú tại bang California,"SELECT COUNT(*)
FROM catalog_sales cs
JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk
JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk
WHERE t.t_hour BETWEEN 20 AND 22 
  AND ca.ca_state = 'CA';"
575,"Hàng Children trả lại ở KS có nhiều không, xem số liệu năm 2002 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KS'
  AND d.d_year = 2002
GROUP BY i.i_category, ca.ca_state, d.d_year;"
691,"Năm 2002, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
461,Năm 1999 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY d.d_year;"
554,Có bao nhiêu đơn hàng Men bị trả lại tại KY vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2000;"
787,So sánh lợi nhuận của Women giữa kênh Store và Web tại IA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'IA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
207,"Hãy liệt kê cho tôi năm thương hiệu sản phẩm có tổng doanh thu cao nhất vào khung giờ buổi sáng, cụ thể là từ tám giờ sáng đến mười hai giờ trưa tại hệ thống cửa hàng","SELECT i.i_brand, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN time_dim t ON ss.ss_sold_time_sk = t.t_time_sk
WHERE t.t_hour BETWEEN 8 AND 12
GROUP BY i.i_brand
ORDER BY revenue DESC LIMIT 5;"
393,Năm 2000 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
    d.d_year,
    'Web' as channel,
    SUM(ws.ws_net_paid) as total_revenue,
    COUNT(*) as total_transactions
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_year;"
398,Tỷ lệ trả hàng của Women ở VA có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'VA'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Women' as category,
    'VA' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
763,"Năm 1999, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
218,Hãy giúp tôi tìm ra ba khách hàng có mức chi tiêu cao nhất tại mỗi tiểu bang và hiển thị thứ hạng của họ dựa trên tổng doanh thu bán hàng qua hệ thống Web,"SELECT * FROM (
    SELECT ca.ca_state, c.c_first_name, SUM(ws.ws_sales_price) AS total_spent,
           DENSE_RANK() OVER (PARTITION BY ca.ca_state ORDER BY SUM(ws.ws_sales_price) DESC) AS rank
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    GROUP BY ca.ca_state, c.c_customer_sk, c.c_first_name
) tmp WHERE rank <= 3;"
5,Đếm tổng số lượng khách hàng trong bảng,"SELECT COUNT(*) AS total_customers 
FROM customer;"
643,"Trong năm 2000, khách hàng ở GA mua nhiều Children không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Children'
  AND d.d_year = 2000
 GROUP BY ca.ca_state, i.i_category;"
805,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ 4 yr Degree.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Books'
  AND cd.cd_education_status = '4 yr Degree'
 GROUP BY cd.cd_education_status, i.i_category;"
613,Có bao nhiêu đơn hàng Men bị trả lại tại TX vào năm 1999?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'TX'
  AND d.d_year = 1999;"
739,Tìm 5 sản phẩm Shoes có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND d.d_year = 1999
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;"
547,Tìm email của các khách hàng VIP ở KY đã mua đồ Sports trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
726,Ai mua đồ Electronics nhiều nhất ở GA vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
684,Khách hàng có bằng 4 yr Degree tại IA thường mua Music qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IA'
  AND i.i_category = 'Music'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
99,Có bao nhiêu khách hàng độc thân đã từng mua hàng qua kênh Catalog trong năm 2002?,"SELECT COUNT(DISTINCT c.c_customer_sk)
FROM catalog_sales cs
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE cd.cd_marital_status = 'S' AND d.d_year = 2002;"
728,Giá bán trung bình của mặt hàng Men trong năm 1999 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Men'
  AND d.d_year = 1999
 GROUP BY i.i_category;"
574,"Năm 2002, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
web_rev AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
    FROM web_sales ws
    JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
),
catalog_rev AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
    FROM catalog_sales cs
    JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
)
SELECT * FROM store_rev
UNION ALL SELECT * FROM web_rev
UNION ALL SELECT * FROM catalog_rev
ORDER BY revenue DESC;"
407,Tìm 10 sản phẩm Men có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
503,Khách hàng có bằng Advanced Degree tại KS thường mua Home qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Advanced Degree'
      AND ca.ca_state = 'KS'
      AND i.i_category = 'Home'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
48,Liệt kê mã định danh của những khách hàng đã lập gia đình và có ít nhất hai người con hiện đang theo học  cao đẳng,SELECT c_customer_id FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'M' AND cd_dep_college_count >= 2;
33,Hiển thị tên khách hàng ở New York đã từng mua loại sản phẩm có tên bắt đầu bằng chữ Smart,"SELECT DISTINCT c_first_name, c_last_name 
FROM customer 
JOIN customer_address ON c_current_addr_sk = ca_address_sk 
JOIN store_sales ON c_customer_sk = ss_customer_sk 
JOIN item ON ss_item_sk = i_item_sk 
WHERE ca_city = 'New York' AND i_product_name LIKE 'Smart%';"
201,Bạn hãy tính tổng số tiền mặt đã hoàn trả cho khách hàng khi họ thực hiện trả hàng tại các cửa hàng vật lý trong suốt tháng mười hai năm 2002,"SELECT SUM(sr.sr_refunded_cash)
FROM store_returns sr
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_moy = 12;"
135,Liệt kê 5 cửa hàng có số lượng nhân viên đông nhất và tổng doanh thu của họ trong quý 1.,"SELECT s.s_store_name, s.s_number_employees, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_qoy = 1
GROUP BY s.s_store_name, s.s_number_employees
ORDER BY s.s_number_employees DESC
LIMIT 5;"
28,Thống kê xem có bao nhiêu khách hàng trong hệ thống của chúng ta sinh ra tại quốc gia Mỹ,SELECT COUNT(*) FROM customer WHERE c_birth_country = 'UNITED STATES';
789,"Trong quý 4 năm 1999, nhóm khách hàng College chi bao nhiêu tiền cho Jewelry?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Jewelry'
  AND d.d_year = 1999
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
231,Bạn hãy tính tổng số tiền chiết khấu đã được áp dụng cho những khách hàng nam hiện đang sinh sống tại khu vực có múi giờ âm bảy,"SELECT SUM(ss.ss_ext_discount_amt)
FROM store_sales ss
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_gender = 'M' AND ca.ca_gmt_offset = -7.00;"
490,Ai mua đồ Sports nhiều nhất ở KY vậy?,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_quantity DESC
LIMIT 1;"
379,Cửa hàng nào ở NC đứng đầu về doanh số Men vào tháng 1?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NC'
  AND i.i_category = 'Men'
  AND d.d_moy = 1
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
289,Hiển thị tên Website và mã số thuế của nó nếu Website đó đã bán hàng Sports cho những hộ gia đình sở hữu trên ba xe ô tô,"SELECT DISTINCT web.web_name, web.web_tax_percentage
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN household_demographics hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports' AND hd.hd_vehicle_count > 3;"
419,Tổng doanh thu của Sports tại bang IA năm 1999 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'IA'
  AND d.d_year = 1999;"
675,Check giùm tôi tồn kho của Men ở chi nhánh VA.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND w.w_state = 'VA'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
392,Tìm 10 sản phẩm Children có lợi nhuận thấp nhất trong năm 1999.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_category,
    SUM(ss.ss_net_profit) as total_profit,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND d.d_year = 1999
GROUP BY i.i_item_id, i.i_product_name, i.i_category
ORDER BY total_profit ASC
LIMIT 10;"
593,Liệt kê 3 thương hiệu Music được ưa chuộng nhất bởi khách hàng ở KY.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3;"
499,Tìm email của các khách hàng VIP ở GA đã mua đồ Sports trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'GA'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
139,Tìm tên các nhà sản xuất (manufacturer) có sản phẩm bị khách hàng trả lại nhiều hơn 100 lần trên Web.,"SELECT i.i_manufact, COUNT(*) AS return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
GROUP BY i.i_manufact
HAVING return_count > 100;"
63,Tìm các khách hàng ở bang 'CA' đã mua hàng trong cả hai năm 2000 và 2001,"SELECT c.c_first_name, c.c_last_name
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'CA'
AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2000)
AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2001);"
472,Khách hàng có bằng 4 yr Degree tại TX thường mua Children qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = '4 yr Degree'
      AND ca.ca_state = 'TX'
      AND i.i_category = 'Children'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
648,"Hàng Music trả lại ở KY có nhiều không, xem số liệu năm 2001 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KY'
  AND d.d_year = 2001
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
129,Hãy thống kê xem các trang Catalog có mô tả chi tiết thường mang lại doanh số cao hơn bao nhiêu so với các trang thông thường,"SELECT cp.cp_description, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk
GROUP BY cp.cp_description;"
877,Khách hàng có bằng 2 yr Degree tại VA thường mua Women qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '2 yr Degree'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Women'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
521,Cho tôi biết top 10 khách hàng chi tiêu nhiều nhất cho mặt hàng Home tại MO.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'MO'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 10;"
65,Tìm khách hàng có thu nhập cao (trên 150.000) nhưng chỉ sở hữu tối đa 1 xe ô tô.,"SELECT c.c_first_name, c.c_last_name, ib.ib_upper_bound, hd.hd_vehicle_count
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk
WHERE ib.ib_upper_bound > 150000 AND hd.hd_vehicle_count <= 1;"
15,Những khách hàng nào có danh xưng là Tiến sĩ?,SELECT * FROM customer WHERE c_salutation = 'Dr.';
157,Tính tổng doanh thu từ các cửa hàng siêu lớn (diện tích trên 5 triệu feet vuông) trong quý 4.,"SELECT s.s_store_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_floor_space > 5000000 AND d.d_qoy = 4
GROUP BY s.s_store_name;"
41,Lọc ra tất cả những khách hàng là nam giới và hiện tại đang có xếp hạng tín dụng ở mức thấp để bộ phận chăm sóc kiểm tra lại,"SELECT * FROM customer_demographics 
WHERE cd_gender = 'M' AND cd_credit_rating = 'Low';"
493,Cửa hàng nào ở IA đứng đầu về doanh số Shoes vào tháng 12?,"SELECT 
    s.s_store_name,
    s.s_city,
    s.s_state,
    SUM(ss.ss_net_paid) as total_sales
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA'
  AND i.i_category = 'Shoes'
  AND d.d_moy = 12
GROUP BY s.s_store_name, s.s_city, s.s_state
ORDER BY total_sales DESC
LIMIT 1;"
380,Có bao nhiêu đơn hàng Women bị trả lại tại VA vào năm 2000?,"SELECT 
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'VA'
  AND d.d_year = 2000;"
188,Xác định phương thức vận chuyển nào thường được sử dụng nhiều nhất cho các đơn hàng từ Web gửi đến khách hàng ở bang Texas,"SELECT sm.sm_type, COUNT(*) AS usage_count
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk
WHERE ca.ca_state = 'TX'
GROUP BY sm.sm_type
ORDER BY usage_count DESC LIMIT 1;"
764,"Năm 2000, doanh thu từ kênh Catalog cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2000
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
217,Hãy tìm lợi nhuận thu được từ những người đàn ông đã ly hôn khi họ mua đồ điện tử thông qua kênh bán hàng Catalog của công ty,"SELECT SUM(cs.cs_net_profit)
FROM catalog_sales cs
JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON cs.cs_item_sk = i.i_item_sk
WHERE cd.cd_gender = 'M' AND cd.cd_marital_status = 'D' AND i.i_category = 'Electronics';"
792,Có bao nhiêu đơn hàng Electronics bị trả lại tại IL vào năm 2001?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2001;"
53,Hiển thị tên khách hàng và trình độ học vấn của họ.,"SELECT c.c_first_name, cd.cd_education_status 
FROM customer c 
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk;"
338,Cho tôi xem danh sách sản phẩm Music bán chạy nhất ở KS.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
  AND ca.ca_state = 'KS'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
749,Check giùm tôi tồn kho của Home ở chi nhánh IA.,"SELECT 
  w.w_warehouse_name,
  w.w_state,
  i.i_category,
  SUM(inv.inv_quantity_on_hand) as total_inventory
 FROM inventory inv
 JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
 JOIN item i ON inv.inv_item_sk = i.i_item_sk
 WHERE i.i_category = 'Home'
  AND w.w_state = 'IA'
 GROUP BY w.w_warehouse_name, w.w_state, i.i_category
 ORDER BY total_inventory DESC;"
720,"Trong quý 4 năm 2001, nhóm khách hàng Secondary chi bao nhiêu tiền cho Home?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Home'
  AND d.d_year = 2001
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
725,"Năm 2002, doanh thu từ kênh Web cao hơn hay thấp hơn kênh Catalog?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 2002
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
296,Tìm tên các Website đã bán đồ 'Women' cho khách hàng có xếp hạng tín dụng 'Good' thông qua phương thức vận chuyển 'OVERNIGHT' mà đơn hàng đó sau này bị trả lại.,"SELECT DISTINCT web.web_name
FROM web_sales ws
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Women' AND sm.sm_type = 'OVERNIGHT' AND cd.cd_credit_rating = 'Good';"
702,Cho tôi xem danh sách sản phẩm Children bán chạy nhất ở KY.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
252,Hãy thống kê tổng số tiền hoàn lại cho những khách hàng sống tại các ngôi nhà dành cho một gia đình khi họ trả lại các mặt hàng Sports được giao bằng phương thức REGULAR,"SELECT SUM(wr.wr_refunded_cash)
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
JOIN web_sales ws ON wr.wr_item_sk = ws.ws_item_sk AND wr.wr_order_number = ws.ws_order_number
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN customer_address ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk
WHERE i.i_category = 'Sports' 
  AND sm.sm_type = 'REGULAR' 
  AND ca.ca_location_type = 'single family';"
727,"Trong quý 4 năm 2000, nhóm khách hàng College chi bao nhiêu tiền cho Children?","SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE cd.cd_education_status = 'College'
  AND i.i_category = 'Children'
  AND d.d_year = 2000
  AND d.d_qoy = 4
 GROUP BY cd.cd_education_status, i.i_category;"
462,So sánh lợi nhuận của Books giữa kênh Store và Web tại MO.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Books' AND ca.ca_state = 'MO'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
ORDER BY channel;"
456,Cho tôi xem danh sách sản phẩm Books bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
897,Giá bán trung bình của mặt hàng Music trong năm 2001 là bao nhiêu?,"SELECT 
  i.i_category,
  AVG(ss.ss_sales_price) as avg_sales_price,
  MIN(ss.ss_sales_price) as min_sales_price,
  MAX(ss.ss_sales_price) as max_sales_price
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Music'
  AND d.d_year = 2001
 GROUP BY i.i_category;"
270,Bạn hãy liệt kê năm nhà sản xuất có lượng hàng tồn kho danh mục 'Children' bị sụt giảm nhiều nhất khi so sánh giữa quý 3 và quý 4 năm 2002,"SELECT i.i_manufact, 
       SUM(CASE WHEN d.d_qoy = 3 THEN inv.inv_quantity_on_hand ELSE 0 END) - 
       SUM(CASE WHEN d.d_qoy = 4 THEN inv.inv_quantity_on_hand ELSE 0 END) AS stock_reduction
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_manufact
ORDER BY stock_reduction DESC LIMIT 5;"
202,Bạn hãy liệt kê năm mặt hàng có tần suất bị trả lại cao nhất tại các kho hàng nằm ở khu vực miền Tây do gặp sự cố hư hỏng trong lúc vận chuyển,"SELECT i.i_item_desc, COUNT(*) AS return_count
FROM store_returns sr
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN warehouse w ON sr.sr_store_sk = w.w_warehouse_sk -- Giả định liên kết qua store_sk
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
WHERE r.r_reason_desc ILIKE '%damaged%'
GROUP BY i.i_item_desc
ORDER BY return_count DESC LIMIT 5;"
162,Trung tâm hỗ trợ (Call Center) nào ở thành phố 'New York' mang về nhiều doanh thu Catalog nhất?,"SELECT cc.cc_name, SUM(cs.cs_sales_price) AS revenue
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
WHERE cc.cc_city = 'New York'
GROUP BY cc.cc_name
ORDER BY revenue DESC LIMIT 1;"
556,"Trong quý 4 năm 2001, nhóm khách hàng Secondary chi bao nhiêu tiền cho Books?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
730,"Hàng Shoes trả lại ở IL có nhiều không, xem số liệu năm 2000 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'IL'
  AND d.d_year = 2000
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
402,Tìm email của các khách hàng VIP ở TX đã mua đồ Sports trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;"
703,Năm 2001 thì kênh Store mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Store' as channel,
  SUM(ss.ss_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2001
 GROUP BY d.d_year;"
477,Tìm email của các khách hàng VIP ở TX đã mua đồ Women trên 5000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Women'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 5000
ORDER BY total_spent DESC;"
772,Doanh số của Jewelry tại NC năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'NC' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Jewelry' AND ca.ca_state = 'NC' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
106,Liệt kê 5 mặt hàng có giá niêm yết (current price) cao nhất thuộc danh mục 'Books' (Sách).,"SELECT i_item_desc, i_current_price
FROM item
WHERE i_category = 'Books'
ORDER BY i_current_price DESC LIMIT 5;"
566,Thống kê tổng số lượng Books được mua bởi những khách hàng có trình độ Advanced Degree.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
  AND cd.cd_education_status = 'Advanced Degree'
GROUP BY cd.cd_education_status, i.i_category;"
390,"Trong năm 2001, khách hàng ở VA mua nhiều Music không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Music'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
2,Tìm URL của những trang web page đã bán đồ 'Women' cho khách hàng có xếp hạng tín dụng 'Good' thông qua hệ thống Website có ngày hoạt động sớm nhất.,"SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN web_site web ON ws.ws_web_site_sk = web.web_site_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Women' AND cd.cd_credit_rating = 'Good'
  AND web.web_rec_start_date = (SELECT MIN(web_rec_start_date) FROM web_site);"
840,Năm ngoái dân ở IL mua Shoes nhiều hay ít?,"SELECT 
  d.d_year,
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue,
  AVG(ss.ss_net_paid) as avg_transaction_value
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
 GROUP BY d.d_year, ca.ca_state, i.i_category;"
562,Tỷ lệ trả hàng của Women ở NC có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Women' AND ca.ca_state = 'NC'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Women' as category,
    'NC' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
81,Cho tôi biết tên 5 khách hàng nữ chi tiêu 'mạnh tay' nhất cho đồ điện tử trong năm 2002,"SELECT c.c_first_name, SUM(ss.ss_sales_price) AS electronics_spend
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'F' 
  AND i.i_category = 'Electronics' 
  AND d.d_year = 2002
GROUP BY c.c_customer_sk, c.c_first_name
ORDER BY electronics_spend DESC
LIMIT 5;"
206,Tính  giúp tôi tổng số tiền thuế mà các khách hàng có trình độ học vấn cao đã chi trả cho việc mua sắm trên mạng vào những ngày cuối tuần.,"SELECT SUM(ws.ws_ext_tax)
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_weekend = 'Y';"
35,Liệt kê tất cả những khách hàng nào đã có trình độ học vấn là tiến sĩ PhD,"SELECT * FROM customer_demographics 
WHERE cd_education_status = 'PhD';"
776,Năm 2000 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2000
 GROUP BY d.d_year;"
509,Thống kê tổng số lượng Electronics được mua bởi những khách hàng có trình độ Secondary.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND cd.cd_education_status = 'Secondary'
GROUP BY cd.cd_education_status, i.i_category;"
428,So sánh lợi nhuận của Children giữa kênh Web và Web tại KY.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'KY'
)
SELECT * FROM store_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Web', 'Web')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Web', 'Web')
ORDER BY channel;"
455,Tỷ lệ trả hàng của Children ở TX có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'TX'
),
system_average AS (
    SELECT 
        COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
    FROM store_sales ss
    LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
)
SELECT 
    'Children' as category,
    'TX' as state,
    csr.return_rate as category_state_return_rate,
    sa.avg_return_rate as system_average_return_rate,
    CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
FROM category_state_returns csr, system_average sa;"
367,Tổng doanh thu của Women tại bang TX năm 2001 là bao nhiêu?,"SELECT 
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women'
  AND ca.ca_state = 'TX'
  AND d.d_year = 2001;"
92,"Liệt kê các khách hàng đã mua hàng liên tiếp trong cả 3 năm 2000, 2001 và 2002 tại kênh Store.","SELECT c.c_first_name, c.c_last_name
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
  AND EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
  AND EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
340,Check giùm tôi tồn kho của Electronics ở chi nhánh IL.,"SELECT 
    w.w_warehouse_name,
    w.w_state,
    i.i_category,
    SUM(inv.inv_quantity_on_hand) as total_inventory
FROM inventory inv
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON inv.inv_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
  AND w.w_state = 'IL'
GROUP BY w.w_warehouse_name, w.w_state, i.i_category
ORDER BY total_inventory DESC;"
565,Liệt kê 3 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở IL.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'IL'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 3;"
346,Năm ngoái dân ở TX mua Sports nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Sports'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
777,Doanh số của Music tại KY năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Music' AND ca.ca_state = 'KY' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
242,Bạn hãy thống kê giúp tôi tổng doanh thu của các sản phẩm thuộc danh mục Music được bán tại hệ thống cửa hàng cho các khách hàng đang cư trú tại bang Texas trong suốt năm 2001,"SELECT SUM(ss.ss_sales_price)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND ca.ca_state = 'TX' AND d.d_year = 2001;"
14,Cho tôi xem 10 khách hàng trẻ tuổi nhất ,SELECT TOP 10 * FROM customer ORDER BY c_birth_year DESC;
316,Tìm email của các khách hàng VIP ở IA đã mua đồ Electronics trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Electronics'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
601,Tổng doanh thu của Home tại bang NC năm 1999 là bao nhiêu?,"SELECT 
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Home'
  AND ca.ca_state = 'NC'
  AND d.d_year = 1999;"
388,"Trong quý 4 năm 2000, nhóm khách hàng Advanced Degree chi bao nhiêu tiền cho Sports?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree'
  AND i.i_category = 'Sports'
  AND d.d_year = 2000
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
274,Hãy hiển thị danh sách các trang web page có chứa hình ảnh minh họa và đã từng bán các mặt hàng Jewelry cho khách hàng có trình độ học vấn là Tiến sĩ.,"SELECT DISTINCT wp.wp_url
FROM web_sales ws
JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry' AND cd.cd_education_status = 'Advanced Degree' AND wp.wp_image_count > 0;"
167,Liệt kê 5 Website đang hoạt động (không có ngày kết thúc web_rec_end_date) và ngày bắt đầu của chúng.,"SELECT web_name, web_rec_start_date
FROM web_site
WHERE web_rec_end_date IS NULL
LIMIT 5;"
841,"Hàng Electronics trả lại ở KS có nhiều không, xem số liệu năm 1999 thử.","SELECT 
  i.i_category,
  ca.ca_state,
  d.d_year,
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount,
  AVG(sr.sr_return_amt) as avg_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'KS'
  AND d.d_year = 1999
 GROUP BY i.i_category, ca.ca_state, d.d_year;"
893,Khách hàng có bằng Secondary tại VA thường mua Sports qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = 'Secondary'
  AND ca.ca_state = 'VA'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
647,Khách hàng có bằng 4 yr Degree tại MO thường mua Sports qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'MO'
  AND i.i_category = 'Sports'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
819,Khách hàng có bằng 4 yr Degree tại IL thường mua Shoes qua kênh nào?,"WITH store_channel AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 ),
 web_channel AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 ),
 catalog_channel AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE cd.cd_education_status = '4 yr Degree'
  AND ca.ca_state = 'IL'
  AND i.i_category = 'Shoes'
 )
 SELECT * FROM store_channel
 UNION ALL SELECT * FROM web_channel
 UNION ALL SELECT * FROM catalog_channel
 ORDER BY total_sales DESC;"
485,"Trong năm 2001, khách hàng ở NC mua nhiều Books không?","SELECT 
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = 2001
GROUP BY ca.ca_state, i.i_category;"
881,"Trong năm 2002, khách hàng ở VA mua nhiều Men không?","SELECT 
  ca.ca_state,
  i.i_category,
  COUNT(*) as total_transactions,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Men'
  AND d.d_year = 2002
 GROUP BY ca.ca_state, i.i_category;"
505,Doanh số của Electronics tại GA năm 1999 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA' AND d.d_year = 1999
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Electronics' AND ca.ca_state = 'GA' AND d.d_year = 1998
)
SELECT 
    1999 as current_year,
    cy.revenue as current_revenue,
    1998 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
832,Doanh số của Women tại NC năm 2001 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'NC' AND d.d_year = 2001
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Women' AND ca.ca_state = 'NC' AND d.d_year = 2000
 )
 SELECT 
  2001 as current_year,
  cy.revenue as current_revenue,
  2000 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
244,Bạn hãy tính toán tổng lợi nhuận ròng thu được từ các sản phẩm danh mục Home khi bán cho những hộ gia đình sống trong các căn hộ chung cư và sở hữu từ hai xe ô tô trở lên,"SELECT SUM(ss.ss_net_profit)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk
JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk
WHERE i.i_category = 'Home' AND ca.ca_location_type = 'condo' AND hd.hd_vehicle_count >= 2;"
567,Cho tôi xem danh sách sản phẩm Shoes bán chạy nhất ở NC.,"SELECT 
    i.i_item_id,
    i.i_product_name,
    i.i_brand,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity_sold,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Shoes'
  AND ca.ca_state = 'NC'
GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
ORDER BY total_quantity_sold DESC
LIMIT 10;"
563,Giá bán trung bình của mặt hàng Home trong năm 2001 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home'
  AND d.d_year = 2001
GROUP BY i.i_category;"
687,Năm 2002 thì kênh Web mang về bao nhiêu tiền?,"SELECT 
  d.d_year,
  'Web' as channel,
  SUM(ws.ws_net_paid) as total_revenue,
  COUNT(*) as total_transactions
 FROM web_sales ws
 JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
 WHERE d.d_year = 2002
 GROUP BY d.d_year;"
190,Thống kê doanh thu từ các chương trình khuyến mãi được quảng bá qua kênh sự kiện trực tiếp trong năm 2000,"SELECT p.p_promo_name, SUM(ss.ss_sales_price) AS revenue
FROM store_sales ss
JOIN promotion p ON ss.ss_promo_sk = p.p_promo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE p.p_channel_event = 'Y' AND d.d_year = 2000
GROUP BY p.p_promo_name;"
783,So sánh lợi nhuận của Children giữa kênh Store và Web tại VA.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
 )
 SELECT * FROM store_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Web')
 ORDER BY channel;"
700,Tỷ lệ trả hàng của Sports ở KY có cao hơn mức trung bình hệ thống không?,"WITH category_state_returns AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Sports' AND ca.ca_state = 'KY'
 ),
 system_average AS (
  SELECT 
  COUNT(sr.sr_item_sk) * 1.0 / COUNT(ss.ss_item_sk) as avg_return_rate
  FROM store_sales ss
  LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number
 )
 SELECT 
  'Sports' as category,
  'KY' as state,
  csr.return_rate as category_state_return_rate,
  sa.avg_return_rate as system_average_return_rate,
  CASE WHEN csr.return_rate > sa.avg_return_rate THEN 'Cao hơn' ELSE 'Thấp hơn hoặc bằng' END as comparison
 FROM category_state_returns csr, system_average sa;"
476,Năm ngoái dân ở VA mua Jewelry nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'VA'
  AND i.i_category = 'Jewelry'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
682,Cho tôi xem danh sách sản phẩm Women bán chạy nhất ở IA.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Women'
  AND ca.ca_state = 'IA'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
511,"Hàng Children trả lại ở GA có nhiều không, xem số liệu năm 2000 thử.","SELECT 
    i.i_category,
    ca.ca_state,
    d.d_year,
    COUNT(*) as total_returns,
    SUM(sr.sr_return_quantity) as total_returned_quantity,
    SUM(sr.sr_return_amt) as total_return_amount,
    AVG(sr.sr_return_amt) as avg_return_amount
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON sr.sr_item_sk = i.i_item_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
  AND d.d_year = 2000
GROUP BY i.i_category, ca.ca_state, d.d_year;"
59,Tìm những khách hàng đã mua hàng và được giảm giá trên 100 đô la.,"SELECT DISTINCT c.c_first_name, c.c_last_name 
FROM customer c 
JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk 
WHERE ss.ss_ext_discount_amt > 100;"
475,Tìm email của các khách hàng VIP ở KY đã mua đồ Children trên 1000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'KY'
  AND i.i_category = 'Children'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 1000
ORDER BY total_spent DESC;"
561,"Trong quý 4 năm 1999, nhóm khách hàng Secondary chi bao nhiêu tiền cho Men?","SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary'
  AND i.i_category = 'Men'
  AND d.d_year = 1999
  AND d.d_qoy = 4
GROUP BY cd.cd_education_status, i.i_category;"
857,So sánh lợi nhuận của Books giữa kênh Catalog và Web tại TX.,"WITH store_profit AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 web_profit AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
  FROM web_sales ws
  JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ws.ws_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 ),
 catalog_profit AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
  FROM catalog_sales cs
  JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  WHERE i.i_category = 'Books' AND ca.ca_state = 'TX'
 )
 SELECT * FROM store_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM web_profit WHERE channel IN ('Catalog', 'Web')
 UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Catalog', 'Web')
 ORDER BY channel;"
748,Cho tôi xem danh sách sản phẩm Sports bán chạy nhất ở KY.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_brand,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity_sold,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'KY'
 GROUP BY i.i_item_id, i.i_product_name, i.i_brand, i.i_category
 ORDER BY total_quantity_sold DESC
 LIMIT 10;"
253,Hãy liệt kê tên các trung tâm hỗ trợ có trên một trăm nhân viên và tổng giá trị thuế thu được từ các đơn hàng Catalog mà họ đã xử lý trong quý bốn,"SELECT cc.cc_name, SUM(cs.cs_ext_tax) AS total_tax
FROM catalog_sales cs
JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk
JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
WHERE cc.cc_employees > 100 AND d.d_qoy = 4
GROUP BY cc.cc_name;"
22,Bạn có thể giúp tôi lọc ra và hiển thị toàn bộ danh sách những khách hàng hiện tại đang có họ là Nguyen trong cơ sở dữ liệu được không?,SELECT * FROM customer WHERE c_first_name = 'Nguyen';
314,Tìm email của các khách hàng VIP ở IA đã mua đồ Sports trên 10000 đô.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE ca.ca_state = 'IA'
  AND i.i_category = 'Sports'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
HAVING SUM(ss.ss_net_paid) > 10000
ORDER BY total_spent DESC;"
460,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Sports tại VA.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
  AND ca.ca_state = 'VA'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 5;"
161,Thành phố nào có lượng hàng trả lại qua Web nhiều hơn là trả trực tiếp tại cửa hàng?,"SELECT ca.ca_city
FROM customer_address ca
WHERE (SELECT COUNT(*) FROM web_returns wr WHERE wr.wr_refunded_addr_sk = ca.ca_address_sk) > 
      (SELECT COUNT(*) FROM store_returns sr WHERE sr.sr_addr_sk = ca.ca_address_sk)
LIMIT 10;"
277,Hãy hiển thị tên và email của khách hàng ở bang 'California' có trình độ 'Advanced Degree' đã từng mua đồ 'Jewelry' qua kênh Web.,"SELECT DISTINCT c.c_first_name, c.c_last_name, c.c_email_address
FROM web_sales ws
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE ca.ca_state = 'CA' AND cd.cd_education_status = 'Advanced Degree' AND i.i_category = 'Jewelry';"
192,Tìm các cửa hàng ở bang California có giờ mở cửa vào lúc 8 giờ sáng và liệt kê tên quản lý của họ.,"SELECT s_store_name, s_manager
FROM store
WHERE s_state = 'CA' AND s_hours ILIKE '%8AM%';"
386,Năm ngoái dân ở TX mua Children nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Children'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
806,Doanh số của Children tại KS năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'KS' AND d.d_year = 2000
 ),
 previous_year AS (
  SELECT SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN item i ON ss.ss_item_sk = i.i_item_sk
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE i.i_category = 'Children' AND ca.ca_state = 'KS' AND d.d_year = 1999
 )
 SELECT 
  2000 as current_year,
  cy.revenue as current_revenue,
  1999 as previous_year,
  py.revenue as previous_revenue,
  cy.revenue - py.revenue as revenue_change,
  ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
 FROM current_year cy, previous_year py;"
414,Năm ngoái dân ở NC mua Books nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'NC'
  AND i.i_category = 'Books'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
492,Giá bán trung bình của mặt hàng Shoes trong năm 2000 là bao nhiêu?,"SELECT 
    i.i_category,
    AVG(ss.ss_sales_price) as avg_sales_price,
    MIN(ss.ss_sales_price) as min_sales_price,
    MAX(ss.ss_sales_price) as max_sales_price
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Shoes'
  AND d.d_year = 2000
GROUP BY i.i_category;"
344,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Home tại KY.,"SELECT 
    c.c_customer_id,
    c.c_first_name || ' ' || c.c_last_name as customer_name,
    c.c_email_address,
    SUM(ss.ss_net_paid) as total_spent,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
  AND ca.ca_state = 'KY'
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
ORDER BY total_spent DESC
LIMIT 5;"
770,Cho tôi biết top 5 khách hàng chi tiêu nhiều nhất cho mặt hàng Children tại GA.,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  c.c_email_address,
  SUM(ss.ss_net_paid) as total_spent,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Children'
  AND ca.ca_state = 'GA'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_email_address
 ORDER BY total_spent DESC
 LIMIT 5;"
309,Khách hàng có bằng Secondary tại NC thường mua Jewelry qua kênh nào?,"WITH store_channel AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_paid) as total_sales
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
),
web_channel AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_paid) as total_sales
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
),
catalog_channel AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as total_sales
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE cd.cd_education_status = 'Secondary'
      AND ca.ca_state = 'NC'
      AND i.i_category = 'Jewelry'
)
SELECT * FROM store_channel
UNION ALL SELECT * FROM web_channel
UNION ALL SELECT * FROM catalog_channel
ORDER BY total_sales DESC;"
662,"Năm 1999, doanh thu từ kênh Store cao hơn hay thấp hơn kênh Web?","WITH store_rev AS (
  SELECT 'Store' as channel, SUM(ss.ss_net_paid) as revenue
  FROM store_sales ss
  JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 web_rev AS (
  SELECT 'Web' as channel, SUM(ws.ws_net_paid) as revenue
  FROM web_sales ws
  JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 ),
 catalog_rev AS (
  SELECT 'Catalog' as channel, SUM(cs.cs_net_paid) as revenue
  FROM catalog_sales cs
  JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk
  WHERE d.d_year = 1999
 )
 SELECT * FROM store_rev
 UNION ALL SELECT * FROM web_rev
 UNION ALL SELECT * FROM catalog_rev
 ORDER BY revenue DESC;"
131,Tìm thành phố có nhiều khách hàng 'VIP' nhất (thu nhập mức cao nhất),"SELECT ca.ca_city, COUNT(*) AS vip_count
FROM customer c
JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
WHERE hd.hd_income_band_sk = (SELECT MAX(ib_income_band_sk) FROM income_band)
GROUP BY ca.ca_city
ORDER BY vip_count DESC LIMIT 1;"
664,Ai mua đồ Men nhiều nhất ở KS vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Men'
  AND ca.ca_state = 'KS'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
872,Có bao nhiêu đơn hàng Books bị trả lại tại MO vào năm 1999?,"SELECT 
  COUNT(*) as total_returns,
  SUM(sr.sr_return_quantity) as total_returned_quantity,
  SUM(sr.sr_return_amt) as total_return_amount
 FROM store_returns sr
 JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON sr.sr_item_sk = i.i_item_sk
 JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
 WHERE i.i_category = 'Books'
  AND ca.ca_state = 'MO'
  AND d.d_year = 1999;"
100,Cho tôi biết 3 loại hàng hóa (category) được khách hàng có trình độ học vấn 'Secondary' mua nhiều nhất.,"SELECT i.i_category, COUNT(*) AS total_count
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
WHERE cd.cd_education_status = 'Secondary'
GROUP BY i.i_category
ORDER BY total_count DESC LIMIT 3;"
373,Thống kê tổng số lượng Children được mua bởi những khách hàng có trình độ College.,"SELECT 
    cd.cd_education_status,
    i.i_category,
    SUM(ss.ss_quantity) as total_quantity,
    COUNT(*) as total_transactions
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
  AND cd.cd_education_status = 'College'
GROUP BY cd.cd_education_status, i.i_category;"
88,Lấy danh sách 5 mặt hàng được khách hàng nam mua nhiều nhất trên Web vào quý 1.,"SELECT i.i_item_desc, SUM(ws.ws_quantity) AS total_qty
FROM web_sales ws
JOIN item i ON ws.ws_item_sk = i.i_item_sk
JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE cd.cd_gender = 'M' AND d.d_qoy = 1
GROUP BY i.i_item_desc
ORDER BY total_qty DESC LIMIT 5;"
459,Doanh số của Men tại MO năm 2000 so với năm trước đó tăng bao nhiêu?,"WITH current_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'MO' AND d.d_year = 2000
),
previous_year AS (
    SELECT SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE i.i_category = 'Men' AND ca.ca_state = 'MO' AND d.d_year = 1999
)
SELECT 
    2000 as current_year,
    cy.revenue as current_revenue,
    1999 as previous_year,
    py.revenue as previous_revenue,
    cy.revenue - py.revenue as revenue_change,
    ROUND((cy.revenue - py.revenue) / py.revenue * 100, 2) as growth_pct
FROM current_year cy, previous_year py;"
331,Năm ngoái dân ở TX mua Home nhiều hay ít?,"SELECT 
    d.d_year,
    ca.ca_state,
    i.i_category,
    COUNT(*) as total_transactions,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue,
    AVG(ss.ss_net_paid) as avg_transaction_value
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE ca.ca_state = 'TX'
  AND i.i_category = 'Home'
  AND d.d_year = (SELECT MAX(d_year) - 1 FROM date_dim WHERE d_date_sk IN (SELECT ss_sold_date_sk FROM store_sales))
GROUP BY d.d_year, ca.ca_state, i.i_category;"
215,Thống kê số lượng trang web có chứa trên năm hình ảnh minh họa và đã từng phát sinh giao dịch bán các mặt hàng gia dụng.,"SELECT COUNT(DISTINCT wp.wp_web_page_sk)
FROM web_page wp
JOIN web_sales ws ON wp.wp_web_page_sk = ws.ws_web_page_sk
JOIN item i ON ws.ws_item_sk = i.i_item_sk
WHERE wp.wp_image_count > 5 AND i.i_category = 'Home';"
467,So sánh lợi nhuận của Children giữa kênh Store và Catalog tại VA.,"WITH store_profit AS (
    SELECT 'Store' as channel, SUM(ss.ss_net_profit) as total_profit
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ss.ss_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
),
web_profit AS (
    SELECT 'Web' as channel, SUM(ws.ws_net_profit) as total_profit
    FROM web_sales ws
    JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON ws.ws_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
),
catalog_profit AS (
    SELECT 'Catalog' as channel, SUM(cs.cs_net_profit) as total_profit
    FROM catalog_sales cs
    JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
    JOIN item i ON cs.cs_item_sk = i.i_item_sk
    WHERE i.i_category = 'Children' AND ca.ca_state = 'VA'
)
SELECT * FROM store_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM web_profit WHERE channel IN ('Store', 'Catalog')
UNION ALL SELECT * FROM catalog_profit WHERE channel IN ('Store', 'Catalog')
ORDER BY channel;"
122,Tìm khách hàng sinh năm 1990 trở đi mà chưa từng thực hiện bất kỳ giao dịch trả hàng nào,"SELECT c_first_name, c_last_name
FROM customer
WHERE c_birth_year >= 1990
   AND c_customer_sk NOT IN (SELECT sr_customer_sk FROM store_returns)
   AND c_customer_sk NOT IN (SELECT wr_refunded_customer_sk FROM web_returns);"
615,Ai mua đồ Electronics nhiều nhất ở TX vậy?,"SELECT 
  c.c_customer_id,
  c.c_first_name || ' ' || c.c_last_name as customer_name,
  SUM(ss.ss_quantity) as total_quantity,
  SUM(ss.ss_net_paid) as total_spent
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Electronics'
  AND ca.ca_state = 'TX'
 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
 ORDER BY total_quantity DESC
 LIMIT 1;"
21,"Tôi cần tìm các khách hàng nam có danh xưng là Mr và hiện đang sinh sống hoặc có quốc tịch tại Canada, hãy liệt kê cho tôi đầy đủ thông tin của họ ",SELECT * FROM customer WHERE c_salutation = 'Mr.' AND c_birth_country = 'CA';
701,Tìm 5 sản phẩm Electronics có lợi nhuận thấp nhất trong năm 2002.,"SELECT 
  i.i_item_id,
  i.i_product_name,
  i.i_category,
  SUM(ss.ss_net_profit) as total_profit,
  SUM(ss.ss_net_paid) as total_revenue
 FROM store_sales ss
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
 WHERE i.i_category = 'Electronics'
  AND d.d_year = 2002
 GROUP BY i.i_item_id, i.i_product_name, i.i_category
 ORDER BY total_profit ASC
 LIMIT 5;"
72,Những khách hàng nào sống ở cùng thành phố với kho hàng (Warehouse) mà họ mua đồ?,"SELECT DISTINCT c.c_first_name, ca.ca_city
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN warehouse w ON ss.ss_warehouse_sk = w.w_warehouse_sk
WHERE ca.ca_city = w.w_city;"
107,Tìm các mặt hàng loại 'Home' (Gia đình) mà chưa từng bị khách hàng trả lại bao giờ.,"SELECT i_item_desc
FROM item i
WHERE i_category = 'Home'
  AND i_item_sk NOT IN (SELECT sr_item_sk FROM store_returns);"
271,Bạn hãy liệt kê danh sách tên các nhà sản xuất có mặt hàng thuộc danh mục Music hiện đang còn hàng trong kho tại bang Texas.,"SELECT DISTINCT i.i_manufact
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'TX' AND inv.inv_quantity_on_hand > 0;"
861,Thống kê tổng số lượng Jewelry được mua bởi những khách hàng có trình độ Advanced Degree.,"SELECT 
  cd.cd_education_status,
  i.i_category,
  SUM(ss.ss_quantity) as total_quantity,
  COUNT(*) as total_transactions
 FROM store_sales ss
 JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
 JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
 JOIN item i ON ss.ss_item_sk = i.i_item_sk
 WHERE i.i_category = 'Jewelry'
  AND cd.cd_education_status = 'Advanced Degree'
 GROUP BY cd.cd_education_status, i.i_category;"
436,Liệt kê 5 thương hiệu Jewelry được ưa chuộng nhất bởi khách hàng ở GA.,"SELECT 
    i.i_brand,
    i.i_category,
    COUNT(*) as purchase_count,
    SUM(ss.ss_quantity) as total_quantity,
    SUM(ss.ss_net_paid) as total_revenue
FROM store_sales ss
JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
  AND ca.ca_state = 'GA'
GROUP BY i.i_brand, i.i_category
ORDER BY purchase_count DESC
LIMIT 5;"
103,Thống kê doanh thu bán hàng qua Web theo từng tháng của năm 2000,"SELECT d.d_moy, SUM(ws.ws_sales_price) AS monthly_revenue
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d_moy;"
gen_1,Thống kê doanh thu web sales sử dụng phương thức vận chuyển AIR năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 1999;"
gen_2,Cho tôi biết top 10 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_3,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 1999;"
gen_4,Cho tôi biết tổng tồn kho sản phẩm Electronics tại các kho ở bang AL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'AL';"
gen_5,Truy vấn top 10 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_6,Liệt kê top 100 sản phẩm danh mục Clothing bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_7,Tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2001;"
gen_8,Tính toán top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_9,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2000;"
gen_10,Cho tôi biết tổng doanh thu cửa hàng tại bang IL năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IL' AND d.d_year = 1999;"
gen_11,Thống kê top 20 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_12,Hỏi về top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_13,Hỏi về tổng doanh thu cửa hàng tại bang AZ năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AZ' AND d.d_year = 2002;"
gen_14,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2001;"
gen_15,Liệt kê top 5 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_16,Liệt kê top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_17,Thống kê tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_18,Hãy tìm tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001;"
gen_19,Thống kê top 20 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_20,Cho tôi biết tỷ lệ đơn hàng Children có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children';"
gen_21,Liệt kê số lượng khách hàng M sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'M';"
gen_22,Thống kê doanh thu web sales quý 4 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;"
gen_23,"Tính toán khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_24,Tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang AK,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'AK'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_25,Thống kê top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_26,Tính toán tổng doanh thu cửa hàng tại bang TX năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX' AND d.d_year = 2000;"
gen_27,Tìm giúp tôi top 50 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_28,Liệt kê doanh thu web sales quý 2 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2;"
gen_29,Hỏi về tỷ lệ đơn hàng Men có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men';"
gen_30,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2002;"
gen_31,Hãy tìm tổng tồn kho sản phẩm Music tại các kho ở bang DE,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'DE';"
gen_32,Khách hàng tình trạng hôn nhân 'W' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Books';"
gen_33,Hãy tìm tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_34,Cho tôi biết top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_35,Tìm giúp tôi tổng tồn kho sản phẩm Toys tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'WA';"
gen_36,Khách hàng tình trạng hôn nhân 'D' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Men';"
gen_37,Tính toán doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2001;"
gen_38,Hãy tìm tổng doanh thu cửa hàng tại bang IN năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 2001;"
gen_39,Hỏi về tổng chi tiêu của khách hàng có trình độ Primary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001;"
gen_40,Cho tôi biết top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_41,Hỏi về tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang GA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'GA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_42,Tính toán số lượng khách hàng M sống tại bang CA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CA' AND cd.cd_gender = 'M';"
gen_43,Hỏi về top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_44,"Truy vấn khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_45,Cho tôi biết top 50 mặt hàng Electronics bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_46,"Thống kê khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2001","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001);"
gen_47,Truy vấn top 5 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_48,Cho tôi biết tổng doanh thu cửa hàng tại bang KS năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS' AND d.d_year = 1999;"
gen_49,Tìm giúp tôi top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_50,Hỏi về khách hàng tình trạng hôn nhân 'S' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Sports';"
gen_51,Liệt kê tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_52,"Thống kê khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_53,Tìm giúp tôi tổng tồn kho sản phẩm Children tại các kho ở bang ID,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'ID';"
gen_54,"Cho tôi biết khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_55,Tính toán top 10 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_56,Truy vấn top 100 sản phẩm danh mục Men bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_57,Top 5 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_58,Tính toán top 5 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_59,Tìm giúp tôi tổng doanh thu cửa hàng tại bang FL năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'FL' AND d.d_year = 2000;"
gen_60,Truy vấn top 100 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_61,Tìm giúp tôi số lượng khách hàng F sống tại bang DE,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'DE' AND cd.cd_gender = 'F';"
gen_62,Cho tôi biết top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_63,Làm ơn cho biết tổng doanh thu cửa hàng tại bang ID năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'ID' AND d.d_year = 2002;"
gen_64,Cho tôi biết tổng tồn kho sản phẩm Jewelry tại các kho ở bang AK,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'AK';"
gen_65,Liệt kê top 50 sản phẩm danh mục Music bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_66,Tìm giúp tôi top 10 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_67,Thống kê doanh thu web sales quý 2 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 2;"
gen_68,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ Secondary năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999;"
gen_69,Hỏi về top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_70,Liệt kê tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang AL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'AL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_71,Tìm giúp tôi doanh thu web sales quý 4 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;"
gen_72,Hãy tìm top 50 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_73,Thống kê tổng tồn kho sản phẩm Electronics tại các kho ở bang IL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'IL';"
gen_74,"Thống kê khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_75,Hãy tìm tổng tồn kho sản phẩm Men tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'KS';"
gen_76,Top 20 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_77,Số lượng khách hàng M sống tại bang HI,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'HI' AND cd.cd_gender = 'M';"
gen_78,Top 100 sản phẩm danh mục Jewelry bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_79,Cho tôi biết khách hàng tình trạng hôn nhân 'M' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Home';"
gen_80,Làm ơn cho biết số lượng khách hàng M sống tại bang DE,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'DE' AND cd.cd_gender = 'M';"
gen_81,Truy vấn tổng doanh thu cửa hàng tại bang TX năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX' AND d.d_year = 2000;"
gen_82,Truy vấn top 100 sản phẩm danh mục Books bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_83,Liệt kê số lượng khách hàng F sống tại bang FL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'FL' AND cd.cd_gender = 'F';"
gen_84,Thống kê doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2000;"
gen_85,Tìm giúp tôi tổng tồn kho sản phẩm Home tại các kho ở bang GA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'GA';"
gen_86,Tìm giúp tôi top 5 mặt hàng Electronics bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_87,Hỏi về số lượng khách hàng M sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'M';"
gen_88,Hãy tìm top 100 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_89,"Cho tôi biết khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2001","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001);"
gen_90,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2002;"
gen_91,Truy vấn tỷ lệ đơn hàng Sports có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports';"
gen_92,Thống kê top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_93,"Hãy tìm khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_94,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 1999;"
gen_95,Truy vấn doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_96,Thống kê top 20 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_97,Khách hàng tình trạng hôn nhân 'W' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Sports';"
gen_98,Tổng doanh thu cửa hàng tại bang FL năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'FL' AND d.d_year = 2002;"
gen_99,Hãy tìm top 20 sản phẩm danh mục Home bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_100,Hỏi về tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_101,Hỏi về tỷ lệ đơn hàng Toys có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys';"
gen_102,Hỏi về top 5 sản phẩm danh mục Books bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_103,Làm ơn cho biết top 20 sản phẩm danh mục Women bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_104,Tính toán doanh thu web sales quý 3 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 3;"
gen_105,"Tính toán khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_106,Cho tôi biết top 10 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_107,Truy vấn top 100 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_108,Liệt kê tỷ lệ đơn hàng Home có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home';"
gen_109,Làm ơn cho biết tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang CO,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'CO'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_110,Liệt kê top 10 sản phẩm danh mục Music bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_111,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 1999;"
gen_112,Liệt kê tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang AK,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'AK'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_113,Thống kê top 50 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_114,Tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_115,Tính toán doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2002;"
gen_116,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2001;"
gen_117,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2002;"
gen_118,Thống kê top 5 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_119,Cho tôi biết doanh thu web sales quý 1 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 1;"
gen_120,Tính toán số lượng khách hàng F sống tại bang ID,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'ID' AND cd.cd_gender = 'F';"
gen_121,Cho tôi biết tổng tồn kho sản phẩm Women tại các kho ở bang KY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'KY';"
gen_122,Thống kê tổng tồn kho sản phẩm Women tại các kho ở bang CT,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'CT';"
gen_123,Tính toán top 50 sản phẩm danh mục Electronics bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_124,Truy vấn tổng tồn kho sản phẩm Books tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'HI';"
gen_125,Hỏi về top 5 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_126,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2002;"
gen_127,Hãy tìm tổng tồn kho sản phẩm Sports tại các kho ở bang NY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'NY';"
gen_128,Làm ơn cho biết top 50 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_129,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2001;"
gen_130,Thống kê khách hàng tình trạng hôn nhân 'M' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Sports';"
gen_131,Truy vấn top 50 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_132,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2002;"
gen_133,Hỏi về tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000;"
gen_134,Cho tôi biết tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000;"
gen_135,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2001;"
gen_136,Thống kê tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_137,Top 10 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_138,Tìm giúp tôi top 10 sản phẩm danh mục Jewelry bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_139,Liệt kê tổng tồn kho sản phẩm Children tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'TX';"
gen_140,Tìm giúp tôi tỷ lệ đơn hàng Toys có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys';"
gen_141,Tổng tồn kho sản phẩm Clothing tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'CA';"
gen_142,"Làm ơn cho biết khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_143,Tìm giúp tôi top 100 sản phẩm danh mục Clothing bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_144,Tìm giúp tôi doanh thu web sales quý 3 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 3;"
gen_145,Tìm giúp tôi số lượng khách hàng F sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'F';"
gen_146,"Tìm giúp tôi khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_147,Thống kê tổng chi tiêu của khách hàng có trình độ College năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000;"
gen_148,Thống kê top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_149,Liệt kê tổng chi tiêu của khách hàng có trình độ Primary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001;"
gen_150,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2001;"
gen_151,Liệt kê tổng doanh thu cửa hàng tại bang CA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CA' AND d.d_year = 2000;"
gen_152,Cho tôi biết tổng tồn kho sản phẩm Home tại các kho ở bang CT,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'CT';"
gen_153,Hỏi về tổng tồn kho sản phẩm Toys tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'HI';"
gen_154,Liệt kê tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999;"
gen_155,Truy vấn tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang IN,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'IN'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_156,Truy vấn tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_157,Tính toán tổng tồn kho sản phẩm Jewelry tại các kho ở bang AL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'AL';"
gen_158,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2002;"
gen_159,Truy vấn tỷ lệ đơn hàng Men có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men';"
gen_160,Tìm giúp tôi top 20 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_161,Hãy tìm top 50 sản phẩm danh mục Music bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_162,Truy vấn tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_163,Truy vấn khách hàng tình trạng hôn nhân 'M' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Toys';"
gen_164,Làm ơn cho biết số lượng khách hàng M sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'M';"
gen_165,Doanh thu web sales quý 2 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 2;"
gen_166,Liệt kê số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2001;"
gen_167,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ College năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001;"
gen_168,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2001;"
gen_169,Tính toán tổng chi tiêu của khách hàng có trình độ Primary năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999;"
gen_170,Top 5 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_171,Liệt kê top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_172,Hãy tìm tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang AL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'AL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_173,Cho tôi biết top 10 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_174,Thống kê số lượng khách hàng M sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'M';"
gen_175,Truy vấn top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_176,Thống kê số lượng khách hàng M sống tại bang CO,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CO' AND cd.cd_gender = 'M';"
gen_177,Truy vấn tổng doanh thu cửa hàng tại bang GA năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'GA' AND d.d_year = 1999;"
gen_178,Liệt kê doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2002;"
gen_179,Thống kê tổng doanh thu cửa hàng tại bang AR năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AR' AND d.d_year = 2000;"
gen_180,Truy vấn tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_181,Hỏi về top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_182,Cho tôi biết tổng tồn kho sản phẩm Children tại các kho ở bang ID,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'ID';"
gen_183,Làm ơn cho biết khách hàng tình trạng hôn nhân 'D' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Electronics';"
gen_184,Làm ơn cho biết tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_185,Làm ơn cho biết top 50 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_186,Tìm giúp tôi doanh thu web sales quý 4 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 4;"
gen_187,Tính toán tổng tồn kho sản phẩm Women tại các kho ở bang FL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'FL';"
gen_188,Thống kê tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_189,"Liệt kê khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_190,Truy vấn top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_191,Doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2001;"
gen_192,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ College năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000;"
gen_193,Tính toán top 20 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_194,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2001;"
gen_195,Liệt kê top 100 sản phẩm danh mục Clothing bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_196,Tìm giúp tôi khách hàng tình trạng hôn nhân 'S' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Jewelry';"
gen_197,Thống kê tổng chi tiêu của khách hàng có trình độ Primary năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999;"
gen_198,Thống kê top 50 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_199,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2001;"
gen_200,Hỏi về khách hàng tình trạng hôn nhân 'D' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Toys';"
gen_201,Thống kê top 20 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_202,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2000;"
gen_203,Tính toán tỷ lệ đơn hàng Clothing có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing';"
gen_204,Liệt kê tổng doanh thu cửa hàng tại bang CT năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CT' AND d.d_year = 2000;"
gen_205,Thống kê tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_206,Hỏi về tỷ lệ đơn hàng Women có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women';"
gen_207,Liệt kê số lượng khách hàng F sống tại bang AR,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AR' AND cd.cd_gender = 'F';"
gen_208,Hãy tìm số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2001;"
gen_209,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2000;"
gen_210,Hãy tìm top 5 sản phẩm danh mục Men bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_211,Doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 1999;"
gen_212,Tìm giúp tôi số lượng khách hàng F sống tại bang KS,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KS' AND cd.cd_gender = 'F';"
gen_213,Tổng chi tiêu của khách hàng có trình độ College năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000;"
gen_214,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 1999;"
gen_215,Truy vấn tổng tồn kho sản phẩm Jewelry tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'AZ';"
gen_216,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2000;"
gen_217,Truy vấn tổng doanh thu cửa hàng tại bang WA năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 2002;"
gen_218,Làm ơn cho biết top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_219,Truy vấn tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001;"
gen_220,Truy vấn tổng tồn kho sản phẩm Sports tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'TX';"
gen_221,Liệt kê top 100 sản phẩm danh mục Books bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_222,Hãy tìm số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 1999;"
gen_223,Cho tôi biết top 10 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_224,Tìm giúp tôi doanh thu web sales quý 4 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4;"
gen_225,Tìm giúp tôi tỷ lệ đơn hàng Women có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women';"
gen_226,Tìm giúp tôi tỷ lệ đơn hàng Sports có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports';"
gen_227,Truy vấn tổng doanh thu cửa hàng tại bang FL năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'FL' AND d.d_year = 2000;"
gen_228,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2002;"
gen_229,Hãy tìm khách hàng tình trạng hôn nhân 'S' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Children';"
gen_230,"Hãy tìm khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2001","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001);"
gen_231,Thống kê tổng doanh thu cửa hàng tại bang CO năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CO' AND d.d_year = 1999;"
gen_232,Cho tôi biết số lượng khách hàng F sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'F';"
gen_233,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001;"
gen_234,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2002;"
gen_235,Tính toán tổng doanh thu cửa hàng tại bang IN năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 1999;"
gen_236,Cho tôi biết số lượng khách hàng F sống tại bang AL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AL' AND cd.cd_gender = 'F';"
gen_237,Top 100 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_238,Top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_239,Hỏi về top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_240,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2001;"
gen_241,Cho tôi biết số lượng khách hàng F sống tại bang KS,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KS' AND cd.cd_gender = 'F';"
gen_242,Tính toán tổng chi tiêu của khách hàng có trình độ College năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002;"
gen_243,Tính toán top 5 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_244,Làm ơn cho biết tổng tồn kho sản phẩm Jewelry tại các kho ở bang GA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'GA';"
gen_245,Tìm giúp tôi tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang NY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'NY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_246,Tính toán tổng doanh thu cửa hàng tại bang FL năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'FL' AND d.d_year = 2001;"
gen_247,Tổng doanh thu cửa hàng tại bang KY năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY' AND d.d_year = 2002;"
gen_248,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2002;"
gen_249,Truy vấn top 10 sản phẩm danh mục Men bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_250,Top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_251,Hãy tìm top 20 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_252,"Tìm giúp tôi khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2001","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001);"
gen_253,Thống kê top 100 sản phẩm danh mục Clothing bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_254,Làm ơn cho biết khách hàng tình trạng hôn nhân 'M' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Men';"
gen_255,Tìm giúp tôi tổng doanh thu cửa hàng tại bang AR năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AR' AND d.d_year = 2000;"
gen_256,Thống kê tổng doanh thu cửa hàng tại bang KS năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS' AND d.d_year = 2000;"
gen_257,Tìm giúp tôi khách hàng tình trạng hôn nhân 'D' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Toys';"
gen_258,Hỏi về tổng chi tiêu của khách hàng có trình độ Secondary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002;"
gen_259,Truy vấn doanh thu web sales quý 2 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 2;"
gen_260,Thống kê khách hàng tình trạng hôn nhân 'S' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Books';"
gen_261,Hỏi về top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_262,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2001;"
gen_263,Tìm giúp tôi tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang TX,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'TX'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_264,Hỏi về tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_265,Hỏi về tổng chi tiêu của khách hàng có trình độ College năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001;"
gen_266,Tính toán top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_267,Truy vấn tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_268,Tổng tồn kho sản phẩm Clothing tại các kho ở bang IN,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'IN';"
gen_269,Làm ơn cho biết top 50 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_270,Doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2002;"
gen_271,Tìm giúp tôi doanh thu web sales quý 1 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 1;"
gen_272,Hãy tìm tổng doanh thu cửa hàng tại bang AL năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AL' AND d.d_year = 2002;"
gen_273,Cho tôi biết tổng tồn kho sản phẩm Children tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'CA';"
gen_274,Truy vấn tổng chi tiêu của khách hàng có trình độ College năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001;"
gen_275,Cho tôi biết tỷ lệ đơn hàng Toys có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys';"
gen_276,Hỏi về tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang HI,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'HI'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_277,Hỏi về tổng tồn kho sản phẩm Music tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'KS';"
gen_278,Thống kê top 100 sản phẩm danh mục Books bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_279,Cho tôi biết top 5 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_280,Hãy tìm top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_281,Tỷ lệ đơn hàng Sports có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports';"
gen_282,Tính toán top 20 sản phẩm danh mục Electronics bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_283,Liệt kê top 50 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_284,Hãy tìm khách hàng tình trạng hôn nhân 'W' thích mua Women không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Women';"
gen_285,Truy vấn doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_286,Liệt kê tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_287,Liệt kê tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000;"
gen_288,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001;"
gen_289,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 1999;"
gen_290,"Hỏi về khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2001","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001);"
gen_291,Tính toán doanh thu web sales quý 4 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4;"
gen_292,Thống kê số lượng khách hàng F sống tại bang IN,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IN' AND cd.cd_gender = 'F';"
gen_293,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ College năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000;"
gen_294,Liệt kê tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_295,Truy vấn tổng tồn kho sản phẩm Women tại các kho ở bang ID,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'ID';"
gen_296,Số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2001;"
gen_297,Tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_298,Tìm giúp tôi số lượng khách hàng M sống tại bang WA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'WA' AND cd.cd_gender = 'M';"
gen_299,Truy vấn tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang GA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'GA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_300,Liệt kê top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_301,Cho tôi biết số lượng khách hàng F sống tại bang CA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CA' AND cd.cd_gender = 'F';"
gen_302,"Thống kê khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_303,Truy vấn top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_304,Thống kê top 10 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_305,Hãy tìm doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_306,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2001;"
gen_307,Cho tôi biết top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_308,Hỏi về doanh thu web sales quý 4 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 4;"
gen_309,Top 5 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_310,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 1999;"
gen_311,Làm ơn cho biết top 20 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_312,Liệt kê tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang ID,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'ID'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_313,Truy vấn tổng chi tiêu của khách hàng có trình độ Primary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001;"
gen_314,Tìm giúp tôi top 5 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_315,"Làm ơn cho biết khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2001","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001);"
gen_316,Tổng doanh thu cửa hàng tại bang AK năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AK' AND d.d_year = 2000;"
gen_317,Làm ơn cho biết top 100 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_318,Truy vấn tổng chi tiêu của khách hàng có trình độ College năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002;"
gen_319,Làm ơn cho biết tỷ lệ đơn hàng Home có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home';"
gen_320,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2002;"
gen_321,Tính toán tổng tồn kho sản phẩm Sports tại các kho ở bang AK,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'AK';"
gen_322,Liệt kê top 50 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_323,Tính toán tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang ID,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'ID'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_324,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 1999;"
gen_325,Tổng doanh thu cửa hàng tại bang WA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 2000;"
gen_326,Truy vấn top 20 sản phẩm danh mục Clothing bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_327,Liệt kê top 5 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_328,Tính toán số lượng khách hàng M sống tại bang DE,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'DE' AND cd.cd_gender = 'M';"
gen_329,Top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_330,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2000;"
gen_331,Số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 1999;"
gen_332,Liệt kê doanh thu web sales quý 3 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 3;"
gen_333,Hãy tìm số lượng khách hàng F sống tại bang AL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AL' AND cd.cd_gender = 'F';"
gen_334,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2000;"
gen_335,Tìm giúp tôi khách hàng tình trạng hôn nhân 'M' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Books';"
gen_336,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ College năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 1999;"
gen_337,Khách hàng tình trạng hôn nhân 'S' thích mua Women không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Women';"
gen_338,Hỏi về tỷ lệ đơn hàng Children có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children';"
gen_339,Số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 1999;"
gen_340,Cho tôi biết tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002;"
gen_341,Cho tôi biết tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002;"
gen_342,Hãy tìm số lượng khách hàng M sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'M';"
gen_343,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2001;"
gen_344,Hỏi về số lượng khách hàng F sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'F';"
gen_345,Cho tôi biết số lượng khách hàng F sống tại bang AR,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AR' AND cd.cd_gender = 'F';"
gen_346,Làm ơn cho biết tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang NY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'NY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_347,Tính toán tổng chi tiêu của khách hàng có trình độ Secondary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002;"
gen_348,Làm ơn cho biết tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_349,Tính toán tỷ lệ đơn hàng Books có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books';"
gen_350,Tính toán tổng tồn kho sản phẩm Music tại các kho ở bang FL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'FL';"
gen_351,Cho tôi biết doanh thu web sales quý 1 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1;"
gen_352,Làm ơn cho biết tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang AZ,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'AZ'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_353,Hỏi về tổng doanh thu cửa hàng tại bang CA năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CA' AND d.d_year = 2001;"
gen_354,Cho tôi biết top 100 sản phẩm danh mục Men bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_355,Tổng tồn kho sản phẩm Music tại các kho ở bang IN,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'IN';"
gen_356,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2001;"
gen_357,Tìm giúp tôi tổng doanh thu cửa hàng tại bang CA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CA' AND d.d_year = 2000;"
gen_358,Hỏi về top 5 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_359,Truy vấn top 5 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_360,Truy vấn top 50 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_361,Thống kê số lượng khách hàng M sống tại bang WA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'WA' AND cd.cd_gender = 'M';"
gen_362,Tính toán top 10 sản phẩm danh mục Sports bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_363,Hãy tìm top 5 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_364,Hãy tìm số lượng khách hàng F sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'F';"
gen_365,Tỷ lệ đơn hàng Children có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children';"
gen_366,Làm ơn cho biết tổng doanh thu cửa hàng tại bang IL năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IL' AND d.d_year = 2000;"
gen_367,Tính toán tổng chi tiêu của khách hàng có trình độ College năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000;"
gen_368,Hãy tìm số lượng khách hàng M sống tại bang AK,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AK' AND cd.cd_gender = 'M';"
gen_369,Thống kê doanh thu web sales quý 1 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 1;"
gen_370,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002;"
gen_371,Tính toán top 100 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_372,Truy vấn tổng tồn kho sản phẩm Books tại các kho ở bang GA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'GA';"
gen_373,Top 50 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_374,Hãy tìm top 10 sản phẩm danh mục Sports bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_375,Tính toán top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_376,Làm ơn cho biết tổng doanh thu cửa hàng tại bang KS năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS' AND d.d_year = 1999;"
gen_377,Hỏi về tỷ lệ đơn hàng Clothing có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing';"
gen_378,Làm ơn cho biết khách hàng tình trạng hôn nhân 'D' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Books';"
gen_379,Tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang AK,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'AK'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_380,Làm ơn cho biết tổng tồn kho sản phẩm Women tại các kho ở bang IL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'IL';"
gen_381,Số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2002;"
gen_382,Tìm giúp tôi top 10 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_383,Làm ơn cho biết tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang ID,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'ID'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_384,Làm ơn cho biết tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_385,Cho tôi biết số lượng khách hàng F sống tại bang KY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KY' AND cd.cd_gender = 'F';"
gen_386,Liệt kê tổng tồn kho sản phẩm Sports tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'HI';"
gen_387,Hỏi về top 10 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_388,Tính toán doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2000;"
gen_389,Cho tôi biết top 10 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_390,Hãy tìm doanh thu web sales quý 2 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2;"
gen_391,Truy vấn top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_392,Tìm giúp tôi top 20 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_393,Thống kê tổng doanh thu cửa hàng tại bang IA năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA' AND d.d_year = 2002;"
gen_394,Thống kê top 100 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_395,Tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999;"
gen_396,Cho tôi biết top 20 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_397,Truy vấn số lượng khách hàng F sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'F';"
gen_398,Truy vấn khách hàng tình trạng hôn nhân 'M' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Jewelry';"
gen_399,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2001;"
gen_400,Tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000;"
gen_401,Cho tôi biết tổng chi tiêu của khách hàng có trình độ Primary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001;"
gen_402,Liệt kê khách hàng tình trạng hôn nhân 'S' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Electronics';"
gen_403,Tìm giúp tôi tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_404,Tính toán khách hàng tình trạng hôn nhân 'S' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Music';"
gen_405,Tổng tồn kho sản phẩm Music tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'WA';"
gen_406,Tính toán top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_407,Thống kê tổng doanh thu cửa hàng tại bang GA năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'GA' AND d.d_year = 2002;"
gen_408,Truy vấn tỷ lệ đơn hàng Children có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children';"
gen_409,Cho tôi biết tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_410,Thống kê số lượng khách hàng M sống tại bang ID,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'ID' AND cd.cd_gender = 'M';"
gen_411,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2000;"
gen_412,Thống kê tỷ lệ đơn hàng Books có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books';"
gen_413,Tính toán khách hàng tình trạng hôn nhân 'W' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Children';"
gen_414,Hỏi về tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_415,Tính toán tổng doanh thu cửa hàng tại bang KY năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY' AND d.d_year = 2002;"
gen_416,Liệt kê top 20 sản phẩm danh mục Sports bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_417,Liệt kê top 50 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_418,Thống kê doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_419,Hỏi về tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_420,Tính toán tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang KY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'KY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_421,"Truy vấn khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_422,Hãy tìm tổng tồn kho sản phẩm Home tại các kho ở bang CO,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'CO';"
gen_423,Tìm giúp tôi tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_424,Tìm giúp tôi top 50 sản phẩm danh mục Music bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_425,Liệt kê số lượng khách hàng F sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'F';"
gen_426,Tìm giúp tôi khách hàng tình trạng hôn nhân 'S' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Sports';"
gen_427,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2002;"
gen_428,Hỏi về top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_429,Liệt kê khách hàng tình trạng hôn nhân 'W' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Home';"
gen_430,Top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_431,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2001;"
gen_432,"Hỏi về khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_433,Cho tôi biết tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_434,Tìm giúp tôi top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_435,"Làm ơn cho biết khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_436,Tính toán tổng doanh thu cửa hàng tại bang IA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA' AND d.d_year = 2000;"
gen_437,Liệt kê top 50 sản phẩm danh mục Men bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_438,Liệt kê tổng tồn kho sản phẩm Books tại các kho ở bang ID,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'ID';"
gen_439,Hãy tìm top 20 sản phẩm danh mục Books bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_440,Tìm giúp tôi doanh thu web sales quý 3 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 3;"
gen_441,Tìm giúp tôi tỷ lệ đơn hàng Home có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home';"
gen_442,Cho tôi biết tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999;"
gen_443,Hỏi về top 20 sản phẩm danh mục Clothing bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_444,Liệt kê tổng tồn kho sản phẩm Books tại các kho ở bang GA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'GA';"
gen_445,Liệt kê số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 1999;"
gen_446,Tìm giúp tôi tổng tồn kho sản phẩm Children tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'WA';"
gen_447,Truy vấn tổng doanh thu cửa hàng tại bang KS năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS' AND d.d_year = 1999;"
gen_448,Hỏi về khách hàng tình trạng hôn nhân 'M' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Children';"
gen_449,Thống kê số lượng khách hàng M sống tại bang CA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CA' AND cd.cd_gender = 'M';"
gen_450,Tính toán tổng tồn kho sản phẩm Electronics tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'WA';"
gen_451,Hãy tìm top 100 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_452,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2001;"
gen_453,Tìm giúp tôi khách hàng tình trạng hôn nhân 'M' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Toys';"
gen_454,Top 50 sản phẩm danh mục Music bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_455,Liệt kê top 5 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_456,Top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_457,Hãy tìm top 100 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_458,Hãy tìm tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_459,Tìm giúp tôi top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_460,Liệt kê top 20 sản phẩm danh mục Clothing bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_461,Thống kê tổng tồn kho sản phẩm Men tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'KS';"
gen_462,Top 10 sản phẩm danh mục Sports bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_463,Cho tôi biết tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang HI,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'HI'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_464,Làm ơn cho biết top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_465,Làm ơn cho biết tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_466,Tìm giúp tôi top 10 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_467,Cho tôi biết top 100 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_468,Hỏi về tổng tồn kho sản phẩm Women tại các kho ở bang CO,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'CO';"
gen_469,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 1999;"
gen_470,Tìm giúp tôi top 20 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_471,Tìm giúp tôi số lượng khách hàng F sống tại bang CO,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CO' AND cd.cd_gender = 'F';"
gen_472,Tính toán top 50 mặt hàng Electronics bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_473,Số lượng khách hàng F sống tại bang FL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'FL' AND cd.cd_gender = 'F';"
gen_474,Hỏi về tổng doanh thu cửa hàng tại bang ID năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'ID' AND d.d_year = 2002;"
gen_475,Hãy tìm top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_476,Tìm giúp tôi tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_477,Tính toán top 10 sản phẩm danh mục Books bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_478,Top 50 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_479,Tính toán số lượng khách hàng M sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'M';"
gen_480,Truy vấn top 50 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_481,Tính toán doanh thu web sales quý 4 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 4;"
gen_482,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2000;"
gen_483,Hỏi về top 10 sản phẩm danh mục Jewelry bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_484,Tìm giúp tôi tổng doanh thu cửa hàng tại bang FL năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'FL' AND d.d_year = 2001;"
gen_485,Tìm giúp tôi top 100 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_486,Cho tôi biết top 5 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_487,Cho tôi biết tổng chi tiêu của khách hàng có trình độ Secondary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002;"
gen_488,Cho tôi biết top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_489,Hãy tìm khách hàng tình trạng hôn nhân 'D' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Sports';"
gen_490,Hãy tìm tỷ lệ đơn hàng Children có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children';"
gen_491,Liệt kê top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_492,Tính toán top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_493,Hỏi về khách hàng tình trạng hôn nhân 'D' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Jewelry';"
gen_494,Làm ơn cho biết tổng tồn kho sản phẩm Jewelry tại các kho ở bang KY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'KY';"
gen_495,"Hãy tìm khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_496,Cho tôi biết tổng tồn kho sản phẩm Men tại các kho ở bang AK,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'AK';"
gen_497,Hãy tìm khách hàng tình trạng hôn nhân 'S' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Sports';"
gen_498,Tính toán doanh thu web sales quý 2 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2;"
gen_499,Thống kê khách hàng tình trạng hôn nhân 'D' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Books';"
gen_500,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 1999;"
gen_501,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2000;"
gen_502,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2001;"
gen_503,Truy vấn top 5 sản phẩm danh mục Books bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_504,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2000;"
gen_505,Tìm giúp tôi tổng tồn kho sản phẩm Women tại các kho ở bang AL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'AL';"
gen_506,Thống kê tổng chi tiêu của khách hàng có trình độ Secondary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002;"
gen_507,Hãy tìm tổng chi tiêu của khách hàng có trình độ Primary năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999;"
gen_508,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002;"
gen_509,Hãy tìm top 20 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_510,Làm ơn cho biết top 20 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_511,Tính toán doanh thu web sales quý 1 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 1;"
gen_512,Thống kê top 50 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_513,Cho tôi biết tổng chi tiêu của khách hàng có trình độ Secondary năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000;"
gen_514,Liệt kê top 20 sản phẩm danh mục Toys bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Toys' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_515,Truy vấn tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang CO,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'CO'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_516,Liệt kê tỷ lệ đơn hàng Music có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
gen_517,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001;"
gen_518,Liệt kê top 5 sản phẩm danh mục Toys bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Toys' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_519,Top 100 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_520,Thống kê top 20 sản phẩm danh mục Jewelry bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_521,Làm ơn cho biết khách hàng tình trạng hôn nhân 'M' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Books';"
gen_522,Làm ơn cho biết doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_523,Hỏi về số lượng khách hàng M sống tại bang ID,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'ID' AND cd.cd_gender = 'M';"
gen_524,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2002;"
gen_525,Truy vấn tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2001;"
gen_526,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 1999;"
gen_527,Tính toán tổng doanh thu cửa hàng tại bang ID năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'ID' AND d.d_year = 2002;"
gen_528,Liệt kê khách hàng tình trạng hôn nhân 'D' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Home';"
gen_529,Số lượng khách hàng F sống tại bang KY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KY' AND cd.cd_gender = 'F';"
gen_530,Tìm giúp tôi top 5 sản phẩm danh mục Home bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_531,Truy vấn khách hàng tình trạng hôn nhân 'W' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Home';"
gen_532,Truy vấn tổng tồn kho sản phẩm Women tại các kho ở bang GA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'GA';"
gen_533,Hỏi về top 100 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_534,Tính toán tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang AL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'AL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_535,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 1999;"
gen_536,Hỏi về số lượng khách hàng F sống tại bang CO,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CO' AND cd.cd_gender = 'F';"
gen_537,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2002;"
gen_538,Truy vấn tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_539,Liệt kê tỷ lệ đơn hàng Books có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books';"
gen_540,Hỏi về tổng tồn kho sản phẩm Clothing tại các kho ở bang IN,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'IN';"
gen_541,Hãy tìm top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_542,Tính toán khách hàng tình trạng hôn nhân 'S' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Men';"
gen_543,Tính toán doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2002;"
gen_544,Hỏi về doanh thu web sales quý 3 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 3;"
gen_545,Tìm giúp tôi top 20 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_546,Hỏi về top 10 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_547,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2001;"
gen_548,Tìm giúp tôi tỷ lệ đơn hàng Clothing có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing';"
gen_549,Hỏi về top 50 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_550,Tính toán tổng doanh thu cửa hàng tại bang IL năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IL' AND d.d_year = 2002;"
gen_551,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 1999;"
gen_552,Liệt kê tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_553,Hỏi về top 100 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_554,Hãy tìm tỷ lệ đơn hàng Sports có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports';"
gen_555,Tổng doanh thu cửa hàng tại bang DE năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'DE' AND d.d_year = 2000;"
gen_556,Liệt kê doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2000;"
gen_557,Tìm giúp tôi top 5 sản phẩm danh mục Toys bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Toys' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_558,Hỏi về tổng doanh thu cửa hàng tại bang AL năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AL' AND d.d_year = 2000;"
gen_559,Thống kê top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_560,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển AIR năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 1999;"
gen_561,Hãy tìm top 100 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_562,Làm ơn cho biết tổng tồn kho sản phẩm Home tại các kho ở bang AK,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'AK';"
gen_563,"Khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_564,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 1999;"
gen_565,Hãy tìm số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2002;"
gen_566,Thống kê tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang KY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'KY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_567,Hãy tìm top 5 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_568,Tỷ lệ đơn hàng Home có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home';"
gen_569,Thống kê tỷ lệ đơn hàng Music có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
gen_570,Truy vấn số lượng khách hàng M sống tại bang CO,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CO' AND cd.cd_gender = 'M';"
gen_571,Hỏi về tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_572,Cho tôi biết top 5 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_573,Tính toán doanh thu web sales quý 4 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 4;"
gen_574,"Khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_575,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2000;"
gen_576,Tính toán số lượng khách hàng M sống tại bang FL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'FL' AND cd.cd_gender = 'M';"
gen_577,Tỷ lệ đơn hàng Clothing có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing';"
gen_578,Thống kê doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2002;"
gen_579,Cho tôi biết doanh thu web sales quý 3 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 3;"
gen_580,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2001;"
gen_581,Tìm giúp tôi top 10 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_582,Làm ơn cho biết doanh thu web sales quý 3 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 3;"
gen_583,Tìm giúp tôi tỷ lệ đơn hàng Men có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men';"
gen_584,Truy vấn top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_585,Tìm giúp tôi tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang AZ,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'AZ'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_586,Truy vấn khách hàng tình trạng hôn nhân 'D' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Books';"
gen_587,Hỏi về tổng doanh thu cửa hàng tại bang NY năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NY' AND d.d_year = 1999;"
gen_588,Hãy tìm top 100 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_589,Cho tôi biết doanh thu web sales quý 4 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 4;"
gen_590,"Khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_591,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ Secondary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002;"
gen_592,Tìm giúp tôi số lượng khách hàng M sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'M';"
gen_593,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 1999;"
gen_594,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2000;"
gen_595,Hỏi về tỷ lệ đơn hàng Books có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books';"
gen_596,Thống kê top 5 sản phẩm danh mục Jewelry bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_597,Làm ơn cho biết tổng tồn kho sản phẩm Home tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'CA';"
gen_598,Làm ơn cho biết top 50 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_599,Hãy tìm tổng tồn kho sản phẩm Books tại các kho ở bang NY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'NY';"
gen_600,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 1999;"
gen_601,Hãy tìm khách hàng tình trạng hôn nhân 'W' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Men';"
gen_602,Tìm giúp tôi top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_603,Tìm giúp tôi tổng tồn kho sản phẩm Clothing tại các kho ở bang DE,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'DE';"
gen_604,Liệt kê top 10 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_605,Top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_606,Cho tôi biết top 10 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_607,Truy vấn số lượng khách hàng M sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'M';"
gen_608,Doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2000;"
gen_609,Hỏi về tổng tồn kho sản phẩm Jewelry tại các kho ở bang DE,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'DE';"
gen_610,Hỏi về top 5 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_611,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2001;"
gen_612,Thống kê số lượng khách hàng F sống tại bang DE,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'DE' AND cd.cd_gender = 'F';"
gen_613,"Hỏi về khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_614,Thống kê top 50 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_615,Làm ơn cho biết top 100 sản phẩm danh mục Women bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_616,Tính toán khách hàng tình trạng hôn nhân 'W' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Electronics';"
gen_617,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2001;"
gen_618,Làm ơn cho biết tổng tồn kho sản phẩm Home tại các kho ở bang GA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'GA';"
gen_619,Liệt kê doanh thu web sales quý 2 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 2;"
gen_620,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2000;"
gen_621,Hỏi về tổng tồn kho sản phẩm Toys tại các kho ở bang NY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'NY';"
gen_622,Cho tôi biết top 20 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_623,"Tính toán khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_624,Thống kê tổng doanh thu cửa hàng tại bang AK năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AK' AND d.d_year = 2000;"
gen_625,Truy vấn tổng tồn kho sản phẩm Children tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'WA';"
gen_626,Tìm giúp tôi top 5 sản phẩm danh mục Clothing bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_627,Top 20 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_628,Tìm giúp tôi top 10 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_629,Làm ơn cho biết tỷ lệ đơn hàng Clothing có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing';"
gen_630,Tìm giúp tôi top 20 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_631,Thống kê khách hàng tình trạng hôn nhân 'D' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Sports';"
gen_632,Tìm giúp tôi top 100 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_633,Liệt kê tổng doanh thu cửa hàng tại bang HI năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'HI' AND d.d_year = 2002;"
gen_634,Top 20 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_635,Số lượng khách hàng M sống tại bang CA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CA' AND cd.cd_gender = 'M';"
gen_636,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2002;"
gen_637,Liệt kê doanh thu web sales quý 3 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 3;"
gen_638,Tìm giúp tôi tổng tồn kho sản phẩm Women tại các kho ở bang DE,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'DE';"
gen_639,Tìm giúp tôi khách hàng tình trạng hôn nhân 'D' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Sports';"
gen_640,Tìm giúp tôi tỷ lệ đơn hàng Children có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children';"
gen_641,Hãy tìm tổng chi tiêu của khách hàng có trình độ Secondary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001;"
gen_642,Hỏi về doanh thu web sales quý 2 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 2;"
gen_643,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển AIR năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 1999;"
gen_644,Làm ơn cho biết tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang AK,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'AK'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_645,Hãy tìm doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_646,Tính toán top 10 sản phẩm danh mục Men bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_647,Tìm giúp tôi top 100 sản phẩm danh mục Children bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_648,Top 5 sản phẩm danh mục Men bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_649,Top 100 sản phẩm danh mục Sports bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_650,Cho tôi biết khách hàng tình trạng hôn nhân 'W' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Home';"
gen_651,Truy vấn doanh thu web sales quý 2 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2;"
gen_652,Thống kê khách hàng tình trạng hôn nhân 'D' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Music';"
gen_653,Liệt kê tổng tồn kho sản phẩm Jewelry tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'TX';"
gen_654,Thống kê tỷ lệ đơn hàng Clothing có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing';"
gen_655,Hỏi về tổng tồn kho sản phẩm Toys tại các kho ở bang IL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'IL';"
gen_656,Tính toán tổng doanh thu cửa hàng tại bang IN năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 2002;"
gen_657,Số lượng khách hàng M sống tại bang KY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KY' AND cd.cd_gender = 'M';"
gen_658,Tìm giúp tôi top 10 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_659,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 1999;"
gen_660,"Khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2001","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001);"
gen_661,Cho tôi biết top 50 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_662,Cho tôi biết khách hàng tình trạng hôn nhân 'D' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Electronics';"
gen_663,Tính toán tổng tồn kho sản phẩm Clothing tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'AZ';"
gen_664,Số lượng khách hàng F sống tại bang HI,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'HI' AND cd.cd_gender = 'F';"
gen_665,Làm ơn cho biết top 20 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_666,Làm ơn cho biết tổng tồn kho sản phẩm Home tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'TX';"
gen_667,Cho tôi biết tổng doanh thu cửa hàng tại bang DE năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'DE' AND d.d_year = 2001;"
gen_668,Làm ơn cho biết tổng doanh thu cửa hàng tại bang CA năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CA' AND d.d_year = 2001;"
gen_669,Tính toán tỷ lệ đơn hàng Toys có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys';"
gen_670,Top 5 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_671,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2001;"
gen_672,Hãy tìm tổng doanh thu cửa hàng tại bang AZ năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AZ' AND d.d_year = 2000;"
gen_673,Hỏi về tổng tồn kho sản phẩm Jewelry tại các kho ở bang NY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'NY';"
gen_674,Cho tôi biết tổng doanh thu cửa hàng tại bang NY năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NY' AND d.d_year = 2001;"
gen_675,Số lượng khách hàng F sống tại bang IL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IL' AND cd.cd_gender = 'F';"
gen_676,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2002;"
gen_677,Liệt kê tỷ lệ đơn hàng Men có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men';"
gen_678,Hãy tìm số lượng khách hàng M sống tại bang IL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IL' AND cd.cd_gender = 'M';"
gen_679,Thống kê doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_680,Hãy tìm tổng chi tiêu của khách hàng có trình độ Secondary năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999;"
gen_681,Thống kê tổng tồn kho sản phẩm Sports tại các kho ở bang IN,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'IN';"
gen_682,Thống kê tổng chi tiêu của khách hàng có trình độ Primary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001;"
gen_683,Hãy tìm top 50 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_684,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2002;"
gen_685,Tính toán tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_686,Tính toán top 10 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_687,Làm ơn cho biết top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_688,Hỏi về khách hàng tình trạng hôn nhân 'S' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Children';"
gen_689,Thống kê top 50 sản phẩm danh mục Clothing bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_690,Tìm giúp tôi tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang AZ,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'AZ'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_691,Thống kê doanh thu web sales quý 2 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2;"
gen_692,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2002;"
gen_693,Tìm giúp tôi tổng doanh thu cửa hàng tại bang WA năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 2002;"
gen_694,Hỏi về số lượng khách hàng F sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'F';"
gen_695,"Hỏi về khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_696,Cho tôi biết top 20 sản phẩm danh mục Men bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_697,Hãy tìm top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_698,Thống kê tổng doanh thu cửa hàng tại bang AR năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AR' AND d.d_year = 1999;"
gen_699,Hỏi về top 100 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_700,Hỏi về tổng tồn kho sản phẩm Jewelry tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'TX';"
gen_701,Cho tôi biết tổng doanh thu cửa hàng tại bang IN năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 2001;"
gen_702,Thống kê tổng doanh thu cửa hàng tại bang ID năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'ID' AND d.d_year = 2000;"
gen_703,Hỏi về top 50 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_704,Cho tôi biết tổng chi tiêu của khách hàng có trình độ College năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002;"
gen_705,Tính toán tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002;"
gen_706,Cho tôi biết tổng doanh thu cửa hàng tại bang AK năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AK' AND d.d_year = 2001;"
gen_707,Hãy tìm top 20 sản phẩm danh mục Children bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_708,Hỏi về doanh thu web sales quý 3 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 3;"
gen_709,Làm ơn cho biết tổng tồn kho sản phẩm Jewelry tại các kho ở bang DE,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'DE';"
gen_710,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2000;"
gen_711,Liệt kê tổng tồn kho sản phẩm Electronics tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'WA';"
gen_712,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2002;"
gen_713,Cho tôi biết top 10 sản phẩm danh mục Clothing bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_714,Hãy tìm số lượng khách hàng M sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'M';"
gen_715,Tìm giúp tôi top 20 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_716,Hỏi về tổng doanh thu cửa hàng tại bang KS năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS' AND d.d_year = 2001;"
gen_717,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2002;"
gen_718,Tính toán tổng tồn kho sản phẩm Women tại các kho ở bang AR,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'AR';"
gen_719,Hãy tìm top 50 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_720,Truy vấn tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang GA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'GA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_721,Cho tôi biết tổng doanh thu cửa hàng tại bang HI năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'HI' AND d.d_year = 2000;"
gen_722,Hãy tìm top 20 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_723,Làm ơn cho biết top 10 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_724,Truy vấn tổng tồn kho sản phẩm Women tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'CA';"
gen_725,Tìm giúp tôi tổng tồn kho sản phẩm Toys tại các kho ở bang CO,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'CO';"
gen_726,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2000;"
gen_727,Hãy tìm doanh thu web sales quý 3 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 3;"
gen_728,Truy vấn doanh thu web sales quý 4 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 4;"
gen_729,Hãy tìm top 20 sản phẩm danh mục Electronics bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_730,Hỏi về top 50 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_731,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2002;"
gen_732,Hãy tìm tổng tồn kho sản phẩm Jewelry tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'KS';"
gen_733,Thống kê tổng doanh thu cửa hàng tại bang DE năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'DE' AND d.d_year = 1999;"
gen_734,Hãy tìm top 20 sản phẩm danh mục Clothing bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_735,Tìm giúp tôi top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_736,Cho tôi biết khách hàng tình trạng hôn nhân 'M' thích mua Women không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Women';"
gen_737,Hỏi về tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang AK,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'AK'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_738,Liệt kê top 50 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_739,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2002;"
gen_740,Cho tôi biết top 5 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_741,Truy vấn tỷ lệ đơn hàng Music có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
gen_742,Doanh thu web sales quý 2 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2;"
gen_743,Thống kê số lượng khách hàng F sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'F';"
gen_744,Thống kê số lượng khách hàng M sống tại bang HI,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'HI' AND cd.cd_gender = 'M';"
gen_745,Thống kê top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_746,Liệt kê tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_747,Làm ơn cho biết doanh thu web sales quý 2 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2;"
gen_748,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ Secondary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001;"
gen_749,Cho tôi biết tổng tồn kho sản phẩm Jewelry tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'AZ';"
gen_750,Tính toán tổng tồn kho sản phẩm Men tại các kho ở bang FL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'FL';"
gen_751,Cho tôi biết top 5 sản phẩm danh mục Jewelry bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_752,Làm ơn cho biết top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_753,Thống kê tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_754,Hỏi về top 20 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_755,Tìm giúp tôi số lượng khách hàng M sống tại bang TX,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'TX' AND cd.cd_gender = 'M';"
gen_756,Top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_757,Cho tôi biết tổng doanh thu cửa hàng tại bang AL năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AL' AND d.d_year = 2002;"
gen_758,Liệt kê tổng chi tiêu của khách hàng có trình độ Primary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002;"
gen_759,Thống kê tỷ lệ đơn hàng Home có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home';"
gen_760,Hãy tìm số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2001;"
gen_761,Liệt kê top 50 sản phẩm danh mục Children bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_762,Cho tôi biết tổng tồn kho sản phẩm Children tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'AZ';"
gen_763,Hãy tìm top 10 sản phẩm danh mục Jewelry bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_764,Tìm giúp tôi số lượng khách hàng M sống tại bang KY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KY' AND cd.cd_gender = 'M';"
gen_765,Làm ơn cho biết top 5 sản phẩm danh mục Music bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_766,Cho tôi biết tổng doanh thu cửa hàng tại bang IL năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IL' AND d.d_year = 2000;"
gen_767,Cho tôi biết tỷ lệ đơn hàng Books có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books';"
gen_768,Hãy tìm top 20 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_769,Cho tôi biết tổng tồn kho sản phẩm Home tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'CA';"
gen_770,Hãy tìm khách hàng tình trạng hôn nhân 'M' thích mua Women không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Women';"
gen_771,Hãy tìm tổng chi tiêu của khách hàng có trình độ College năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000;"
gen_772,"Truy vấn khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_773,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2000;"
gen_774,Làm ơn cho biết top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_775,Hãy tìm top 50 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_776,Truy vấn top 100 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_777,Thống kê tỷ lệ đơn hàng Women có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women';"
gen_778,Liệt kê top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_779,Thống kê khách hàng tình trạng hôn nhân 'S' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Toys';"
gen_780,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2000;"
gen_781,Tìm giúp tôi tổng tồn kho sản phẩm Books tại các kho ở bang DE,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'DE';"
gen_782,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 1999;"
gen_783,Tính toán tổng tồn kho sản phẩm Women tại các kho ở bang IN,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'IN';"
gen_784,Cho tôi biết khách hàng tình trạng hôn nhân 'S' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Jewelry';"
gen_785,Thống kê top 100 sản phẩm danh mục Books bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_786,Làm ơn cho biết top 5 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_787,Hỏi về khách hàng tình trạng hôn nhân 'D' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Children';"
gen_788,Làm ơn cho biết top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_789,Cho tôi biết tổng doanh thu cửa hàng tại bang FL năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'FL' AND d.d_year = 2000;"
gen_790,Hãy tìm số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2000;"
gen_791,Truy vấn khách hàng tình trạng hôn nhân 'D' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Toys';"
gen_792,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2001;"
gen_793,Thống kê tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999;"
gen_794,Doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 1999;"
gen_795,Tính toán khách hàng tình trạng hôn nhân 'D' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Home';"
gen_796,Doanh thu web sales quý 1 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 1;"
gen_797,Hỏi về top 50 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_798,Cho tôi biết tổng doanh thu cửa hàng tại bang TX năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX' AND d.d_year = 2001;"
gen_799,Tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001;"
gen_800,Tính toán tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000;"
gen_801,Truy vấn doanh thu web sales quý 1 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 1;"
gen_802,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2000;"
gen_803,Top 5 sản phẩm danh mục Electronics bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_804,Hãy tìm tổng chi tiêu của khách hàng có trình độ College năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002;"
gen_805,Liệt kê doanh thu web sales quý 4 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4;"
gen_806,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2001;"
gen_807,Liệt kê khách hàng tình trạng hôn nhân 'M' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Home';"
gen_808,Thống kê top 20 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_809,Liệt kê tỷ lệ đơn hàng Women có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women';"
gen_810,Liệt kê tổng chi tiêu của khách hàng có trình độ College năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002;"
gen_811,Doanh thu web sales quý 4 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4;"
gen_812,Làm ơn cho biết top 5 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_813,Liệt kê tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang GA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'GA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_814,Tìm giúp tôi khách hàng tình trạng hôn nhân 'S' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Toys';"
gen_815,Top 10 sản phẩm danh mục Sports bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_816,Cho tôi biết tổng tồn kho sản phẩm Music tại các kho ở bang IA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'IA';"
gen_817,Hãy tìm số lượng khách hàng M sống tại bang KY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KY' AND cd.cd_gender = 'M';"
gen_818,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 1999;"
gen_819,Hãy tìm số lượng khách hàng M sống tại bang IN,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IN' AND cd.cd_gender = 'M';"
gen_820,Liệt kê top 50 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_821,Truy vấn tổng doanh thu cửa hàng tại bang CA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CA' AND d.d_year = 2000;"
gen_822,Hãy tìm tổng doanh thu cửa hàng tại bang AR năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AR' AND d.d_year = 2000;"
gen_823,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001;"
gen_824,Tìm giúp tôi tổng doanh thu cửa hàng tại bang CT năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CT' AND d.d_year = 2001;"
gen_825,Truy vấn tổng doanh thu cửa hàng tại bang GA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'GA' AND d.d_year = 2000;"
gen_826,Cho tôi biết top 10 sản phẩm danh mục Music bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_827,Thống kê tổng tồn kho sản phẩm Men tại các kho ở bang AK,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'AK';"
gen_828,Hỏi về tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_829,Cho tôi biết top 5 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_830,Top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_831,Làm ơn cho biết top 10 sản phẩm danh mục Home bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_832,Truy vấn top 5 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_833,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 1999;"
gen_834,Cho tôi biết top 50 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_835,Truy vấn top 50 sản phẩm danh mục Electronics bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_836,Tổng tồn kho sản phẩm Toys tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'KS';"
gen_837,Hãy tìm tổng tồn kho sản phẩm Children tại các kho ở bang IN,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'IN';"
gen_838,Thống kê top 10 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_839,Số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2000;"
gen_840,Tìm giúp tôi số lượng khách hàng M sống tại bang GA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'GA' AND cd.cd_gender = 'M';"
gen_841,Tổng tồn kho sản phẩm Men tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'KS';"
gen_842,Hãy tìm tổng doanh thu cửa hàng tại bang IL năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IL' AND d.d_year = 2001;"
gen_843,Liệt kê tổng tồn kho sản phẩm Clothing tại các kho ở bang KY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'KY';"
gen_844,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 1999;"
gen_845,Truy vấn top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_846,Thống kê khách hàng tình trạng hôn nhân 'D' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Toys';"
gen_847,Truy vấn doanh thu web sales quý 3 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 3;"
gen_848,Top 5 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_849,Tính toán top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_850,Cho tôi biết top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_851,Truy vấn tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang AK,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'AK'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_852,Hãy tìm tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_853,Tính toán doanh thu web sales quý 3 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 3;"
gen_854,Liệt kê số lượng khách hàng M sống tại bang TX,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'TX' AND cd.cd_gender = 'M';"
gen_855,Thống kê tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_856,Top 10 sản phẩm danh mục Women bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_857,Top 10 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_858,Cho tôi biết top 10 sản phẩm danh mục Women bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_859,Cho tôi biết tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang KY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'KY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_860,Cho tôi biết top 50 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_861,Hãy tìm top 20 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_862,Tính toán doanh thu web sales quý 4 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;"
gen_863,Truy vấn doanh thu web sales quý 2 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2;"
gen_864,Thống kê tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang CO,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'CO'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_865,Truy vấn doanh thu web sales quý 4 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4;"
gen_866,Truy vấn top 10 sản phẩm danh mục Women bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_867,Tìm giúp tôi top 100 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_868,Liệt kê doanh thu web sales quý 1 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 1;"
gen_869,Cho tôi biết top 20 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_870,Tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang HI,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'HI'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_871,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2000;"
gen_872,Top 20 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_873,Hãy tìm top 50 sản phẩm danh mục Jewelry bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_874,"Tìm giúp tôi khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_875,Tìm giúp tôi khách hàng tình trạng hôn nhân 'W' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Books';"
gen_876,Tổng doanh thu cửa hàng tại bang GA năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'GA' AND d.d_year = 1999;"
gen_877,Hãy tìm top 10 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_878,Làm ơn cho biết số lượng khách hàng F sống tại bang AL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AL' AND cd.cd_gender = 'F';"
gen_879,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2002;"
gen_880,Liệt kê top 5 sản phẩm danh mục Music bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_881,Thống kê tổng tồn kho sản phẩm Men tại các kho ở bang NY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'NY';"
gen_882,Liệt kê doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2001;"
gen_883,Truy vấn tổng doanh thu cửa hàng tại bang IL năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IL' AND d.d_year = 1999;"
gen_884,Khách hàng tình trạng hôn nhân 'W' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Home';"
gen_885,Liệt kê số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2002;"
gen_886,Hãy tìm tổng doanh thu cửa hàng tại bang CT năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CT' AND d.d_year = 1999;"
gen_887,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 1999;"
gen_888,Làm ơn cho biết tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_889,Cho tôi biết tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001;"
gen_890,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ Primary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001;"
gen_891,Cho tôi biết số lượng khách hàng M sống tại bang CA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CA' AND cd.cd_gender = 'M';"
gen_892,Làm ơn cho biết tổng doanh thu cửa hàng tại bang NY năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NY' AND d.d_year = 2001;"
gen_893,Làm ơn cho biết tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_894,Liệt kê khách hàng tình trạng hôn nhân 'W' thích mua Women không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Women';"
gen_895,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ College năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 1999;"
gen_896,Tìm giúp tôi số lượng khách hàng M sống tại bang AR,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AR' AND cd.cd_gender = 'M';"
gen_897,Liệt kê doanh thu web sales quý 2 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2;"
gen_898,Cho tôi biết doanh thu web sales quý 4 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4;"
gen_899,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2000;"
gen_900,Tính toán tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_901,"Cho tôi biết khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_902,Hỏi về tổng tồn kho sản phẩm Men tại các kho ở bang IL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'IL';"
gen_903,Tìm giúp tôi top 20 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_904,Làm ơn cho biết số lượng khách hàng F sống tại bang AR,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AR' AND cd.cd_gender = 'F';"
gen_905,Cho tôi biết doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_906,Hỏi về số lượng khách hàng M sống tại bang GA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'GA' AND cd.cd_gender = 'M';"
gen_907,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2002;"
gen_908,Hãy tìm số lượng khách hàng F sống tại bang AK,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AK' AND cd.cd_gender = 'F';"
gen_909,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2000;"
gen_910,Làm ơn cho biết số lượng khách hàng F sống tại bang AK,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AK' AND cd.cd_gender = 'F';"
gen_911,"Liệt kê khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2001","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001);"
gen_912,Top 50 sản phẩm danh mục Sports bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_913,Thống kê top 20 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_914,Cho tôi biết tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_915,Thống kê tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_916,Tính toán tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_917,Hỏi về top 50 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_918,Hỏi về tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang ID,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'ID'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_919,Thống kê top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_920,Làm ơn cho biết tỷ lệ đơn hàng Men có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men';"
gen_921,Liệt kê doanh thu web sales quý 2 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 2;"
gen_922,Top 5 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_923,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2002;"
gen_924,Tổng tồn kho sản phẩm Children tại các kho ở bang AR,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'AR';"
gen_925,Truy vấn top 20 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_926,Truy vấn tổng chi tiêu của khách hàng có trình độ Secondary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002;"
gen_927,Hãy tìm khách hàng tình trạng hôn nhân 'D' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Music';"
gen_928,Thống kê tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang FL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'FL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_929,Liệt kê top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_930,Khách hàng tình trạng hôn nhân 'M' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Children';"
gen_931,Truy vấn tổng chi tiêu của khách hàng có trình độ Secondary năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000;"
gen_932,Thống kê top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_933,Làm ơn cho biết số lượng khách hàng F sống tại bang FL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'FL' AND cd.cd_gender = 'F';"
gen_934,Tính toán tổng doanh thu cửa hàng tại bang KY năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY' AND d.d_year = 1999;"
gen_935,Cho tôi biết khách hàng tình trạng hôn nhân 'D' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Sports';"
gen_936,Thống kê doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2001;"
gen_937,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2000;"
gen_938,Truy vấn khách hàng tình trạng hôn nhân 'S' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Electronics';"
gen_939,Hãy tìm tổng tồn kho sản phẩm Children tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'HI';"
gen_940,Tìm giúp tôi tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_941,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2002;"
gen_942,Truy vấn tổng tồn kho sản phẩm Electronics tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'TX';"
gen_943,Liệt kê tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_944,Tính toán doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2002;"
gen_945,Hỏi về khách hàng tình trạng hôn nhân 'D' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Home';"
gen_946,Tính toán top 20 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_947,Tổng chi tiêu của khách hàng có trình độ Primary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002;"
gen_948,Truy vấn tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang TX,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'TX'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_949,Hỏi về tổng doanh thu cửa hàng tại bang CT năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CT' AND d.d_year = 2002;"
gen_950,Thống kê tổng doanh thu cửa hàng tại bang KY năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY' AND d.d_year = 2002;"
gen_951,Hãy tìm tổng tồn kho sản phẩm Electronics tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'CA';"
gen_952,Truy vấn top 20 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_953,"Hãy tìm khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_954,Tìm giúp tôi top 10 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_955,Hãy tìm top 50 sản phẩm danh mục Sports bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_956,Cho tôi biết số lượng khách hàng M sống tại bang KS,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KS' AND cd.cd_gender = 'M';"
gen_957,Làm ơn cho biết doanh thu web sales quý 4 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;"
gen_958,Tổng tồn kho sản phẩm Jewelry tại các kho ở bang IL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'IL';"
gen_959,Top 100 sản phẩm danh mục Clothing bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_960,Tính toán doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2000;"
gen_961,Cho tôi biết khách hàng tình trạng hôn nhân 'D' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Home';"
gen_962,Thống kê tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang AK,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'AK'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_963,Làm ơn cho biết top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_964,Liệt kê top 10 sản phẩm danh mục Clothing bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_965,Tính toán khách hàng tình trạng hôn nhân 'S' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Books';"
gen_966,Hỏi về tổng tồn kho sản phẩm Children tại các kho ở bang FL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'FL';"
gen_967,Số lượng khách hàng M sống tại bang WA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'WA' AND cd.cd_gender = 'M';"
gen_968,Doanh thu web sales sử dụng phương thức vận chuyển AIR năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 1999;"
gen_969,Làm ơn cho biết tỷ lệ đơn hàng Books có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books';"
gen_970,Hỏi về tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999;"
gen_971,Liệt kê số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2000;"
gen_972,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 1999;"
gen_973,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2000;"
gen_974,Truy vấn tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_975,Cho tôi biết tổng doanh thu cửa hàng tại bang AR năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AR' AND d.d_year = 2001;"
gen_976,Thống kê tổng chi tiêu của khách hàng có trình độ Secondary năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000;"
gen_977,Tính toán tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang KY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'KY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_978,Thống kê tỷ lệ đơn hàng Toys có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys';"
gen_979,Cho tôi biết top 5 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_980,Thống kê top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_981,Thống kê doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2002;"
gen_982,Thống kê tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang CO,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'CO'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_983,Cho tôi biết top 20 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_984,Hãy tìm tổng doanh thu cửa hàng tại bang AL năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AL' AND d.d_year = 1999;"
gen_985,Tính toán doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2001;"
gen_986,Cho tôi biết tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang HI,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'HI'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_987,Thống kê tổng tồn kho sản phẩm Toys tại các kho ở bang IA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'IA';"
gen_988,Làm ơn cho biết tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_989,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 1999;"
gen_990,Hãy tìm tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_991,Tìm giúp tôi tổng doanh thu cửa hàng tại bang TX năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX' AND d.d_year = 2002;"
gen_992,Truy vấn top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_993,Tìm giúp tôi tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_994,Tổng doanh thu cửa hàng tại bang IA năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA' AND d.d_year = 2002;"
gen_995,Tổng doanh thu cửa hàng tại bang HI năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'HI' AND d.d_year = 2001;"
gen_996,Hỏi về top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_997,Liệt kê khách hàng tình trạng hôn nhân 'M' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Toys';"
gen_998,Tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang NY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'NY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_999,Tìm giúp tôi top 10 sản phẩm danh mục Men bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1000,Tìm giúp tôi tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang CO,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'CO'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1001,Thống kê top 10 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1002,Làm ơn cho biết top 100 sản phẩm danh mục Clothing bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1003,Tìm giúp tôi tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1004,Cho tôi biết tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2002;"
gen_1005,Tính toán tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1006,Hỏi về tổng tồn kho sản phẩm Toys tại các kho ở bang AK,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'AK';"
gen_1007,Truy vấn khách hàng tình trạng hôn nhân 'M' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Books';"
gen_1008,Hỏi về số lượng khách hàng F sống tại bang KY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KY' AND cd.cd_gender = 'F';"
gen_1009,Tính toán top 50 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1010,Tìm giúp tôi tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang AK,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'AK'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1011,Truy vấn top 100 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1012,Tổng doanh thu cửa hàng tại bang DE năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'DE' AND d.d_year = 1999;"
gen_1013,Thống kê top 20 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1014,Khách hàng tình trạng hôn nhân 'D' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Books';"
gen_1015,Thống kê doanh thu web sales quý 1 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1;"
gen_1016,Cho tôi biết số lượng khách hàng M sống tại bang CT,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CT' AND cd.cd_gender = 'M';"
gen_1017,Cho tôi biết tổng chi tiêu của khách hàng có trình độ Secondary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001;"
gen_1018,Truy vấn tổng doanh thu cửa hàng tại bang IA năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA' AND d.d_year = 2002;"
gen_1019,Khách hàng tình trạng hôn nhân 'S' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Jewelry';"
gen_1020,Hỏi về tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang TX,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'TX'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1021,Hãy tìm top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1022,Cho tôi biết tỷ lệ đơn hàng Home có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Home';"
gen_1023,"Làm ơn cho biết khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2002","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2002);"
gen_1024,Làm ơn cho biết số lượng khách hàng M sống tại bang FL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'FL' AND cd.cd_gender = 'M';"
gen_1025,Hãy tìm top 20 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1026,Liệt kê tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang HI,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'HI'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1027,Thống kê top 10 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1028,Tính toán khách hàng tình trạng hôn nhân 'D' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Books';"
gen_1029,Truy vấn khách hàng tình trạng hôn nhân 'W' thích mua Women không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Women';"
gen_1030,Cho tôi biết top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1031,Top 50 sản phẩm danh mục Home bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1032,Thống kê top 20 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_1033,Doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2000;"
gen_1034,Liệt kê tỷ lệ đơn hàng Sports có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports';"
gen_1035,Làm ơn cho biết tổng doanh thu cửa hàng tại bang NY năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NY' AND d.d_year = 2000;"
gen_1036,Top 100 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1037,Hỏi về tổng tồn kho sản phẩm Children tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'HI';"
gen_1038,Truy vấn top 5 sản phẩm danh mục Sports bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1039,Tính toán tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1040,Thống kê top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1041,Thống kê tổng tồn kho sản phẩm Sports tại các kho ở bang NY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'NY';"
gen_1042,Doanh thu web sales quý 3 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 3;"
gen_1043,Top 50 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1044,Truy vấn tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang GA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'GA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1045,Hỏi về khách hàng tình trạng hôn nhân 'S' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Home';"
gen_1046,Hỏi về tổng doanh thu cửa hàng tại bang IN năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 2000;"
gen_1047,Tính toán khách hàng tình trạng hôn nhân 'W' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Books';"
gen_1048,Tính toán top 10 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1049,Liệt kê top 20 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1050,Liệt kê tổng doanh thu cửa hàng tại bang IA năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA' AND d.d_year = 2001;"
gen_1051,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2002;"
gen_1052,Tìm giúp tôi top 100 sản phẩm danh mục Music bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1053,Tính toán top 20 sản phẩm danh mục Children bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1054,Hãy tìm khách hàng tình trạng hôn nhân 'M' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Books';"
gen_1055,Liệt kê top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_1056,Cho tôi biết top 100 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1057,Cho tôi biết top 50 sản phẩm danh mục Music bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1058,Liệt kê khách hàng tình trạng hôn nhân 'M' thích mua Women không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Women';"
gen_1059,Làm ơn cho biết tổng tồn kho sản phẩm Jewelry tại các kho ở bang IL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'IL';"
gen_1060,Truy vấn khách hàng tình trạng hôn nhân 'M' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Children';"
gen_1061,Tính toán tổng doanh thu cửa hàng tại bang AZ năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AZ' AND d.d_year = 1999;"
gen_1062,Cho tôi biết top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1063,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2002;"
gen_1064,Hãy tìm tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang AL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'AL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1065,Làm ơn cho biết khách hàng tình trạng hôn nhân 'S' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Home';"
gen_1066,Thống kê top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1067,Cho tôi biết tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang NY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'NY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1068,Hỏi về top 5 sản phẩm danh mục Women bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1069,Liệt kê khách hàng tình trạng hôn nhân 'M' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Sports';"
gen_1070,Hãy tìm tổng tồn kho sản phẩm Children tại các kho ở bang KY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'KY';"
gen_1071,Cho tôi biết tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang FL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'FL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1072,Hỏi về doanh thu web sales quý 4 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4;"
gen_1073,Thống kê tổng doanh thu cửa hàng tại bang AZ năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AZ' AND d.d_year = 2001;"
gen_1074,Tìm giúp tôi tổng doanh thu cửa hàng tại bang TX năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX' AND d.d_year = 2000;"
gen_1075,Liệt kê top 20 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1076,Cho tôi biết tổng doanh thu cửa hàng tại bang WA năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 2001;"
gen_1077,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2000;"
gen_1078,Làm ơn cho biết số lượng khách hàng F sống tại bang HI,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'HI' AND cd.cd_gender = 'F';"
gen_1079,Thống kê top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1080,Tính toán tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang ID,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'ID'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1081,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ College năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001;"
gen_1082,Truy vấn khách hàng tình trạng hôn nhân 'M' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Home';"
gen_1083,Tỷ lệ đơn hàng Books có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books';"
gen_1084,Tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang KY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'KY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1085,Làm ơn cho biết tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang TX,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'TX'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1086,Hỏi về top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_1087,Hãy tìm số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2002;"
gen_1088,Truy vấn top 50 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1089,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999;"
gen_1090,Liệt kê top 100 mặt hàng Electronics bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1091,Hãy tìm tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1092,Hãy tìm top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1093,Cho tôi biết top 10 sản phẩm danh mục Jewelry bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1094,Số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2000;"
gen_1095,Làm ơn cho biết khách hàng tình trạng hôn nhân 'S' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Toys';"
gen_1096,Cho tôi biết top 100 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1097,Liệt kê khách hàng tình trạng hôn nhân 'D' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Toys';"
gen_1098,Tính toán khách hàng tình trạng hôn nhân 'W' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Music';"
gen_1099,Hỏi về doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_1100,Truy vấn doanh thu web sales quý 3 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 3;"
gen_1101,Tìm giúp tôi tổng tồn kho sản phẩm Music tại các kho ở bang AR,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'AR';"
gen_1102,Số lượng khách hàng M sống tại bang IN,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IN' AND cd.cd_gender = 'M';"
gen_1103,Truy vấn top 5 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1104,Hỏi về số lượng khách hàng M sống tại bang CA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CA' AND cd.cd_gender = 'M';"
gen_1105,Hãy tìm top 100 sản phẩm danh mục Home bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1106,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2002;"
gen_1107,Cho tôi biết số lượng khách hàng M sống tại bang GA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'GA' AND cd.cd_gender = 'M';"
gen_1108,Tìm giúp tôi top 50 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1109,Liệt kê tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1110,Hãy tìm tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang IN,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'IN'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1111,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2001;"
gen_1112,Tổng tồn kho sản phẩm Home tại các kho ở bang AR,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'AR';"
gen_1113,Làm ơn cho biết top 100 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1114,Cho tôi biết tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1115,Hỏi về doanh thu web sales quý 1 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1;"
gen_1116,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 1999;"
gen_1117,Khách hàng tình trạng hôn nhân 'W' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Music';"
gen_1118,Tính toán top 50 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1119,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2000;"
gen_1120,Truy vấn top 5 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1121,Khách hàng tình trạng hôn nhân 'M' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Men';"
gen_1122,Tính toán tổng tồn kho sản phẩm Children tại các kho ở bang CT,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'CT';"
gen_1123,Hãy tìm tổng tồn kho sản phẩm Music tại các kho ở bang AR,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'AR';"
gen_1124,Thống kê tổng tồn kho sản phẩm Children tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'TX';"
gen_1125,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2002;"
gen_1126,Làm ơn cho biết top 100 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1127,Tính toán top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1128,Thống kê khách hàng tình trạng hôn nhân 'W' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Sports';"
gen_1129,Hãy tìm số lượng khách hàng F sống tại bang IL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IL' AND cd.cd_gender = 'F';"
gen_1130,Tìm giúp tôi tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1131,Liệt kê top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_1132,Hỏi về khách hàng tình trạng hôn nhân 'W' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Music';"
gen_1133,Làm ơn cho biết số lượng khách hàng M sống tại bang CO,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CO' AND cd.cd_gender = 'M';"
gen_1134,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển AIR năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 1999;"
gen_1135,Tính toán tổng doanh thu cửa hàng tại bang DE năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'DE' AND d.d_year = 2001;"
gen_1136,Làm ơn cho biết tổng doanh thu cửa hàng tại bang IL năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IL' AND d.d_year = 1999;"
gen_1137,Số lượng khách hàng F sống tại bang WA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'WA' AND cd.cd_gender = 'F';"
gen_1138,Tìm giúp tôi top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1139,Liệt kê top 10 sản phẩm danh mục Children bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1140,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2000;"
gen_1141,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2001;"
gen_1142,Hỏi về tổng tồn kho sản phẩm Women tại các kho ở bang CT,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'CT';"
gen_1143,Hỏi về top 5 sản phẩm danh mục Books bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1144,"Tính toán khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2001","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2001);"
gen_1145,Truy vấn tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang FL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'FL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1146,Truy vấn top 50 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1147,Hỏi về top 20 sản phẩm danh mục Home bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1148,Thống kê tổng doanh thu cửa hàng tại bang KY năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY' AND d.d_year = 1999;"
gen_1149,Thống kê top 5 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1150,Liệt kê tổng tồn kho sản phẩm Women tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'KS';"
gen_1151,Tìm giúp tôi top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1152,"Tìm giúp tôi khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_1153,Làm ơn cho biết tổng doanh thu cửa hàng tại bang AZ năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AZ' AND d.d_year = 2001;"
gen_1154,Hỏi về tổng tồn kho sản phẩm Music tại các kho ở bang KY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'KY';"
gen_1155,Cho tôi biết top 20 sản phẩm danh mục Clothing bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1156,Cho tôi biết tổng tồn kho sản phẩm Children tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'HI';"
gen_1157,Tính toán khách hàng tình trạng hôn nhân 'S' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Jewelry';"
gen_1158,Thống kê top 10 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1159,Liệt kê doanh thu web sales quý 4 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 4;"
gen_1160,Liệt kê top 10 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1161,Truy vấn top 10 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1162,Cho tôi biết top 10 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1163,Số lượng khách hàng M sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'M';"
gen_1164,Truy vấn tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1165,Thống kê top 50 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1166,Top 100 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1167,Hỏi về khách hàng tình trạng hôn nhân 'W' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Jewelry';"
gen_1168,Hãy tìm top 100 sản phẩm danh mục Music bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1169,Tính toán tổng chi tiêu của khách hàng có trình độ Primary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002;"
gen_1170,Tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_1171,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2002;"
gen_1172,Truy vấn tổng doanh thu cửa hàng tại bang ID năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'ID' AND d.d_year = 2001;"
gen_1173,Hỏi về tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang FL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'FL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1174,Hãy tìm số lượng khách hàng F sống tại bang ID,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'ID' AND cd.cd_gender = 'F';"
gen_1175,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000;"
gen_1176,Tính toán tỷ lệ đơn hàng Music có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
gen_1177,Tìm giúp tôi tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1178,Cho tôi biết doanh thu web sales quý 2 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2;"
gen_1179,Liệt kê khách hàng tình trạng hôn nhân 'W' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Toys';"
gen_1180,Doanh thu web sales quý 4 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 4;"
gen_1181,Hãy tìm doanh thu web sales quý 4 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;"
gen_1182,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 1999;"
gen_1183,Liệt kê tổng doanh thu cửa hàng tại bang AK năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AK' AND d.d_year = 2000;"
gen_1184,Cho tôi biết tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang FL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'FL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1185,Thống kê tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001;"
gen_1186,Hỏi về top 20 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1187,Truy vấn top 50 sản phẩm danh mục Books bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1188,Hỏi về top 100 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1189,Tính toán doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_1190,Hãy tìm số lượng khách hàng F sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'F';"
gen_1191,Tính toán tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang CO,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'CO'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1192,Hãy tìm tổng tồn kho sản phẩm Books tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'AZ';"
gen_1193,Tính toán top 10 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1194,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2001;"
gen_1195,Hỏi về top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1196,Hãy tìm tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000;"
gen_1197,Liệt kê tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang AL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'AL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1198,Liệt kê doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 1999;"
gen_1199,Tổng doanh thu cửa hàng tại bang NY năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NY' AND d.d_year = 2002;"
gen_1200,Cho tôi biết top 50 sản phẩm danh mục Men bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1201,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2000;"
gen_1202,Liệt kê doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2001;"
gen_1203,Hãy tìm top 20 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_1204,Doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_1205,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2001;"
gen_1206,Hỏi về tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2001;"
gen_1207,Làm ơn cho biết số lượng khách hàng F sống tại bang TX,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'TX' AND cd.cd_gender = 'F';"
gen_1208,Tìm giúp tôi khách hàng tình trạng hôn nhân 'D' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Music';"
gen_1209,Tìm giúp tôi khách hàng tình trạng hôn nhân 'S' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Books';"
gen_1210,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2002;"
gen_1211,Thống kê khách hàng tình trạng hôn nhân 'S' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Music';"
gen_1212,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999;"
gen_1213,Top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1214,Tính toán top 5 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1215,Làm ơn cho biết top 50 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1216,Làm ơn cho biết tổng tồn kho sản phẩm Clothing tại các kho ở bang CO,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'CO';"
gen_1217,Thống kê tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1218,Hỏi về tổng doanh thu cửa hàng tại bang DE năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'DE' AND d.d_year = 2002;"
gen_1219,Hỏi về top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1220,Liệt kê top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1221,Hãy tìm tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang AZ,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'AZ'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1222,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2002;"
gen_1223,Top 5 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1224,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2000;"
gen_1225,Liệt kê tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_1226,Tìm giúp tôi tổng doanh thu cửa hàng tại bang AL năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AL' AND d.d_year = 2000;"
gen_1227,Thống kê top 20 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_1228,Tìm giúp tôi top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1229,Tính toán tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_1230,Hỏi về top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_1231,Cho tôi biết tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1232,Tìm giúp tôi top 5 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1233,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2001;"
gen_1234,Liệt kê tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001;"
gen_1235,Liệt kê top 5 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1236,Tính toán tổng doanh thu cửa hàng tại bang IN năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 2000;"
gen_1237,Làm ơn cho biết top 10 sản phẩm danh mục Sports bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1238,Hãy tìm số lượng khách hàng F sống tại bang WA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'WA' AND cd.cd_gender = 'F';"
gen_1239,Hãy tìm top 5 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1240,Tổng chi tiêu của khách hàng có trình độ Primary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001;"
gen_1241,Hỏi về top 20 sản phẩm danh mục Children bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1242,Tìm giúp tôi top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1243,Tính toán top 20 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_1244,Top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1245,Liệt kê số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2002;"
gen_1246,Tính toán số lượng khách hàng M sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'M';"
gen_1247,Truy vấn top 50 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1248,"Cho tôi biết khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_1249,Thống kê khách hàng tình trạng hôn nhân 'S' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Jewelry';"
gen_1250,Tính toán tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang FL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'FL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1251,Hãy tìm tổng chi tiêu của khách hàng có trình độ Primary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002;"
gen_1252,Liệt kê tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang ID,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'ID'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1253,Hỏi về top 5 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1254,Hỏi về tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1255,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2002;"
gen_1256,Cho tôi biết tổng doanh thu cửa hàng tại bang KY năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY' AND d.d_year = 1999;"
gen_1257,Liệt kê top 10 sản phẩm danh mục Home bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1258,Cho tôi biết tổng doanh thu cửa hàng tại bang CT năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CT' AND d.d_year = 2002;"
gen_1259,Tính toán khách hàng tình trạng hôn nhân 'D' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Electronics';"
gen_1260,Top 100 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1261,Thống kê khách hàng tình trạng hôn nhân 'M' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Books';"
gen_1262,Cho tôi biết tổng doanh thu cửa hàng tại bang KY năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY' AND d.d_year = 2000;"
gen_1263,Liệt kê top 10 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1264,Hỏi về số lượng khách hàng M sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'M';"
gen_1265,Tính toán tổng tồn kho sản phẩm Books tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'TX';"
gen_1266,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2002;"
gen_1267,Truy vấn top 10 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1268,Làm ơn cho biết top 20 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1269,Liệt kê tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang HI,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'HI'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1270,Hỏi về số lượng khách hàng M sống tại bang IL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IL' AND cd.cd_gender = 'M';"
gen_1271,Tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002;"
gen_1272,Thống kê tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_1273,Cho tôi biết top 20 sản phẩm danh mục Men bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1274,Hãy tìm top 50 sản phẩm danh mục Music bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1275,Liệt kê số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2000;"
gen_1276,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 1999;"
gen_1277,Cho tôi biết tổng tồn kho sản phẩm Women tại các kho ở bang CT,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'CT';"
gen_1278,Tìm giúp tôi tỷ lệ đơn hàng Music có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
gen_1279,Truy vấn doanh thu web sales quý 1 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1;"
gen_1280,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 1999;"
gen_1281,Tính toán tổng tồn kho sản phẩm Books tại các kho ở bang AK,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'AK';"
gen_1282,Cho tôi biết top 50 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1283,Truy vấn tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1284,Tính toán top 20 sản phẩm danh mục Men bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1285,Hỏi về khách hàng tình trạng hôn nhân 'S' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Music';"
gen_1286,Hãy tìm tỷ lệ đơn hàng Clothing có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing';"
gen_1287,Liệt kê top 50 sản phẩm danh mục Jewelry bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1288,Hãy tìm tổng tồn kho sản phẩm Sports tại các kho ở bang IL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'IL';"
gen_1289,Làm ơn cho biết số lượng khách hàng M sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'M';"
gen_1290,Tìm giúp tôi tổng tồn kho sản phẩm Home tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'CA';"
gen_1291,Làm ơn cho biết khách hàng tình trạng hôn nhân 'S' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Jewelry';"
gen_1292,Cho tôi biết số lượng khách hàng M sống tại bang DE,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'DE' AND cd.cd_gender = 'M';"
gen_1293,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2001;"
gen_1294,Làm ơn cho biết tổng doanh thu cửa hàng tại bang IN năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 1999;"
gen_1295,Tính toán top 20 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1296,Top 100 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1297,Tính toán top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1298,Liệt kê tổng chi tiêu của khách hàng có trình độ Primary năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2000;"
gen_1299,Truy vấn tổng doanh thu cửa hàng tại bang DE năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'DE' AND d.d_year = 1999;"
gen_1300,Tìm giúp tôi top 20 sản phẩm danh mục Books bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1301,Thống kê top 100 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1302,Tổng tồn kho sản phẩm Women tại các kho ở bang KY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'KY';"
gen_1303,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 1999;"
gen_1304,Cho tôi biết tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999;"
gen_1305,Tính toán tổng tồn kho sản phẩm Children tại các kho ở bang FL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'FL';"
gen_1306,Thống kê tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1307,Làm ơn cho biết tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1308,Tìm giúp tôi khách hàng tình trạng hôn nhân 'M' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Music';"
gen_1309,Cho tôi biết tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1310,Tính toán top 100 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1311,Tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000;"
gen_1312,Thống kê top 20 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1313,Doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2002;"
gen_1314,Hãy tìm khách hàng tình trạng hôn nhân 'D' thích mua Clothing không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Clothing';"
gen_1315,Hãy tìm top 50 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1316,Truy vấn tổng doanh thu cửa hàng tại bang KY năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY' AND d.d_year = 2002;"
gen_1317,Liệt kê tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1318,Thống kê số lượng khách hàng M sống tại bang IN,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IN' AND cd.cd_gender = 'M';"
gen_1319,Hãy tìm khách hàng tình trạng hôn nhân 'S' thích mua Clothing không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Clothing';"
gen_1320,Hãy tìm tỷ lệ đơn hàng Men có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men';"
gen_1321,Hãy tìm tổng tồn kho sản phẩm Home tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'TX';"
gen_1322,Hỏi về top 5 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1323,Hãy tìm tỷ lệ đơn hàng Books có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books';"
gen_1324,Tính toán top 10 mặt hàng Electronics bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1325,Hãy tìm số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2001;"
gen_1326,Liệt kê số lượng khách hàng M sống tại bang WA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'WA' AND cd.cd_gender = 'M';"
gen_1327,Cho tôi biết top 5 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1328,Hãy tìm tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_1329,Làm ơn cho biết top 50 sản phẩm danh mục Electronics bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1330,Cho tôi biết top 10 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1331,Làm ơn cho biết tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1332,Làm ơn cho biết tổng tồn kho sản phẩm Electronics tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'WA';"
gen_1333,Làm ơn cho biết tỷ lệ đơn hàng Music có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
gen_1334,Cho tôi biết số lượng khách hàng M sống tại bang KY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KY' AND cd.cd_gender = 'M';"
gen_1335,Hỏi về khách hàng tình trạng hôn nhân 'W' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Electronics';"
gen_1336,Liệt kê tổng tồn kho sản phẩm Men tại các kho ở bang AK,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'AK';"
gen_1337,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2002;"
gen_1338,Hãy tìm top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1339,Tổng tồn kho sản phẩm Sports tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'WA';"
gen_1340,Cho tôi biết tỷ lệ đơn hàng Men có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men';"
gen_1341,Làm ơn cho biết doanh thu web sales quý 4 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 4;"
gen_1342,Hãy tìm top 50 mặt hàng Electronics bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1343,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000;"
gen_1344,Hãy tìm tổng doanh thu cửa hàng tại bang HI năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'HI' AND d.d_year = 2001;"
gen_1345,Cho tôi biết tổng doanh thu cửa hàng tại bang ID năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'ID' AND d.d_year = 2002;"
gen_1346,Truy vấn khách hàng tình trạng hôn nhân 'W' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Men';"
gen_1347,Doanh thu web sales quý 4 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;"
gen_1348,Truy vấn top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1349,Hãy tìm tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1350,Thống kê doanh thu web sales quý 4 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 4;"
gen_1351,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2002;"
gen_1352,Thống kê top 5 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1353,Hỏi về top 50 sản phẩm danh mục Jewelry bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1354,Tìm giúp tôi top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1355,Hỏi về số lượng khách hàng M sống tại bang DE,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'DE' AND cd.cd_gender = 'M';"
gen_1356,Số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2000;"
gen_1357,Tính toán doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_1358,Tính toán top 10 sản phẩm danh mục Electronics bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1359,Hãy tìm tổng doanh thu cửa hàng tại bang CO năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CO' AND d.d_year = 2002;"
gen_1360,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2000;"
gen_1361,Tính toán tỷ lệ đơn hàng Women có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women';"
gen_1362,Tính toán tỷ lệ đơn hàng Sports có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports';"
gen_1363,Liệt kê khách hàng tình trạng hôn nhân 'W' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Men';"
gen_1364,Truy vấn tỷ lệ đơn hàng Clothing có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing';"
gen_1365,Tìm giúp tôi top 5 sản phẩm danh mục Women bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1366,Thống kê tổng tồn kho sản phẩm Women tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'HI';"
gen_1367,Truy vấn khách hàng tình trạng hôn nhân 'D' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Home';"
gen_1368,Tìm giúp tôi số lượng khách hàng F sống tại bang KY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KY' AND cd.cd_gender = 'F';"
gen_1369,Liệt kê tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999;"
gen_1370,Liệt kê top 20 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1371,Cho tôi biết top 10 sản phẩm danh mục Sports bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1372,Số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2001;"
gen_1373,Làm ơn cho biết tổng doanh thu cửa hàng tại bang HI năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'HI' AND d.d_year = 2001;"
gen_1374,Truy vấn tỷ lệ đơn hàng Women có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women';"
gen_1375,Tính toán top 10 sản phẩm danh mục Clothing bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1376,Truy vấn khách hàng tình trạng hôn nhân 'M' thích mua Clothing không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Clothing';"
gen_1377,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2001;"
gen_1378,Hãy tìm tổng tồn kho sản phẩm Children tại các kho ở bang NY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'NY';"
gen_1379,Truy vấn số lượng khách hàng F sống tại bang CO,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CO' AND cd.cd_gender = 'F';"
gen_1380,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 1999;"
gen_1381,Hỏi về tổng chi tiêu của khách hàng có trình độ College năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000;"
gen_1382,Tính toán số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 1999;"
gen_1383,Cho tôi biết top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1384,"Liệt kê khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 2000","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 2000);"
gen_1385,Thống kê top 50 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1386,Cho tôi biết top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1387,Hãy tìm tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang KY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'KY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1388,Làm ơn cho biết top 5 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1389,Tính toán top 20 sản phẩm danh mục Electronics bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1390,Hỏi về tổng chi tiêu của khách hàng có trình độ Primary năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999;"
gen_1391,Truy vấn top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_1392,Thống kê top 10 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1393,Cho tôi biết khách hàng tình trạng hôn nhân 'D' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Jewelry';"
gen_1394,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2000;"
gen_1395,Hỏi về tổng doanh thu cửa hàng tại bang WA năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 1999;"
gen_1396,Hỏi về khách hàng tình trạng hôn nhân 'M' thích mua Clothing không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Clothing';"
gen_1397,Thống kê top 100 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1398,Tính toán tổng doanh thu cửa hàng tại bang WA năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 2001;"
gen_1399,Hãy tìm khách hàng tình trạng hôn nhân 'W' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Electronics';"
gen_1400,Cho tôi biết top 50 sản phẩm danh mục Children bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1401,Làm ơn cho biết tổng tồn kho sản phẩm Electronics tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'AZ';"
gen_1402,Truy vấn tổng tồn kho sản phẩm Home tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'WA';"
gen_1403,Thống kê doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2001;"
gen_1404,Hỏi về top 10 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1405,Hãy tìm tổng doanh thu cửa hàng tại bang TX năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX' AND d.d_year = 2002;"
gen_1406,Tìm giúp tôi tổng doanh thu cửa hàng tại bang AR năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AR' AND d.d_year = 2002;"
gen_1407,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2002;"
gen_1408,Truy vấn top 10 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1409,Hãy tìm số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2002;"
gen_1410,Tính toán tỷ lệ đơn hàng Children có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children';"
gen_1411,Tính toán top 5 sản phẩm danh mục Jewelry bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1412,Thống kê tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000;"
gen_1413,Truy vấn top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1414,Tìm giúp tôi top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1415,Liệt kê tổng tồn kho sản phẩm Women tại các kho ở bang IN,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'IN';"
gen_1416,Tính toán tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999;"
gen_1417,Làm ơn cho biết top 100 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1418,Liệt kê số lượng khách hàng F sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'F';"
gen_1419,Hỏi về số lượng khách hàng F sống tại bang HI,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'HI' AND cd.cd_gender = 'F';"
gen_1420,Thống kê tổng doanh thu cửa hàng tại bang CO năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CO' AND d.d_year = 2002;"
gen_1421,Cho tôi biết tổng tồn kho sản phẩm Books tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'WA';"
gen_1422,Top 10 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1423,Liệt kê số lượng khách hàng F sống tại bang CT,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CT' AND cd.cd_gender = 'F';"
gen_1424,Tính toán top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1425,Tổng tồn kho sản phẩm Home tại các kho ở bang GA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'GA';"
gen_1426,Top 100 mặt hàng Electronics bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1427,Tính toán tỷ lệ đơn hàng Men có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men';"
gen_1428,Liệt kê tổng doanh thu cửa hàng tại bang AL năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AL' AND d.d_year = 2001;"
gen_1429,Tính toán tổng tồn kho sản phẩm Women tại các kho ở bang IL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'IL';"
gen_1430,Làm ơn cho biết tỷ lệ đơn hàng Toys có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys';"
gen_1431,Liệt kê tổng tồn kho sản phẩm Toys tại các kho ở bang NY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'NY';"
gen_1432,Tính toán top 100 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1433,Thống kê tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang IN,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'IN'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1434,Tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1435,Tìm giúp tôi tổng doanh thu cửa hàng tại bang CA năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CA' AND d.d_year = 1999;"
gen_1436,Truy vấn doanh thu web sales quý 4 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;"
gen_1437,Hỏi về doanh thu web sales quý 4 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;"
gen_1438,Tính toán tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1439,Truy vấn top 10 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1440,Hỏi về top 100 sản phẩm danh mục Jewelry bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1441,Số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2001;"
gen_1442,Cho tôi biết top 100 sản phẩm danh mục Jewelry bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1443,Thống kê tỷ lệ đơn hàng Men có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Men';"
gen_1444,Hỏi về tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999;"
gen_1445,"Liệt kê khách hàng nào mua hàng ở cả 3 kênh store, web, catalog trong năm 1999","SELECT c.c_customer_id
FROM customer c
WHERE EXISTS (SELECT 1 FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999)
AND EXISTS (SELECT 1 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND d.d_year = 1999);"
gen_1446,Hỏi về tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999;"
gen_1447,Tìm giúp tôi top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1448,Tính toán khách hàng tình trạng hôn nhân 'W' thích mua Women không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Women';"
gen_1449,Thống kê tổng tồn kho sản phẩm Music tại các kho ở bang GA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'GA';"
gen_1450,Hãy tìm top 20 sản phẩm danh mục Jewelry bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1451,Truy vấn top 5 sản phẩm danh mục Women bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1452,Tính toán tổng chi tiêu của khách hàng có trình độ Secondary năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999;"
gen_1453,Hãy tìm tổng doanh thu cửa hàng tại bang WA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 2000;"
gen_1454,Làm ơn cho biết tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1455,Hãy tìm top 50 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1456,Doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 1999;"
gen_1457,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2000;"
gen_1458,Thống kê doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2002;"
gen_1459,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 1999;"
gen_1460,Thống kê số lượng khách hàng F sống tại bang HI,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'HI' AND cd.cd_gender = 'F';"
gen_1461,Truy vấn số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2001;"
gen_1462,Truy vấn tổng tồn kho sản phẩm Jewelry tại các kho ở bang DE,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'DE';"
gen_1463,Tính toán top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1464,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2001;"
gen_1465,Làm ơn cho biết top 5 sản phẩm danh mục Books bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1466,Tính toán tổng doanh thu cửa hàng tại bang IA năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA' AND d.d_year = 1999;"
gen_1467,Liệt kê top 20 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_1468,Top 5 sản phẩm danh mục Women bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1469,Cho tôi biết số lượng khách hàng M sống tại bang WA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'WA' AND cd.cd_gender = 'M';"
gen_1470,Làm ơn cho biết tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1471,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2000;"
gen_1472,Làm ơn cho biết top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1473,Thống kê top 5 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1474,Tìm giúp tôi doanh thu web sales quý 1 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 1;"
gen_1475,Cho tôi biết tổng tồn kho sản phẩm Home tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'KS';"
gen_1476,Cho tôi biết tổng doanh thu cửa hàng tại bang AZ năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AZ' AND d.d_year = 1999;"
gen_1477,Số lượng khách hàng F sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'F';"
gen_1478,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển AIR năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 1999;"
gen_1479,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2001;"
gen_1480,Làm ơn cho biết khách hàng tình trạng hôn nhân 'S' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Electronics';"
gen_1481,Cho tôi biết tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_1482,Tính toán tổng tồn kho sản phẩm Electronics tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'AZ';"
gen_1483,Tìm giúp tôi khách hàng tình trạng hôn nhân 'D' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Books';"
gen_1484,Hãy tìm top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1485,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2002;"
gen_1486,Doanh thu web sales quý 2 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 2;"
gen_1487,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2002;"
gen_1488,Tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1489,Top 5 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1490,Hỏi về tổng tồn kho sản phẩm Books tại các kho ở bang CT,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'CT';"
gen_1491,Truy vấn tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000;"
gen_1492,Hãy tìm top 5 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1493,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999;"
gen_1494,Thống kê top 10 sản phẩm danh mục Children bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1495,Truy vấn tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1496,Cho tôi biết doanh thu web sales quý 1 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 1;"
gen_1497,Cho tôi biết tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000;"
gen_1498,Cho tôi biết top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1499,Tính toán doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2000;"
gen_1500,Truy vấn tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1501,Hãy tìm số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2002;"
gen_1502,Hỏi về tỷ lệ đơn hàng Music có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Music';"
gen_1503,Hãy tìm top 10 sản phẩm danh mục Books bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1504,Top 50 sản phẩm danh mục Books bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1505,Làm ơn cho biết doanh thu web sales quý 3 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 3;"
gen_1506,Thống kê top 10 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1507,Tìm giúp tôi doanh thu web sales quý 2 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 2;"
gen_1508,Tính toán số lượng khách hàng M sống tại bang GA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'GA' AND cd.cd_gender = 'M';"
gen_1509,Liệt kê tổng tồn kho sản phẩm Electronics tại các kho ở bang NY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'NY';"
gen_1510,Cho tôi biết top 5 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1511,Liệt kê top 50 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1512,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2000;"
gen_1513,Truy vấn tổng tồn kho sản phẩm Sports tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'HI';"
gen_1514,Cho tôi biết top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_1515,Hỏi về tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_1516,Tìm giúp tôi doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_1517,Liệt kê khách hàng tình trạng hôn nhân 'M' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Books';"
gen_1518,Truy vấn tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_1519,Liệt kê số lượng khách hàng F sống tại bang IN,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IN' AND cd.cd_gender = 'F';"
gen_1520,Liệt kê top 5 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1521,Liệt kê tổng doanh thu cửa hàng tại bang IN năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 2000;"
gen_1522,Tìm giúp tôi tổng tồn kho sản phẩm Clothing tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'AZ';"
gen_1523,Hãy tìm doanh thu web sales quý 4 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 4;"
gen_1524,Tìm giúp tôi tổng tồn kho sản phẩm Music tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'CA';"
gen_1525,Hãy tìm top 100 sản phẩm danh mục Electronics bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1526,Làm ơn cho biết tổng doanh thu cửa hàng tại bang IA năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA' AND d.d_year = 2002;"
gen_1527,Hãy tìm số lượng khách hàng M sống tại bang WA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'WA' AND cd.cd_gender = 'M';"
gen_1528,Liệt kê tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang KY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'KY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1529,Thống kê số lượng khách hàng F sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'F';"
gen_1530,Tính toán top 50 sản phẩm danh mục Clothing bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1531,Truy vấn tổng tồn kho sản phẩm Women tại các kho ở bang DE,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'DE';"
gen_1532,Làm ơn cho biết top 50 sản phẩm danh mục Men bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1533,Cho tôi biết khách hàng tình trạng hôn nhân 'W' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Jewelry';"
gen_1534,Cho tôi biết tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000;"
gen_1535,Liệt kê doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_1536,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển AIR năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 1999;"
gen_1537,Tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang TX,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'TX'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1538,Doanh thu web sales quý 4 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 4;"
gen_1539,Tính toán tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang AZ,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'AZ'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1540,Làm ơn cho biết khách hàng tình trạng hôn nhân 'M' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Sports';"
gen_1541,Truy vấn số lượng khách hàng M sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'M';"
gen_1542,Truy vấn tổng tồn kho sản phẩm Music tại các kho ở bang IA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'IA';"
gen_1543,Hỏi về top 20 sản phẩm danh mục Music bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1544,Cho tôi biết top 10 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1545,Liệt kê doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2000;"
gen_1546,Hỏi về top 20 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1547,Tìm giúp tôi tổng doanh thu cửa hàng tại bang ID năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'ID' AND d.d_year = 2001;"
gen_1548,Liệt kê số lượng khách hàng F sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'F';"
gen_1549,Hãy tìm tổng doanh thu cửa hàng tại bang KS năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS' AND d.d_year = 2000;"
gen_1550,Tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1551,Top 50 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1552,Tính toán tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1553,Tính toán tổng tồn kho sản phẩm Women tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'HI';"
gen_1554,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2002;"
gen_1555,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2000;"
gen_1556,Tìm giúp tôi doanh thu web sales quý 2 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 2;"
gen_1557,Hãy tìm top 20 mặt hàng Electronics bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1558,Thống kê số lượng khách hàng M sống tại bang NY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'NY' AND cd.cd_gender = 'M';"
gen_1559,Hãy tìm doanh thu web sales quý 2 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2;"
gen_1560,Hỏi về top 10 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1561,Tìm giúp tôi top 10 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1562,Thống kê khách hàng tình trạng hôn nhân 'S' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Men';"
gen_1563,Tìm giúp tôi tổng doanh thu cửa hàng tại bang IL năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IL' AND d.d_year = 1999;"
gen_1564,Thống kê doanh thu web sales quý 3 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 3;"
gen_1565,Truy vấn tổng chi tiêu của khách hàng có trình độ College năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000;"
gen_1566,Tìm giúp tôi tỷ lệ đơn hàng Books có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Books';"
gen_1567,Thống kê doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 1999;"
gen_1568,Tìm giúp tôi top 50 sản phẩm danh mục Women bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1569,Hỏi về số lượng khách hàng M sống tại bang TX,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'TX' AND cd.cd_gender = 'M';"
gen_1570,Tính toán tổng tồn kho sản phẩm Clothing tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'KS';"
gen_1571,Làm ơn cho biết số lượng khách hàng M sống tại bang ID,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'ID' AND cd.cd_gender = 'M';"
gen_1572,Tính toán top 5 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1573,Hỏi về top 20 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1574,Làm ơn cho biết tổng doanh thu cửa hàng tại bang IA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA' AND d.d_year = 2000;"
gen_1575,Hãy tìm top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1576,Hãy tìm top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1577,Cho tôi biết tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang TX,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'TX'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1578,Tìm giúp tôi doanh thu web sales quý 3 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 3;"
gen_1579,Làm ơn cho biết top 50 sản phẩm danh mục Children bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1580,Liệt kê số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2002;"
gen_1581,Thống kê top 5 sản phẩm danh mục Home bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1582,Thống kê doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 1999;"
gen_1583,Liệt kê tổng tồn kho sản phẩm Home tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'KS';"
gen_1584,Cho tôi biết top 5 sản phẩm danh mục Sports bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1585,Tìm giúp tôi số lượng khách hàng F sống tại bang TX,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'TX' AND cd.cd_gender = 'F';"
gen_1586,Tìm giúp tôi số lượng khách hàng F sống tại bang FL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'FL' AND cd.cd_gender = 'F';"
gen_1587,Hãy tìm khách hàng tình trạng hôn nhân 'M' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Sports';"
gen_1588,Tính toán tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000;"
gen_1589,Tổng tồn kho sản phẩm Children tại các kho ở bang ID,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'ID';"
gen_1590,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 1999;"
gen_1591,Truy vấn top 10 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1592,Thống kê tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang HI,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'HI'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1593,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2001;"
gen_1594,Khách hàng tình trạng hôn nhân 'D' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Home';"
gen_1595,Tìm giúp tôi doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_1596,Cho tôi biết tổng tồn kho sản phẩm Music tại các kho ở bang CO,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'CO';"
gen_1597,Truy vấn tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1598,Tìm giúp tôi tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1599,Hỏi về tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1600,Hãy tìm top 5 sản phẩm danh mục Clothing bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1601,Tổng tồn kho sản phẩm Books tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'AZ';"
gen_1602,Hỏi về top 5 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1603,Cho tôi biết tổng doanh thu cửa hàng tại bang AL năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AL' AND d.d_year = 2001;"
gen_1604,Liệt kê top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1605,Tính toán số lượng khách hàng M sống tại bang CO,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CO' AND cd.cd_gender = 'M';"
gen_1606,Truy vấn top 5 sản phẩm danh mục Home bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1607,Hỏi về top 20 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1608,Truy vấn top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1609,Tổng doanh thu cửa hàng tại bang TX năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX' AND d.d_year = 1999;"
gen_1610,Thống kê khách hàng tình trạng hôn nhân 'S' thích mua Clothing không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Clothing';"
gen_1611,Liệt kê doanh thu web sales quý 1 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 1;"
gen_1612,Hãy tìm tỷ lệ đơn hàng Women có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women';"
gen_1613,Hãy tìm tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999;"
gen_1614,Làm ơn cho biết tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang ID,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'ID'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1615,Làm ơn cho biết top 100 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1616,Tìm giúp tôi tổng doanh thu cửa hàng tại bang AR năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AR' AND d.d_year = 2001;"
gen_1617,Tính toán tổng doanh thu cửa hàng tại bang KS năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS' AND d.d_year = 2000;"
gen_1618,Hỏi về tỷ lệ đơn hàng Sports có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports';"
gen_1619,Cho tôi biết tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_1620,Làm ơn cho biết top 50 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1621,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'wrong size' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong size' AND d.d_year = 2001;"
gen_1622,Thống kê top 100 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1623,Cho tôi biết tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang IN,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'IN'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1624,Cho tôi biết tổng tồn kho sản phẩm Jewelry tại các kho ở bang KY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'KY';"
gen_1625,Cho tôi biết tỷ lệ đơn hàng Women có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Women';"
gen_1626,Liệt kê top 10 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1627,Thống kê tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang IN,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'IN'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1628,Tìm giúp tôi khách hàng tình trạng hôn nhân 'D' thích mua Home không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Home';"
gen_1629,Tìm giúp tôi tổng doanh thu cửa hàng tại bang FL năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'FL' AND d.d_year = 1999;"
gen_1630,Tổng chi tiêu của khách hàng có trình độ Secondary năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000;"
gen_1631,Tìm giúp tôi tổng doanh thu cửa hàng tại bang AZ năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AZ' AND d.d_year = 1999;"
gen_1632,Làm ơn cho biết doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2000;"
gen_1633,Thống kê số lượng khách hàng F sống tại bang CA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CA' AND cd.cd_gender = 'F';"
gen_1634,Liệt kê top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1635,Tính toán khách hàng tình trạng hôn nhân 'D' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Men';"
gen_1636,Làm ơn cho biết top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_1637,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ College năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002;"
gen_1638,Hỏi về tổng chi tiêu của khách hàng có trình độ Primary năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002;"
gen_1639,Khách hàng tình trạng hôn nhân 'S' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Men';"
gen_1640,Truy vấn tổng tồn kho sản phẩm Sports tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Sports' AND w.w_state = 'KS';"
gen_1641,Thống kê tổng tồn kho sản phẩm Women tại các kho ở bang ID,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'ID';"
gen_1642,Truy vấn top 5 mặt hàng Electronics bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1643,Truy vấn top 10 sản phẩm danh mục Music bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1644,Làm ơn cho biết top 20 sản phẩm danh mục Toys bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Toys' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1645,Tính toán top 20 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1646,Thống kê top 10 sản phẩm danh mục Clothing bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1647,Thống kê số lượng khách hàng M sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'M';"
gen_1648,Tổng doanh thu cửa hàng tại bang CO năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CO' AND d.d_year = 2001;"
gen_1649,Tìm giúp tôi khách hàng tình trạng hôn nhân 'D' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Electronics';"
gen_1650,Tính toán top 50 sản phẩm danh mục Women bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1651,Liệt kê tỷ lệ đơn hàng Children có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children';"
gen_1652,Tính toán top 50 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1653,Cho tôi biết top 50 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1654,Thống kê tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang NY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'NY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1655,Cho tôi biết tổng tồn kho sản phẩm Clothing tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'WA';"
gen_1656,Cho tôi biết số lượng khách hàng F sống tại bang FL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'FL' AND cd.cd_gender = 'F';"
gen_1657,Thống kê top 5 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1658,Làm ơn cho biết top 10 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1659,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2002;"
gen_1660,Truy vấn doanh thu web sales quý 2 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 2;"
gen_1661,Tìm giúp tôi khách hàng tình trạng hôn nhân 'S' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Music';"
gen_1662,Thống kê doanh thu web sales quý 2 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2;"
gen_1663,Tính toán tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang IN,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'IN'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1664,Liệt kê tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang AZ,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'AZ'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1665,Thống kê tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang IN,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'IN'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1666,Cho tôi biết top 50 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1667,Liệt kê doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_1668,Khách hàng tình trạng hôn nhân 'W' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Toys';"
gen_1669,Hãy tìm top 10 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1670,Top 20 sản phẩm danh mục Sports bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1671,Tỷ lệ đơn hàng Jewelry có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry';"
gen_1672,Cho tôi biết top 5 sản phẩm danh mục Music bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1673,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2002;"
gen_1674,Hỏi về top 5 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1675,Tính toán số lượng khách hàng M sống tại bang HI,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'HI' AND cd.cd_gender = 'M';"
gen_1676,Liệt kê tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang TX,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'TX'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1677,Tìm giúp tôi tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang TX,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'TX'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1678,Liệt kê khách hàng tình trạng hôn nhân 'W' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Jewelry';"
gen_1679,Liệt kê top 100 sản phẩm danh mục Electronics bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1680,Làm ơn cho biết tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1681,Cho tôi biết top 50 sản phẩm danh mục Sports bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1682,Tính toán top 10 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1683,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2002;"
gen_1684,Hỏi về tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang CO,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'CO'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1685,Truy vấn tổng doanh thu cửa hàng tại bang IN năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 2001;"
gen_1686,Tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999;"
gen_1687,Tính toán top 50 sản phẩm danh mục Clothing bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1688,Hãy tìm số lượng khách hàng M sống tại bang AR,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AR' AND cd.cd_gender = 'M';"
gen_1689,Hãy tìm top 100 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1690,Làm ơn cho biết tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1691,Hãy tìm tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1692,Thống kê doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2001;"
gen_1693,Tính toán top 5 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1694,Truy vấn top 50 sản phẩm danh mục Women bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1695,Hỏi về doanh thu web sales quý 1 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 1;"
gen_1696,Cho tôi biết tổng tồn kho sản phẩm Jewelry tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'KS';"
gen_1697,Thống kê top 10 khách hàng mua nhiều Clothing nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Clothing'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1698,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 2002;"
gen_1699,Liệt kê top 20 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_1700,Hãy tìm tổng tồn kho sản phẩm Home tại các kho ở bang IN,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'IN';"
gen_1701,Truy vấn top 20 sản phẩm danh mục Sports bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1702,Truy vấn tổng chi tiêu của khách hàng có trình độ Secondary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001;"
gen_1703,Tổng doanh thu cửa hàng tại bang NY năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NY' AND d.d_year = 1999;"
gen_1704,Tính toán top 20 sản phẩm danh mục Clothing bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1705,Thống kê số lượng khách hàng M sống tại bang AL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AL' AND cd.cd_gender = 'M';"
gen_1706,Làm ơn cho biết khách hàng tình trạng hôn nhân 'W' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Sports';"
gen_1707,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2000;"
gen_1708,Hãy tìm top 100 sản phẩm danh mục Home bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1709,Tìm giúp tôi khách hàng tình trạng hôn nhân 'W' thích mua Music không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Music';"
gen_1710,Hỏi về doanh thu web sales quý 3 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 3;"
gen_1711,Cho tôi biết tổng tồn kho sản phẩm Home tại các kho ở bang FL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Home' AND w.w_state = 'FL';"
gen_1712,Tìm giúp tôi top 5 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1713,Làm ơn cho biết tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang FL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'FL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1714,Tính toán top 50 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1715,Liệt kê khách hàng tình trạng hôn nhân 'W' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Electronics';"
gen_1716,Hãy tìm doanh thu web sales quý 2 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 2;"
gen_1717,Tìm giúp tôi top 50 sản phẩm danh mục Sports bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1718,Tổng tồn kho sản phẩm Books tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'KS';"
gen_1719,Cho tôi biết tổng chi tiêu của khách hàng có trình độ Primary năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2000;"
gen_1720,Thống kê top 5 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1721,Làm ơn cho biết top 20 sản phẩm danh mục Children bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1722,Tính toán top 100 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1723,Tìm giúp tôi doanh thu web sales quý 1 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 1;"
gen_1724,Thống kê tìm các mặt hàng Jewelry bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Jewelry' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1725,Thống kê top 5 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1726,Hỏi về top 5 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1727,Làm ơn cho biết số lượng khách hàng F sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'F';"
gen_1728,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'damaged' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'damaged' AND d.d_year = 2000;"
gen_1729,Hãy tìm tổng tồn kho sản phẩm Toys tại các kho ở bang GA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'GA';"
gen_1730,Làm ơn cho biết tổng doanh thu cửa hàng tại bang KS năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KS' AND d.d_year = 2001;"
gen_1731,Cho tôi biết số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 2002,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 2002;"
gen_1732,Cho tôi biết doanh thu web sales quý 4 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 4;"
gen_1733,Liệt kê top 100 sản phẩm danh mục Music bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1734,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2002;"
gen_1735,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999;"
gen_1736,Làm ơn cho biết tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang DE,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'DE'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1737,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 1999;"
gen_1738,Cho tôi biết khách hàng tình trạng hôn nhân 'W' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Toys';"
gen_1739,Tính toán tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001;"
gen_1740,Hãy tìm top 5 sản phẩm danh mục Children bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1741,Top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1742,Tính toán tổng doanh thu cửa hàng tại bang GA năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'GA' AND d.d_year = 2002;"
gen_1743,Hãy tìm top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1744,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'too small' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too small' AND d.d_year = 1999;"
gen_1745,Làm ơn cho biết khách hàng tình trạng hôn nhân 'M' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Electronics';"
gen_1746,Tìm giúp tôi tổng doanh thu cửa hàng tại bang CO năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CO' AND d.d_year = 1999;"
gen_1747,Truy vấn tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002;"
gen_1748,Thống kê số lượng khách hàng F sống tại bang IL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IL' AND cd.cd_gender = 'F';"
gen_1749,Tổng doanh thu cửa hàng tại bang CA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CA' AND d.d_year = 2000;"
gen_1750,Tìm giúp tôi tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang AL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'AL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1751,Cho tôi biết tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang NY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'NY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1752,Hãy tìm tổng tồn kho sản phẩm Electronics tại các kho ở bang AR,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'AR';"
gen_1753,Thống kê số lượng khách hàng M sống tại bang CT,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CT' AND cd.cd_gender = 'M';"
gen_1754,Tính toán số lượng khách hàng F sống tại bang AK,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AK' AND cd.cd_gender = 'F';"
gen_1755,Làm ơn cho biết top 5 sản phẩm danh mục Children bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1756,Truy vấn tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1757,Hỏi về top 50 sản phẩm danh mục Toys bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Toys' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1758,Số lượng khách hàng F sống tại bang DE,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'DE' AND cd.cd_gender = 'F';"
gen_1759,Tính toán tổng doanh thu cửa hàng tại bang WA năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 2002;"
gen_1760,Tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002;"
gen_1761,Tính toán top 100 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1762,Liệt kê top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1763,Liệt kê tổng chi tiêu của khách hàng có trình độ College năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000;"
gen_1764,Tính toán khách hàng tình trạng hôn nhân 'M' thích mua Electronics không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Electronics';"
gen_1765,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 2000;"
gen_1766,Cho tôi biết top 5 sản phẩm danh mục Music bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1767,Hỏi về số lượng khách hàng M sống tại bang AR,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AR' AND cd.cd_gender = 'M';"
gen_1768,Tính toán top 50 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1769,Hỏi về top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_1770,Truy vấn tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1771,Hãy tìm tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1772,Hãy tìm top 20 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1773,Làm ơn cho biết tổng doanh thu cửa hàng tại bang ID năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'ID' AND d.d_year = 2001;"
gen_1774,Hỏi về top 10 mặt hàng Home bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Home'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1775,Làm ơn cho biết tổng tồn kho sản phẩm Clothing tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'CA';"
gen_1776,Hỏi về tổng tồn kho sản phẩm Toys tại các kho ở bang IA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'IA';"
gen_1777,Tìm giúp tôi top 5 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 5;"
gen_1778,Hãy tìm top 20 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1779,Tổng tồn kho sản phẩm Electronics tại các kho ở bang IL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'IL';"
gen_1780,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 1999;"
gen_1781,Tính toán tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang GA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'GA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1782,Làm ơn cho biết top 20 sản phẩm danh mục Men bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1783,Làm ơn cho biết số lượng khách hàng F sống tại bang ID,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'ID' AND cd.cd_gender = 'F';"
gen_1784,Cho tôi biết top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1785,Cho tôi biết khách hàng tình trạng hôn nhân 'D' thích mua Clothing không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Clothing';"
gen_1786,Hỏi về tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang GA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'GA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1787,Thống kê tổng doanh thu cửa hàng tại bang ID năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'ID' AND d.d_year = 1999;"
gen_1788,Cho tôi biết doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2001;"
gen_1789,Truy vấn top 5 sản phẩm danh mục Jewelry bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1790,Truy vấn top 10 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1791,Tính toán tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1792,Làm ơn cho biết số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2000;"
gen_1793,Làm ơn cho biết tổng doanh thu cửa hàng tại bang IN năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IN' AND d.d_year = 2000;"
gen_1794,Làm ơn cho biết tổng doanh thu cửa hàng tại bang AK năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AK' AND d.d_year = 1999;"
gen_1795,Tính toán top 50 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1796,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2002;"
gen_1797,Truy vấn khách hàng tình trạng hôn nhân 'W' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Sports';"
gen_1798,Hỏi về tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang CO,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'CO'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1799,Tìm giúp tôi tổng doanh thu cửa hàng tại bang IA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'IA' AND d.d_year = 2000;"
gen_1800,Cho tôi biết top 10 sản phẩm danh mục Men bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1801,Top 100 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1802,Thống kê số lượng hàng trả lại cửa hàng vì lý do 'wrong item' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'wrong item' AND d.d_year = 2001;"
gen_1803,Hãy tìm tổng chi tiêu của khách hàng có trình độ Primary năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2000;"
gen_1804,Thống kê tổng tồn kho sản phẩm Jewelry tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'TX';"
gen_1805,Hãy tìm tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2000,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000;"
gen_1806,Tìm giúp tôi khách hàng tình trạng hôn nhân 'W' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Jewelry';"
gen_1807,Hỏi về top 50 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1808,Hãy tìm top 50 sản phẩm danh mục Sports bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1809,Hỏi về tổng doanh thu cửa hàng tại bang WA năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 2000;"
gen_1810,Top 50 khách hàng mua nhiều Men nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Men'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1811,Thống kê tổng doanh thu cửa hàng tại bang AL năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AL' AND d.d_year = 2000;"
gen_1812,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ Primary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001;"
gen_1813,Số lượng khách hàng M sống tại bang KS,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KS' AND cd.cd_gender = 'M';"
gen_1814,Thống kê top 100 sản phẩm danh mục Music bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1815,Hỏi về tổng doanh thu cửa hàng tại bang AR năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AR' AND d.d_year = 1999;"
gen_1816,Tổng tồn kho sản phẩm Children tại các kho ở bang CO,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'CO';"
gen_1817,Số lượng khách hàng F sống tại bang CO,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CO' AND cd.cd_gender = 'F';"
gen_1818,Hãy tìm tổng tồn kho sản phẩm Books tại các kho ở bang HI,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'HI';"
gen_1819,Làm ơn cho biết tổng tồn kho sản phẩm Music tại các kho ở bang FL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Music' AND w.w_state = 'FL';"
gen_1820,Liệt kê tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang AR,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'AR'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1821,Liệt kê top 100 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1822,Tìm giúp tôi số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2001,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2001;"
gen_1823,Top 50 sản phẩm danh mục Children bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1824,Liệt kê số lượng hàng trả lại cửa hàng vì lý do 'too big' trong năm 1999,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'too big' AND d.d_year = 1999;"
gen_1825,Hỏi về tổng tồn kho sản phẩm Jewelry tại các kho ở bang AZ,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'AZ';"
gen_1826,Hỏi về top 10 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1827,Tìm giúp tôi tổng chi tiêu của khách hàng có trình độ Primary năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999;"
gen_1828,Hãy tìm tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1829,Hỏi về tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1830,Hỏi về số lượng hàng trả lại cửa hàng vì lý do 'did not like' trong năm 2000,"SELECT COUNT(*)
FROM store_returns sr
JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE r.r_reason_desc = 'did not like' AND d.d_year = 2000;"
gen_1831,Hỏi về tổng tồn kho sản phẩm Books tại các kho ở bang CA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'CA';"
gen_1832,Tính toán khách hàng tình trạng hôn nhân 'D' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'D' AND i.i_category = 'Children';"
gen_1833,Thống kê doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2002;"
gen_1834,Liệt kê top 20 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_1835,Số lượng khách hàng F sống tại bang AL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AL' AND cd.cd_gender = 'F';"
gen_1836,Cho tôi biết khách hàng tình trạng hôn nhân 'M' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Children';"
gen_1837,Tìm giúp tôi khách hàng tình trạng hôn nhân 'M' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Children';"
gen_1838,Làm ơn cho biết tìm các mặt hàng Music bán chạy hơn mức trung bình ở bang WA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Music' AND s.s_state = 'WA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1839,Top 10 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1840,Tính toán top 5 khách hàng mua nhiều Sports nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Sports'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1841,Tìm giúp tôi top 5 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1842,Truy vấn top 100 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1843,Thống kê doanh thu web sales quý 2 năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND d.d_qoy = 2;"
gen_1844,Hỏi về tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang AL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'AL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1845,Tính toán top 50 sản phẩm danh mục Children bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1846,Cho tôi biết tổng tồn kho sản phẩm Toys tại các kho ở bang FL,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'FL';"
gen_1847,Tính toán top 20 sản phẩm danh mục Toys bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Toys' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1848,Cho tôi biết top 50 sản phẩm danh mục Clothing bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1849,Cho tôi biết doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_1850,Tính toán tổng tồn kho sản phẩm Electronics tại các kho ở bang TX,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'TX';"
gen_1851,Tổng chi tiêu của khách hàng có trình độ Secondary năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001;"
gen_1852,Số lượng khách hàng M sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'M';"
gen_1853,Truy vấn số lượng khách hàng F sống tại bang DE,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'DE' AND cd.cd_gender = 'F';"
gen_1854,Hỏi về doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2002;"
gen_1855,Cho tôi biết top 100 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1856,Cho tôi biết tổng doanh thu cửa hàng tại bang WA năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'WA' AND d.d_year = 1999;"
gen_1857,Hãy tìm số lượng khách hàng M sống tại bang TX,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'TX' AND cd.cd_gender = 'M';"
gen_1858,Tính toán doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 2001;"
gen_1859,Tìm giúp tôi tổng tồn kho sản phẩm Jewelry tại các kho ở bang WA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'WA';"
gen_1860,Hỏi về top 10 sản phẩm danh mục Sports bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1861,Thống kê tổng chi tiêu của khách hàng có trình độ College năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001;"
gen_1862,Truy vấn top 5 mặt hàng Men bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Men'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1863,Liệt kê doanh thu web sales sử dụng phương thức vận chuyển GROUND năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'GROUND' AND d.d_year = 1999;"
gen_1864,Tính toán khách hàng tình trạng hôn nhân 'M' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'M' AND i.i_category = 'Toys';"
gen_1865,Liệt kê top 10 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1866,Truy vấn doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 2002;"
gen_1867,Thống kê số lượng khách hàng F sống tại bang WA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'WA' AND cd.cd_gender = 'F';"
gen_1868,Tìm giúp tôi số lượng khách hàng M sống tại bang DE,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'DE' AND cd.cd_gender = 'M';"
gen_1869,Top 50 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1870,Tính toán top 5 mặt hàng Books bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Books'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 5;"
gen_1871,Hãy tìm top 10 sản phẩm danh mục Clothing bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1872,Tính toán top 20 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_1873,Hãy tìm tìm các mặt hàng Clothing bán chạy hơn mức trung bình ở bang NY,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Clothing' AND s.s_state = 'NY'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1874,Thống kê top 5 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1875,Cho tôi biết tìm các mặt hàng Toys bán chạy hơn mức trung bình ở bang CA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Toys' AND s.s_state = 'CA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1876,Tìm giúp tôi top 10 mặt hàng Sports bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1877,Hãy tìm top 20 khách hàng mua nhiều Music nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Music'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 20;"
gen_1878,Cho tôi biết khách hàng tình trạng hôn nhân 'W' thích mua Books không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Books';"
gen_1879,Thống kê top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1880,Liệt kê top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1881,Liệt kê top 20 sản phẩm danh mục Home bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Home' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1882,Hỏi về top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1883,Tính toán tổng tồn kho sản phẩm Children tại các kho ở bang KY,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Children' AND w.w_state = 'KY';"
gen_1884,Hãy tìm tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2002;"
gen_1885,Liệt kê doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2000;"
gen_1886,Hỏi về doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_1887,Thống kê tổng doanh thu cửa hàng tại bang AZ năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AZ' AND d.d_year = 2000;"
gen_1888,Liệt kê tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 2001,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2001;"
gen_1889,Hỏi về số lượng khách hàng M sống tại bang IA,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IA' AND cd.cd_gender = 'M';"
gen_1890,Tìm giúp tôi số lượng khách hàng F sống tại bang IN,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IN' AND cd.cd_gender = 'F';"
gen_1891,Tính toán tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002;"
gen_1892,Thống kê top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1893,Tìm giúp tôi tổng tồn kho sản phẩm Electronics tại các kho ở bang CO,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Electronics' AND w.w_state = 'CO';"
gen_1894,Liệt kê top 100 sản phẩm danh mục Clothing bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1895,Thống kê tỷ lệ đơn hàng Children có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Children';"
gen_1896,Hỏi về top 100 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1897,Liệt kê top 50 khách hàng có tổng giá trị trả hàng cao nhất năm 2000,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 50;"
gen_1898,Liệt kê top 10 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 10;"
gen_1899,Tính toán khách hàng tình trạng hôn nhân 'W' thích mua Jewelry không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Jewelry';"
gen_1900,Tìm giúp tôi tổng tồn kho sản phẩm Toys tại các kho ở bang CT,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Toys' AND w.w_state = 'CT';"
gen_1901,Tính toán tổng chi tiêu của khách hàng có trình độ 4 yr Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999;"
gen_1902,Làm ơn cho biết top 50 khách hàng mua nhiều Toys nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Toys'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1903,Truy vấn top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1904,Hãy tìm top 100 sản phẩm danh mục Electronics bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1905,Truy vấn top 100 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1906,Hỏi về top 50 khách hàng mua nhiều Books nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Books'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1907,Cho tôi biết tổng tồn kho sản phẩm Clothing tại các kho ở bang KS,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'KS';"
gen_1908,Thống kê top 100 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1909,Hỏi về tổng doanh thu cửa hàng tại bang AR năm 2000,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AR' AND d.d_year = 2000;"
gen_1910,Làm ơn cho biết doanh thu web sales quý 1 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 1;"
gen_1911,Tìm giúp tôi doanh thu web sales sử dụng phương thức vận chuyển MAIL năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'MAIL' AND d.d_year = 1999;"
gen_1912,Hãy tìm top 20 sản phẩm danh mục Men bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Men' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1913,Hãy tìm top 50 mặt hàng Toys bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1914,Làm ơn cho biết tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999;"
gen_1915,Làm ơn cho biết tìm các mặt hàng Sports bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Sports' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1916,Truy vấn tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1917,Liệt kê số lượng khách hàng F sống tại bang TX,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'TX' AND cd.cd_gender = 'F';"
gen_1918,Liệt kê khách hàng tình trạng hôn nhân 'W' thích mua Sports không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Sports';"
gen_1919,Làm ơn cho biết top 10 sản phẩm danh mục Jewelry bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Jewelry' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1920,Tính toán số lượng khách hàng M sống tại bang KY,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'KY' AND cd.cd_gender = 'M';"
gen_1921,Làm ơn cho biết tỷ lệ đơn hàng Sports có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Sports';"
gen_1922,Liệt kê số lượng khách hàng M sống tại bang IN,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IN' AND cd.cd_gender = 'M';"
gen_1923,Liệt kê tổng doanh thu cửa hàng tại bang AK năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AK' AND d.d_year = 2002;"
gen_1924,Tính toán tổng tồn kho sản phẩm Men tại các kho ở bang AR,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Men' AND w.w_state = 'AR';"
gen_1925,Thống kê tổng tồn kho sản phẩm Jewelry tại các kho ở bang CO,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Jewelry' AND w.w_state = 'CO';"
gen_1926,Tìm giúp tôi top 100 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1927,Làm ơn cho biết top 50 mặt hàng Clothing bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Clothing'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1928,Hãy tìm top 5 sản phẩm danh mục Sports bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Sports' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1929,Tìm giúp tôi top 50 mặt hàng Jewelry bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1930,Liệt kê tổng doanh thu cửa hàng tại bang NY năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NY' AND d.d_year = 1999;"
gen_1931,Cho tôi biết tìm các mặt hàng Women bán chạy hơn mức trung bình ở bang AL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Women' AND s.s_state = 'AL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1932,Hỏi về doanh thu web sales quý 1 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 1;"
gen_1933,Hãy tìm tỷ lệ đơn hàng Toys có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys';"
gen_1934,Hãy tìm tổng doanh thu cửa hàng tại bang FL năm 1999,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'FL' AND d.d_year = 1999;"
gen_1935,Hỏi về top 50 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1936,Tổng chi tiêu của khách hàng có trình độ Primary năm 1999,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999;"
gen_1937,Liệt kê top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1938,Tính toán top 50 sản phẩm danh mục Electronics bán chạy nhất năm 1999,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 1999
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1939,Cho tôi biết tìm các mặt hàng Children bán chạy hơn mức trung bình ở bang CT,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Children' AND s.s_state = 'CT'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1940,Hãy tìm top 5 khách hàng mua nhiều Children nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Children'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 5;"
gen_1941,Liệt kê top 100 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 100;"
gen_1942,Liệt kê tổng tồn kho sản phẩm Books tại các kho ở bang DE,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Books' AND w.w_state = 'DE';"
gen_1943,Top 50 sản phẩm danh mục Children bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 50;"
gen_1944,Liệt kê tổng tồn kho sản phẩm Clothing tại các kho ở bang IA,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Clothing' AND w.w_state = 'IA';"
gen_1945,Thống kê top 5 sản phẩm danh mục Clothing bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1946,Tính toán top 10 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1947,Tính toán tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1948,Làm ơn cho biết top 100 sản phẩm danh mục Women bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Women' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1949,Truy vấn khách hàng tình trạng hôn nhân 'S' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Men';"
gen_1950,Liệt kê top 100 sản phẩm danh mục Books bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1951,Liệt kê tỷ lệ đơn hàng Toys có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Toys';"
gen_1952,Tính toán top 100 khách hàng mua nhiều Jewelry nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Jewelry'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1953,Doanh thu web sales quý 3 năm 2001,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND d.d_qoy = 3;"
gen_1954,Thống kê khách hàng tình trạng hôn nhân 'W' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Children';"
gen_1955,Tính toán top 10 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 10;"
gen_1956,Truy vấn top 10 sản phẩm danh mục Children bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Children' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1957,Tính toán tìm các mặt hàng Men bán chạy hơn mức trung bình ở bang IL,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Men' AND s.s_state = 'IL'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1958,Cho tôi biết top 10 sản phẩm danh mục Clothing bán chạy nhất năm 2000,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2000
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 10;"
gen_1959,Hỏi về doanh thu web sales quý 2 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2;"
gen_1960,Làm ơn cho biết doanh thu web sales quý 2 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 2;"
gen_1961,Thống kê doanh thu web sales quý 3 năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND d.d_qoy = 3;"
gen_1962,Thống kê số lượng khách hàng F sống tại bang CT,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'CT' AND cd.cd_gender = 'F';"
gen_1963,Hãy tìm tổng chi tiêu của khách hàng có trình độ 2 yr Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002;"
gen_1964,Làm ơn cho biết tìm các mặt hàng Electronics bán chạy hơn mức trung bình ở bang KS,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Electronics' AND s.s_state = 'KS'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1965,Hãy tìm khách hàng tình trạng hôn nhân 'S' thích mua Men không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Men';"
gen_1966,Hỏi về tổng chi tiêu của khách hàng có trình độ College năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002;"
gen_1967,Tính toán số lượng khách hàng F sống tại bang AZ,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'AZ' AND cd.cd_gender = 'F';"
gen_1968,Hãy tìm doanh thu web sales quý 2 năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND d.d_qoy = 2;"
gen_1969,Làm ơn cho biết top 100 sản phẩm danh mục Music bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Music' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1970,Liệt kê tổng tồn kho sản phẩm Women tại các kho ở bang CO,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'CO';"
gen_1971,Tính toán top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 2002,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1972,Làm ơn cho biết tỷ lệ đơn hàng Electronics có khuyến mãi,"SELECT CAST(SUM(CASE WHEN ss.ss_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*)
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE i.i_category = 'Electronics';"
gen_1973,Tính toán top 50 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1974,Thống kê doanh thu web sales sử dụng phương thức vận chuyển AIR năm 2000,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'AIR' AND d.d_year = 2000;"
gen_1975,Hãy tìm top 100 khách hàng mua nhiều Women nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Women'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1976,Làm ơn cho biết top 5 sản phẩm danh mục Books bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Books' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 5;"
gen_1977,Hãy tìm khách hàng tình trạng hôn nhân 'S' thích mua Toys không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'S' AND i.i_category = 'Toys';"
gen_1978,Thống kê khách hàng tình trạng hôn nhân 'W' thích mua Women không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Women';"
gen_1979,Thống kê tổng doanh thu cửa hàng tại bang CA năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'CA' AND d.d_year = 2001;"
gen_1980,Làm ơn cho biết tổng doanh thu cửa hàng tại bang KY năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'KY' AND d.d_year = 2002;"
gen_1981,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển RAIL năm 2002,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'RAIL' AND d.d_year = 2002;"
gen_1982,Hỏi về top 50 khách hàng mua nhiều Home nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Home'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 50;"
gen_1983,Liệt kê tổng doanh thu cửa hàng tại bang TX năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'TX' AND d.d_year = 2002;"
gen_1984,Tính toán tổng doanh thu cửa hàng tại bang AZ năm 2001,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'AZ' AND d.d_year = 2001;"
gen_1985,Tìm giúp tôi top 100 sản phẩm danh mục Clothing bán chạy nhất năm 2002,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Clothing' AND d.d_year = 2002
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 100;"
gen_1986,Làm ơn cho biết top 100 khách hàng mua nhiều Electronics nhất qua catalog,"SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_quantity) as total_qty
FROM catalog_sales cs
JOIN item i ON cs.cs_item_sk = i.i_item_sk
JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk
WHERE i.i_category = 'Electronics'
GROUP BY c.c_first_name, c.c_last_name
ORDER BY total_qty DESC
LIMIT 100;"
gen_1987,Làm ơn cho biết top 100 khách hàng có tổng giá trị trả hàng cao nhất năm 2001,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 100;"
gen_1988,Tính toán top 20 mặt hàng Children bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Children'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 20;"
gen_1989,Làm ơn cho biết top 10 mặt hàng Music bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Music'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 10;"
gen_1990,Tính toán tổng tồn kho sản phẩm Women tại các kho ở bang AK,"SELECT SUM(inv.inv_quantity_on_hand)
FROM inventory inv
JOIN item i ON inv.inv_item_sk = i.i_item_sk
JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk
WHERE i.i_category = 'Women' AND w.w_state = 'AK';"
gen_1991,Tìm các mặt hàng Books bán chạy hơn mức trung bình ở bang HI,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Books' AND s.s_state = 'HI'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1992,Hãy tìm tổng chi tiêu của khách hàng có trình độ Advanced Degree năm 2002,"SELECT SUM(ss.ss_net_paid)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002;"
gen_1993,Tìm giúp tôi top 50 mặt hàng Women bị trả lại nhiều nhất trên web,"SELECT i.i_item_desc, COUNT(*) as return_count
FROM web_returns wr
JOIN item i ON wr.wr_item_sk = i.i_item_sk
WHERE i.i_category = 'Women'
GROUP BY i.i_item_desc
ORDER BY return_count DESC
LIMIT 50;"
gen_1994,Liệt kê khách hàng tình trạng hôn nhân 'W' thích mua Children không,"SELECT COUNT(*)
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN item i ON ss.ss_item_sk = i.i_item_sk
WHERE cd.cd_marital_status = 'W' AND i.i_category = 'Children';"
gen_1995,Top 20 sản phẩm danh mục Electronics bán chạy nhất năm 2001,"SELECT i.i_item_desc, SUM(ss.ss_quantity) AS total_sold
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE i.i_category = 'Electronics' AND d.d_year = 2001
GROUP BY i.i_item_desc
ORDER BY total_sold DESC
LIMIT 20;"
gen_1996,Truy vấn số lượng khách hàng F sống tại bang IL,"SELECT COUNT(*)
FROM customer c
JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk
WHERE ca.ca_state = 'IL' AND cd.cd_gender = 'F';"
gen_1997,Làm ơn cho biết top 20 khách hàng có tổng giá trị trả hàng cao nhất năm 1999,"SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(sr.sr_return_amt) as total_return
FROM store_returns sr
JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk
JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name
ORDER BY total_return DESC
LIMIT 20;"
gen_1998,Tìm giúp tôi tìm các mặt hàng Home bán chạy hơn mức trung bình ở bang IA,"WITH avg_sales AS (
    SELECT AVG(ss_quantity) as avg_qty
    FROM store_sales
)
SELECT i.i_item_desc, SUM(ss.ss_quantity) as total_qty
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN store s ON ss.ss_store_sk = s.s_store_sk
WHERE i.i_category = 'Home' AND s.s_state = 'IA'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_quantity) > (SELECT avg_qty FROM avg_sales);"
gen_1999,Liệt kê tổng doanh thu cửa hàng tại bang NY năm 2002,"SELECT SUM(ss.ss_net_paid) AS total_revenue
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE s.s_state = 'NY' AND d.d_year = 2002;"
gen_2000,Hãy tìm doanh thu web sales sử dụng phương thức vận chuyển SHIP năm 1999,"SELECT SUM(ws.ws_net_paid)
FROM web_sales ws
JOIN ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk
WHERE sm.sm_type = 'SHIP' AND d.d_year = 1999;"
gen_2001,Truy vấn so sánh doanh thu cửa hàng năm 2000 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2002,"Hãy tìm xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2003,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Toys,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Toys'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2004,Tìm giúp tôi top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 100;"
gen_2005,"Truy vấn xếp hạng 100 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 100;"
gen_2006,"Liệt kê xếp hạng 50 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 50;"
gen_2007,"Truy vấn xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2008,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2009,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2010,Liệt kê tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2011,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2012,Tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2013,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2014,Hãy tìm top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 100;"
gen_2015,Tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2016,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2017,Làm ơn cho biết top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 5;"
gen_2018,Thống kê top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 10;"
gen_2019,Tính toán tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2020,"Xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2021,Thống kê top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 50;"
gen_2022,Tính toán tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2023,Hãy tìm top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 5;"
gen_2024,Làm ơn cho biết top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 100;"
gen_2025,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2026,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2027,"Tính toán xếp hạng 100 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 100;"
gen_2028,Cho tôi biết so sánh doanh thu cửa hàng năm 2001 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2029,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2030,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2031,"Tính toán xếp hạng 50 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 50;"
gen_2032,Tính toán so sánh doanh thu cửa hàng năm 2002 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2033,Tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2034,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2035,"Thống kê xếp hạng 10 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 10;"
gen_2036,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2037,Cho tôi biết so sánh doanh thu cửa hàng năm 2002 ở bang GA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'GA') as other_states_avg
FROM state_revenues
WHERE s_state = 'GA';"
gen_2038,Cho tôi biết so sánh doanh thu cửa hàng năm 2001 ở bang IN với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IN') as other_states_avg
FROM state_revenues
WHERE s_state = 'IN';"
gen_2039,Tìm giúp tôi tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2040,Làm ơn cho biết tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2041,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2042,Liệt kê so sánh doanh thu cửa hàng năm 2002 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2043,Tính toán so sánh doanh thu cửa hàng năm 2000 ở bang HI với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'HI') as other_states_avg
FROM state_revenues
WHERE s_state = 'HI';"
gen_2044,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2045,Làm ơn cho biết top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 20;"
gen_2046,Tính toán top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 50;"
gen_2047,Cho tôi biết top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 5;"
gen_2048,Tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2049,Hỏi về tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2050,Làm ơn cho biết so sánh doanh thu cửa hàng năm 2001 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2051,Liệt kê so sánh doanh thu cửa hàng năm 2001 ở bang NY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'NY') as other_states_avg
FROM state_revenues
WHERE s_state = 'NY';"
gen_2052,Thống kê top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 5;"
gen_2053,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2054,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2055,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Toys,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Toys'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2056,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2057,"Làm ơn cho biết xếp hạng 50 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 50;"
gen_2058,Thống kê tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2059,"Truy vấn xếp hạng 50 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 50;"
gen_2060,Tìm giúp tôi top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 10;"
gen_2061,Hãy tìm tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2062,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2063,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2064,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2065,Tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2066,Thống kê tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2067,"Xếp hạng 100 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 100;"
gen_2068,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2069,Hãy tìm tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2070,Liệt kê so sánh doanh thu cửa hàng năm 2002 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2071,"Hãy tìm xếp hạng 50 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 50;"
gen_2072,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2073,Tính toán tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2074,Hãy tìm top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 5;"
gen_2075,"Cho tôi biết xếp hạng 100 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 100;"
gen_2076,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2077,Truy vấn top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 100;"
gen_2078,Tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2079,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2080,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2081,Liệt kê so sánh doanh thu cửa hàng năm 1999 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2082,Truy vấn so sánh doanh thu cửa hàng năm 2000 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2083,Hãy tìm so sánh doanh thu cửa hàng năm 1999 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2084,"Thống kê xếp hạng 20 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 20;"
gen_2085,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2086,Hãy tìm so sánh doanh thu cửa hàng năm 2001 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2087,"Hỏi về xếp hạng 20 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 20;"
gen_2088,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2089,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang AZ với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AZ') as other_states_avg
FROM state_revenues
WHERE s_state = 'AZ';"
gen_2090,"Tính toán xếp hạng 20 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 20;"
gen_2091,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2092,"Thống kê xếp hạng 5 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 5;"
gen_2093,Hỏi về top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 50;"
gen_2094,Hỏi về top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 10;"
gen_2095,Liệt kê so sánh doanh thu cửa hàng năm 2000 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2096,Truy vấn top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 10;"
gen_2097,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2098,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2099,Thống kê top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 5;"
gen_2100,Làm ơn cho biết top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 100;"
gen_2101,Truy vấn so sánh doanh thu cửa hàng năm 2000 ở bang AZ với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AZ') as other_states_avg
FROM state_revenues
WHERE s_state = 'AZ';"
gen_2102,"Hãy tìm xếp hạng 50 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 50;"
gen_2103,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2104,Truy vấn tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2105,Làm ơn cho biết so sánh doanh thu cửa hàng năm 1999 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2106,Hãy tìm tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2107,Thống kê so sánh doanh thu cửa hàng năm 2000 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2108,"Liệt kê xếp hạng 10 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 10;"
gen_2109,Làm ơn cho biết tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2110,Liệt kê tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2111,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2112,"Xếp hạng 5 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 5;"
gen_2113,Liệt kê so sánh doanh thu cửa hàng năm 2001 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2114,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2115,Truy vấn top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 5;"
gen_2116,Tính toán tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2117,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2118,"Thống kê xếp hạng 100 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 100;"
gen_2119,"Xếp hạng 5 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 5;"
gen_2120,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2121,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2122,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2123,"Tính toán xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2124,Tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2125,Cho tôi biết so sánh doanh thu cửa hàng năm 2002 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2126,Làm ơn cho biết top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 50;"
gen_2127,Tính toán tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2128,Tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2129,"Truy vấn xếp hạng 20 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 20;"
gen_2130,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2131,Tìm giúp tôi tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2132,Top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 100;"
gen_2133,Làm ơn cho biết tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2134,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2135,Tính toán top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 50;"
gen_2136,Thống kê tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2137,Truy vấn so sánh doanh thu cửa hàng năm 1999 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2138,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2139,Tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2140,Làm ơn cho biết tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2141,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2142,"Xếp hạng 5 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 5;"
gen_2143,Hãy tìm so sánh doanh thu cửa hàng năm 2000 ở bang GA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'GA') as other_states_avg
FROM state_revenues
WHERE s_state = 'GA';"
gen_2144,Làm ơn cho biết top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 10;"
gen_2145,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2146,Thống kê so sánh doanh thu cửa hàng năm 1999 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2147,Hãy tìm tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2148,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2149,Tìm giúp tôi top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 20;"
gen_2150,Truy vấn so sánh doanh thu cửa hàng năm 2001 ở bang CA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CA') as other_states_avg
FROM state_revenues
WHERE s_state = 'CA';"
gen_2151,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2001 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2152,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2153,Liệt kê so sánh doanh thu cửa hàng năm 2000 ở bang GA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'GA') as other_states_avg
FROM state_revenues
WHERE s_state = 'GA';"
gen_2154,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2155,"Hỏi về xếp hạng 100 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 100;"
gen_2156,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2157,"Làm ơn cho biết xếp hạng 20 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 20;"
gen_2158,Làm ơn cho biết tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2159,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2160,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2161,"Cho tôi biết xếp hạng 10 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 10;"
gen_2162,"Hãy tìm xếp hạng 20 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 20;"
gen_2163,Cho tôi biết tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2164,Tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2165,"Tính toán xếp hạng 50 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 50;"
gen_2166,Thống kê tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2167,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2168,Hãy tìm tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2169,Hỏi về tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2170,Hãy tìm tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2171,"Cho tôi biết xếp hạng 5 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 5;"
gen_2172,Tính toán tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2173,"Hỏi về xếp hạng 5 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 5;"
gen_2174,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2175,"Hãy tìm xếp hạng 5 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 5;"
gen_2176,Làm ơn cho biết top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 50;"
gen_2177,Tính toán so sánh doanh thu cửa hàng năm 2002 ở bang NY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'NY') as other_states_avg
FROM state_revenues
WHERE s_state = 'NY';"
gen_2178,Thống kê tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2179,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2180,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2181,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Toys,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Toys'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2182,Truy vấn tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2183,Làm ơn cho biết top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 20;"
gen_2184,"Thống kê xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2185,Hỏi về top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 100;"
gen_2186,Liệt kê tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2187,Thống kê so sánh doanh thu cửa hàng năm 2000 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2188,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2189,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2190,Thống kê so sánh doanh thu cửa hàng năm 2002 ở bang AZ với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AZ') as other_states_avg
FROM state_revenues
WHERE s_state = 'AZ';"
gen_2191,"Tìm giúp tôi xếp hạng 10 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 10;"
gen_2192,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2193,Top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 100;"
gen_2194,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2195,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2002 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2196,Top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 10;"
gen_2197,Làm ơn cho biết tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2198,"Tìm giúp tôi xếp hạng 100 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 100;"
gen_2199,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2200,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2201,Tìm giúp tôi tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2202,"Tính toán xếp hạng 100 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 100;"
gen_2203,Tính toán top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 5;"
gen_2204,Làm ơn cho biết tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2205,Hỏi về top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 10;"
gen_2206,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2207,Truy vấn top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 20;"
gen_2208,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2209,"Liệt kê xếp hạng 20 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 20;"
gen_2210,"Hỏi về xếp hạng 10 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 10;"
gen_2211,Hãy tìm so sánh doanh thu cửa hàng năm 2002 ở bang ID với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'ID') as other_states_avg
FROM state_revenues
WHERE s_state = 'ID';"
gen_2212,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2213,"Thống kê xếp hạng 50 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 50;"
gen_2214,Hãy tìm top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 20;"
gen_2215,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2216,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2217,"Hỏi về xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2218,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2219,Liệt kê tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2220,Liệt kê top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 5;"
gen_2221,Hãy tìm top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 50;"
gen_2222,"Tính toán xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2223,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2224,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Toys,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Toys'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2225,Tính toán top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 50;"
gen_2226,Hỏi về tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2227,Làm ơn cho biết top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 100;"
gen_2228,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2229,"Tính toán xếp hạng 100 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 100;"
gen_2230,Tìm giúp tôi top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 50;"
gen_2231,Hỏi về so sánh doanh thu cửa hàng năm 2002 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2232,Hỏi về so sánh doanh thu cửa hàng năm 2001 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2233,Cho tôi biết so sánh doanh thu cửa hàng năm 2002 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2234,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2235,So sánh doanh thu cửa hàng năm 2001 ở bang IN với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IN') as other_states_avg
FROM state_revenues
WHERE s_state = 'IN';"
gen_2236,Cho tôi biết top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 10;"
gen_2237,Cho tôi biết tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2238,"Liệt kê xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2239,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2240,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2241,"Hỏi về xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2242,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2243,Tính toán so sánh doanh thu cửa hàng năm 2001 ở bang ID với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'ID') as other_states_avg
FROM state_revenues
WHERE s_state = 'ID';"
gen_2244,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2245,Làm ơn cho biết tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2246,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2247,Thống kê top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 20;"
gen_2248,Top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 50;"
gen_2249,Hỏi về so sánh doanh thu cửa hàng năm 2001 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2250,Cho tôi biết tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2251,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2252,Hãy tìm top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 50;"
gen_2253,Hỏi về tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2254,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2255,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2256,Hãy tìm tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2257,Tính toán top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 20;"
gen_2258,"Tìm giúp tôi xếp hạng 20 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 20;"
gen_2259,Truy vấn top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 10;"
gen_2260,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2261,"Thống kê xếp hạng 10 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 10;"
gen_2262,Thống kê top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 100;"
gen_2263,"Xếp hạng 10 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 10;"
gen_2264,"Cho tôi biết xếp hạng 50 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 50;"
gen_2265,Tìm giúp tôi top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 20;"
gen_2266,Truy vấn so sánh doanh thu cửa hàng năm 2000 ở bang ID với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'ID') as other_states_avg
FROM state_revenues
WHERE s_state = 'ID';"
gen_2267,"Hỏi về xếp hạng 50 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 50;"
gen_2268,Liệt kê so sánh doanh thu cửa hàng năm 2002 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2269,Hỏi về so sánh doanh thu cửa hàng năm 2001 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2270,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2271,Hỏi về top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 5;"
gen_2272,"Xếp hạng 50 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 50;"
gen_2273,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2274,"Cho tôi biết xếp hạng 5 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 5;"
gen_2275,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2276,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2277,Làm ơn cho biết so sánh doanh thu cửa hàng năm 1999 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2278,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang HI với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'HI') as other_states_avg
FROM state_revenues
WHERE s_state = 'HI';"
gen_2279,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2280,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2281,Thống kê tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2282,Cho tôi biết tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2283,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2284,Truy vấn top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 5;"
gen_2285,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2286,Truy vấn tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2287,Truy vấn so sánh doanh thu cửa hàng năm 2002 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2288,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2289,Hỏi về so sánh doanh thu cửa hàng năm 2002 ở bang CA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CA') as other_states_avg
FROM state_revenues
WHERE s_state = 'CA';"
gen_2290,Cho tôi biết tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2291,Truy vấn top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 10;"
gen_2292,"Truy vấn xếp hạng 100 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 100;"
gen_2293,Thống kê so sánh doanh thu cửa hàng năm 1999 ở bang GA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'GA') as other_states_avg
FROM state_revenues
WHERE s_state = 'GA';"
gen_2294,Truy vấn so sánh doanh thu cửa hàng năm 2001 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2295,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2296,"Truy vấn xếp hạng 20 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 20;"
gen_2297,Tính toán so sánh doanh thu cửa hàng năm 2001 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2298,Thống kê top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 10;"
gen_2299,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2300,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2301,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2302,Hãy tìm tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2303,Hỏi về so sánh doanh thu cửa hàng năm 2000 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2304,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2305,Cho tôi biết tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2306,Hỏi về tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2307,So sánh doanh thu cửa hàng năm 2002 ở bang TX với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'TX') as other_states_avg
FROM state_revenues
WHERE s_state = 'TX';"
gen_2308,Truy vấn tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2309,Liệt kê tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2310,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2311,Liệt kê top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 10;"
gen_2312,Liệt kê top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 100;"
gen_2313,"Thống kê xếp hạng 5 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 5;"
gen_2314,"Hãy tìm xếp hạng 100 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 100;"
gen_2315,"Cho tôi biết xếp hạng 20 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 20;"
gen_2316,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2317,Làm ơn cho biết top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 100;"
gen_2318,Hãy tìm so sánh doanh thu cửa hàng năm 2000 ở bang CA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CA') as other_states_avg
FROM state_revenues
WHERE s_state = 'CA';"
gen_2319,Thống kê so sánh doanh thu cửa hàng năm 2002 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2320,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2321,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2322,Tìm giúp tôi tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2323,Tìm giúp tôi top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 5;"
gen_2324,Tìm giúp tôi tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2325,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2326,"Hãy tìm xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2327,Tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2328,"Làm ơn cho biết xếp hạng 100 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 100;"
gen_2329,Thống kê tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2330,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2331,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2332,Cho tôi biết so sánh doanh thu cửa hàng năm 1999 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2333,Hỏi về tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2334,Tìm giúp tôi so sánh doanh thu cửa hàng năm 1999 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2335,"Làm ơn cho biết xếp hạng 20 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 20;"
gen_2336,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2337,Tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2338,"Hỏi về xếp hạng 50 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 50;"
gen_2339,"Tìm giúp tôi xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2340,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2341,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2342,"Hãy tìm xếp hạng 100 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 100;"
gen_2343,Top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 10;"
gen_2344,"Truy vấn xếp hạng 50 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 50;"
gen_2345,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2346,Hãy tìm top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 10;"
gen_2347,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2348,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2349,Tính toán tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2350,"Truy vấn xếp hạng 20 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 20;"
gen_2351,Hãy tìm top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 100;"
gen_2352,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2353,Thống kê so sánh doanh thu cửa hàng năm 2001 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2354,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2355,Cho tôi biết top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 20;"
gen_2356,Hỏi về tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2357,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2358,Hãy tìm so sánh doanh thu cửa hàng năm 2000 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2359,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2360,Cho tôi biết tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2361,Cho tôi biết top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 50;"
gen_2362,Truy vấn tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2363,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2364,Truy vấn tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2365,Hãy tìm top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 50;"
gen_2366,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2367,Làm ơn cho biết tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2368,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2369,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2370,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2371,"Liệt kê xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2372,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2373,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2374,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2375,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2376,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2377,Thống kê tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2378,Thống kê so sánh doanh thu cửa hàng năm 2002 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2379,Tính toán so sánh doanh thu cửa hàng năm 2001 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2380,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2000 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2381,Liệt kê top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 20;"
gen_2382,Thống kê tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2383,Thống kê so sánh doanh thu cửa hàng năm 2001 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2384,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2385,"Thống kê xếp hạng 5 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 5;"
gen_2386,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Toys,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Toys'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2387,"Làm ơn cho biết xếp hạng 5 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 5;"
gen_2388,"Tìm giúp tôi xếp hạng 5 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 5;"
gen_2389,Tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2390,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2391,Cho tôi biết top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 5;"
gen_2392,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2393,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2394,"Liệt kê xếp hạng 100 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 100;"
gen_2395,Hỏi về top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 10;"
gen_2396,Tính toán tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2397,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2398,Liệt kê top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 50;"
gen_2399,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2400,Hãy tìm tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2401,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2402,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2001 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2403,Truy vấn tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2404,Cho tôi biết so sánh doanh thu cửa hàng năm 1999 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2405,Tìm giúp tôi tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2406,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2407,Truy vấn so sánh doanh thu cửa hàng năm 1999 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2408,Làm ơn cho biết tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2409,Làm ơn cho biết so sánh doanh thu cửa hàng năm 2001 ở bang GA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'GA') as other_states_avg
FROM state_revenues
WHERE s_state = 'GA';"
gen_2410,Hãy tìm so sánh doanh thu cửa hàng năm 2000 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2411,Top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 50;"
gen_2412,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2413,Làm ơn cho biết so sánh doanh thu cửa hàng năm 1999 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2414,Liệt kê tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2415,Hỏi về top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 20;"
gen_2416,Cho tôi biết top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 100;"
gen_2417,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2418,Tìm giúp tôi top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 50;"
gen_2419,Tính toán so sánh doanh thu cửa hàng năm 2001 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2420,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2421,Tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2422,Tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2423,"Thống kê xếp hạng 20 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 20;"
gen_2424,"Cho tôi biết xếp hạng 5 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 5;"
gen_2425,"Liệt kê xếp hạng 20 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 20;"
gen_2426,"Tính toán xếp hạng 20 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 20;"
gen_2427,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2428,Làm ơn cho biết tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2429,Hỏi về so sánh doanh thu cửa hàng năm 2002 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2430,Liệt kê tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2431,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2432,Hỏi về so sánh doanh thu cửa hàng năm 2002 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2433,Liệt kê so sánh doanh thu cửa hàng năm 2001 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2434,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2435,Cho tôi biết top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 50;"
gen_2436,"Hỏi về xếp hạng 20 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 20;"
gen_2437,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2438,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2439,Liệt kê top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 100;"
gen_2440,Tìm giúp tôi so sánh doanh thu cửa hàng năm 1999 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2441,"Cho tôi biết xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2442,"Tìm giúp tôi xếp hạng 20 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 20;"
gen_2443,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2444,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2445,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2446,Cho tôi biết so sánh doanh thu cửa hàng năm 2002 ở bang IN với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IN') as other_states_avg
FROM state_revenues
WHERE s_state = 'IN';"
gen_2447,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2448,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2449,Tính toán top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 5;"
gen_2450,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2451,"Thống kê xếp hạng 5 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 5;"
gen_2452,Hãy tìm so sánh doanh thu cửa hàng năm 2002 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2453,Thống kê so sánh doanh thu cửa hàng năm 2000 ở bang KS với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KS') as other_states_avg
FROM state_revenues
WHERE s_state = 'KS';"
gen_2454,Top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 5;"
gen_2455,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2456,Làm ơn cho biết top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 5;"
gen_2457,Tính toán so sánh doanh thu cửa hàng năm 2001 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2458,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2459,"Cho tôi biết xếp hạng 50 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 50;"
gen_2460,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2461,Tìm giúp tôi tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2462,"Xếp hạng 10 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 10;"
gen_2463,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2464,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2465,Truy vấn so sánh doanh thu cửa hàng năm 2002 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2466,Làm ơn cho biết tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2467,Tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2468,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2469,"Xếp hạng 50 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 50;"
gen_2470,Hỏi về tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2471,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2472,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2473,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2474,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2475,Cho tôi biết top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 10;"
gen_2476,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2477,Cho tôi biết so sánh doanh thu cửa hàng năm 2002 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2478,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2479,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2480,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2481,"Tìm giúp tôi xếp hạng 100 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 100;"
gen_2482,Cho tôi biết tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2483,Liệt kê tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2484,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2485,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2486,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2487,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2488,"Làm ơn cho biết xếp hạng 10 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 10;"
gen_2489,Thống kê so sánh doanh thu cửa hàng năm 2001 ở bang GA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'GA') as other_states_avg
FROM state_revenues
WHERE s_state = 'GA';"
gen_2490,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2002 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2491,Truy vấn tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2492,"Truy vấn xếp hạng 20 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 20;"
gen_2493,Tìm giúp tôi top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 5;"
gen_2494,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2495,"Làm ơn cho biết xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2496,Hỏi về tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2497,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2498,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2499,"Làm ơn cho biết xếp hạng 100 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 100;"
gen_2500,Tìm giúp tôi tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2501,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2502,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2503,Hỏi về tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2504,Cho tôi biết tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2505,Cho tôi biết tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2506,Làm ơn cho biết top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 10;"
gen_2507,Truy vấn tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2508,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Toys,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Toys'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2509,So sánh doanh thu cửa hàng năm 2000 ở bang HI với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'HI') as other_states_avg
FROM state_revenues
WHERE s_state = 'HI';"
gen_2510,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2511,"Làm ơn cho biết xếp hạng 5 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 5;"
gen_2512,Cho tôi biết so sánh doanh thu cửa hàng năm 2000 ở bang AZ với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AZ') as other_states_avg
FROM state_revenues
WHERE s_state = 'AZ';"
gen_2513,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2000 ở bang AZ với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AZ') as other_states_avg
FROM state_revenues
WHERE s_state = 'AZ';"
gen_2514,Hỏi về tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2515,Làm ơn cho biết tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2516,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2517,Tính toán tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2518,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2519,Làm ơn cho biết so sánh doanh thu cửa hàng năm 2000 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2520,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2521,Hỏi về top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 5;"
gen_2522,"Hãy tìm xếp hạng 5 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 5;"
gen_2523,"Truy vấn xếp hạng 100 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 100;"
gen_2524,"Thống kê xếp hạng 20 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 20;"
gen_2525,Tìm giúp tôi top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 5;"
gen_2526,"Làm ơn cho biết xếp hạng 100 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 100;"
gen_2527,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2528,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2529,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2530,Cho tôi biết tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2531,Thống kê tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2532,Tìm giúp tôi tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2533,Truy vấn tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2534,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2535,Liệt kê tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2536,Truy vấn top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 100;"
gen_2537,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Toys,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Toys'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2538,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2539,So sánh doanh thu cửa hàng năm 2000 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2540,"Cho tôi biết xếp hạng 20 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 20;"
gen_2541,Tính toán tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2542,Hỏi về top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 20;"
gen_2543,Top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 50;"
gen_2544,Cho tôi biết so sánh doanh thu cửa hàng năm 2000 ở bang GA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'GA') as other_states_avg
FROM state_revenues
WHERE s_state = 'GA';"
gen_2545,Thống kê so sánh doanh thu cửa hàng năm 1999 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2546,Liệt kê so sánh doanh thu cửa hàng năm 1999 ở bang KS với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KS') as other_states_avg
FROM state_revenues
WHERE s_state = 'KS';"
gen_2547,Hỏi về top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 5;"
gen_2548,Liệt kê so sánh doanh thu cửa hàng năm 2001 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2549,Làm ơn cho biết tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2550,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2551,"Thống kê xếp hạng 50 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 50;"
gen_2552,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2553,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2554,Tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2555,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2556,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2557,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2558,"Tìm giúp tôi xếp hạng 50 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 50;"
gen_2559,Liệt kê so sánh doanh thu cửa hàng năm 2001 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2560,Cho tôi biết top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 10;"
gen_2561,"Liệt kê xếp hạng 100 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 100;"
gen_2562,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2563,"Xếp hạng 5 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 5;"
gen_2564,Cho tôi biết top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 5;"
gen_2565,Truy vấn tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2566,Liệt kê so sánh doanh thu cửa hàng năm 2002 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2567,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2568,Làm ơn cho biết top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 20;"
gen_2569,Tính toán tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2570,Liệt kê so sánh doanh thu cửa hàng năm 2002 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2571,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2572,"Truy vấn xếp hạng 100 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 100;"
gen_2573,"Tìm giúp tôi xếp hạng 50 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 50;"
gen_2574,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2575,Hỏi về tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2576,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2577,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Toys,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Toys'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2578,Hỏi về tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2579,Hỏi về top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 20;"
gen_2580,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2581,Hãy tìm tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2582,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2583,Làm ơn cho biết so sánh doanh thu cửa hàng năm 1999 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2584,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2585,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2586,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2587,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2588,Tìm giúp tôi tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2589,Truy vấn tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2590,So sánh doanh thu cửa hàng năm 1999 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2591,Tìm giúp tôi top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 5;"
gen_2592,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2593,"Liệt kê xếp hạng 20 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 20;"
gen_2594,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2595,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2596,Hãy tìm so sánh doanh thu cửa hàng năm 2001 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2597,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2598,Làm ơn cho biết so sánh doanh thu cửa hàng năm 2001 ở bang HI với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'HI') as other_states_avg
FROM state_revenues
WHERE s_state = 'HI';"
gen_2599,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2600,Tính toán so sánh doanh thu cửa hàng năm 2000 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2601,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2602,"Làm ơn cho biết xếp hạng 100 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 100;"
gen_2603,Làm ơn cho biết so sánh doanh thu cửa hàng năm 2002 ở bang KS với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KS') as other_states_avg
FROM state_revenues
WHERE s_state = 'KS';"
gen_2604,Hãy tìm so sánh doanh thu cửa hàng năm 2001 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2605,Liệt kê tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2606,"Hỏi về xếp hạng 100 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 100;"
gen_2607,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2608,So sánh doanh thu cửa hàng năm 1999 ở bang TX với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'TX') as other_states_avg
FROM state_revenues
WHERE s_state = 'TX';"
gen_2609,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2610,"Liệt kê xếp hạng 50 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 50;"
gen_2611,Làm ơn cho biết tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2612,Truy vấn top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 10;"
gen_2613,Cho tôi biết so sánh doanh thu cửa hàng năm 2001 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2614,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2615,Truy vấn so sánh doanh thu cửa hàng năm 2002 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2616,"Cho tôi biết xếp hạng 100 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 100;"
gen_2617,"Thống kê xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2618,Liệt kê so sánh doanh thu cửa hàng năm 1999 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2619,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2620,Truy vấn tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2621,Tính toán top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 100;"
gen_2622,Hỏi về top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 100;"
gen_2623,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2624,"Liệt kê xếp hạng 5 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 5;"
gen_2625,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2626,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2627,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2628,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2629,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2630,Thống kê so sánh doanh thu cửa hàng năm 2001 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2631,"Xếp hạng 20 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 20;"
gen_2632,Hãy tìm tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2633,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2634,Cho tôi biết top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 10;"
gen_2635,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2636,"Hỏi về xếp hạng 100 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 100;"
gen_2637,Hãy tìm tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2638,Thống kê top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 50;"
gen_2639,Làm ơn cho biết tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2640,Làm ơn cho biết tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2641,Truy vấn top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 20;"
gen_2642,Top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 100;"
gen_2643,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2644,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2645,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2646,Cho tôi biết so sánh doanh thu cửa hàng năm 2002 ở bang CA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CA') as other_states_avg
FROM state_revenues
WHERE s_state = 'CA';"
gen_2647,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2648,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2649,"Xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2650,Tìm giúp tôi tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2651,Liệt kê so sánh doanh thu cửa hàng năm 2002 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2652,Hãy tìm tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2653,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2654,Hỏi về top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 10;"
gen_2655,Làm ơn cho biết so sánh doanh thu cửa hàng năm 2000 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2656,Làm ơn cho biết top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 50;"
gen_2657,Top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 50;"
gen_2658,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2002 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2659,Truy vấn tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2660,Truy vấn so sánh doanh thu cửa hàng năm 2000 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2661,Thống kê tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2662,Hỏi về top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 50;"
gen_2663,Cho tôi biết tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2664,Truy vấn so sánh doanh thu cửa hàng năm 1999 ở bang AZ với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AZ') as other_states_avg
FROM state_revenues
WHERE s_state = 'AZ';"
gen_2665,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2666,So sánh doanh thu cửa hàng năm 2001 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2667,Tính toán so sánh doanh thu cửa hàng năm 2002 ở bang KS với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KS') as other_states_avg
FROM state_revenues
WHERE s_state = 'KS';"
gen_2668,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2669,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2670,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2671,Tính toán so sánh doanh thu cửa hàng năm 2002 ở bang IN với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IN') as other_states_avg
FROM state_revenues
WHERE s_state = 'IN';"
gen_2672,"Truy vấn xếp hạng 5 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 5;"
gen_2673,Tìm giúp tôi top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 10;"
gen_2674,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2675,Truy vấn so sánh doanh thu cửa hàng năm 1999 ở bang WA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'WA') as other_states_avg
FROM state_revenues
WHERE s_state = 'WA';"
gen_2676,Tính toán top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 10;"
gen_2677,Hãy tìm top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 20;"
gen_2678,Làm ơn cho biết tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2679,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2680,Truy vấn so sánh doanh thu cửa hàng năm 1999 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2681,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2682,Thống kê tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2683,Cho tôi biết so sánh doanh thu cửa hàng năm 2001 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2684,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2685,Thống kê so sánh doanh thu cửa hàng năm 2001 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2686,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2687,Thống kê tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2688,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2689,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2690,Tính toán so sánh doanh thu cửa hàng năm 2002 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2691,"Hãy tìm xếp hạng 50 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 50;"
gen_2692,Top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 100;"
gen_2693,So sánh doanh thu cửa hàng năm 1999 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2694,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2695,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2696,Làm ơn cho biết tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2697,Làm ơn cho biết top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 5;"
gen_2698,Truy vấn top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 100;"
gen_2699,Thống kê so sánh doanh thu cửa hàng năm 2002 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2700,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2701,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2702,Làm ơn cho biết tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2703,Top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 20;"
gen_2704,So sánh doanh thu cửa hàng năm 1999 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2705,"Hãy tìm xếp hạng 100 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 100;"
gen_2706,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2707,"Liệt kê xếp hạng 10 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 10;"
gen_2708,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2709,Tìm giúp tôi tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2710,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2711,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2000 ở bang KS với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KS') as other_states_avg
FROM state_revenues
WHERE s_state = 'KS';"
gen_2712,Top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 10;"
gen_2713,Hãy tìm tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2714,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2715,Hãy tìm so sánh doanh thu cửa hàng năm 2000 ở bang KS với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KS') as other_states_avg
FROM state_revenues
WHERE s_state = 'KS';"
gen_2716,Thống kê top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 20;"
gen_2717,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2718,Thống kê tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2719,Hỏi về tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2720,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2721,Cho tôi biết so sánh doanh thu cửa hàng năm 2002 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2722,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2723,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2724,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2725,"Cho tôi biết xếp hạng 5 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 5;"
gen_2726,Cho tôi biết so sánh doanh thu cửa hàng năm 1999 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2727,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2728,Cho tôi biết top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 20;"
gen_2729,Tính toán tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2730,So sánh doanh thu cửa hàng năm 1999 ở bang KS với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KS') as other_states_avg
FROM state_revenues
WHERE s_state = 'KS';"
gen_2731,Hãy tìm top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 10;"
gen_2732,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2733,Hỏi về tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2734,Thống kê so sánh doanh thu cửa hàng năm 2002 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2735,"Tìm giúp tôi xếp hạng 20 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 20;"
gen_2736,Hãy tìm top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 50;"
gen_2737,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2738,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2739,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2740,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2741,Tìm giúp tôi top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 20;"
gen_2742,Cho tôi biết so sánh doanh thu cửa hàng năm 2001 ở bang CA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CA') as other_states_avg
FROM state_revenues
WHERE s_state = 'CA';"
gen_2743,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2744,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2745,Hãy tìm top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 10;"
gen_2746,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2001 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2747,"Truy vấn xếp hạng 50 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 50;"
gen_2748,"Hãy tìm xếp hạng 10 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 10;"
gen_2749,Liệt kê top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 10;"
gen_2750,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2751,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2752,Thống kê tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2753,Thống kê tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2754,Tìm giúp tôi top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 50;"
gen_2755,"Làm ơn cho biết xếp hạng 20 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 20;"
gen_2756,Thống kê so sánh doanh thu cửa hàng năm 2000 ở bang CA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CA') as other_states_avg
FROM state_revenues
WHERE s_state = 'CA';"
gen_2757,"Liệt kê xếp hạng 5 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 5;"
gen_2758,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2759,Hỏi về so sánh doanh thu cửa hàng năm 2002 ở bang NY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'NY') as other_states_avg
FROM state_revenues
WHERE s_state = 'NY';"
gen_2760,Tính toán top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 20;"
gen_2761,So sánh doanh thu cửa hàng năm 2002 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2762,Hãy tìm so sánh doanh thu cửa hàng năm 1999 ở bang CT với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CT') as other_states_avg
FROM state_revenues
WHERE s_state = 'CT';"
gen_2763,Hãy tìm tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2764,"Tính toán xếp hạng 5 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 5;"
gen_2765,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2766,Top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 20;"
gen_2767,Tính toán top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 20;"
gen_2768,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2769,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2770,Tính toán top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 100;"
gen_2771,Tìm giúp tôi so sánh doanh thu cửa hàng năm 2000 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2772,Tính toán so sánh doanh thu cửa hàng năm 2002 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2773,Liệt kê so sánh doanh thu cửa hàng năm 2001 ở bang ID với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'ID') as other_states_avg
FROM state_revenues
WHERE s_state = 'ID';"
gen_2774,Liệt kê top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 50;"
gen_2775,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2776,Liệt kê top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 5;"
gen_2777,Hỏi về tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2778,"Cho tôi biết xếp hạng 50 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 50;"
gen_2779,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2780,Cho tôi biết tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2781,"Tính toán xếp hạng 50 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 50;"
gen_2782,"Làm ơn cho biết xếp hạng 50 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 50;"
gen_2783,Tìm giúp tôi so sánh doanh thu cửa hàng năm 1999 ở bang NY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'NY') as other_states_avg
FROM state_revenues
WHERE s_state = 'NY';"
gen_2784,Tính toán so sánh doanh thu cửa hàng năm 2000 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2785,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2786,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2787,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2788,Liệt kê so sánh doanh thu cửa hàng năm 2000 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2789,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2790,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2791,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2792,Liệt kê so sánh doanh thu cửa hàng năm 2001 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2793,Tính toán tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2794,Tính toán so sánh doanh thu cửa hàng năm 2000 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2795,Làm ơn cho biết top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 5;"
gen_2796,Tính toán tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2797,"Thống kê xếp hạng 20 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 20;"
gen_2798,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2799,Truy vấn tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2800,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2801,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2802,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2803,Tìm giúp tôi tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2804,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2805,Hãy tìm tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2806,"Cho tôi biết xếp hạng 10 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 10;"
gen_2807,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2808,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2809,"Tính toán xếp hạng 5 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 5;"
gen_2810,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2811,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2812,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2813,"Hỏi về xếp hạng 10 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 10;"
gen_2814,Hỏi về top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 100;"
gen_2815,Hỏi về tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2816,Hãy tìm tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2817,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2818,Hỏi về so sánh doanh thu cửa hàng năm 2002 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2819,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2820,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2821,Hãy tìm tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2822,Truy vấn tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2823,Thống kê top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 100;"
gen_2824,Tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2825,Liệt kê so sánh doanh thu cửa hàng năm 2000 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2826,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang NY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'NY') as other_states_avg
FROM state_revenues
WHERE s_state = 'NY';"
gen_2827,Hãy tìm so sánh doanh thu cửa hàng năm 2002 ở bang NY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'NY') as other_states_avg
FROM state_revenues
WHERE s_state = 'NY';"
gen_2828,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2829,Hãy tìm so sánh doanh thu cửa hàng năm 1999 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2830,Hỏi về so sánh doanh thu cửa hàng năm 2002 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2831,"Tìm giúp tôi xếp hạng 5 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 5;"
gen_2832,Thống kê so sánh doanh thu cửa hàng năm 2002 ở bang ID với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'ID') as other_states_avg
FROM state_revenues
WHERE s_state = 'ID';"
gen_2833,Cho tôi biết top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 20;"
gen_2834,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2835,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2836,Liệt kê tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2837,Thống kê top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 50;"
gen_2838,Hỏi về so sánh doanh thu cửa hàng năm 2002 ở bang HI với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'HI') as other_states_avg
FROM state_revenues
WHERE s_state = 'HI';"
gen_2839,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2840,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2841,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2842,"Hãy tìm xếp hạng 5 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 5;"
gen_2843,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2844,"Tìm giúp tôi xếp hạng 10 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 10;"
gen_2845,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2846,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2847,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2848,Thống kê top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 10;"
gen_2849,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2850,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2851,Thống kê so sánh doanh thu cửa hàng năm 2000 ở bang AL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AL') as other_states_avg
FROM state_revenues
WHERE s_state = 'AL';"
gen_2852,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2853,Hỏi về tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2854,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2855,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2856,Cho tôi biết top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 100;"
gen_2857,Hỏi về so sánh doanh thu cửa hàng năm 2000 ở bang NY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'NY') as other_states_avg
FROM state_revenues
WHERE s_state = 'NY';"
gen_2858,"Hãy tìm xếp hạng 5 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 5;"
gen_2859,Hỏi về tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2860,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2861,Tính toán tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2862,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2863,Hãy tìm tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2864,Liệt kê so sánh doanh thu cửa hàng năm 2001 ở bang FL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'FL') as other_states_avg
FROM state_revenues
WHERE s_state = 'FL';"
gen_2865,Liệt kê top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 10;"
gen_2866,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2867,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2868,Làm ơn cho biết tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2869,Thống kê tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2870,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2871,Hãy tìm top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 100;"
gen_2872,"Hãy tìm xếp hạng 50 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 50;"
gen_2873,Tính toán so sánh doanh thu cửa hàng năm 1999 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2874,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2875,"Tính toán xếp hạng 100 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 100;"
gen_2876,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2877,Cho tôi biết so sánh doanh thu cửa hàng năm 2001 ở bang CO với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CO') as other_states_avg
FROM state_revenues
WHERE s_state = 'CO';"
gen_2878,"Cho tôi biết xếp hạng 100 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 100;"
gen_2879,Tìm giúp tôi top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 100;"
gen_2880,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2881,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2882,Tính toán tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2883,Hỏi về so sánh doanh thu cửa hàng năm 2001 ở bang AZ với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AZ') as other_states_avg
FROM state_revenues
WHERE s_state = 'AZ';"
gen_2884,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2885,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2886,Tính toán top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 10;"
gen_2887,Thống kê tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2888,Tìm giúp tôi so sánh doanh thu cửa hàng năm 1999 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2889,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2890,Tính toán tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2891,Làm ơn cho biết so sánh doanh thu cửa hàng năm 1999 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2892,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2893,Truy vấn tìm các sản phẩm danh mục Music có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Music'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Music'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2894,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2895,"Thống kê xếp hạng 50 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 50;"
gen_2896,Thống kê so sánh doanh thu cửa hàng năm 2001 ở bang HI với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'HI') as other_states_avg
FROM state_revenues
WHERE s_state = 'HI';"
gen_2897,Tìm các sản phẩm danh mục Sports có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Sports'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2898,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2899,Cho tôi biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Primary năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Primary' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2900,Làm ơn cho biết tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2901,Thống kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2902,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2903,Truy vấn top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2001 - 1, 2001)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2001 - 1 AND t2.d_year = 2001
ORDER BY growth DESC
LIMIT 50;"
gen_2904,Cho tôi biết tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2905,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2906,Tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2907,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2908,"Làm ơn cho biết xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2909,Hãy tìm so sánh doanh thu cửa hàng năm 2000 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2910,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Electronics,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2911,Hãy tìm so sánh doanh thu cửa hàng năm 1999 ở bang DE với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'DE') as other_states_avg
FROM state_revenues
WHERE s_state = 'DE';"
gen_2912,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2913,Tìm giúp tôi tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2914,Liệt kê so sánh doanh thu cửa hàng năm 2001 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2915,Thống kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Men,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Men'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2916,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2917,"Truy vấn xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2918,Hãy tìm so sánh doanh thu cửa hàng năm 2000 ở bang ID với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'ID') as other_states_avg
FROM state_revenues
WHERE s_state = 'ID';"
gen_2919,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2920,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2921,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2922,Thống kê so sánh doanh thu cửa hàng năm 2000 ở bang IL với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IL') as other_states_avg
FROM state_revenues
WHERE s_state = 'IL';"
gen_2923,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2924,Cho tôi biết so sánh doanh thu cửa hàng năm 2001 ở bang KY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KY') as other_states_avg
FROM state_revenues
WHERE s_state = 'KY';"
gen_2925,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2926,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2927,Thống kê top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 10;"
gen_2928,Tìm giúp tôi tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2929,Hãy tìm tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2930,Liệt kê tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2931,Làm ơn cho biết tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2932,"Hỏi về xếp hạng 5 cửa hàng theo doanh thu năm 2002, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002
GROUP BY s.s_store_name
LIMIT 5;"
gen_2933,Liệt kê tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2934,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2935,Thống kê top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 5;"
gen_2936,Làm ơn cho biết tìm các sản phẩm danh mục Books có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Books'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Books'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2937,Truy vấn tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2938,Liệt kê top 100 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 100;"
gen_2939,Cho tôi biết so sánh doanh thu cửa hàng năm 2002 ở bang TX với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'TX') as other_states_avg
FROM state_revenues
WHERE s_state = 'TX';"
gen_2940,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Music,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Music'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2941,Truy vấn tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2942,Hãy tìm so sánh doanh thu cửa hàng năm 1999 ở bang AK với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AK') as other_states_avg
FROM state_revenues
WHERE s_state = 'AK';"
gen_2943,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2944,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2945,Hãy tìm so sánh doanh thu cửa hàng năm 2002 ở bang CA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CA') as other_states_avg
FROM state_revenues
WHERE s_state = 'CA';"
gen_2946,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Books,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Books'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2947,"Cho tôi biết xếp hạng 10 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 10;"
gen_2948,"Liệt kê xếp hạng 50 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 50;"
gen_2949,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Secondary năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Secondary' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2950,Hãy tìm tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2951,Tìm giúp tôi so sánh doanh thu cửa hàng năm 1999 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2952,Hãy tìm so sánh doanh thu cửa hàng năm 2000 ở bang AR với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AR') as other_states_avg
FROM state_revenues
WHERE s_state = 'AR';"
gen_2953,"Xếp hạng 20 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 20;"
gen_2954,Liệt kê tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2001,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2001
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2955,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ Advanced Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'Advanced Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2956,Liệt kê tìm các sản phẩm danh mục Men có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Men'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Men'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2957,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2958,Truy vấn tìm các sản phẩm danh mục Children có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Children'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Children'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2959,"Tìm giúp tôi xếp hạng 20 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 20;"
gen_2960,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2961,Hãy tìm top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 10;"
gen_2962,Tính toán tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Jewelry,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Jewelry'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2963,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 4 yr Degree năm 1999,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '4 yr Degree' AND d.d_year = 1999
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2964,"Hãy tìm xếp hạng 10 cửa hàng theo doanh thu năm 2001, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001
GROUP BY s.s_store_name
LIMIT 10;"
gen_2965,So sánh doanh thu cửa hàng năm 1999 ở bang ID với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 1999
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'ID') as other_states_avg
FROM state_revenues
WHERE s_state = 'ID';"
gen_2966,Hãy tìm tìm các sản phẩm danh mục Electronics có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Electronics'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2967,Hỏi về so sánh doanh thu cửa hàng năm 2000 ở bang CA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'CA') as other_states_avg
FROM state_revenues
WHERE s_state = 'CA';"
gen_2968,Hỏi về so sánh doanh thu cửa hàng năm 2002 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2969,Tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2000,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2000
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2970,Truy vấn tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2971,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Toys,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Toys'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2972,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Children,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Children'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2973,Tìm giúp tôi tìm các sản phẩm danh mục Women có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Women'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Women'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2974,Tính toán tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ College năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = 'College' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2975,Truy vấn tính doanh thu tích lũy (running total) theo tháng cho nhóm khách hàng trình độ 2 yr Degree năm 2002,"SELECT d.d_moy,
       SUM(ss.ss_net_paid) as revenue,
       SUM(SUM(ss.ss_net_paid)) OVER (ORDER BY d.d_moy) as cumulative_revenue
FROM store_sales ss
JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE cd.cd_education_status = '2 yr Degree' AND d.d_year = 2002
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2976,Truy vấn so sánh doanh thu cửa hàng năm 2000 ở bang KS với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'KS') as other_states_avg
FROM state_revenues
WHERE s_state = 'KS';"
gen_2977,Tính toán top 50 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (1999 - 1, 1999)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 1999 - 1 AND t2.d_year = 1999
ORDER BY growth DESC
LIMIT 50;"
gen_2978,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 1999 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2979,"Liệt kê xếp hạng 5 cửa hàng theo doanh thu năm 2000, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000
GROUP BY s.s_store_name
LIMIT 5;"
gen_2980,Tính toán so sánh doanh thu cửa hàng năm 2002 ở bang IA với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'IA') as other_states_avg
FROM state_revenues
WHERE s_state = 'IA';"
gen_2981,Hỏi về tìm các sản phẩm danh mục Toys có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Toys'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Toys'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2982,Hãy tìm tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2983,Hỏi về top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 5;"
gen_2984,Truy vấn so sánh doanh thu cửa hàng năm 2000 ở bang NY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2000
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'NY') as other_states_avg
FROM state_revenues
WHERE s_state = 'NY';"
gen_2985,Truy vấn so sánh doanh thu cửa hàng năm 2002 ở bang AZ với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2002
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'AZ') as other_states_avg
FROM state_revenues
WHERE s_state = 'AZ';"
gen_2986,"Thống kê xếp hạng 100 cửa hàng theo doanh thu năm 1999, hiển thị cả rank","SELECT s.s_store_name, 
       SUM(ss.ss_net_paid) as revenue,
       RANK() OVER (ORDER BY SUM(ss.ss_net_paid) DESC) as store_rank
FROM store_sales ss
JOIN store s ON ss.ss_store_sk = s.s_store_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999
GROUP BY s.s_store_name
LIMIT 100;"
gen_2987,Thống kê so sánh doanh thu cửa hàng năm 2001 ở bang NY với doanh thu trung bình các bang khác,"WITH state_revenues AS (
    SELECT s.s_state, SUM(ss.ss_net_paid) as revenue
    FROM store_sales ss
    JOIN store s ON ss.ss_store_sk = s.s_store_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year = 2001
    GROUP BY s.s_state
)
SELECT revenue as state_revenue,
       (SELECT AVG(revenue) FROM state_revenues WHERE s_state != 'NY') as other_states_avg
FROM state_revenues
WHERE s_state = 'NY';"
gen_2988,Cho tôi biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Women,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Women'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2989,Thống kê tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2001,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2990,Làm ơn cho biết top 10 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2002 - 1, 2002)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2002 - 1 AND t2.d_year = 2002
ORDER BY growth DESC
LIMIT 10;"
gen_2991,Tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Clothing,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Clothing'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2992,Hãy tìm top 20 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 20;"
gen_2993,Truy vấn top 5 khách hàng tăng trưởng chi tiêu mạnh nhất (year-over-year growth) so với năm trước đó,"WITH cust_sales AS (
    SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year, SUM(ss.ss_net_paid) as annual_spend
    FROM store_sales ss
    JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk
    JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
    WHERE d.d_year IN (2000 - 1, 2000)
    GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name, d.d_year
)
SELECT t2.c_first_name, t2.c_last_name, 
       (t2.annual_spend - t1.annual_spend) as growth
FROM cust_sales t1
JOIN cust_sales t2 ON t1.c_customer_sk = t2.c_customer_sk
WHERE t1.d_year = 2000 - 1 AND t2.d_year = 2000
ORDER BY growth DESC
LIMIT 5;"
gen_2994,Cho tôi biết tìm các sản phẩm danh mục Jewelry có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2000,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Jewelry'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2995,Làm ơn cho biết tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2002 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2996,Thống kê tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 2002,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2002 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2997,Liệt kê tìm các sản phẩm danh mục Home có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Home'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Home'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_2998,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2001 cho danh mục Sports,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2001 AND i.i_category = 'Sports'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
gen_2999,Tìm giúp tôi tìm các sản phẩm danh mục Clothing có doanh thu cao hơn doanh thu trung bình của danh mục đó trong năm 1999,"WITH cat_avg AS (
    SELECT AVG(item_revenue) as avg_rev
    FROM (
        SELECT i.i_item_sk, SUM(ss.ss_net_paid) as item_revenue
        FROM store_sales ss
        JOIN item i ON ss.ss_item_sk = i.i_item_sk
        JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
        WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
        GROUP BY i.i_item_sk
    ) sub
)
SELECT i.i_item_desc, SUM(ss.ss_net_paid) as revenue
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 1999 AND i.i_category = 'Clothing'
GROUP BY i.i_item_desc
HAVING SUM(ss.ss_net_paid) > (SELECT avg_rev FROM cat_avg)
ORDER BY revenue DESC;"
gen_3000,Hỏi về tính tổng doanh thu theo tháng và tỷ lệ đóng góp của từng tháng trong năm 2000 cho danh mục Home,"SELECT d.d_moy, 
       SUM(ss.ss_net_paid) as monthly_sales,
       SUM(ss.ss_net_paid) * 100.0 / SUM(SUM(ss.ss_net_paid)) OVER () as pct_contribution
FROM store_sales ss
JOIN item i ON ss.ss_item_sk = i.i_item_sk
JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
WHERE d.d_year = 2000 AND i.i_category = 'Home'
GROUP BY d.d_moy
ORDER BY d.d_moy;"
